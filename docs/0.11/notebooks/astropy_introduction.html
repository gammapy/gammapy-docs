

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Astropy introduction for Gammapy users &mdash; gammapy v0.11</title>
  

  
  
    <link rel="shortcut icon" href="../_static/gammapy_logo.ico"/>
  
  
  
    <link rel="canonical" href="https://docs.gammapy.org/dev/notebooks/astropy_introduction.html"/>
  

  

  
  
    

  

  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/graphviz.css" type="text/css" />
  <link rel="stylesheet" href="../_static/gammapy.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Fitting 2D images with Gammapy" href="image_analysis.html" />
    <link rel="prev" title="Spectrum simulation for CTA" href="spectrum_simulation_cta.html" /> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> gammapy
          

          
          </a>

          
            
            
              <div class="version">
                0.11
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting Started</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../getting-started.html">Getting Started</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../getting-started.html#help">Help!?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting-started.html#install">Install</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting-started.html#download-tutorials">Download tutorials</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting-started.html#check-your-setup">Check your setup</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting-started.html#use-gammapy">Use Gammapy</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../getting-started.html#id2">Python</a></li>
<li class="toctree-l3"><a class="reference internal" href="../getting-started.html#ipython">IPython</a></li>
<li class="toctree-l3"><a class="reference internal" href="../getting-started.html#python-script">Python script</a></li>
<li class="toctree-l3"><a class="reference internal" href="../getting-started.html#command-line">Command line</a></li>
<li class="toctree-l3"><a class="reference internal" href="../getting-started.html#jupyter-notebooks">Jupyter notebooks</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../getting-started.html#install-issues">Install issues</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="../tutorials.html">Tutorial notebooks</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../tutorials.html#notebooks">Notebooks</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="first_steps.html">Getting started with Gammapy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="first_steps.html#Introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="first_steps.html#Setup">Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="first_steps.html#Maps">Maps</a></li>
<li class="toctree-l4"><a class="reference internal" href="first_steps.html#Event-lists">Event lists</a></li>
<li class="toctree-l4"><a class="reference internal" href="first_steps.html#Source-catalogs">Source catalogs</a></li>
<li class="toctree-l4"><a class="reference internal" href="first_steps.html#Spectral-models-and-flux-points">Spectral models and flux points</a></li>
<li class="toctree-l4"><a class="reference internal" href="first_steps.html#What-next?">What next?</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="intro_maps.html">Gammapy Maps</a><ul>
<li class="toctree-l4"><a class="reference internal" href="intro_maps.html#Introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="intro_maps.html#0.-Setup">0. Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="intro_maps.html#1.-Creating-WCS-Maps">1. Creating WCS Maps</a></li>
<li class="toctree-l4"><a class="reference internal" href="intro_maps.html#2.-Accessing-and-Modifying-Data">2. Accessing and Modifying Data</a></li>
<li class="toctree-l4"><a class="reference internal" href="intro_maps.html#3.-Reading-and-Writing">3. Reading and Writing</a></li>
<li class="toctree-l4"><a class="reference internal" href="intro_maps.html#4.-Visualizing-and-Plotting">4. Visualizing and Plotting</a></li>
<li class="toctree-l4"><a class="reference internal" href="intro_maps.html#5.-Reprojecting,-Interpolating-and-Miscellaneous">5. Reprojecting, Interpolating and Miscellaneous</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="cta_1dc_introduction.html">CTA first data challenge (1DC) with Gammapy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="cta_1dc_introduction.html#Introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="cta_1dc_introduction.html#Notebook-and-Gammapy-Setup">Notebook and Gammapy Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="cta_1dc_introduction.html#DC-1-data">DC-1 data</a></li>
<li class="toctree-l4"><a class="reference internal" href="cta_1dc_introduction.html#EVENT-data">EVENT data</a></li>
<li class="toctree-l4"><a class="reference internal" href="cta_1dc_introduction.html#EVENT-analysis-example">EVENT analysis example</a></li>
<li class="toctree-l4"><a class="reference internal" href="cta_1dc_introduction.html#IRFs">IRFs</a></li>
<li class="toctree-l4"><a class="reference internal" href="cta_1dc_introduction.html#Index-files-and-DataStore">Index files and DataStore</a></li>
<li class="toctree-l4"><a class="reference internal" href="cta_1dc_introduction.html#Select-observations">Select observations</a></li>
<li class="toctree-l4"><a class="reference internal" href="cta_1dc_introduction.html#Load-data">Load data</a></li>
<li class="toctree-l4"><a class="reference internal" href="cta_1dc_introduction.html#Model-XML-files">Model XML files</a></li>
<li class="toctree-l4"><a class="reference internal" href="cta_1dc_introduction.html#Exercises">Exercises</a></li>
<li class="toctree-l4"><a class="reference internal" href="cta_1dc_introduction.html#What-next?">What next?</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="cta_data_analysis.html">CTA data analysis with Gammapy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="cta_data_analysis.html#Introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="cta_data_analysis.html#Setup">Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="cta_data_analysis.html#Select-observations">Select observations</a></li>
<li class="toctree-l4"><a class="reference internal" href="cta_data_analysis.html#Make-sky-images">Make sky images</a></li>
<li class="toctree-l4"><a class="reference internal" href="cta_data_analysis.html#Source-Detection">Source Detection</a></li>
<li class="toctree-l4"><a class="reference internal" href="cta_data_analysis.html#Spatial-analysis">Spatial analysis</a></li>
<li class="toctree-l4"><a class="reference internal" href="cta_data_analysis.html#Spectrum">Spectrum</a></li>
<li class="toctree-l4"><a class="reference internal" href="cta_data_analysis.html#Exercises">Exercises</a></li>
<li class="toctree-l4"><a class="reference internal" href="cta_data_analysis.html#What-next?">What next?</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="analysis_3d.html">3D analysis</a><ul>
<li class="toctree-l4"><a class="reference internal" href="analysis_3d.html#Setup">Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="analysis_3d.html#Prepare-modeling-input-data">Prepare modeling input data</a></li>
<li class="toctree-l4"><a class="reference internal" href="analysis_3d.html#Likelihood-fit">Likelihood fit</a></li>
<li class="toctree-l4"><a class="reference internal" href="analysis_3d.html#Exercises">Exercises</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="analysis_3d_joint.html">Joint 3D Analysis</a><ul>
<li class="toctree-l4"><a class="reference internal" href="analysis_3d_joint.html#Prepare-modeling-input-data">Prepare modeling input data</a></li>
<li class="toctree-l4"><a class="reference internal" href="analysis_3d_joint.html#Likelihood-fit">Likelihood fit</a></li>
<li class="toctree-l4"><a class="reference internal" href="analysis_3d_joint.html#Plotting-residuals">Plotting residuals</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="simulate_3d.html">3D simulation and fitting</a><ul>
<li class="toctree-l4"><a class="reference internal" href="simulate_3d.html#Imports-and-versions">Imports and versions</a></li>
<li class="toctree-l4"><a class="reference internal" href="simulate_3d.html#Simulate">Simulate</a></li>
<li class="toctree-l4"><a class="reference internal" href="simulate_3d.html#Fit">Fit</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="hess.html">H.E.S.S. with Gammapy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="hess.html#Data-access">Data access</a></li>
<li class="toctree-l4"><a class="reference internal" href="hess.html#Maps">Maps</a></li>
<li class="toctree-l4"><a class="reference internal" href="hess.html#PSF">PSF</a></li>
<li class="toctree-l4"><a class="reference internal" href="hess.html#Map-fit">Map fit</a></li>
<li class="toctree-l4"><a class="reference internal" href="hess.html#Residual-image">Residual image</a></li>
<li class="toctree-l4"><a class="reference internal" href="hess.html#Spectrum">Spectrum</a></li>
<li class="toctree-l4"><a class="reference internal" href="hess.html#Classical-Ring-Background-Analysis">Classical Ring Background Analysis</a></li>
<li class="toctree-l4"><a class="reference internal" href="hess.html#Exercises">Exercises</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="detect_ts.html">Source detection with Gammapy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="detect_ts.html#Introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="detect_ts.html#Setup">Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="detect_ts.html#Read-in-input-images">Read in input images</a></li>
<li class="toctree-l4"><a class="reference internal" href="detect_ts.html#Plot-images">Plot images</a></li>
<li class="toctree-l4"><a class="reference internal" href="detect_ts.html#Source-catalog">Source catalog</a></li>
<li class="toctree-l4"><a class="reference internal" href="detect_ts.html#Measurements">Measurements</a></li>
<li class="toctree-l4"><a class="reference internal" href="detect_ts.html#Compare-to-3FHL">Compare to 3FHL</a></li>
<li class="toctree-l4"><a class="reference internal" href="detect_ts.html#Exercises">Exercises</a></li>
<li class="toctree-l4"><a class="reference internal" href="detect_ts.html#What-next?">What next?</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="image_fitting_with_sherpa.html">Fitting 2D images with Sherpa</a><ul>
<li class="toctree-l4"><a class="reference internal" href="image_fitting_with_sherpa.html#Introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="image_fitting_with_sherpa.html#Necessary-imports">Necessary imports</a></li>
<li class="toctree-l4"><a class="reference internal" href="image_fitting_with_sherpa.html#Generate-the-required-Maps">Generate the required Maps</a></li>
<li class="toctree-l4"><a class="reference internal" href="image_fitting_with_sherpa.html#Making-a-PSF-Map">Making a PSF Map</a></li>
<li class="toctree-l4"><a class="reference internal" href="image_fitting_with_sherpa.html#Make-2D-images-from-3D-ones">Make 2D images from 3D ones</a></li>
<li class="toctree-l4"><a class="reference internal" href="image_fitting_with_sherpa.html#Read-the-maps-and-store-them-in-a-sherpa-model">Read the maps and store them in a sherpa model</a></li>
<li class="toctree-l4"><a class="reference internal" href="image_fitting_with_sherpa.html#Find-and-fit-the-brightest-source">Find and fit the brightest source</a></li>
<li class="toctree-l4"><a class="reference internal" href="image_fitting_with_sherpa.html#Iteratively-find-and-fit-additional-sources">Iteratively find and fit additional sources</a></li>
<li class="toctree-l4"><a class="reference internal" href="image_fitting_with_sherpa.html#Generating-output-table-and-Test-Statistics-estimation">Generating output table and Test Statistics estimation</a></li>
<li class="toctree-l4"><a class="reference internal" href="image_fitting_with_sherpa.html#Exercises">Exercises</a></li>
<li class="toctree-l4"><a class="reference internal" href="image_fitting_with_sherpa.html#More-about-sherpa">More about sherpa</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="spectrum_models.html">Spectral models in Gammapy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="spectrum_models.html#Introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_models.html#Setup">Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_models.html#Create-a-model">Create a model</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_models.html#Get-and-set-model-parameters">Get and set model parameters</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_models.html#List-available-models">List available models</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_models.html#Plotting">Plotting</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_models.html#Parameter-errors">Parameter errors</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_models.html#Integral-fluxes">Integral fluxes</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_models.html#User-defined-model">User-defined model</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_models.html#What’s-next?">What’s next?</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="spectrum_pipe.html">Spectrum analysis with Gammapy (run pipeline)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="spectrum_pipe.html#Setup">Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_pipe.html#Select-data">Select data</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_pipe.html#Configure-the-analysis">Configure the analysis</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_pipe.html#Run-the-analysis">Run the analysis</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_pipe.html#Results">Results</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_pipe.html#Exercises">Exercises</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="spectrum_analysis.html">Spectral analysis with Gammapy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="spectrum_analysis.html#Introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_analysis.html#Setup">Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_analysis.html#Configure-logger">Configure logger</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_analysis.html#Load-Data">Load Data</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_analysis.html#Define-Target-Region">Define Target Region</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_analysis.html#Create-exclusion-mask">Create exclusion mask</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_analysis.html#Estimate-background">Estimate background</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_analysis.html#Source-statistic">Source statistic</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_analysis.html#Extract-spectrum">Extract spectrum</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_analysis.html#Look-at-observations">Look at observations</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_analysis.html#Fit-spectrum">Fit spectrum</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_analysis.html#Compute-Flux-Points">Compute Flux Points</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_analysis.html#Stack-observations">Stack observations</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_analysis.html#Exercises">Exercises</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="spectrum_fitting_with_sherpa.html">Fitting gammapy spectra with sherpa</a><ul>
<li class="toctree-l4"><a class="reference internal" href="spectrum_fitting_with_sherpa.html#Load-data-stack">Load data stack</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_fitting_with_sherpa.html#Define-source-model">Define source model</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_fitting_with_sherpa.html#Fit-and-error-estimation">Fit and error estimation</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_fitting_with_sherpa.html#Results-plot">Results plot</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_fitting_with_sherpa.html#Errors-and-confidence-contours">Errors and confidence contours</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_fitting_with_sherpa.html#Exercises">Exercises</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="sed_fitting_gammacat_fermi.html">Flux point fitting in Gammapy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="sed_fitting_gammacat_fermi.html#Introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="sed_fitting_gammacat_fermi.html#Setup">Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="sed_fitting_gammacat_fermi.html#Load-spectral-points">Load spectral points</a></li>
<li class="toctree-l4"><a class="reference internal" href="sed_fitting_gammacat_fermi.html#Power-Law-Fit">Power Law Fit</a></li>
<li class="toctree-l4"><a class="reference internal" href="sed_fitting_gammacat_fermi.html#Exponential-Cut-Off-Powerlaw-Fit">Exponential Cut-Off Powerlaw Fit</a></li>
<li class="toctree-l4"><a class="reference internal" href="sed_fitting_gammacat_fermi.html#Log-Parabola-Fit">Log-Parabola Fit</a></li>
<li class="toctree-l4"><a class="reference internal" href="sed_fitting_gammacat_fermi.html#Exercises">Exercises</a></li>
<li class="toctree-l4"><a class="reference internal" href="sed_fitting_gammacat_fermi.html#What-next?">What next?</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="fermi_lat.html">Fermi-LAT data with Gammapy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="fermi_lat.html#Introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="fermi_lat.html#Setup">Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="fermi_lat.html#Events">Events</a></li>
<li class="toctree-l4"><a class="reference internal" href="fermi_lat.html#Counts">Counts</a></li>
<li class="toctree-l4"><a class="reference internal" href="fermi_lat.html#Exposure">Exposure</a></li>
<li class="toctree-l4"><a class="reference internal" href="fermi_lat.html#Galactic-diffuse-background">Galactic diffuse background</a></li>
<li class="toctree-l4"><a class="reference internal" href="fermi_lat.html#Isotropic-diffuse-background">Isotropic diffuse background</a></li>
<li class="toctree-l4"><a class="reference internal" href="fermi_lat.html#PSF">PSF</a></li>
<li class="toctree-l4"><a class="reference internal" href="fermi_lat.html#Background">Background</a></li>
<li class="toctree-l4"><a class="reference internal" href="fermi_lat.html#Excess-and-flux">Excess and flux</a></li>
<li class="toctree-l4"><a class="reference internal" href="fermi_lat.html#Fit">Fit</a></li>
<li class="toctree-l4"><a class="reference internal" href="fermi_lat.html#Exercises">Exercises</a></li>
<li class="toctree-l4"><a class="reference internal" href="fermi_lat.html#Summary">Summary</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="light_curve.html">Light curves</a><ul>
<li class="toctree-l4"><a class="reference internal" href="light_curve.html#Introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="light_curve.html#Setup">Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="light_curve.html#Spectrum">Spectrum</a></li>
<li class="toctree-l4"><a class="reference internal" href="light_curve.html#Light-curve-estimation">Light curve estimation</a></li>
<li class="toctree-l4"><a class="reference internal" href="light_curve.html#Results">Results</a></li>
<li class="toctree-l4"><a class="reference internal" href="light_curve.html#Exercises">Exercises</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="cta_sensitivity.html">Estimation of the CTA point source sensitivity</a><ul>
<li class="toctree-l4"><a class="reference internal" href="cta_sensitivity.html#Introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="cta_sensitivity.html#Setup">Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="cta_sensitivity.html#Define-analysis-region-and-energy-binning">Define analysis region and energy binning</a></li>
<li class="toctree-l4"><a class="reference internal" href="cta_sensitivity.html#Load-IRFs">Load IRFs</a></li>
<li class="toctree-l4"><a class="reference internal" href="cta_sensitivity.html#Determine-energy-dependent-integration-radius">Determine energy dependent integration radius</a></li>
<li class="toctree-l4"><a class="reference internal" href="cta_sensitivity.html#Estimate-background">Estimate background</a></li>
<li class="toctree-l4"><a class="reference internal" href="cta_sensitivity.html#Compute-sensitivity">Compute sensitivity</a></li>
<li class="toctree-l4"><a class="reference internal" href="cta_sensitivity.html#Results">Results</a></li>
<li class="toctree-l4"><a class="reference internal" href="cta_sensitivity.html#Exercises">Exercises</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="spectrum_simulation.html">Spectrum simulation with Gammapy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="spectrum_simulation.html#Introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_simulation.html#Setup">Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_simulation.html#Create-detector">Create detector</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_simulation.html#Power-law">Power law</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_simulation.html#Include-background">Include background</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_simulation.html#Exercises">Exercises</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_simulation.html#What’s-next">What’s next</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="spectrum_simulation_cta.html">Spectrum simulation for CTA</a><ul>
<li class="toctree-l4"><a class="reference internal" href="spectrum_simulation_cta.html#Setup">Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_simulation_cta.html#Simulation">Simulation</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_simulation_cta.html#Spectral-analysis">Spectral analysis</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_simulation_cta.html#Exercises">Exercises</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_simulation_cta.html#What-next?">What next?</a></li>
</ul>
</li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Astropy introduction for Gammapy users</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Setup">Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Units-and-constants">Units and constants</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Coordinates">Coordinates</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Time">Time</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Table:-Manipulating-the-3FGL-catalog">Table: Manipulating the 3FGL catalog</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Exercises">Exercises</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="image_analysis.html">Fitting 2D images with Gammapy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="image_analysis.html#Setup">Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="image_analysis.html#Prepare-modeling-input-data">Prepare modeling input data</a></li>
<li class="toctree-l4"><a class="reference internal" href="image_analysis.html#Define-a-mask">Define a mask</a></li>
<li class="toctree-l4"><a class="reference internal" href="image_analysis.html#Modeling-the-source">Modeling the source</a></li>
<li class="toctree-l4"><a class="reference internal" href="image_analysis.html#Modeling-the-background">Modeling the background</a></li>
<li class="toctree-l4"><a class="reference internal" href="image_analysis.html#Todo:-Demonstrate-plotting-a-flux-map">Todo: Demonstrate plotting a flux map</a></li>
<li class="toctree-l4"><a class="reference internal" href="image_analysis.html#Exercises">Exercises</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials.html#extra-topics">Extra topics</a><ul>
<li class="toctree-l3"><a class="reference internal" href="hgps.html">HGPS</a><ul>
<li class="toctree-l4"><a class="reference internal" href="hgps.html#Introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="hgps.html#Notebook-Overview">Notebook Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="hgps.html#Packages">Packages</a></li>
<li class="toctree-l4"><a class="reference internal" href="hgps.html#Setup">Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="hgps.html#Download-Data">Download Data</a></li>
<li class="toctree-l4"><a class="reference internal" href="hgps.html#Catalog-with-Astropy">Catalog with Astropy</a></li>
<li class="toctree-l4"><a class="reference internal" href="hgps.html#Maps-with-Astropy">Maps with Astropy</a></li>
<li class="toctree-l4"><a class="reference internal" href="hgps.html#Catalog-with-Gammapy">Catalog with Gammapy</a></li>
<li class="toctree-l4"><a class="reference internal" href="hgps.html#Maps-with-Gammapy">Maps with Gammapy</a></li>
<li class="toctree-l4"><a class="reference internal" href="hgps.html#Conclusions">Conclusions</a></li>
<li class="toctree-l4"><a class="reference internal" href="hgps.html#Exercises">Exercises</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="source_population_model.html">Astrophysical source population modeling with Gammapy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="source_population_model.html#Introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="source_population_model.html#Setup">Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="source_population_model.html#Simulate-positions">Simulate positions</a></li>
<li class="toctree-l4"><a class="reference internal" href="source_population_model.html#Simulate-luminosities">Simulate luminosities</a></li>
<li class="toctree-l4"><a class="reference internal" href="source_population_model.html#Compute-observable-parameters">Compute observable parameters</a></li>
<li class="toctree-l4"><a class="reference internal" href="source_population_model.html#Check-output">Check output</a></li>
<li class="toctree-l4"><a class="reference internal" href="source_population_model.html#Exercises">Exercises</a></li>
<li class="toctree-l4"><a class="reference internal" href="source_population_model.html#What-next?">What next?</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="cwt.html">CWT Algorithm</a><ul>
<li class="toctree-l4"><a class="reference internal" href="cwt.html#Setup">Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="cwt.html#CWT-Algorithm">CWT Algorithm</a></li>
<li class="toctree-l4"><a class="reference internal" href="cwt.html#Results-of-analysis">Results of analysis</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="astro_dark_matter.html">Dark matter utilities</a><ul>
<li class="toctree-l4"><a class="reference internal" href="astro_dark_matter.html#Introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="astro_dark_matter.html#Setup">Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="astro_dark_matter.html#Profiles">Profiles</a></li>
<li class="toctree-l4"><a class="reference internal" href="astro_dark_matter.html#J-Factors">J Factors</a></li>
<li class="toctree-l4"><a class="reference internal" href="astro_dark_matter.html#Gamma-ray-spectra-at-production">Gamma-ray spectra at production</a></li>
<li class="toctree-l4"><a class="reference internal" href="astro_dark_matter.html#Flux-maps">Flux maps</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="background_model.html">Make template background model</a><ul>
<li class="toctree-l4"><a class="reference internal" href="background_model.html#Introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="background_model.html#Setup">Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="background_model.html#Select-off-data">Select off data</a></li>
<li class="toctree-l4"><a class="reference internal" href="background_model.html#Background-model">Background model</a></li>
<li class="toctree-l4"><a class="reference internal" href="background_model.html#Zenith-dependence">Zenith dependence</a></li>
<li class="toctree-l4"><a class="reference internal" href="background_model.html#Index-tables">Index tables</a></li>
<li class="toctree-l4"><a class="reference internal" href="background_model.html#Exercises">Exercises</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="mcmc_sampling.html">Fitting and error estimation with MCMC</a><ul>
<li class="toctree-l4"><a class="reference internal" href="mcmc_sampling.html#Introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="mcmc_sampling.html#Simulate-an-observation">Simulate an observation</a></li>
<li class="toctree-l4"><a class="reference internal" href="mcmc_sampling.html#Estimate-parameter-correlations-with-MCMC">Estimate parameter correlations with MCMC</a></li>
<li class="toctree-l4"><a class="reference internal" href="mcmc_sampling.html#Plotting-the-results">Plotting the results</a></li>
<li class="toctree-l4"><a class="reference internal" href="mcmc_sampling.html#Plot-the-results">Plot the results</a></li>
<li class="toctree-l4"><a class="reference internal" href="mcmc_sampling.html#Plot-the-model-dispersion">Plot the model dispersion</a></li>
<li class="toctree-l4"><a class="reference internal" href="mcmc_sampling.html#Fun-Zone">Fun Zone</a></li>
<li class="toctree-l4"><a class="reference internal" href="mcmc_sampling.html#PeVatrons-in-CTA-?">PeVatrons in CTA ?</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="pulsar_analysis.html">Pulsar analysis with Gammapy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="pulsar_analysis.html#Introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="pulsar_analysis.html#Opening-the-data">Opening the data</a></li>
<li class="toctree-l4"><a class="reference internal" href="pulsar_analysis.html#Phasogram">Phasogram</a></li>
<li class="toctree-l4"><a class="reference internal" href="pulsar_analysis.html#Phase-resolved-map">Phase-resolved map</a></li>
<li class="toctree-l4"><a class="reference internal" href="pulsar_analysis.html#Phase-resolved-spectrum">Phase-resolved spectrum</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials.html#basics">Basics</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../install/index.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../install/index.html#quick-install-guide">Quick install guide</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../install/index.html#stable-version">Stable version</a></li>
<li class="toctree-l3"><a class="reference internal" href="../install/index.html#development-version">Development version</a></li>
<li class="toctree-l3"><a class="reference internal" href="../install/index.html#verify">Verify</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../install/index.html#need-help">Need help?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../install/index.html#detailed-information">Detailed information</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../install/conda.html">Installation with conda</a></li>
<li class="toctree-l3"><a class="reference internal" href="../install/pip.html">Installation with pip or setup.py</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../install/pip.html#install-pip">pip</a></li>
<li class="toctree-l4"><a class="reference internal" href="../install/pip.html#setup-py">setup.py</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../install/macports.html">Installation with Macports</a></li>
<li class="toctree-l3"><a class="reference internal" href="../install/other.html">Other package managers</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../install/other.html#id1">apt-get</a></li>
<li class="toctree-l4"><a class="reference internal" href="../install/other.html#id2">yum</a></li>
<li class="toctree-l4"><a class="reference internal" href="../install/other.html#id3">Homebrew</a></li>
<li class="toctree-l4"><a class="reference internal" href="../install/other.html#id4">Fermi ScienceTools</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../install/check.html">Check Gammapy installation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../install/check.html#how-to-run-checks">How to run checks</a></li>
<li class="toctree-l4"><a class="reference internal" href="../install/check.html#common-issues">Common issues</a></li>
<li class="toctree-l4"><a class="reference internal" href="../install/check.html#known-issues">Known issues</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../install/dependencies.html">Dependencies</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../references.html">References</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../references.html#publications">Publications</a></li>
<li class="toctree-l2"><a class="reference internal" href="../references.html#glossary">Glossary</a></li>
<li class="toctree-l2"><a class="reference internal" href="../references.html#other-gamma-ray-packages">Other gamma-ray packages</a></li>
<li class="toctree-l2"><a class="reference internal" href="../references.html#other-useful-packages">Other useful packages</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">Changelog</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#gammapy-0p11-release">0.11 (2019-03-29)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../changelog.html#summary">Summary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../changelog.html#pull-requests">Pull requests</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#gammapy-0p10-release">0.10 (2019-01-28)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../changelog.html#id4">Summary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../changelog.html#id5">Pull requests</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#gammapy-0p9-release">0.9 (2018-11-29)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../changelog.html#id7">Summary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../changelog.html#id8">Pull requests</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#gammapy-0p8-release">0.8 (2018-09-23)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../changelog.html#id10">Summary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../changelog.html#id11">Pull requests</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#gammapy-0p7-release">0.7 (2018-02-28)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../changelog.html#id13">Summary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../changelog.html#id15">Pull requests</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#april-28-2017">0.6 (April 28, 2017)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../changelog.html#id16">Summary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../changelog.html#id17">Pull requests</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#november-22-2016">0.5 (November 22, 2016)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../changelog.html#id18">Summary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../changelog.html#id19">Pull requests</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#april-20-2016">0.4 (April 20, 2016)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../changelog.html#id20">Summary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../changelog.html#id21">Pull requests</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#august-13-2015">0.3 (August 13, 2015)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../changelog.html#id22">Summary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../changelog.html#id23">Pull requests</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#april-13-2015">0.2 (April 13, 2015)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../changelog.html#id24">Summary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../changelog.html#id25">Pull requests</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#august-25-2014">0.1 (August 25, 2014)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../changelog.html#id26">Summary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../changelog.html#id27">Pull requests</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Gammapy Package</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../data/index.html">data - Data and observations</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../data/index.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../data/index.html#getting-started">Getting Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="../data/index.html#using-gammapy-data">Using <code class="docutils literal notranslate"><span class="pre">gammapy.data</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../data/index.html#reference-api">Reference/API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../data/index.html#module-gammapy.data">gammapy.data Package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../data/index.html#classes">Classes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../data/index.html#variables">Variables</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../irf/index.html">irf - Instrument response functions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../irf/index.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../irf/index.html#getting-started">Getting Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="../irf/index.html#effective-area">Effective area</a></li>
<li class="toctree-l2"><a class="reference internal" href="../irf/index.html#background">Background</a></li>
<li class="toctree-l2"><a class="reference internal" href="../irf/index.html#psf">PSF</a></li>
<li class="toctree-l2"><a class="reference internal" href="../irf/index.html#energy-dispersion">Energy Dispersion</a></li>
<li class="toctree-l2"><a class="reference internal" href="../irf/index.html#using-gammapy-irf">Using <code class="docutils literal notranslate"><span class="pre">gammapy.irf</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="../irf/theory.html">IRF Theory</a></li>
<li class="toctree-l3"><a class="reference internal" href="../irf/aeff.html">Effective area</a></li>
<li class="toctree-l3"><a class="reference internal" href="../irf/edisp.html">Energy dispersion</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../irf/index.html#reference-api">Reference/API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../irf/index.html#module-gammapy.irf">gammapy.irf Package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../irf/index.html#functions">Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../irf/index.html#classes">Classes</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../maps/index.html">maps - Sky maps</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../maps/index.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../maps/index.html#getting-started">Getting Started</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../maps/index.html#constructing-with-factory-methods">Constructing with Factory Methods</a></li>
<li class="toctree-l3"><a class="reference internal" href="../maps/index.html#indexing-and-slicing">Indexing and Slicing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../maps/index.html#accessor-methods">Accessor Methods</a></li>
<li class="toctree-l3"><a class="reference internal" href="../maps/index.html#interface-with-mapcoord-and-skycoord">Interface with <code class="docutils literal notranslate"><span class="pre">MapCoord</span></code> and <code class="docutils literal notranslate"><span class="pre">SkyCoord</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../maps/index.html#mapcoord">MapCoord</a></li>
<li class="toctree-l3"><a class="reference internal" href="../maps/index.html#interpolation">Interpolation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../maps/index.html#projection">Projection</a></li>
<li class="toctree-l3"><a class="reference internal" href="../maps/index.html#iterating-on-a-map">Iterating on a Map</a></li>
<li class="toctree-l3"><a class="reference internal" href="../maps/index.html#fits-i-o">FITS I/O</a></li>
<li class="toctree-l3"><a class="reference internal" href="../maps/index.html#visualization">Visualization</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../maps/index.html#examples">Examples</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../maps/index.html#creating-a-counts-cube-from-an-ft1-file">Creating a Counts Cube from an FT1 File</a></li>
<li class="toctree-l3"><a class="reference internal" href="../maps/index.html#generating-a-cutout-of-a-model-cube">Generating a Cutout of a Model Cube</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../maps/index.html#using-gammapy-maps">Using <code class="docutils literal notranslate"><span class="pre">gammapy.maps</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="../maps/hpxmap.html">HEALPix-based Maps</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../maps/hpxmap.html#healpix-geometry">HEALPix Geometry</a></li>
<li class="toctree-l4"><a class="reference internal" href="../maps/hpxmap.html#sparse-maps">Sparse Maps</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../maps/wcsmap.html">WCS-based Maps</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../maps/index.html#reference-api">Reference/API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../maps/index.html#module-gammapy.maps">gammapy.maps Package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../maps/index.html#classes">Classes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../maps/index.html#class-inheritance-diagram">Class Inheritance Diagram</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../image/index.html">image - Map image analysis</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../image/index.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../image/index.html#getting-started">Getting Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="../image/index.html#using-gammapy-image">Using <code class="docutils literal notranslate"><span class="pre">gammapy.image</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="../image/models.html">Morphology models (<code class="docutils literal notranslate"><span class="pre">gammapy.image.models</span></code>)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../image/models.html#introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../image/models.html#getting-started">Getting Started</a></li>
<li class="toctree-l4"><a class="reference internal" href="../image/models.html#reference-api">Reference/API</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../image/plotting.html">Image plotting</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../image/plotting.html#colormaps">Colormaps</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../image/index.html#reference-api">Reference/API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../image/index.html#module-gammapy.image">gammapy.image Package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../image/index.html#functions">Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../image/index.html#classes">Classes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../image/index.html#module-gammapy.image.models">gammapy.image.models Package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../image/index.html#id1">Classes</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../cube/index.html">cube - Map cube analysis</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../cube/index.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cube/index.html#getting-started">Getting Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cube/index.html#using-gammapy-cube">Using <code class="docutils literal notranslate"><span class="pre">gammapy.cube</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../cube/index.html#reference-api">Reference/API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../cube/index.html#module-gammapy.cube">gammapy.cube Package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../cube/index.html#functions">Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cube/index.html#classes">Classes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../cube/index.html#module-gammapy.cube.models">gammapy.cube.models Module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../cube/index.html#id1">Classes</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../detect/index.html">detect - Source detection</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../detect/index.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../detect/index.html#computation-of-ts-images">Computation of TS images</a></li>
<li class="toctree-l2"><a class="reference internal" href="../detect/index.html#computation-of-li-ma-significance-images">Computation of Li &amp; Ma significance images</a></li>
<li class="toctree-l2"><a class="reference internal" href="../detect/index.html#using-gammapy-detect">Using <code class="docutils literal notranslate"><span class="pre">gammapy.detect</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../detect/index.html#reference-api">Reference/API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../detect/index.html#module-gammapy.detect">gammapy.detect Package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../detect/index.html#functions">Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../detect/index.html#classes">Classes</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../background/index.html">background - Background modeling</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../background/index.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../background/index.html#getting-started">Getting Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="../background/index.html#using-gammapy-background">Using <code class="docutils literal notranslate"><span class="pre">gammapy.background</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="../background/reflected.html">Reflected regions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../background/index.html#reference-api">Reference/API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../background/index.html#module-gammapy.background">gammapy.background Package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../background/index.html#functions">Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../background/index.html#classes">Classes</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../spectrum/index.html">spectrum - 1D spectrum analysis</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../spectrum/index.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../spectrum/index.html#getting-started">Getting Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="../spectrum/index.html#using-gammapy-spectrum">Using <code class="docutils literal notranslate"><span class="pre">gammapy.spectrum</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="../spectrum/fitting.html">Spectral Fitting</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../spectrum/fitting.html#getting-started">Getting Started</a></li>
<li class="toctree-l4"><a class="reference internal" href="../spectrum/fitting.html#interactive-sherpa-fit">Interactive Sherpa Fit</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../spectrum/index.html#reference-api">Reference/API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../spectrum/index.html#module-gammapy.spectrum">gammapy.spectrum Package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../spectrum/index.html#functions">Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../spectrum/index.html#classes">Classes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../spectrum/index.html#module-gammapy.spectrum.models">gammapy.spectrum.models Module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../spectrum/index.html#id4">Classes</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../time/index.html">time - Time analysis</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../time/index.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../time/index.html#getting-started">Getting Started</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../time/index.html#lightcurve">Lightcurve</a></li>
<li class="toctree-l3"><a class="reference internal" href="../time/index.html#variability-test">Variability test</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../time/index.html#other-codes">Other codes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../time/index.html#using-gammapy-time">Using <code class="docutils literal notranslate"><span class="pre">gammapy.time</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="../time/period.html">Period detection and plotting</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../time/period.html#introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../time/period.html#getting-started">Getting Started</a></li>
<li class="toctree-l4"><a class="reference internal" href="../time/period.html#example">Example</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../time/index.html#reference-api">Reference/API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../time/index.html#module-gammapy.time">gammapy.time Package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../time/index.html#functions">Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../time/index.html#classes">Classes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../time/index.html#module-gammapy.time.models">gammapy.time.models Module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../time/index.html#id1">Classes</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../stats/index.html">stats - Statistics</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../stats/index.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stats/index.html#getting-started">Getting Started</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../stats/index.html#li-ma-significance">Li &amp; Ma Significance</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stats/index.html#confidence-intervals">Confidence Intervals</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../stats/index.html#using-gammapy-stats">Using <code class="docutils literal notranslate"><span class="pre">gammapy.stats</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="../stats/feldman_cousins.html">Feldman and Cousins Confidence Intervals</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stats/feldman_cousins.html#examples">Examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="../stats/feldman_cousins.html#acceptance-interval-fixing">Acceptance Interval Fixing</a></li>
<li class="toctree-l4"><a class="reference internal" href="../stats/feldman_cousins.html#sensitivity">Sensitivity</a></li>
<li class="toctree-l4"><a class="reference internal" href="../stats/feldman_cousins.html#general-case">General Case</a></li>
<li class="toctree-l4"><a class="reference internal" href="../stats/feldman_cousins.html#verification">Verification</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stats/fit_statistics.html">Fit statistics</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stats/fit_statistics.html#introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../stats/fit_statistics.html#gaussian-data">Gaussian data</a></li>
<li class="toctree-l4"><a class="reference internal" href="../stats/fit_statistics.html#poisson-data">Poisson data</a></li>
<li class="toctree-l4"><a class="reference internal" href="../stats/fit_statistics.html#poisson-data-with-background-measurement">Poisson data with background measurement</a></li>
<li class="toctree-l4"><a class="reference internal" href="../stats/fit_statistics.html#further-references">Further references</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../stats/index.html#reference-api">Reference/API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../stats/index.html#module-gammapy.stats">gammapy.stats Package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stats/index.html#functions">Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../stats/index.html#classes">Classes</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../utils/index.html">utils - Utilities</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../utils/index.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../utils/index.html#time-handling-in-gammapy">Time handling in Gammapy</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#time-format-and-scale">Time format and scale</a></li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#mission-elapsed-times-met">Mission elapsed times (MET)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#time-differences">Time differences</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../utils/index.html#energy-handling-in-gammapy">Energy handling in Gammapy</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#basics">Basics</a></li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#energy">Energy</a></li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#energybounds">EnergyBounds</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../utils/index.html#reference-api">Reference/API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#module-gammapy.utils.energy">gammapy.utils.energy Module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#classes">Classes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#module-gammapy.utils.units">gammapy.utils.units Module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#functions">Functions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#module-gammapy.utils.coordinates">gammapy.utils.coordinates Package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#id3">Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#variables">Variables</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#module-gammapy.utils.interpolation">gammapy.utils.interpolation Module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#id4">Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#id5">Classes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#module-gammapy.utils.table">gammapy.utils.table Module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#id6">Functions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#module-gammapy.utils.fits">gammapy.utils.fits Module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#gammapy-fits-utilities">Gammapy FITS utilities</a></li>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#id7">Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#id8">Classes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#module-gammapy.utils.random">gammapy.utils.random Module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#id9">Functions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#module-gammapy.utils.distributions">gammapy.utils.distributions Package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#id10">Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#id11">Classes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#module-gammapy.utils.scripts">gammapy.utils.scripts Module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#id12">Functions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#module-gammapy.utils.testing">gammapy.utils.testing Module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#id13">Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#id14">Classes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#module-gammapy.utils.wcs">gammapy.utils.wcs Module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#id15">Functions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#module-gammapy.utils.nddata">gammapy.utils.nddata Module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#id16">Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#id17">Classes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#module-gammapy.utils.time">gammapy.utils.time Module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#id18">Functions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#module-gammapy.utils.fitting">gammapy.utils.fitting Package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#id19">Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#id20">Classes</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../scripts/index.html">scripts - Command line tools</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../scripts/index.html#introduction">Introduction</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../scripts/index.html#execute">Execute</a></li>
<li class="toctree-l3"><a class="reference internal" href="../scripts/index.html#command-not-found">Command not found</a></li>
<li class="toctree-l3"><a class="reference internal" href="../scripts/index.html#example">Example</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../scripts/index.html#reference">Reference</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../scripts/index.html#gammapy">gammapy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../scripts/index.html#gammapy-check">check</a></li>
<li class="toctree-l4"><a class="reference internal" href="../scripts/index.html#gammapy-download">download</a></li>
<li class="toctree-l4"><a class="reference internal" href="../scripts/index.html#gammapy-image">image</a></li>
<li class="toctree-l4"><a class="reference internal" href="../scripts/index.html#gammapy-info">info</a></li>
<li class="toctree-l4"><a class="reference internal" href="../scripts/index.html#gammapy-jupyter">jupyter</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../scripts/index.html#implementation">Implementation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../scripts/index.html#limitations">Limitations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../scripts/index.html#plan">Plan</a></li>
<li class="toctree-l2"><a class="reference internal" href="../scripts/index.html#write-your-own-cli">Write your own CLI</a></li>
<li class="toctree-l2"><a class="reference internal" href="../scripts/index.html#reference-api">Reference/API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../scripts/index.html#module-gammapy.scripts">gammapy.scripts Package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../scripts/index.html#classes">Classes</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../catalog/index.html">catalog - Source catalogs</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../catalog/index.html#introduction">Introduction</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../catalog/index.html#available-catalogs">Available catalogs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../catalog/index.html#how-it-works">How it works</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../catalog/index.html#getting-started">Getting Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="../catalog/index.html#using-gammapy-catalog">Using <code class="docutils literal notranslate"><span class="pre">gammapy.catalog</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="../catalog/gammacat.html">gamma-cat</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../catalog/gammacat.html#catalog">Catalog</a></li>
<li class="toctree-l4"><a class="reference internal" href="../catalog/gammacat.html#data-collection">Data collection</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../catalog/index.html#reference-api">Reference/API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../catalog/index.html#module-gammapy.catalog">gammapy.catalog Package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../catalog/index.html#functions">Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../catalog/index.html#classes">Classes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../catalog/index.html#variables">Variables</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../astro/index.html">astro - Astrophysics</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../astro/index.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../astro/index.html#getting-started">Getting Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="../astro/index.html#sub-packages">Sub-packages</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../astro/source/index.html">Astrophysical source models (<code class="docutils literal notranslate"><span class="pre">gammapy.astro.source</span></code>)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../astro/source/index.html#introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../astro/source/index.html#getting-started">Getting Started</a></li>
<li class="toctree-l4"><a class="reference internal" href="../astro/source/index.html#using-gammapy-astro-source">Using <code class="docutils literal notranslate"><span class="pre">gammapy.astro.source</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../astro/source/index.html#reference-api">Reference/API</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../astro/population/index.html">Astrophysical source population models (<code class="docutils literal notranslate"><span class="pre">gammapy.astro.population</span></code>)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../astro/population/index.html#introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../astro/population/index.html#getting-started">Getting Started</a></li>
<li class="toctree-l4"><a class="reference internal" href="../astro/population/index.html#reference-api">Reference/API</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../astro/darkmatter/index.html">Dark matter (<code class="docutils literal notranslate"><span class="pre">gammapy.astro.darkmatter</span></code>)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../astro/darkmatter/index.html#introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../astro/darkmatter/index.html#other-packages">Other packages</a></li>
<li class="toctree-l4"><a class="reference internal" href="../astro/darkmatter/index.html#using-gammapy-spectrum">Using <code class="docutils literal notranslate"><span class="pre">gammapy.spectrum</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../astro/darkmatter/index.html#reference-api">Reference/API</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Developer Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../development/index.html">Developer documentation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../development/intro.html">How to contribute to Gammapy?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../development/setup.html">Gammapy project setup</a></li>
<li class="toctree-l2"><a class="reference internal" href="../development/howto.html">Developer HOWTO</a></li>
<li class="toctree-l2"><a class="reference internal" href="../development/release.html">How to make a Gammapy release</a></li>
<li class="toctree-l2"><a class="reference internal" href="../development/pigs/index.html">PIGs</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../development/pigs/pig-001.html">PIG 1 - PIG purpose and guidelines</a></li>
<li class="toctree-l3"><a class="reference internal" href="../development/pigs/pig-002.html">PIG 2 - Organization of low-level analysis code</a></li>
<li class="toctree-l3"><a class="reference internal" href="../development/pigs/pig-003.html">PIG 3 - Plan for dropping Python 2.7 support</a></li>
<li class="toctree-l3"><a class="reference internal" href="../development/pigs/pig-004.html">PIG 4 - Setup for tutorial notebooks and data</a></li>
<li class="toctree-l3"><a class="reference internal" href="../development/pigs/pig-005.html">PIG 5 - Gammapy 1.0 Roadmap</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../development/dataformats.html">Data Formats</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">gammapy</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../tutorials.html">Tutorial notebooks</a> &raquo;</li>
        
      <li>Astropy introduction for Gammapy users</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/notebooks/astropy_introduction.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput,
div.nbinput div.prompt,
div.nbinput div.input_area,
div.nbinput div[class*=highlight],
div.nbinput div[class*=highlight] pre,
div.nboutput,
div.nbinput div.prompt,
div.nbinput div.output_area,
div.nboutput div[class*=highlight],
div.nboutput div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput,
div.nboutput {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput,
    div.nboutput {
        flex-direction: column;
    }
}

/* input container */
div.nbinput {
    padding-top: 5px;
}

/* last container */
div.nblast {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput div.prompt,
div.nboutput div.prompt {
    min-width: 5ex;
    padding-top: 0.4em;
    padding-right: 0.4em;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput div.prompt,
    div.nboutput div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput div.prompt pre,
div.nboutput div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput div.input_area,
div.nboutput div.output_area {
    padding: 0.4em;
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput div.input_area,
    div.nboutput div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    background: #f5f5f5;
}

/* override MathJax center alignment in output cells */
div.nboutput div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput div.math p {
    text-align: left;
}

/* standard error */
div.nboutput div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast,
.nboutput.nblast {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast + .nbinput {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="admonition note">
<p class="admonition-title fa fa-exclamation-circle"><strong>This is a fixed-text formatted version of a Jupyter notebook</strong></p>
<ul class="simple">
<li>Try online <a class="reference external" href="https://mybinder.org/v2/gh/gammapy/gammapy-webpage/v0.11?urlpath=lab/tree/astropy_introduction.ipynb"><img alt="Binder" src="https://mybinder.org/badge.svg" /></a></li>
<li>You can contribute with your own notebooks in this <a class="reference external" href="https://github.com/gammapy/gammapy/tree/master/tutorials">GitHub repository</a>.</li>
<li><strong>Source files:</strong> <a class="reference external" href="../_static/notebooks/astropy_introduction.ipynb">astropy_introduction.ipynb</a> | <a class="reference external" href="../_static/notebooks/astropy_introduction.py">astropy_introduction.py</a></li>
</ul>
</div>
<div class="section" id="Astropy-introduction-for-Gammapy-users">
<h1>Astropy introduction for Gammapy users<a class="headerlink" href="#Astropy-introduction-for-Gammapy-users" title="Permalink to this headline">¶</a></h1>
<div class="section" id="Introduction">
<h2>Introduction<a class="headerlink" href="#Introduction" title="Permalink to this headline">¶</a></h2>
<p>To become efficient at using Gammapy, you have to learn to use some parts of Astropy, especially FITS I/O and how to work with Table, Quantity, SkyCoord, Angle and Time objects.</p>
<p>Gammapy is built on Astropy, meaning that data in Gammapy is often stored in Astropy objects, and the methods on those objects are part of the public Gammapy API.</p>
<p>This tutorial is a quick introduction to the parts of Astropy you should know become familiar with to use Gammapy (or also when not using Gammapy, just doing astronomy from Python scripts). The largest part is devoted to tables, which are a the most important building block for Gammapy (event lists, flux points, light curves, … many other thing are store in Table objects).</p>
<p>We will:</p>
<ul class="simple">
<li>open and write fits files with <a class="reference external" href="http://docs.astropy.org/en/stable/io/fits/index.html">io.fits</a></li>
<li>manipulate <a class="reference external" href="http://docs.astropy.org/en/stable/coordinates/">coordinates</a>: <a class="reference external" href="http://docs.astropy.org/en/stable/api/astropy.coordinates.SkyCoord.html">SkyCoord</a> and <a class="reference external" href="http://docs.astropy.org/en/stable/coordinates/angles.html">Angle</a> classes</li>
<li>use <a class="reference external" href="http://docs.astropy.org/en/stable/units/index.html">units</a> and <a class="reference external" href="http://docs.astropy.org/en/stable/api/astropy.units.Quantity.html">Quantities</a>. See also this <a class="reference external" href="http://www.astropy.org/astropy-tutorials/Quantities.html">tutorial</a></li>
<li>manipulate <a class="reference external" href="http://docs.astropy.org/en/stable/time/index.html">Times and Dates</a></li>
<li>use <a class="reference external" href="http://docs.astropy.org/en/stable/table/index.html">tables</a> with the <a class="reference external" href="http://docs.astropy.org/en/stable/api/astropy.table.Table.html">Table</a> class with the Fermi catalog</li>
<li>define regions in the sky with the <a class="reference external" href="http://astropy-regions.readthedocs.io/en/latest/getting_started.html">region</a> package</li>
</ul>
</div>
<div class="section" id="Setup">
<h2>Setup<a class="headerlink" href="#Setup" title="Permalink to this headline">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># to make plots appear in the notebook</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># If something below doesn&#39;t work, here&#39;s how you</span>
<span class="c1"># can check what version of Numpy and Astropy you have</span>
<span class="c1"># All examples should work with Astropy 1.3,</span>
<span class="c1"># most even with Astropy 1.0</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">astropy</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="k">print</span><span class="p">(</span><span class="s2">&quot;numpy:&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">__version__</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s2">&quot;astropy:&quot;</span><span class="p">,</span> <span class="n">astropy</span><span class="o">.</span><span class="n">__version__</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
numpy: 1.16.2
astropy: 3.1.1
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Units, Quantities and constants</span>
<span class="kn">import</span> <span class="nn">astropy.units</span> <span class="kn">as</span> <span class="nn">u</span>
<span class="kn">from</span> <span class="nn">astropy.units</span> <span class="kn">import</span> <span class="n">Quantity</span>
<span class="kn">import</span> <span class="nn">astropy.constants</span> <span class="kn">as</span> <span class="nn">cst</span>

<span class="kn">from</span> <span class="nn">astropy.io</span> <span class="kn">import</span> <span class="n">fits</span>
<span class="kn">from</span> <span class="nn">astropy.table</span> <span class="kn">import</span> <span class="n">Table</span>
<span class="kn">from</span> <span class="nn">astropy.coordinates</span> <span class="kn">import</span> <span class="n">SkyCoord</span><span class="p">,</span> <span class="n">Angle</span>
<span class="kn">from</span> <span class="nn">astropy.time</span> <span class="kn">import</span> <span class="n">Time</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Units-and-constants">
<h2>Units and constants<a class="headerlink" href="#Units-and-constants" title="Permalink to this headline">¶</a></h2>
<div class="section" id="Basic-usage">
<h3>Basic usage<a class="headerlink" href="#Basic-usage" title="Permalink to this headline">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># One can create a Quantity like this</span>
<span class="n">L</span> <span class="o">=</span> <span class="n">Quantity</span><span class="p">(</span><span class="mf">1e35</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="s2">&quot;erg/s&quot;</span><span class="p">)</span>
<span class="c1"># or like this</span>
<span class="n">d</span> <span class="o">=</span> <span class="mi">8</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">kpc</span>

<span class="c1"># then one can produce new Quantities</span>
<span class="n">flux</span> <span class="o">=</span> <span class="n">L</span> <span class="o">/</span> <span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">d</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># And convert its value to an equivalent unit</span>
<span class="n">flux</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s2">&quot;erg cm-2 s-1&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="math notranslate nohighlight">
$$1.3058974 \times 10^{-11} \; \mathrm{\frac{erg}{s\,cm^{2}}}$$</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">flux</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s2">&quot;W/m2&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="math notranslate nohighlight">
$$1.3058974 \times 10^{-14} \; \mathrm{\frac{W}{m^{2}}}$$</div></div>
</div>
<p>More generally a Quantity is a numpy array with a unit.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">E</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">GeV</span>
<span class="n">E</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s2">&quot;TeV&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="math notranslate nohighlight">
$$[0.01,~0.021544347,~0.046415888,~0.1,~0.21544347,~0.46415888,~1,~2.1544347,~4.6415888,~10] \; \mathrm{TeV}$$</div></div>
</div>
<p>Here we compute the interaction time of protons.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">x_eff</span> <span class="o">=</span> <span class="mi">30</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">mbarn</span>
<span class="n">density</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">cm</span> <span class="o">**</span> <span class="o">-</span><span class="mi">3</span>

<span class="n">interaction_time</span> <span class="o">=</span> <span class="p">(</span><span class="n">density</span> <span class="o">*</span> <span class="n">x_eff</span> <span class="o">*</span> <span class="n">cst</span><span class="o">.</span><span class="n">c</span><span class="p">)</span> <span class="o">**</span> <span class="o">-</span><span class="mi">1</span>

<span class="n">interaction_time</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s2">&quot;Myr&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="math notranslate nohighlight">
$$35.233361 \; \mathrm{Myr}$$</div></div>
</div>
</div>
<div class="section" id="Use-Quantities-in-functions">
<h3>Use Quantities in functions<a class="headerlink" href="#Use-Quantities-in-functions" title="Permalink to this headline">¶</a></h3>
<p>We compute here the energy loss rate of an electron of kinetic energy E in magnetic field B. See formula (5B10) in this <a class="reference external" href="http://www.cv.nrao.edu/course/astr534/SynchrotronPower.html">lecture</a></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">electron_energy_loss_rate</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">E</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; energy loss rate of an electron of kinetic energy E in magnetic field B</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">U_B</span> <span class="o">=</span> <span class="n">B</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">cst</span><span class="o">.</span><span class="n">mu0</span><span class="p">)</span>
    <span class="n">gamma</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">E</span> <span class="o">/</span> <span class="p">(</span><span class="n">cst</span><span class="o">.</span><span class="n">m_e</span> <span class="o">*</span> <span class="n">cst</span><span class="o">.</span><span class="n">c</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="p">)</span>  <span class="c1"># note that this works only because E/(cst.m_e*cst.c**2) is dimensionless</span>
    <span class="n">beta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">gamma</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
    <span class="k">return</span> <span class="mf">4.0</span> <span class="o">/</span> <span class="mf">3.0</span> <span class="o">*</span> <span class="n">cst</span><span class="o">.</span><span class="n">sigma_T</span> <span class="o">*</span> <span class="n">cst</span><span class="o">.</span><span class="n">c</span> <span class="o">*</span> <span class="n">gamma</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">beta</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">U_B</span>


<span class="k">print</span><span class="p">(</span><span class="n">electron_energy_loss_rate</span><span class="p">(</span><span class="mf">1e-5</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">G</span><span class="p">,</span> <span class="mi">1</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">TeV</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s2">&quot;erg/s&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
4.0519325060487625e-13 erg / s
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Now plot it</span>
<span class="n">E_elec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">MeV</span>
<span class="n">B</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">G</span>
<span class="n">y</span> <span class="o">=</span> <span class="p">(</span><span class="n">E_elec</span> <span class="o">/</span> <span class="n">electron_energy_loss_rate</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">E_elec</span><span class="p">))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s2">&quot;yr&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">E_elec</span><span class="p">,</span> <span class="n">y</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_astropy_introduction_15_0.png" src="../_images/notebooks_astropy_introduction_15_0.png" />
</div>
</div>
<p>A frequent issue is homogeneity. One can use decorators to ensure it.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># This ensures that B and E are homogeneous to magnetic field strength and energy</span>
<span class="c1"># If not will raise a UnitError exception</span>
<span class="nd">@u.quantity_input</span><span class="p">(</span><span class="n">B</span><span class="o">=</span><span class="n">u</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">E</span><span class="o">=</span><span class="n">u</span><span class="o">.</span><span class="n">J</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">electron_energy_loss_rate</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">E</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; energy loss rate of an electron of kinetic energy E in magnetic field B</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">U_B</span> <span class="o">=</span> <span class="n">B</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">cst</span><span class="o">.</span><span class="n">mu0</span><span class="p">)</span>
    <span class="n">gamma</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">E</span> <span class="o">/</span> <span class="p">(</span><span class="n">cst</span><span class="o">.</span><span class="n">m_e</span> <span class="o">*</span> <span class="n">cst</span><span class="o">.</span><span class="n">c</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="p">)</span>  <span class="c1"># note that this works only because E/(cst.m_e*cst.c**2) is dimensionless</span>
    <span class="n">beta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">gamma</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
    <span class="k">return</span> <span class="mf">4.0</span> <span class="o">/</span> <span class="mf">3.0</span> <span class="o">*</span> <span class="n">cst</span><span class="o">.</span><span class="n">sigma_T</span> <span class="o">*</span> <span class="n">cst</span><span class="o">.</span><span class="n">c</span> <span class="o">*</span> <span class="n">gamma</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">beta</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">U_B</span>


<span class="c1"># Now try it</span>
<span class="k">try</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="n">electron_energy_loss_rate</span><span class="p">(</span><span class="mf">1e-5</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">G</span><span class="p">,</span> <span class="mi">1</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">Hz</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s2">&quot;erg/s&quot;</span><span class="p">))</span>
<span class="k">except</span> <span class="n">u</span><span class="o">.</span><span class="n">UnitsError</span> <span class="k">as</span> <span class="n">message</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Incorrect unit: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">message</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Incorrect unit: Argument &#39;E&#39; to function &#39;electron_energy_loss_rate&#39; must be in units convertible to &#39;J&#39;.
</pre></div></div>
</div>
</div>
</div>
<div class="section" id="Coordinates">
<h2>Coordinates<a class="headerlink" href="#Coordinates" title="Permalink to this headline">¶</a></h2>
<p>Note that SkyCoord are arrays of coordinates. We will see that in more detail in the next section.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Different ways to create a SkyCoord</span>
<span class="n">c1</span> <span class="o">=</span> <span class="n">SkyCoord</span><span class="p">(</span><span class="mf">10.625</span><span class="p">,</span> <span class="mf">41.2</span><span class="p">,</span> <span class="n">frame</span><span class="o">=</span><span class="s2">&quot;icrs&quot;</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="s2">&quot;deg&quot;</span><span class="p">)</span>
<span class="n">c1</span> <span class="o">=</span> <span class="n">SkyCoord</span><span class="p">(</span><span class="s2">&quot;00h42m30s&quot;</span><span class="p">,</span> <span class="s2">&quot;+41d12m00s&quot;</span><span class="p">,</span> <span class="n">frame</span><span class="o">=</span><span class="s2">&quot;icrs&quot;</span><span class="p">)</span>

<span class="n">c2</span> <span class="o">=</span> <span class="n">SkyCoord</span><span class="p">(</span><span class="mf">83.633083</span><span class="p">,</span> <span class="mf">22.0145</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="s2">&quot;deg&quot;</span><span class="p">)</span>
<span class="c1"># If you have internet access, you could also use this to define the `source_pos`:</span>
<span class="c1"># c2 = SkyCoord.from_name(&quot;Crab&quot;)     # Get the name from CDS</span>

<span class="k">print</span><span class="p">(</span><span class="n">c1</span><span class="o">.</span><span class="n">ra</span><span class="p">,</span> <span class="n">c2</span><span class="o">.</span><span class="n">dec</span><span class="p">)</span>
<span class="c1"># separation returns an Angle object</span>
<span class="k">print</span><span class="p">(</span><span class="s2">&quot;Distance to Crab: &quot;</span><span class="p">,</span> <span class="n">c1</span><span class="o">.</span><span class="n">separation</span><span class="p">(</span><span class="n">c2</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="s2">&quot;Distance to Crab: &quot;</span><span class="p">,</span> <span class="n">c1</span><span class="o">.</span><span class="n">separation</span><span class="p">(</span><span class="n">c2</span><span class="p">)</span><span class="o">.</span><span class="n">degree</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
10d37m30s 22d00m52.2s
Distance to Crab:  63d12m28.2297s
Distance to Crab:  63.2078415848386
</pre></div></div>
</div>
<div class="section" id="Coordinate-transformations">
<h3>Coordinate transformations<a class="headerlink" href="#Coordinate-transformations" title="Permalink to this headline">¶</a></h3>
<p>How to change between coordinate frames. The Crab in Galactic coordinates.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">c2b</span> <span class="o">=</span> <span class="n">c2</span><span class="o">.</span><span class="n">galactic</span>
<span class="k">print</span><span class="p">(</span><span class="n">c2b</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">c2b</span><span class="o">.</span><span class="n">l</span><span class="p">,</span> <span class="n">c2b</span><span class="o">.</span><span class="n">b</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;SkyCoord (Galactic): (l, b) in deg
    (184.55745771, -5.78435696)&gt;
184d33m26.8478s -5d47m03.6851s
</pre></div></div>
</div>
</div>
</div>
<div class="section" id="Time">
<h2>Time<a class="headerlink" href="#Time" title="Permalink to this headline">¶</a></h2>
<p>Is the Crab visible now?</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">now</span> <span class="o">=</span> <span class="n">Time</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="n">now</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">now</span><span class="o">.</span><span class="n">mjd</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
2019-03-29 16:41:51.788169
58571.695738288996
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># define the location for the AltAz system</span>
<span class="kn">from</span> <span class="nn">astropy.coordinates</span> <span class="kn">import</span> <span class="n">EarthLocation</span><span class="p">,</span> <span class="n">AltAz</span>

<span class="n">paris</span> <span class="o">=</span> <span class="n">EarthLocation</span><span class="p">(</span><span class="n">lat</span><span class="o">=</span><span class="mf">48.8567</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">,</span> <span class="n">lon</span><span class="o">=</span><span class="mf">2.3508</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">)</span>

<span class="c1"># calculate the horizontal coordinates</span>
<span class="n">crab_altaz</span> <span class="o">=</span> <span class="n">c2</span><span class="o">.</span><span class="n">transform_to</span><span class="p">(</span><span class="n">AltAz</span><span class="p">(</span><span class="n">obstime</span><span class="o">=</span><span class="n">now</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="n">paris</span><span class="p">))</span>

<span class="k">print</span><span class="p">(</span><span class="n">crab_altaz</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;SkyCoord (AltAz: obstime=2019-03-29 16:41:51.788169, location=(4200910.64325784, 172456.78503911, 4780088.65877593) m, pressure=0.0 hPa, temperature=0.0 deg_C, relative_humidity=0.0, obswl=1.0 micron): (az, alt) in deg
    (171.19416159, 62.95038106)&gt;
</pre></div></div>
</div>
</div>
<div class="section" id="Table:-Manipulating-the-3FGL-catalog">
<h2>Table: Manipulating the 3FGL catalog<a class="headerlink" href="#Table:-Manipulating-the-3FGL-catalog" title="Permalink to this headline">¶</a></h2>
<p>Here we are going to do some selections with the 3FGL catalog. To do so we use the Table class from astropy.</p>
<div class="section" id="Accessing-the-table">
<h3>Accessing the table<a class="headerlink" href="#Accessing-the-table" title="Permalink to this headline">¶</a></h3>
<p>First, we need to open the catalog in a Table.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Open Fermi 3FGL from the repo</span>
<span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;GAMMAPY_DATA&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="n">Path</span><span class="p">(</span>
    <span class="s2">&quot;catalogs/fermi/gll_psc_v16.fit.gz&quot;</span>
<span class="p">)</span>
<span class="n">table</span> <span class="o">=</span> <span class="n">Table</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">filename</span><span class="p">),</span> <span class="n">hdu</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="c1"># Alternatively, one can grab it from the server.</span>
<span class="c1"># table = Table.read(&quot;http://fermi.gsfc.nasa.gov/ssc/data/access/lat/4yr_catalog/gll_psc_v16.fit&quot;)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
WARNING: UnitsWarning: &#39;photon/cm**2/MeV/s&#39; contains multiple slashes, which is discouraged by the FITS standard [astropy.units.format.generic]
WARNING: UnitsWarning: &#39;photon/cm**2/s&#39; contains multiple slashes, which is discouraged by the FITS standard [astropy.units.format.generic]
WARNING: UnitsWarning: &#39;erg/cm**2/s&#39; contains multiple slashes, which is discouraged by the FITS standard [astropy.units.format.generic]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Note that a single FITS file might contain different tables in different HDUs</span>
<span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;GAMMAPY_DATA&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="n">Path</span><span class="p">(</span>
    <span class="s2">&quot;catalogs/fermi/gll_psc_v16.fit.gz&quot;</span>
<span class="p">)</span>
<span class="c1"># You can load a `fits.HDUList` and check the extension names</span>
<span class="k">print</span><span class="p">([</span><span class="n">_</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">filename</span><span class="p">))])</span>
<span class="c1"># Then you can load by name or integer index via the `hdu` option</span>
<span class="n">extended_source_table</span> <span class="o">=</span> <span class="n">Table</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">filename</span><span class="p">),</span> <span class="n">hdu</span><span class="o">=</span><span class="s2">&quot;ExtendedSources&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&#39;PRIMARY&#39;, &#39;LAT_Point_Source_Catalog&#39;, &#39;ROIs&#39;, &#39;Hist_Start&#39;, &#39;GTI&#39;, &#39;ExtendedSources&#39;]
</pre></div></div>
</div>
</div>
<div class="section" id="General-informations-on-the-Table">
<h3>General informations on the Table<a class="headerlink" href="#General-informations-on-the-Table" title="Permalink to this headline">¶</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">table</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;Table length=3034&gt;
        name          dtype   shape        unit        format  n_bad
-------------------- ------- ------- ---------------- -------- -----
         Source_Name bytes18                                       0
             RAJ2000 float32                      deg  {:8.4f}     0
             DEJ2000 float32                      deg  {:8.4f}     0
                GLON float32                      deg  {:8.4f}     0
                GLAT float32                      deg  {:8.4f}     0
   Conf_68_SemiMajor float32                      deg  {:8.4f}    28
   Conf_68_SemiMinor float32                      deg  {:8.4f}    28
      Conf_68_PosAng float32                      deg  {:8.3f}    28
   Conf_95_SemiMajor float32                      deg  {:8.4f}    28
   Conf_95_SemiMinor float32                      deg  {:8.4f}    28
      Conf_95_PosAng float32                      deg  {:8.3f}    28
             ROI_num   int16                                       0
          Signif_Avg float32                           {:8.3f}     5
        Pivot_Energy float32                      MeV {:10.2f}     0
        Flux_Density float32         ph / (cm2 MeV s) {:10.4e}     0
    Unc_Flux_Density float32         ph / (cm2 MeV s) {:10.4e}     5
            Flux1000 float32             ph / (cm2 s) {:10.4e}     0
        Unc_Flux1000 float32             ph / (cm2 s)              5
      Energy_Flux100 float32            erg / (cm2 s) {:10.4e}     0
  Unc_Energy_Flux100 float32            erg / (cm2 s) {:10.4e}     5
        Signif_Curve float32                          {:10.2f}     0
        SpectrumType bytes16                                       0
      Spectral_Index float32                           {:8.4f}     0
  Unc_Spectral_Index float32                           {:8.4f}     9
                beta float32                           {:8.4f}  2639
            Unc_beta float32                           {:8.4f}  2680
              Cutoff float32                      MeV {:10.2f}  2918
          Unc_Cutoff float32                      MeV {:10.2f}  2918
           Exp_Index float32                           {:8.4f}  2918
       Unc_Exp_Index float32                           {:8.4f}  3028
      PowerLaw_Index float32                           {:8.4f}     0
          Flux30_100 float32             ph / (cm2 s)           3034
      Unc_Flux30_100 float32             ph / (cm2 s)           3034
         nuFnu30_100 float32            erg / (cm2 s)           3034
       Sqrt_TS30_100 float32                           {:8.3f}  3034
         Flux100_300 float32             ph / (cm2 s)              0
     Unc_Flux100_300 float32    (2,)     ph / (cm2 s)            836
        nuFnu100_300 float32            erg / (cm2 s)              0
      Sqrt_TS100_300 float32                           {:8.3f}     5
        Flux300_1000 float32             ph / (cm2 s)              0
    Unc_Flux300_1000 float32    (2,)     ph / (cm2 s)            327
       nuFnu300_1000 float32            erg / (cm2 s)              0
     Sqrt_TS300_1000 float32                           {:8.3f}     5
       Flux1000_3000 float32             ph / (cm2 s)              0
   Unc_Flux1000_3000 float32    (2,)     ph / (cm2 s)            111
      nuFnu1000_3000 float32            erg / (cm2 s)              0
    Sqrt_TS1000_3000 float32                           {:8.3f}     0
      Flux3000_10000 float32             ph / (cm2 s)              0
  Unc_Flux3000_10000 float32    (2,)     ph / (cm2 s)            137
     nuFnu3000_10000 float32            erg / (cm2 s)              0
   Sqrt_TS3000_10000 float32                           {:8.3f}     3
    Flux10000_100000 float32             ph / (cm2 s)              0
Unc_Flux10000_100000 float32    (2,)     ph / (cm2 s)            670
   nuFnu10000_100000 float32            erg / (cm2 s)              0
 Sqrt_TS10000_100000 float32                           {:8.3f}     2
   Variability_Index float32                                       0
         Signif_Peak float32                                    2387
           Flux_Peak float32             ph / (cm2 s)           2387
       Unc_Flux_Peak float32             ph / (cm2 s)           2387
           Time_Peak float64                        s           2387
       Peak_Interval float32                        s           2387
        Flux_History float32   (48,)     ph / (cm2 s)              0
    Unc_Flux_History float32 (48, 2)     ph / (cm2 s)          64623
Extended_Source_Name bytes18                                       0
           0FGL_Name bytes17                                       0
           1FGL_Name bytes18                                       0
           2FGL_Name bytes18                                       0
           1FHL_Name bytes18                                       0
          ASSOC_GAM1 bytes15                                       0
          ASSOC_GAM2 bytes14                                       0
          ASSOC_GAM3 bytes15                                       0
         TEVCAT_FLAG  bytes1                                       0
           ASSOC_TEV bytes21                                       0
              CLASS1  bytes5                                       0
              ASSOC1 bytes26                                       0
              ASSOC2 bytes26                                       0
               Flags   int16                                       0
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Statistics on each column</span>
<span class="n">table</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;stats&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/Users/adonath/software/anaconda3/envs/gammapy-dev/lib/python3.7/site-packages/numpy/lib/nanfunctions.py:1503: RuntimeWarning: invalid value encountered in subtract
  np.subtract(arr, avg, out=arr, casting=&#39;unsafe&#39;)
/Users/adonath/software/anaconda3/envs/gammapy-dev/lib/python3.7/site-packages/numpy/lib/nanfunctions.py:1503: RuntimeWarning: invalid value encountered in subtract
  np.subtract(arr, avg, out=arr, casting=&#39;unsafe&#39;)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;Table length=3034&gt;
        name                mean              std              min           max       n_bad
-------------------- ----------------- ------------------ ------------- -------------- -----
         Source_Name                --                 --            --             --     0
             RAJ2000         185.63785          100.58523        0.0377       359.8812     0
             DEJ2000         -2.235143           41.53712      -87.6185        88.7739     0
                GLON          186.2728          107.57225    0.12616104       359.9692     0
                GLAT         1.2272784          36.499836     -87.95155       86.36791     0
   Conf_68_SemiMajor              -inf                nan          -inf      0.6587264    28
   Conf_68_SemiMinor              -inf                nan          -inf     0.32094488    28
      Conf_68_PosAng       -0.21967074          51.926346        -89.94          89.92    28
   Conf_95_SemiMajor              -inf                nan          -inf         1.0681    28
   Conf_95_SemiMinor              -inf                nan          -inf         0.5204    28
      Conf_95_PosAng       -0.21967074          51.926346        -89.94          89.92    28
             ROI_num 424.7771918259723 238.84623199551552             1            840     0
          Signif_Avg              -inf                nan          -inf      1048.9587     5
        Pivot_Energy         2104.4626           2578.198     100.79754       37201.97     0
        Flux_Density     1.2938883e-11      2.1723061e-10 4.2151523e-16  1.1447582e-08     0
    Unc_Flux_Density              -inf                nan          -inf   6.864756e-10     5
            Flux1000     2.7506988e-09       2.764754e-08  4.905819e-12  1.2976768e-06     0
        Unc_Flux1000              -inf                nan          -inf  2.8939553e-09     5
      Energy_Flux100     2.5601129e-11      1.8885869e-10 1.6522738e-12  8.9300825e-09     0
  Unc_Energy_Flux100              -inf                nan          -inf  2.5295337e-11     5
        Signif_Curve          2.431611          3.8773124           0.0       84.97297     0
        SpectrumType                --                 --            --             --     0
      Spectral_Index         2.2145069         0.36053884    0.50000006       5.715894     0
  Unc_Spectral_Index              -inf                nan          -inf      1.0611331     9
                beta              -inf                nan          -inf            1.0  2639
            Unc_beta              -inf                nan          -inf      0.3376085  2680
              Cutoff              -inf                nan          -inf      13326.353  2918
          Unc_Cutoff              -inf                nan          -inf      3750.5642  2918
           Exp_Index              -inf                nan          -inf            1.0  2918
       Unc_Exp_Index              -inf                nan          -inf    0.044299893  3028
      PowerLaw_Index          2.249819         0.30635425     1.0975342       5.715894     0
          Flux30_100               nan                nan           nan            nan  3034
      Unc_Flux30_100               nan                nan           nan            nan  3034
         nuFnu30_100               nan                nan           nan            nan  3034
       Sqrt_TS30_100               nan                nan           nan            nan  3034
         Flux100_300     2.3779466e-08      1.2034207e-07 1.0022202e-14    5.37625e-06     0
     Unc_Flux100_300              -inf                nan          -inf   9.567011e-08   836
        nuFnu100_300     5.7192215e-12       3.026846e-11 2.4912323e-18  1.3717709e-09     0
      Sqrt_TS100_300         3.8165362           8.915827           0.0       215.4162     5
        Flux300_1000      8.619365e-09       6.732932e-08 3.9778793e-15  3.2167186e-06     0
    Unc_Flux300_1000              -inf                nan          -inf   1.897159e-08   327
       nuFnu300_1000      5.904836e-12      4.7984526e-11 2.9117903e-18  2.2924256e-09     0
     Sqrt_TS300_1000          7.471796           19.89813           0.0      568.66296     5
       Flux1000_3000     2.1950213e-09      2.2779465e-08 1.5087699e-15  1.0701934e-06     0
   Unc_Flux1000_3000              -inf                nan          -inf  6.0994774e-09   111
      nuFnu1000_3000     5.1461344e-12      5.3878357e-11  3.765228e-18  2.5253446e-09     0
    Sqrt_TS1000_3000          8.607782          22.247915           0.0       711.6319     0
      Flux3000_10000      4.836294e-10      4.6478523e-09  9.338969e-16  2.1617714e-07     0
  Unc_Flux3000_10000              -inf                nan          -inf  2.9860603e-09   137
     nuFnu3000_10000     3.0733539e-12      2.8322539e-11 5.6769025e-18  1.3210241e-09     0
   Sqrt_TS3000_10000           6.98671          13.919392           0.0      465.89935     3
    Flux10000_100000      7.399214e-11      3.2253794e-10 1.0387837e-17 1.13814576e-08     0
Unc_Flux10000_100000              -inf                nan          -inf   7.880918e-10   670
   nuFnu10000_100000     1.1641434e-12       4.635748e-12  9.385276e-20  1.1601801e-10     0
 Sqrt_TS10000_100000          4.019383           5.470039           0.0     111.192406     2
   Variability_Index         154.12613          1230.7148           0.0       60733.92     0
         Signif_Peak              -inf                nan          -inf      255.07051  2387
           Flux_Peak              -inf                nan          -inf  2.1237443e-05  2387
       Unc_Flux_Peak              -inf                nan          -inf  1.4785873e-07  2387
           Time_Peak              -inf                nan          -inf    364203776.0  2387
       Peak_Interval              -inf                nan          -inf      2630000.0  2387
        Flux_History     3.5440095e-08      2.2605154e-07           0.0  2.1237443e-05     0
    Unc_Flux_History              -inf                nan          -inf  2.3038561e-07 64623
Extended_Source_Name                --                 --            --             --     0
           0FGL_Name                --                 --            --             --     0
           1FGL_Name                --                 --            --             --     0
           2FGL_Name                --                 --            --             --     0
           1FHL_Name                --                 --            --             --     0
          ASSOC_GAM1                --                 --            --             --     0
          ASSOC_GAM2                --                 --            --             --     0
          ASSOC_GAM3                --                 --            --             --     0
         TEVCAT_FLAG                --                 --            --             --     0
           ASSOC_TEV                --                 --            --             --     0
              CLASS1                --                 --            --             --     0
              ASSOC1                --                 --            --             --     0
              ASSOC2                --                 --            --             --     0
               Flags 45.77356624917601  265.7116050036644             0           2565     0
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/Users/adonath/software/anaconda3/envs/gammapy-dev/lib/python3.7/site-packages/numpy/lib/nanfunctions.py:1503: RuntimeWarning: invalid value encountered in subtract
  np.subtract(arr, avg, out=arr, casting=&#39;unsafe&#39;)
/Users/adonath/software/anaconda3/envs/gammapy-dev/lib/python3.7/site-packages/numpy/lib/nanfunctions.py:1503: RuntimeWarning: invalid value encountered in subtract
  np.subtract(arr, avg, out=arr, casting=&#39;unsafe&#39;)
/Users/adonath/software/anaconda3/envs/gammapy-dev/lib/python3.7/site-packages/numpy/lib/nanfunctions.py:1503: RuntimeWarning: invalid value encountered in subtract
  np.subtract(arr, avg, out=arr, casting=&#39;unsafe&#39;)
/Users/adonath/software/anaconda3/envs/gammapy-dev/lib/python3.7/site-packages/numpy/lib/nanfunctions.py:1503: RuntimeWarning: invalid value encountered in subtract
  np.subtract(arr, avg, out=arr, casting=&#39;unsafe&#39;)
/Users/adonath/software/anaconda3/envs/gammapy-dev/lib/python3.7/site-packages/numpy/lib/nanfunctions.py:1503: RuntimeWarning: invalid value encountered in subtract
  np.subtract(arr, avg, out=arr, casting=&#39;unsafe&#39;)
/Users/adonath/software/anaconda3/envs/gammapy-dev/lib/python3.7/site-packages/numpy/lib/nanfunctions.py:1503: RuntimeWarning: invalid value encountered in subtract
  np.subtract(arr, avg, out=arr, casting=&#39;unsafe&#39;)
/Users/adonath/software/anaconda3/envs/gammapy-dev/lib/python3.7/site-packages/numpy/lib/nanfunctions.py:1503: RuntimeWarning: invalid value encountered in subtract
  np.subtract(arr, avg, out=arr, casting=&#39;unsafe&#39;)
/Users/adonath/software/anaconda3/envs/gammapy-dev/lib/python3.7/site-packages/numpy/lib/nanfunctions.py:1503: RuntimeWarning: invalid value encountered in subtract
  np.subtract(arr, avg, out=arr, casting=&#39;unsafe&#39;)
/Users/adonath/software/anaconda3/envs/gammapy-dev/lib/python3.7/site-packages/numpy/lib/nanfunctions.py:1503: RuntimeWarning: invalid value encountered in subtract
  np.subtract(arr, avg, out=arr, casting=&#39;unsafe&#39;)
/Users/adonath/software/anaconda3/envs/gammapy-dev/lib/python3.7/site-packages/numpy/lib/nanfunctions.py:1503: RuntimeWarning: invalid value encountered in subtract
  np.subtract(arr, avg, out=arr, casting=&#39;unsafe&#39;)
/Users/adonath/software/anaconda3/envs/gammapy-dev/lib/python3.7/site-packages/numpy/lib/nanfunctions.py:1503: RuntimeWarning: invalid value encountered in subtract
  np.subtract(arr, avg, out=arr, casting=&#39;unsafe&#39;)
/Users/adonath/software/anaconda3/envs/gammapy-dev/lib/python3.7/site-packages/numpy/lib/nanfunctions.py:1503: RuntimeWarning: invalid value encountered in subtract
  np.subtract(arr, avg, out=arr, casting=&#39;unsafe&#39;)
/Users/adonath/software/anaconda3/envs/gammapy-dev/lib/python3.7/site-packages/numpy/lib/nanfunctions.py:1503: RuntimeWarning: invalid value encountered in subtract
  np.subtract(arr, avg, out=arr, casting=&#39;unsafe&#39;)
/Users/adonath/software/anaconda3/envs/gammapy-dev/lib/python3.7/site-packages/numpy/lib/nanfunctions.py:1503: RuntimeWarning: invalid value encountered in subtract
  np.subtract(arr, avg, out=arr, casting=&#39;unsafe&#39;)
/Users/adonath/software/anaconda3/envs/gammapy-dev/lib/python3.7/site-packages/numpy/lib/nanfunctions.py:1503: RuntimeWarning: invalid value encountered in subtract
  np.subtract(arr, avg, out=arr, casting=&#39;unsafe&#39;)
/Users/adonath/software/anaconda3/envs/gammapy-dev/lib/python3.7/site-packages/numpy/lib/nanfunctions.py:1503: RuntimeWarning: invalid value encountered in subtract
  np.subtract(arr, avg, out=arr, casting=&#39;unsafe&#39;)
/Users/adonath/software/anaconda3/envs/gammapy-dev/lib/python3.7/site-packages/numpy/lib/nanfunctions.py:1503: RuntimeWarning: invalid value encountered in subtract
  np.subtract(arr, avg, out=arr, casting=&#39;unsafe&#39;)
/Users/adonath/software/anaconda3/envs/gammapy-dev/lib/python3.7/site-packages/numpy/lib/nanfunctions.py:1503: RuntimeWarning: invalid value encountered in subtract
  np.subtract(arr, avg, out=arr, casting=&#39;unsafe&#39;)
/Users/adonath/software/anaconda3/envs/gammapy-dev/lib/python3.7/site-packages/numpy/lib/nanfunctions.py:1503: RuntimeWarning: invalid value encountered in subtract
  np.subtract(arr, avg, out=arr, casting=&#39;unsafe&#39;)
/Users/adonath/software/anaconda3/envs/gammapy-dev/lib/python3.7/site-packages/numpy/lib/nanfunctions.py:1503: RuntimeWarning: invalid value encountered in subtract
  np.subtract(arr, avg, out=arr, casting=&#39;unsafe&#39;)
/Users/adonath/software/anaconda3/envs/gammapy-dev/lib/python3.7/site-packages/numpy/lib/nanfunctions.py:1503: RuntimeWarning: invalid value encountered in subtract
  np.subtract(arr, avg, out=arr, casting=&#39;unsafe&#39;)
/Users/adonath/software/anaconda3/envs/gammapy-dev/lib/python3.7/site-packages/numpy/lib/nanfunctions.py:1503: RuntimeWarning: invalid value encountered in subtract
  np.subtract(arr, avg, out=arr, casting=&#39;unsafe&#39;)
/Users/adonath/software/anaconda3/envs/gammapy-dev/lib/python3.7/site-packages/numpy/lib/nanfunctions.py:1503: RuntimeWarning: invalid value encountered in subtract
  np.subtract(arr, avg, out=arr, casting=&#39;unsafe&#39;)
/Users/adonath/software/anaconda3/envs/gammapy-dev/lib/python3.7/site-packages/numpy/lib/nanfunctions.py:1503: RuntimeWarning: invalid value encountered in subtract
  np.subtract(arr, avg, out=arr, casting=&#39;unsafe&#39;)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">### list of column names</span>
<span class="n">table</span><span class="o">.</span><span class="n">colnames</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>[&#39;Source_Name&#39;,
 &#39;RAJ2000&#39;,
 &#39;DEJ2000&#39;,
 &#39;GLON&#39;,
 &#39;GLAT&#39;,
 &#39;Conf_68_SemiMajor&#39;,
 &#39;Conf_68_SemiMinor&#39;,
 &#39;Conf_68_PosAng&#39;,
 &#39;Conf_95_SemiMajor&#39;,
 &#39;Conf_95_SemiMinor&#39;,
 &#39;Conf_95_PosAng&#39;,
 &#39;ROI_num&#39;,
 &#39;Signif_Avg&#39;,
 &#39;Pivot_Energy&#39;,
 &#39;Flux_Density&#39;,
 &#39;Unc_Flux_Density&#39;,
 &#39;Flux1000&#39;,
 &#39;Unc_Flux1000&#39;,
 &#39;Energy_Flux100&#39;,
 &#39;Unc_Energy_Flux100&#39;,
 &#39;Signif_Curve&#39;,
 &#39;SpectrumType&#39;,
 &#39;Spectral_Index&#39;,
 &#39;Unc_Spectral_Index&#39;,
 &#39;beta&#39;,
 &#39;Unc_beta&#39;,
 &#39;Cutoff&#39;,
 &#39;Unc_Cutoff&#39;,
 &#39;Exp_Index&#39;,
 &#39;Unc_Exp_Index&#39;,
 &#39;PowerLaw_Index&#39;,
 &#39;Flux30_100&#39;,
 &#39;Unc_Flux30_100&#39;,
 &#39;nuFnu30_100&#39;,
 &#39;Sqrt_TS30_100&#39;,
 &#39;Flux100_300&#39;,
 &#39;Unc_Flux100_300&#39;,
 &#39;nuFnu100_300&#39;,
 &#39;Sqrt_TS100_300&#39;,
 &#39;Flux300_1000&#39;,
 &#39;Unc_Flux300_1000&#39;,
 &#39;nuFnu300_1000&#39;,
 &#39;Sqrt_TS300_1000&#39;,
 &#39;Flux1000_3000&#39;,
 &#39;Unc_Flux1000_3000&#39;,
 &#39;nuFnu1000_3000&#39;,
 &#39;Sqrt_TS1000_3000&#39;,
 &#39;Flux3000_10000&#39;,
 &#39;Unc_Flux3000_10000&#39;,
 &#39;nuFnu3000_10000&#39;,
 &#39;Sqrt_TS3000_10000&#39;,
 &#39;Flux10000_100000&#39;,
 &#39;Unc_Flux10000_100000&#39;,
 &#39;nuFnu10000_100000&#39;,
 &#39;Sqrt_TS10000_100000&#39;,
 &#39;Variability_Index&#39;,
 &#39;Signif_Peak&#39;,
 &#39;Flux_Peak&#39;,
 &#39;Unc_Flux_Peak&#39;,
 &#39;Time_Peak&#39;,
 &#39;Peak_Interval&#39;,
 &#39;Flux_History&#39;,
 &#39;Unc_Flux_History&#39;,
 &#39;Extended_Source_Name&#39;,
 &#39;0FGL_Name&#39;,
 &#39;1FGL_Name&#39;,
 &#39;2FGL_Name&#39;,
 &#39;1FHL_Name&#39;,
 &#39;ASSOC_GAM1&#39;,
 &#39;ASSOC_GAM2&#39;,
 &#39;ASSOC_GAM3&#39;,
 &#39;TEVCAT_FLAG&#39;,
 &#39;ASSOC_TEV&#39;,
 &#39;CLASS1&#39;,
 &#39;ASSOC1&#39;,
 &#39;ASSOC2&#39;,
 &#39;Flags&#39;]
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># HTML display</span>
<span class="c1"># table.show_in_browser(jsviewer=True)</span>
<span class="c1"># table.show_in_notebook(jsviewer=True)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Accessing-the-table">
<h3>Accessing the table<a class="headerlink" href="#Accessing-the-table" title="Permalink to this headline">¶</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># The header keywords are stored as a dict</span>
<span class="c1"># table.meta</span>
<span class="n">table</span><span class="o">.</span><span class="n">meta</span><span class="p">[</span><span class="s2">&quot;TSMIN&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>25
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># First row</span>
<span class="n">table</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<i>Row index=0</i>
<table id="table4671219640">
<thead><tr><th>Source_Name</th><th>RAJ2000</th><th>DEJ2000</th><th>GLON</th><th>GLAT</th><th>Conf_68_SemiMajor</th><th>Conf_68_SemiMinor</th><th>Conf_68_PosAng</th><th>Conf_95_SemiMajor</th><th>Conf_95_SemiMinor</th><th>Conf_95_PosAng</th><th>ROI_num</th><th>Signif_Avg</th><th>Pivot_Energy</th><th>Flux_Density</th><th>Unc_Flux_Density</th><th>Flux1000</th><th>Unc_Flux1000</th><th>Energy_Flux100</th><th>Unc_Energy_Flux100</th><th>Signif_Curve</th><th>SpectrumType</th><th>Spectral_Index</th><th>Unc_Spectral_Index</th><th>beta</th><th>Unc_beta</th><th>Cutoff</th><th>Unc_Cutoff</th><th>Exp_Index</th><th>Unc_Exp_Index</th><th>PowerLaw_Index</th><th>Flux30_100</th><th>Unc_Flux30_100</th><th>nuFnu30_100</th><th>Sqrt_TS30_100</th><th>Flux100_300</th><th>Unc_Flux100_300 [2]</th><th>nuFnu100_300</th><th>Sqrt_TS100_300</th><th>Flux300_1000</th><th>Unc_Flux300_1000 [2]</th><th>nuFnu300_1000</th><th>Sqrt_TS300_1000</th><th>Flux1000_3000</th><th>Unc_Flux1000_3000 [2]</th><th>nuFnu1000_3000</th><th>Sqrt_TS1000_3000</th><th>Flux3000_10000</th><th>Unc_Flux3000_10000 [2]</th><th>nuFnu3000_10000</th><th>Sqrt_TS3000_10000</th><th>Flux10000_100000</th><th>Unc_Flux10000_100000 [2]</th><th>nuFnu10000_100000</th><th>Sqrt_TS10000_100000</th><th>Variability_Index</th><th>Signif_Peak</th><th>Flux_Peak</th><th>Unc_Flux_Peak</th><th>Time_Peak</th><th>Peak_Interval</th><th>Flux_History [48]</th><th>Unc_Flux_History [48,2]</th><th>Extended_Source_Name</th><th>0FGL_Name</th><th>1FGL_Name</th><th>2FGL_Name</th><th>1FHL_Name</th><th>ASSOC_GAM1</th><th>ASSOC_GAM2</th><th>ASSOC_GAM3</th><th>TEVCAT_FLAG</th><th>ASSOC_TEV</th><th>CLASS1</th><th>ASSOC1</th><th>ASSOC2</th><th>Flags</th></tr></thead>
<thead><tr><th></th><th>deg</th><th>deg</th><th>deg</th><th>deg</th><th>deg</th><th>deg</th><th>deg</th><th>deg</th><th>deg</th><th>deg</th><th></th><th></th><th>MeV</th><th>ph / (cm2 MeV s)</th><th>ph / (cm2 MeV s)</th><th>ph / (cm2 s)</th><th>ph / (cm2 s)</th><th>erg / (cm2 s)</th><th>erg / (cm2 s)</th><th></th><th></th><th></th><th></th><th></th><th></th><th>MeV</th><th>MeV</th><th></th><th></th><th></th><th>ph / (cm2 s)</th><th>ph / (cm2 s)</th><th>erg / (cm2 s)</th><th></th><th>ph / (cm2 s)</th><th>ph / (cm2 s)</th><th>erg / (cm2 s)</th><th></th><th>ph / (cm2 s)</th><th>ph / (cm2 s)</th><th>erg / (cm2 s)</th><th></th><th>ph / (cm2 s)</th><th>ph / (cm2 s)</th><th>erg / (cm2 s)</th><th></th><th>ph / (cm2 s)</th><th>ph / (cm2 s)</th><th>erg / (cm2 s)</th><th></th><th>ph / (cm2 s)</th><th>ph / (cm2 s)</th><th>erg / (cm2 s)</th><th></th><th></th><th></th><th>ph / (cm2 s)</th><th>ph / (cm2 s)</th><th>s</th><th>s</th><th>ph / (cm2 s)</th><th>ph / (cm2 s)</th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th></tr></thead>
<thead><tr><th>bytes18</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>int16</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>bytes16</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float64</th><th>float32</th><th>float32</th><th>float32</th><th>bytes18</th><th>bytes17</th><th>bytes18</th><th>bytes18</th><th>bytes18</th><th>bytes15</th><th>bytes14</th><th>bytes15</th><th>bytes1</th><th>bytes21</th><th>bytes5</th><th>bytes26</th><th>bytes26</th><th>int16</th></tr></thead>
<tr><td>3FGL J0000.1+6545</td><td>0.0377</td><td>65.7517</td><td>117.6939</td><td>3.4030</td><td>0.0628</td><td>0.0481</td><td>41.030</td><td>0.1019</td><td>0.0780</td><td>41.030</td><td>185</td><td>6.813</td><td>1159.08</td><td>1.0053e-12</td><td>1.4911e-13</td><td>1.0160e-09</td><td>1.5759212e-10</td><td>1.3570e-11</td><td>2.0732e-12</td><td>3.40</td><td>PowerLaw</td><td>2.4110</td><td>0.0823</td><td>-inf</td><td>-inf</td><td>-inf</td><td>-inf</td><td>-inf</td><td>-inf</td><td>2.4110</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>1.8083163e-08</td><td>-8.39548e-09 .. 8.236045e-09</td><td>4.1752856e-12</td><td>2.169</td><td>6.9407333e-09</td><td>-1.3528098e-09 .. 1.3669199e-09</td><td>4.543647e-12</td><td>5.270</td><td>1.2366493e-09</td><td>-2.2512775e-10 .. 2.3434676e-10</td><td>2.8553431e-12</td><td>6.022</td><td>5.78052e-11</td><td>-4.04457e-11 .. 4.8533958e-11</td><td>3.7841312e-13</td><td>1.509</td><td>2.8396294e-11</td><td>-1.484277e-11 .. 1.91547e-11</td><td>4.3172041e-13</td><td>2.421</td><td>40.753517</td><td>-inf</td><td>-inf</td><td>-inf</td><td>-inf</td><td>-inf</td><td>6.361567e-08 .. 0.0</td><td>-2.777704e-08 .. 2.0913118e-08</td><td></td><td></td><td></td><td>2FGL J2359.6+6543c</td><td></td><td></td><td></td><td></td><td>N</td><td></td><td></td><td></td><td></td><td>4</td></tr>
</table></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Spectral index of the 5 first entries</span>
<span class="n">table</span><span class="p">[:</span><span class="mi">5</span><span class="p">][</span><span class="s2">&quot;Spectral_Index&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
&lt;Column name=&apos;Spectral_Index&apos; dtype=&apos;float32&apos; format=&apos;{:8.4f}&apos; length=5&gt;
<table>
<tr><td>2.4110</td></tr>
<tr><td>1.8667</td></tr>
<tr><td>2.7328</td></tr>
<tr><td>2.1493</td></tr>
<tr><td>2.3051</td></tr>
</table></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Which source has the lowest spectral index?</span>
<span class="n">row</span> <span class="o">=</span> <span class="n">table</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">table</span><span class="p">[</span><span class="s2">&quot;Spectral_Index&quot;</span><span class="p">])]</span>
<span class="k">print</span><span class="p">(</span>
    <span class="s2">&quot;Hardest source: &quot;</span><span class="p">,</span>
    <span class="n">row</span><span class="p">[</span><span class="s2">&quot;Source_Name&quot;</span><span class="p">],</span>
    <span class="n">row</span><span class="p">[</span><span class="s2">&quot;CLASS1&quot;</span><span class="p">],</span>
    <span class="n">row</span><span class="p">[</span><span class="s2">&quot;Spectral_Index&quot;</span><span class="p">],</span>
<span class="p">)</span>

<span class="c1"># Which source has the largest spectral index?</span>
<span class="n">row</span> <span class="o">=</span> <span class="n">table</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">table</span><span class="p">[</span><span class="s2">&quot;Spectral_Index&quot;</span><span class="p">])]</span>
<span class="k">print</span><span class="p">(</span>
    <span class="s2">&quot;Softest source: &quot;</span><span class="p">,</span>
    <span class="n">row</span><span class="p">[</span><span class="s2">&quot;Source_Name&quot;</span><span class="p">],</span>
    <span class="n">row</span><span class="p">[</span><span class="s2">&quot;CLASS1&quot;</span><span class="p">],</span>
    <span class="n">row</span><span class="p">[</span><span class="s2">&quot;Spectral_Index&quot;</span><span class="p">],</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Hardest source:  3FGL J2051.3-0828  PSR   0.50000006
Softest source:  3FGL J0534.5+2201s PWN   5.715894
</pre></div></div>
</div>
</div>
<div class="section" id="Quantities-and-SkyCoords-from-a-Table">
<h3>Quantities and SkyCoords from a Table<a class="headerlink" href="#Quantities-and-SkyCoords-from-a-Table" title="Permalink to this headline">¶</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">fluxes</span> <span class="o">=</span> <span class="n">table</span><span class="p">[</span><span class="s2">&quot;nuFnu1000_3000&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">quantity</span>
<span class="n">fluxes</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="math notranslate nohighlight">
$$[2.8553431 \times 10^{-12},~3.5327822 \times 10^{-13},~6.7680339 \times 10^{-13},~\dots,~7.3150578 \times 10^{-13},~1.0483972 \times 10^{-12},~4.7821024 \times 10^{-13}] \; \mathrm{\frac{erg}{s\,cm^{2}}}$$</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">coord</span> <span class="o">=</span> <span class="n">SkyCoord</span><span class="p">(</span><span class="n">table</span><span class="p">[</span><span class="s2">&quot;GLON&quot;</span><span class="p">],</span> <span class="n">table</span><span class="p">[</span><span class="s2">&quot;GLAT&quot;</span><span class="p">],</span> <span class="n">frame</span><span class="o">=</span><span class="s2">&quot;galactic&quot;</span><span class="p">)</span>
<span class="n">coord</span><span class="o">.</span><span class="n">fk5</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>&lt;SkyCoord (FK5: equinox=J2000.000): (ra, dec) in deg
    [(3.87169046e-02,  65.75181035), (6.14199915e-02, -37.64829374),
     (2.54454515e-01,  63.2441095 ), ..., (3.59736654e+02,  39.44771292),
     (3.59829367e+02, -30.64638844), (3.59881529e+02, -20.88248953)]&gt;
</pre></div>
</div>
</div>
</div>
<div class="section" id="Selections-in-a-Table">
<h3>Selections in a Table<a class="headerlink" href="#Selections-in-a-Table" title="Permalink to this headline">¶</a></h3>
<p>Here we select Sources according to their class and do some whole sky chart</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Get coordinates of FSRQs</span>
<span class="n">fsrq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
    <span class="n">np</span><span class="o">.</span><span class="n">logical_or</span><span class="p">(</span><span class="n">table</span><span class="p">[</span><span class="s2">&quot;CLASS1&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;fsrq &quot;</span><span class="p">,</span> <span class="n">table</span><span class="p">[</span><span class="s2">&quot;CLASS1&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;FSQR &quot;</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># This is here for plotting purpose...</span>
<span class="c1"># glon = glon.wrap_at(180*u.degree)</span>

<span class="c1"># Open figure</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s2">&quot;aitoff&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
    <span class="n">coord</span><span class="p">[</span><span class="n">fsrq</span><span class="p">]</span><span class="o">.</span><span class="n">l</span><span class="o">.</span><span class="n">wrap_at</span><span class="p">(</span><span class="mi">180</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">degree</span><span class="p">)</span><span class="o">.</span><span class="n">radian</span><span class="p">,</span>
    <span class="n">coord</span><span class="p">[</span><span class="n">fsrq</span><span class="p">]</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">radian</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="s2">&quot;FSRQ&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="c1"># ax.invert_xaxis()  -&gt; This does not work for projections...</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>&lt;matplotlib.legend.Legend at 0x112a83390&gt;
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_astropy_introduction_43_1.png" src="../_images/notebooks_astropy_introduction_43_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Now do it for a series of classes</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s2">&quot;aitoff&quot;</span><span class="p">)</span>

<span class="n">source_classes</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;psr&quot;</span><span class="p">,</span> <span class="s2">&quot;spp&quot;</span><span class="p">,</span> <span class="s2">&quot;fsrq&quot;</span><span class="p">,</span> <span class="s2">&quot;bll&quot;</span><span class="p">,</span> <span class="s2">&quot;bin&quot;</span><span class="p">]</span>

<span class="k">for</span> <span class="n">source_class</span> <span class="ow">in</span> <span class="n">source_classes</span><span class="p">:</span>
    <span class="c1"># We select elements with correct class in upper or lower characters</span>
    <span class="n">index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
        <span class="p">[</span><span class="n">_</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="n">source_class</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">table</span><span class="p">[</span><span class="s2">&quot;CLASS1&quot;</span><span class="p">]]</span>
    <span class="p">)</span>

    <span class="n">label</span> <span class="o">=</span> <span class="n">source_class</span> <span class="k">if</span> <span class="n">source_class</span> <span class="k">else</span> <span class="s2">&quot;unid&quot;</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
        <span class="n">coord</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">l</span><span class="o">.</span><span class="n">wrap_at</span><span class="p">(</span><span class="mi">180</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">degree</span><span class="p">)</span><span class="o">.</span><span class="n">radian</span><span class="p">,</span>
        <span class="n">coord</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">radian</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span>
    <span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_astropy_introduction_44_0.png" src="../_images/notebooks_astropy_introduction_44_0.png" />
</div>
</div>
</div>
<div class="section" id="Creating-tables">
<h3>Creating tables<a class="headerlink" href="#Creating-tables" title="Permalink to this headline">¶</a></h3>
<p>A <code class="docutils literal notranslate"><span class="pre">Table</span></code> is basically a dict mapping column names to column values, where a column value is a Numpy array (or Quantity object, which is a Numpy array sub-class). This implies that adding columns to a table after creation is nice and easy, but adding a row is hard and slow, basically all data has to be copied and all objects that make up a Table have to be re-created.</p>
<p>Here’s one way to create a <code class="docutils literal notranslate"><span class="pre">Table</span></code> from scratch: put the data into a list of dicts, and then call the <code class="docutils literal notranslate"><span class="pre">Table</span></code> constructor with the <code class="docutils literal notranslate"><span class="pre">rows</span></code> option.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">rows</span> <span class="o">=</span> <span class="p">[</span><span class="nb">dict</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="s2">&quot;spam&quot;</span><span class="p">),</span> <span class="nb">dict</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mi">43</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="s2">&quot;ham&quot;</span><span class="p">)]</span>
<span class="n">my_table</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span><span class="n">rows</span><span class="o">=</span><span class="n">rows</span><span class="p">)</span>
<span class="n">my_table</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<i>Table length=2</i>
<table id="table4606482416" class="table-striped table-bordered table-condensed">
<thead><tr><th>a</th><th>b</th></tr></thead>
<thead><tr><th>int64</th><th>str4</th></tr></thead>
<tr><td>42</td><td>spam</td></tr>
<tr><td>43</td><td>ham</td></tr>
</table></div>
</div>
</div>
<div class="section" id="Writing-tables">
<h3>Writing tables<a class="headerlink" href="#Writing-tables" title="Permalink to this headline">¶</a></h3>
<p>Writing tables to files is easy, you can just give the filename and format you want. If you run a script repeatedly you might want to add <code class="docutils literal notranslate"><span class="pre">overwrite=True</span></code>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Examples how to write a table in different formats</span>
<span class="c1"># Uncomment if you really want to do it</span>

<span class="c1"># my_table.write(&#39;/tmp/table.fits&#39;, format=&#39;fits&#39;)</span>
<span class="c1"># my_table.write(&#39;/tmp/table.fits.gz&#39;, format=&#39;fits&#39;)</span>
<span class="c1"># my_table.write(&#39;/tmp/table.ecsv&#39;, format=&#39;ascii.ecsv&#39;)</span>
</pre></div>
</div>
</div>
<p>FITS (and some other formats, e.g.&nbsp;HDF5) support writing multiple tables to a single file. The <code class="docutils literal notranslate"><span class="pre">table.write</span></code> API doesn’t support that directly yet. Here’s how you can currently write multiple tables to a FITS file: you have to convert the <code class="docutils literal notranslate"><span class="pre">astropy.table.Table</span></code> objects to <code class="docutils literal notranslate"><span class="pre">astropy.io.fits.BinTable</span></code> objects, and then store them in a <code class="docutils literal notranslate"><span class="pre">astropy.io.fits.HDUList</span></code> objects and call <code class="docutils literal notranslate"><span class="pre">HDUList.writeto</span></code>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">my_table2</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]))</span>
<span class="n">hdu_list</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">HDUList</span><span class="p">(</span>
    <span class="p">[</span>
        <span class="n">fits</span><span class="o">.</span><span class="n">PrimaryHDU</span><span class="p">(),</span>  <span class="c1"># need an empty primary HDU</span>
        <span class="n">fits</span><span class="o">.</span><span class="n">table_to_hdu</span><span class="p">(</span><span class="n">my_table</span><span class="p">),</span>
        <span class="n">fits</span><span class="o">.</span><span class="n">table_to_hdu</span><span class="p">(</span><span class="n">my_table2</span><span class="p">),</span>
    <span class="p">]</span>
<span class="p">)</span>
<span class="c1"># hdu_list.writeto(&#39;tables.fits&#39;)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Tables-and-pandas">
<h3>Tables and pandas<a class="headerlink" href="#Tables-and-pandas" title="Permalink to this headline">¶</a></h3>
<p><a class="reference external" href="http://pandas.pydata.org/">pandas</a> is one of the most-used packages in the scientific Python stack. Numpy provides the <code class="docutils literal notranslate"><span class="pre">ndarray</span></code> object and functions that operate on <code class="docutils literal notranslate"><span class="pre">ndarray</span></code> objects. Pandas provides the <code class="docutils literal notranslate"><span class="pre">Dataframe</span></code> and <code class="docutils literal notranslate"><span class="pre">Series</span></code> objects, which roughly correspond to the Astropy <code class="docutils literal notranslate"><span class="pre">Table</span></code> and <code class="docutils literal notranslate"><span class="pre">Column</span></code> objects. While both <code class="docutils literal notranslate"><span class="pre">pandas.Dataframe</span></code> and <code class="docutils literal notranslate"><span class="pre">astropy.table.Table</span></code> can often be used to work with tabular data, each has features that the other doesn’t. When Astropy was started, it
was decided to not base it on <code class="docutils literal notranslate"><span class="pre">pandas.Dataframe</span></code>, but to introduce <code class="docutils literal notranslate"><span class="pre">Table</span></code>, mainly because <code class="docutils literal notranslate"><span class="pre">pandas.Dataframe</span></code> doesn’t support multi-dimensional columns, but FITS does and astronomers use sometimes.</p>
<p>But <code class="docutils literal notranslate"><span class="pre">pandas.Dataframe</span></code> has a ton of features that <code class="docutils literal notranslate"><span class="pre">Table</span></code> doesn’t, and is highly optimised, so if you find something to be hard with <code class="docutils literal notranslate"><span class="pre">Table</span></code>, you can convert it to a <code class="docutils literal notranslate"><span class="pre">Dataframe</span></code> and do your work there. As explained in the <a class="reference external" href="http://docs.astropy.org/en/stable/table/pandas.html">interfacing with the pandas package</a> page in the Astropy docs, it is easy to go back and forth between Table and Dataframe:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">table</span> <span class="o">=</span> <span class="n">Table</span><span class="o">.</span><span class="n">from_pandas</span><span class="p">(</span><span class="n">dataframe</span><span class="p">)</span>
<span class="n">dataframe</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span>
</pre></div>
</div>
<p>Let’s try it out with the Fermi-LAT catalog.</p>
<p>One little trick is needed when converting to a dataframe: we need to drop the multi-dimensional columns that the 3FGL catalog uses for a few columns (flux up/down errors, and lightcurves):</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[34]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">scalar_colnames</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span>
    <span class="n">name</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">table</span><span class="o">.</span><span class="n">colnames</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">table</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">1</span>
<span class="p">)</span>
<span class="n">data_frame</span> <span class="o">=</span> <span class="n">table</span><span class="p">[</span><span class="n">scalar_colnames</span><span class="p">]</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[35]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># If you want to have a quick-look at the dataframe:</span>
<span class="c1"># data_frame</span>
<span class="c1"># data_frame.info()</span>
<span class="c1"># data_frame.describe()</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[36]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Just do demonstrate one of the useful DataFrame methods,</span>
<span class="c1"># this is how you can count the number of sources in each class:</span>
<span class="n">data_frame</span><span class="p">[</span><span class="s2">&quot;CLASS1&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[36]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>b&#39;     &#39;    1010
b&#39;bll  &#39;     642
b&#39;bcu  &#39;     568
b&#39;fsrq &#39;     446
b&#39;PSR  &#39;     143
b&#39;spp  &#39;      49
b&#39;FSRQ &#39;      38
b&#39;psr  &#39;      24
b&#39;BLL  &#39;      18
b&#39;glc  &#39;      15
b&#39;SNR  &#39;      12
b&#39;rdg  &#39;      12
b&#39;snr  &#39;      11
b&#39;PWN  &#39;      10
b&#39;BCU  &#39;       5
b&#39;sbg  &#39;       4
b&#39;ssrq &#39;       3
b&#39;HMB  &#39;       3
b&#39;RDG  &#39;       3
b&#39;nlsy1&#39;       3
b&#39;agn  &#39;       3
b&#39;NLSY1&#39;       2
b&#39;GAL  &#39;       2
b&#39;pwn  &#39;       2
b&#39;NOV  &#39;       1
b&#39;SFR  &#39;       1
b&#39;css  &#39;       1
b&#39;BIN  &#39;       1
b&#39;sey  &#39;       1
b&#39;gal  &#39;       1
Name: CLASS1, dtype: int64
</pre></div>
</div>
</div>
<p>If you’d like to learn more about pandas, have a look <a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/10min.html">here</a> or <a class="reference external" href="http://nbviewer.jupyter.org/github/jakevdp/PythonDataScienceHandbook/blob/master/notebooks/03.00-Introduction-to-Pandas.ipynb">here</a>.</p>
</div>
</div>
<div class="section" id="Exercises">
<h2>Exercises<a class="headerlink" href="#Exercises" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>When searched for the hardest and softest sources in 3FGL we did not look at the type of spectrum (PL, ECPL etc), find the hardest and softest PL sources instead.</li>
<li>Replot the full sky chart of sources in ra-dec instead of galactic coordinates</li>
<li>Find the 3FGL sources visible from Paris now</li>
</ul>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[37]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="image_analysis.html" class="btn btn-neutral float-right" title="Fitting 2D images with Gammapy" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="spectrum_simulation_cta.html" class="btn btn-neutral" title="Spectrum simulation for CTA" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, The Gammapy developers
      Last updated on 29 Mar 2019.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
        <script type="text/javascript" src="../_static/copybutton.js"></script>
        <script type="text/javascript" src="../_static/gammapy.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    

  

  <script type="text/javascript" src="../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>