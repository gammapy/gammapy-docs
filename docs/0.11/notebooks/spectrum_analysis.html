

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Spectral analysis with Gammapy &mdash; gammapy v0.11</title>
  

  
  
    <link rel="shortcut icon" href="../_static/gammapy_logo.ico"/>
  
  
  
    <link rel="canonical" href="https://docs.gammapy.org/dev/notebooks/spectrum_analysis.html"/>
  

  

  
  
    

  

  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/graphviz.css" type="text/css" />
  <link rel="stylesheet" href="../_static/gammapy.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Fitting gammapy spectra with sherpa" href="spectrum_fitting_with_sherpa.html" />
    <link rel="prev" title="Spectrum analysis with Gammapy (run pipeline)" href="spectrum_pipe.html" /> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> gammapy
          

          
          </a>

          
            
            
              <div class="version">
                0.11
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting Started</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../getting-started.html">Getting Started</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../getting-started.html#help">Help!?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting-started.html#install">Install</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting-started.html#download-tutorials">Download tutorials</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting-started.html#check-your-setup">Check your setup</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting-started.html#use-gammapy">Use Gammapy</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../getting-started.html#id2">Python</a></li>
<li class="toctree-l3"><a class="reference internal" href="../getting-started.html#ipython">IPython</a></li>
<li class="toctree-l3"><a class="reference internal" href="../getting-started.html#python-script">Python script</a></li>
<li class="toctree-l3"><a class="reference internal" href="../getting-started.html#command-line">Command line</a></li>
<li class="toctree-l3"><a class="reference internal" href="../getting-started.html#jupyter-notebooks">Jupyter notebooks</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../getting-started.html#install-issues">Install issues</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="../tutorials.html">Tutorial notebooks</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../tutorials.html#notebooks">Notebooks</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="first_steps.html">Getting started with Gammapy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="first_steps.html#Introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="first_steps.html#Setup">Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="first_steps.html#Maps">Maps</a></li>
<li class="toctree-l4"><a class="reference internal" href="first_steps.html#Event-lists">Event lists</a></li>
<li class="toctree-l4"><a class="reference internal" href="first_steps.html#Source-catalogs">Source catalogs</a></li>
<li class="toctree-l4"><a class="reference internal" href="first_steps.html#Spectral-models-and-flux-points">Spectral models and flux points</a></li>
<li class="toctree-l4"><a class="reference internal" href="first_steps.html#What-next?">What next?</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="intro_maps.html">Gammapy Maps</a><ul>
<li class="toctree-l4"><a class="reference internal" href="intro_maps.html#Introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="intro_maps.html#0.-Setup">0. Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="intro_maps.html#1.-Creating-WCS-Maps">1. Creating WCS Maps</a></li>
<li class="toctree-l4"><a class="reference internal" href="intro_maps.html#2.-Accessing-and-Modifying-Data">2. Accessing and Modifying Data</a></li>
<li class="toctree-l4"><a class="reference internal" href="intro_maps.html#3.-Reading-and-Writing">3. Reading and Writing</a></li>
<li class="toctree-l4"><a class="reference internal" href="intro_maps.html#4.-Visualizing-and-Plotting">4. Visualizing and Plotting</a></li>
<li class="toctree-l4"><a class="reference internal" href="intro_maps.html#5.-Reprojecting,-Interpolating-and-Miscellaneous">5. Reprojecting, Interpolating and Miscellaneous</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="cta_1dc_introduction.html">CTA first data challenge (1DC) with Gammapy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="cta_1dc_introduction.html#Introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="cta_1dc_introduction.html#Notebook-and-Gammapy-Setup">Notebook and Gammapy Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="cta_1dc_introduction.html#DC-1-data">DC-1 data</a></li>
<li class="toctree-l4"><a class="reference internal" href="cta_1dc_introduction.html#EVENT-data">EVENT data</a></li>
<li class="toctree-l4"><a class="reference internal" href="cta_1dc_introduction.html#EVENT-analysis-example">EVENT analysis example</a></li>
<li class="toctree-l4"><a class="reference internal" href="cta_1dc_introduction.html#IRFs">IRFs</a></li>
<li class="toctree-l4"><a class="reference internal" href="cta_1dc_introduction.html#Index-files-and-DataStore">Index files and DataStore</a></li>
<li class="toctree-l4"><a class="reference internal" href="cta_1dc_introduction.html#Select-observations">Select observations</a></li>
<li class="toctree-l4"><a class="reference internal" href="cta_1dc_introduction.html#Load-data">Load data</a></li>
<li class="toctree-l4"><a class="reference internal" href="cta_1dc_introduction.html#Model-XML-files">Model XML files</a></li>
<li class="toctree-l4"><a class="reference internal" href="cta_1dc_introduction.html#Exercises">Exercises</a></li>
<li class="toctree-l4"><a class="reference internal" href="cta_1dc_introduction.html#What-next?">What next?</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="cta_data_analysis.html">CTA data analysis with Gammapy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="cta_data_analysis.html#Introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="cta_data_analysis.html#Setup">Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="cta_data_analysis.html#Select-observations">Select observations</a></li>
<li class="toctree-l4"><a class="reference internal" href="cta_data_analysis.html#Make-sky-images">Make sky images</a></li>
<li class="toctree-l4"><a class="reference internal" href="cta_data_analysis.html#Source-Detection">Source Detection</a></li>
<li class="toctree-l4"><a class="reference internal" href="cta_data_analysis.html#Spatial-analysis">Spatial analysis</a></li>
<li class="toctree-l4"><a class="reference internal" href="cta_data_analysis.html#Spectrum">Spectrum</a></li>
<li class="toctree-l4"><a class="reference internal" href="cta_data_analysis.html#Exercises">Exercises</a></li>
<li class="toctree-l4"><a class="reference internal" href="cta_data_analysis.html#What-next?">What next?</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="analysis_3d.html">3D analysis</a><ul>
<li class="toctree-l4"><a class="reference internal" href="analysis_3d.html#Setup">Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="analysis_3d.html#Prepare-modeling-input-data">Prepare modeling input data</a></li>
<li class="toctree-l4"><a class="reference internal" href="analysis_3d.html#Likelihood-fit">Likelihood fit</a></li>
<li class="toctree-l4"><a class="reference internal" href="analysis_3d.html#Exercises">Exercises</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="analysis_3d_joint.html">Joint 3D Analysis</a><ul>
<li class="toctree-l4"><a class="reference internal" href="analysis_3d_joint.html#Prepare-modeling-input-data">Prepare modeling input data</a></li>
<li class="toctree-l4"><a class="reference internal" href="analysis_3d_joint.html#Likelihood-fit">Likelihood fit</a></li>
<li class="toctree-l4"><a class="reference internal" href="analysis_3d_joint.html#Plotting-residuals">Plotting residuals</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="simulate_3d.html">3D simulation and fitting</a><ul>
<li class="toctree-l4"><a class="reference internal" href="simulate_3d.html#Imports-and-versions">Imports and versions</a></li>
<li class="toctree-l4"><a class="reference internal" href="simulate_3d.html#Simulate">Simulate</a></li>
<li class="toctree-l4"><a class="reference internal" href="simulate_3d.html#Fit">Fit</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="hess.html">H.E.S.S. with Gammapy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="hess.html#Data-access">Data access</a></li>
<li class="toctree-l4"><a class="reference internal" href="hess.html#Maps">Maps</a></li>
<li class="toctree-l4"><a class="reference internal" href="hess.html#PSF">PSF</a></li>
<li class="toctree-l4"><a class="reference internal" href="hess.html#Map-fit">Map fit</a></li>
<li class="toctree-l4"><a class="reference internal" href="hess.html#Residual-image">Residual image</a></li>
<li class="toctree-l4"><a class="reference internal" href="hess.html#Spectrum">Spectrum</a></li>
<li class="toctree-l4"><a class="reference internal" href="hess.html#Classical-Ring-Background-Analysis">Classical Ring Background Analysis</a></li>
<li class="toctree-l4"><a class="reference internal" href="hess.html#Exercises">Exercises</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="detect_ts.html">Source detection with Gammapy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="detect_ts.html#Introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="detect_ts.html#Setup">Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="detect_ts.html#Read-in-input-images">Read in input images</a></li>
<li class="toctree-l4"><a class="reference internal" href="detect_ts.html#Plot-images">Plot images</a></li>
<li class="toctree-l4"><a class="reference internal" href="detect_ts.html#Source-catalog">Source catalog</a></li>
<li class="toctree-l4"><a class="reference internal" href="detect_ts.html#Measurements">Measurements</a></li>
<li class="toctree-l4"><a class="reference internal" href="detect_ts.html#Compare-to-3FHL">Compare to 3FHL</a></li>
<li class="toctree-l4"><a class="reference internal" href="detect_ts.html#Exercises">Exercises</a></li>
<li class="toctree-l4"><a class="reference internal" href="detect_ts.html#What-next?">What next?</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="image_fitting_with_sherpa.html">Fitting 2D images with Sherpa</a><ul>
<li class="toctree-l4"><a class="reference internal" href="image_fitting_with_sherpa.html#Introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="image_fitting_with_sherpa.html#Necessary-imports">Necessary imports</a></li>
<li class="toctree-l4"><a class="reference internal" href="image_fitting_with_sherpa.html#Generate-the-required-Maps">Generate the required Maps</a></li>
<li class="toctree-l4"><a class="reference internal" href="image_fitting_with_sherpa.html#Making-a-PSF-Map">Making a PSF Map</a></li>
<li class="toctree-l4"><a class="reference internal" href="image_fitting_with_sherpa.html#Make-2D-images-from-3D-ones">Make 2D images from 3D ones</a></li>
<li class="toctree-l4"><a class="reference internal" href="image_fitting_with_sherpa.html#Read-the-maps-and-store-them-in-a-sherpa-model">Read the maps and store them in a sherpa model</a></li>
<li class="toctree-l4"><a class="reference internal" href="image_fitting_with_sherpa.html#Find-and-fit-the-brightest-source">Find and fit the brightest source</a></li>
<li class="toctree-l4"><a class="reference internal" href="image_fitting_with_sherpa.html#Iteratively-find-and-fit-additional-sources">Iteratively find and fit additional sources</a></li>
<li class="toctree-l4"><a class="reference internal" href="image_fitting_with_sherpa.html#Generating-output-table-and-Test-Statistics-estimation">Generating output table and Test Statistics estimation</a></li>
<li class="toctree-l4"><a class="reference internal" href="image_fitting_with_sherpa.html#Exercises">Exercises</a></li>
<li class="toctree-l4"><a class="reference internal" href="image_fitting_with_sherpa.html#More-about-sherpa">More about sherpa</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="spectrum_models.html">Spectral models in Gammapy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="spectrum_models.html#Introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_models.html#Setup">Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_models.html#Create-a-model">Create a model</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_models.html#Get-and-set-model-parameters">Get and set model parameters</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_models.html#List-available-models">List available models</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_models.html#Plotting">Plotting</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_models.html#Parameter-errors">Parameter errors</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_models.html#Integral-fluxes">Integral fluxes</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_models.html#User-defined-model">User-defined model</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_models.html#What’s-next?">What’s next?</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="spectrum_pipe.html">Spectrum analysis with Gammapy (run pipeline)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="spectrum_pipe.html#Setup">Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_pipe.html#Select-data">Select data</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_pipe.html#Configure-the-analysis">Configure the analysis</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_pipe.html#Run-the-analysis">Run the analysis</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_pipe.html#Results">Results</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_pipe.html#Exercises">Exercises</a></li>
</ul>
</li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Spectral analysis with Gammapy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Setup">Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Configure-logger">Configure logger</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Load-Data">Load Data</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Define-Target-Region">Define Target Region</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Create-exclusion-mask">Create exclusion mask</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Estimate-background">Estimate background</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Source-statistic">Source statistic</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Extract-spectrum">Extract spectrum</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Look-at-observations">Look at observations</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Fit-spectrum">Fit spectrum</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Compute-Flux-Points">Compute Flux Points</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Stack-observations">Stack observations</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Exercises">Exercises</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="spectrum_fitting_with_sherpa.html">Fitting gammapy spectra with sherpa</a><ul>
<li class="toctree-l4"><a class="reference internal" href="spectrum_fitting_with_sherpa.html#Load-data-stack">Load data stack</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_fitting_with_sherpa.html#Define-source-model">Define source model</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_fitting_with_sherpa.html#Fit-and-error-estimation">Fit and error estimation</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_fitting_with_sherpa.html#Results-plot">Results plot</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_fitting_with_sherpa.html#Errors-and-confidence-contours">Errors and confidence contours</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_fitting_with_sherpa.html#Exercises">Exercises</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="sed_fitting_gammacat_fermi.html">Flux point fitting in Gammapy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="sed_fitting_gammacat_fermi.html#Introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="sed_fitting_gammacat_fermi.html#Setup">Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="sed_fitting_gammacat_fermi.html#Load-spectral-points">Load spectral points</a></li>
<li class="toctree-l4"><a class="reference internal" href="sed_fitting_gammacat_fermi.html#Power-Law-Fit">Power Law Fit</a></li>
<li class="toctree-l4"><a class="reference internal" href="sed_fitting_gammacat_fermi.html#Exponential-Cut-Off-Powerlaw-Fit">Exponential Cut-Off Powerlaw Fit</a></li>
<li class="toctree-l4"><a class="reference internal" href="sed_fitting_gammacat_fermi.html#Log-Parabola-Fit">Log-Parabola Fit</a></li>
<li class="toctree-l4"><a class="reference internal" href="sed_fitting_gammacat_fermi.html#Exercises">Exercises</a></li>
<li class="toctree-l4"><a class="reference internal" href="sed_fitting_gammacat_fermi.html#What-next?">What next?</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="fermi_lat.html">Fermi-LAT data with Gammapy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="fermi_lat.html#Introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="fermi_lat.html#Setup">Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="fermi_lat.html#Events">Events</a></li>
<li class="toctree-l4"><a class="reference internal" href="fermi_lat.html#Counts">Counts</a></li>
<li class="toctree-l4"><a class="reference internal" href="fermi_lat.html#Exposure">Exposure</a></li>
<li class="toctree-l4"><a class="reference internal" href="fermi_lat.html#Galactic-diffuse-background">Galactic diffuse background</a></li>
<li class="toctree-l4"><a class="reference internal" href="fermi_lat.html#Isotropic-diffuse-background">Isotropic diffuse background</a></li>
<li class="toctree-l4"><a class="reference internal" href="fermi_lat.html#PSF">PSF</a></li>
<li class="toctree-l4"><a class="reference internal" href="fermi_lat.html#Background">Background</a></li>
<li class="toctree-l4"><a class="reference internal" href="fermi_lat.html#Excess-and-flux">Excess and flux</a></li>
<li class="toctree-l4"><a class="reference internal" href="fermi_lat.html#Fit">Fit</a></li>
<li class="toctree-l4"><a class="reference internal" href="fermi_lat.html#Exercises">Exercises</a></li>
<li class="toctree-l4"><a class="reference internal" href="fermi_lat.html#Summary">Summary</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="light_curve.html">Light curves</a><ul>
<li class="toctree-l4"><a class="reference internal" href="light_curve.html#Introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="light_curve.html#Setup">Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="light_curve.html#Spectrum">Spectrum</a></li>
<li class="toctree-l4"><a class="reference internal" href="light_curve.html#Light-curve-estimation">Light curve estimation</a></li>
<li class="toctree-l4"><a class="reference internal" href="light_curve.html#Results">Results</a></li>
<li class="toctree-l4"><a class="reference internal" href="light_curve.html#Exercises">Exercises</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="cta_sensitivity.html">Estimation of the CTA point source sensitivity</a><ul>
<li class="toctree-l4"><a class="reference internal" href="cta_sensitivity.html#Introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="cta_sensitivity.html#Setup">Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="cta_sensitivity.html#Define-analysis-region-and-energy-binning">Define analysis region and energy binning</a></li>
<li class="toctree-l4"><a class="reference internal" href="cta_sensitivity.html#Load-IRFs">Load IRFs</a></li>
<li class="toctree-l4"><a class="reference internal" href="cta_sensitivity.html#Determine-energy-dependent-integration-radius">Determine energy dependent integration radius</a></li>
<li class="toctree-l4"><a class="reference internal" href="cta_sensitivity.html#Estimate-background">Estimate background</a></li>
<li class="toctree-l4"><a class="reference internal" href="cta_sensitivity.html#Compute-sensitivity">Compute sensitivity</a></li>
<li class="toctree-l4"><a class="reference internal" href="cta_sensitivity.html#Results">Results</a></li>
<li class="toctree-l4"><a class="reference internal" href="cta_sensitivity.html#Exercises">Exercises</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="spectrum_simulation.html">Spectrum simulation with Gammapy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="spectrum_simulation.html#Introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_simulation.html#Setup">Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_simulation.html#Create-detector">Create detector</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_simulation.html#Power-law">Power law</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_simulation.html#Include-background">Include background</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_simulation.html#Exercises">Exercises</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_simulation.html#What’s-next">What’s next</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="spectrum_simulation_cta.html">Spectrum simulation for CTA</a><ul>
<li class="toctree-l4"><a class="reference internal" href="spectrum_simulation_cta.html#Setup">Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_simulation_cta.html#Simulation">Simulation</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_simulation_cta.html#Spectral-analysis">Spectral analysis</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_simulation_cta.html#Exercises">Exercises</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_simulation_cta.html#What-next?">What next?</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="astropy_introduction.html">Astropy introduction for Gammapy users</a><ul>
<li class="toctree-l4"><a class="reference internal" href="astropy_introduction.html#Introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="astropy_introduction.html#Setup">Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="astropy_introduction.html#Units-and-constants">Units and constants</a></li>
<li class="toctree-l4"><a class="reference internal" href="astropy_introduction.html#Coordinates">Coordinates</a></li>
<li class="toctree-l4"><a class="reference internal" href="astropy_introduction.html#Time">Time</a></li>
<li class="toctree-l4"><a class="reference internal" href="astropy_introduction.html#Table:-Manipulating-the-3FGL-catalog">Table: Manipulating the 3FGL catalog</a></li>
<li class="toctree-l4"><a class="reference internal" href="astropy_introduction.html#Exercises">Exercises</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="image_analysis.html">Fitting 2D images with Gammapy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="image_analysis.html#Setup">Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="image_analysis.html#Prepare-modeling-input-data">Prepare modeling input data</a></li>
<li class="toctree-l4"><a class="reference internal" href="image_analysis.html#Define-a-mask">Define a mask</a></li>
<li class="toctree-l4"><a class="reference internal" href="image_analysis.html#Modeling-the-source">Modeling the source</a></li>
<li class="toctree-l4"><a class="reference internal" href="image_analysis.html#Modeling-the-background">Modeling the background</a></li>
<li class="toctree-l4"><a class="reference internal" href="image_analysis.html#Todo:-Demonstrate-plotting-a-flux-map">Todo: Demonstrate plotting a flux map</a></li>
<li class="toctree-l4"><a class="reference internal" href="image_analysis.html#Exercises">Exercises</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials.html#extra-topics">Extra topics</a><ul>
<li class="toctree-l3"><a class="reference internal" href="hgps.html">HGPS</a><ul>
<li class="toctree-l4"><a class="reference internal" href="hgps.html#Introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="hgps.html#Notebook-Overview">Notebook Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="hgps.html#Packages">Packages</a></li>
<li class="toctree-l4"><a class="reference internal" href="hgps.html#Setup">Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="hgps.html#Download-Data">Download Data</a></li>
<li class="toctree-l4"><a class="reference internal" href="hgps.html#Catalog-with-Astropy">Catalog with Astropy</a></li>
<li class="toctree-l4"><a class="reference internal" href="hgps.html#Maps-with-Astropy">Maps with Astropy</a></li>
<li class="toctree-l4"><a class="reference internal" href="hgps.html#Catalog-with-Gammapy">Catalog with Gammapy</a></li>
<li class="toctree-l4"><a class="reference internal" href="hgps.html#Maps-with-Gammapy">Maps with Gammapy</a></li>
<li class="toctree-l4"><a class="reference internal" href="hgps.html#Conclusions">Conclusions</a></li>
<li class="toctree-l4"><a class="reference internal" href="hgps.html#Exercises">Exercises</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="source_population_model.html">Astrophysical source population modeling with Gammapy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="source_population_model.html#Introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="source_population_model.html#Setup">Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="source_population_model.html#Simulate-positions">Simulate positions</a></li>
<li class="toctree-l4"><a class="reference internal" href="source_population_model.html#Simulate-luminosities">Simulate luminosities</a></li>
<li class="toctree-l4"><a class="reference internal" href="source_population_model.html#Compute-observable-parameters">Compute observable parameters</a></li>
<li class="toctree-l4"><a class="reference internal" href="source_population_model.html#Check-output">Check output</a></li>
<li class="toctree-l4"><a class="reference internal" href="source_population_model.html#Exercises">Exercises</a></li>
<li class="toctree-l4"><a class="reference internal" href="source_population_model.html#What-next?">What next?</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="cwt.html">CWT Algorithm</a><ul>
<li class="toctree-l4"><a class="reference internal" href="cwt.html#Setup">Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="cwt.html#CWT-Algorithm">CWT Algorithm</a></li>
<li class="toctree-l4"><a class="reference internal" href="cwt.html#Results-of-analysis">Results of analysis</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="astro_dark_matter.html">Dark matter utilities</a><ul>
<li class="toctree-l4"><a class="reference internal" href="astro_dark_matter.html#Introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="astro_dark_matter.html#Setup">Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="astro_dark_matter.html#Profiles">Profiles</a></li>
<li class="toctree-l4"><a class="reference internal" href="astro_dark_matter.html#J-Factors">J Factors</a></li>
<li class="toctree-l4"><a class="reference internal" href="astro_dark_matter.html#Gamma-ray-spectra-at-production">Gamma-ray spectra at production</a></li>
<li class="toctree-l4"><a class="reference internal" href="astro_dark_matter.html#Flux-maps">Flux maps</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="background_model.html">Make template background model</a><ul>
<li class="toctree-l4"><a class="reference internal" href="background_model.html#Introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="background_model.html#Setup">Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="background_model.html#Select-off-data">Select off data</a></li>
<li class="toctree-l4"><a class="reference internal" href="background_model.html#Background-model">Background model</a></li>
<li class="toctree-l4"><a class="reference internal" href="background_model.html#Zenith-dependence">Zenith dependence</a></li>
<li class="toctree-l4"><a class="reference internal" href="background_model.html#Index-tables">Index tables</a></li>
<li class="toctree-l4"><a class="reference internal" href="background_model.html#Exercises">Exercises</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="mcmc_sampling.html">Fitting and error estimation with MCMC</a><ul>
<li class="toctree-l4"><a class="reference internal" href="mcmc_sampling.html#Introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="mcmc_sampling.html#Simulate-an-observation">Simulate an observation</a></li>
<li class="toctree-l4"><a class="reference internal" href="mcmc_sampling.html#Estimate-parameter-correlations-with-MCMC">Estimate parameter correlations with MCMC</a></li>
<li class="toctree-l4"><a class="reference internal" href="mcmc_sampling.html#Plotting-the-results">Plotting the results</a></li>
<li class="toctree-l4"><a class="reference internal" href="mcmc_sampling.html#Plot-the-results">Plot the results</a></li>
<li class="toctree-l4"><a class="reference internal" href="mcmc_sampling.html#Plot-the-model-dispersion">Plot the model dispersion</a></li>
<li class="toctree-l4"><a class="reference internal" href="mcmc_sampling.html#Fun-Zone">Fun Zone</a></li>
<li class="toctree-l4"><a class="reference internal" href="mcmc_sampling.html#PeVatrons-in-CTA-?">PeVatrons in CTA ?</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="pulsar_analysis.html">Pulsar analysis with Gammapy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="pulsar_analysis.html#Introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="pulsar_analysis.html#Opening-the-data">Opening the data</a></li>
<li class="toctree-l4"><a class="reference internal" href="pulsar_analysis.html#Phasogram">Phasogram</a></li>
<li class="toctree-l4"><a class="reference internal" href="pulsar_analysis.html#Phase-resolved-map">Phase-resolved map</a></li>
<li class="toctree-l4"><a class="reference internal" href="pulsar_analysis.html#Phase-resolved-spectrum">Phase-resolved spectrum</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials.html#basics">Basics</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../install/index.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../install/index.html#quick-install-guide">Quick install guide</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../install/index.html#stable-version">Stable version</a></li>
<li class="toctree-l3"><a class="reference internal" href="../install/index.html#development-version">Development version</a></li>
<li class="toctree-l3"><a class="reference internal" href="../install/index.html#verify">Verify</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../install/index.html#need-help">Need help?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../install/index.html#detailed-information">Detailed information</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../install/conda.html">Installation with conda</a></li>
<li class="toctree-l3"><a class="reference internal" href="../install/pip.html">Installation with pip or setup.py</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../install/pip.html#install-pip">pip</a></li>
<li class="toctree-l4"><a class="reference internal" href="../install/pip.html#setup-py">setup.py</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../install/macports.html">Installation with Macports</a></li>
<li class="toctree-l3"><a class="reference internal" href="../install/other.html">Other package managers</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../install/other.html#id1">apt-get</a></li>
<li class="toctree-l4"><a class="reference internal" href="../install/other.html#id2">yum</a></li>
<li class="toctree-l4"><a class="reference internal" href="../install/other.html#id3">Homebrew</a></li>
<li class="toctree-l4"><a class="reference internal" href="../install/other.html#id4">Fermi ScienceTools</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../install/check.html">Check Gammapy installation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../install/check.html#how-to-run-checks">How to run checks</a></li>
<li class="toctree-l4"><a class="reference internal" href="../install/check.html#common-issues">Common issues</a></li>
<li class="toctree-l4"><a class="reference internal" href="../install/check.html#known-issues">Known issues</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../install/dependencies.html">Dependencies</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../references.html">References</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../references.html#publications">Publications</a></li>
<li class="toctree-l2"><a class="reference internal" href="../references.html#glossary">Glossary</a></li>
<li class="toctree-l2"><a class="reference internal" href="../references.html#other-gamma-ray-packages">Other gamma-ray packages</a></li>
<li class="toctree-l2"><a class="reference internal" href="../references.html#other-useful-packages">Other useful packages</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">Changelog</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#gammapy-0p11-release">0.11 (2019-03-29)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../changelog.html#summary">Summary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../changelog.html#pull-requests">Pull requests</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#gammapy-0p10-release">0.10 (2019-01-28)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../changelog.html#id4">Summary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../changelog.html#id5">Pull requests</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#gammapy-0p9-release">0.9 (2018-11-29)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../changelog.html#id7">Summary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../changelog.html#id8">Pull requests</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#gammapy-0p8-release">0.8 (2018-09-23)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../changelog.html#id10">Summary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../changelog.html#id11">Pull requests</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#gammapy-0p7-release">0.7 (2018-02-28)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../changelog.html#id13">Summary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../changelog.html#id15">Pull requests</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#april-28-2017">0.6 (April 28, 2017)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../changelog.html#id16">Summary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../changelog.html#id17">Pull requests</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#november-22-2016">0.5 (November 22, 2016)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../changelog.html#id18">Summary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../changelog.html#id19">Pull requests</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#april-20-2016">0.4 (April 20, 2016)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../changelog.html#id20">Summary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../changelog.html#id21">Pull requests</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#august-13-2015">0.3 (August 13, 2015)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../changelog.html#id22">Summary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../changelog.html#id23">Pull requests</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#april-13-2015">0.2 (April 13, 2015)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../changelog.html#id24">Summary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../changelog.html#id25">Pull requests</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#august-25-2014">0.1 (August 25, 2014)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../changelog.html#id26">Summary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../changelog.html#id27">Pull requests</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Gammapy Package</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../data/index.html">data - Data and observations</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../data/index.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../data/index.html#getting-started">Getting Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="../data/index.html#using-gammapy-data">Using <code class="docutils literal notranslate"><span class="pre">gammapy.data</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../data/index.html#reference-api">Reference/API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../data/index.html#module-gammapy.data">gammapy.data Package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../data/index.html#classes">Classes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../data/index.html#variables">Variables</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../irf/index.html">irf - Instrument response functions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../irf/index.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../irf/index.html#getting-started">Getting Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="../irf/index.html#effective-area">Effective area</a></li>
<li class="toctree-l2"><a class="reference internal" href="../irf/index.html#background">Background</a></li>
<li class="toctree-l2"><a class="reference internal" href="../irf/index.html#psf">PSF</a></li>
<li class="toctree-l2"><a class="reference internal" href="../irf/index.html#energy-dispersion">Energy Dispersion</a></li>
<li class="toctree-l2"><a class="reference internal" href="../irf/index.html#using-gammapy-irf">Using <code class="docutils literal notranslate"><span class="pre">gammapy.irf</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="../irf/theory.html">IRF Theory</a></li>
<li class="toctree-l3"><a class="reference internal" href="../irf/aeff.html">Effective area</a></li>
<li class="toctree-l3"><a class="reference internal" href="../irf/edisp.html">Energy dispersion</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../irf/index.html#reference-api">Reference/API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../irf/index.html#module-gammapy.irf">gammapy.irf Package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../irf/index.html#functions">Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../irf/index.html#classes">Classes</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../maps/index.html">maps - Sky maps</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../maps/index.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../maps/index.html#getting-started">Getting Started</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../maps/index.html#constructing-with-factory-methods">Constructing with Factory Methods</a></li>
<li class="toctree-l3"><a class="reference internal" href="../maps/index.html#indexing-and-slicing">Indexing and Slicing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../maps/index.html#accessor-methods">Accessor Methods</a></li>
<li class="toctree-l3"><a class="reference internal" href="../maps/index.html#interface-with-mapcoord-and-skycoord">Interface with <code class="docutils literal notranslate"><span class="pre">MapCoord</span></code> and <code class="docutils literal notranslate"><span class="pre">SkyCoord</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../maps/index.html#mapcoord">MapCoord</a></li>
<li class="toctree-l3"><a class="reference internal" href="../maps/index.html#interpolation">Interpolation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../maps/index.html#projection">Projection</a></li>
<li class="toctree-l3"><a class="reference internal" href="../maps/index.html#iterating-on-a-map">Iterating on a Map</a></li>
<li class="toctree-l3"><a class="reference internal" href="../maps/index.html#fits-i-o">FITS I/O</a></li>
<li class="toctree-l3"><a class="reference internal" href="../maps/index.html#visualization">Visualization</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../maps/index.html#examples">Examples</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../maps/index.html#creating-a-counts-cube-from-an-ft1-file">Creating a Counts Cube from an FT1 File</a></li>
<li class="toctree-l3"><a class="reference internal" href="../maps/index.html#generating-a-cutout-of-a-model-cube">Generating a Cutout of a Model Cube</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../maps/index.html#using-gammapy-maps">Using <code class="docutils literal notranslate"><span class="pre">gammapy.maps</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="../maps/hpxmap.html">HEALPix-based Maps</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../maps/hpxmap.html#healpix-geometry">HEALPix Geometry</a></li>
<li class="toctree-l4"><a class="reference internal" href="../maps/hpxmap.html#sparse-maps">Sparse Maps</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../maps/wcsmap.html">WCS-based Maps</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../maps/index.html#reference-api">Reference/API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../maps/index.html#module-gammapy.maps">gammapy.maps Package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../maps/index.html#classes">Classes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../maps/index.html#class-inheritance-diagram">Class Inheritance Diagram</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../image/index.html">image - Map image analysis</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../image/index.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../image/index.html#getting-started">Getting Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="../image/index.html#using-gammapy-image">Using <code class="docutils literal notranslate"><span class="pre">gammapy.image</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="../image/models.html">Morphology models (<code class="docutils literal notranslate"><span class="pre">gammapy.image.models</span></code>)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../image/models.html#introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../image/models.html#getting-started">Getting Started</a></li>
<li class="toctree-l4"><a class="reference internal" href="../image/models.html#reference-api">Reference/API</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../image/plotting.html">Image plotting</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../image/plotting.html#colormaps">Colormaps</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../image/index.html#reference-api">Reference/API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../image/index.html#module-gammapy.image">gammapy.image Package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../image/index.html#functions">Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../image/index.html#classes">Classes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../image/index.html#module-gammapy.image.models">gammapy.image.models Package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../image/index.html#id1">Classes</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../cube/index.html">cube - Map cube analysis</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../cube/index.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cube/index.html#getting-started">Getting Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cube/index.html#using-gammapy-cube">Using <code class="docutils literal notranslate"><span class="pre">gammapy.cube</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../cube/index.html#reference-api">Reference/API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../cube/index.html#module-gammapy.cube">gammapy.cube Package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../cube/index.html#functions">Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cube/index.html#classes">Classes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../cube/index.html#module-gammapy.cube.models">gammapy.cube.models Module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../cube/index.html#id1">Classes</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../detect/index.html">detect - Source detection</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../detect/index.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../detect/index.html#computation-of-ts-images">Computation of TS images</a></li>
<li class="toctree-l2"><a class="reference internal" href="../detect/index.html#computation-of-li-ma-significance-images">Computation of Li &amp; Ma significance images</a></li>
<li class="toctree-l2"><a class="reference internal" href="../detect/index.html#using-gammapy-detect">Using <code class="docutils literal notranslate"><span class="pre">gammapy.detect</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../detect/index.html#reference-api">Reference/API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../detect/index.html#module-gammapy.detect">gammapy.detect Package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../detect/index.html#functions">Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../detect/index.html#classes">Classes</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../background/index.html">background - Background modeling</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../background/index.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../background/index.html#getting-started">Getting Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="../background/index.html#using-gammapy-background">Using <code class="docutils literal notranslate"><span class="pre">gammapy.background</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="../background/reflected.html">Reflected regions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../background/index.html#reference-api">Reference/API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../background/index.html#module-gammapy.background">gammapy.background Package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../background/index.html#functions">Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../background/index.html#classes">Classes</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../spectrum/index.html">spectrum - 1D spectrum analysis</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../spectrum/index.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../spectrum/index.html#getting-started">Getting Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="../spectrum/index.html#using-gammapy-spectrum">Using <code class="docutils literal notranslate"><span class="pre">gammapy.spectrum</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="../spectrum/fitting.html">Spectral Fitting</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../spectrum/fitting.html#getting-started">Getting Started</a></li>
<li class="toctree-l4"><a class="reference internal" href="../spectrum/fitting.html#interactive-sherpa-fit">Interactive Sherpa Fit</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../spectrum/index.html#reference-api">Reference/API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../spectrum/index.html#module-gammapy.spectrum">gammapy.spectrum Package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../spectrum/index.html#functions">Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../spectrum/index.html#classes">Classes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../spectrum/index.html#module-gammapy.spectrum.models">gammapy.spectrum.models Module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../spectrum/index.html#id4">Classes</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../time/index.html">time - Time analysis</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../time/index.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../time/index.html#getting-started">Getting Started</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../time/index.html#lightcurve">Lightcurve</a></li>
<li class="toctree-l3"><a class="reference internal" href="../time/index.html#variability-test">Variability test</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../time/index.html#other-codes">Other codes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../time/index.html#using-gammapy-time">Using <code class="docutils literal notranslate"><span class="pre">gammapy.time</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="../time/period.html">Period detection and plotting</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../time/period.html#introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../time/period.html#getting-started">Getting Started</a></li>
<li class="toctree-l4"><a class="reference internal" href="../time/period.html#example">Example</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../time/index.html#reference-api">Reference/API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../time/index.html#module-gammapy.time">gammapy.time Package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../time/index.html#functions">Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../time/index.html#classes">Classes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../time/index.html#module-gammapy.time.models">gammapy.time.models Module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../time/index.html#id1">Classes</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../stats/index.html">stats - Statistics</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../stats/index.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stats/index.html#getting-started">Getting Started</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../stats/index.html#li-ma-significance">Li &amp; Ma Significance</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stats/index.html#confidence-intervals">Confidence Intervals</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../stats/index.html#using-gammapy-stats">Using <code class="docutils literal notranslate"><span class="pre">gammapy.stats</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="../stats/feldman_cousins.html">Feldman and Cousins Confidence Intervals</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stats/feldman_cousins.html#examples">Examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="../stats/feldman_cousins.html#acceptance-interval-fixing">Acceptance Interval Fixing</a></li>
<li class="toctree-l4"><a class="reference internal" href="../stats/feldman_cousins.html#sensitivity">Sensitivity</a></li>
<li class="toctree-l4"><a class="reference internal" href="../stats/feldman_cousins.html#general-case">General Case</a></li>
<li class="toctree-l4"><a class="reference internal" href="../stats/feldman_cousins.html#verification">Verification</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stats/fit_statistics.html">Fit statistics</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stats/fit_statistics.html#introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../stats/fit_statistics.html#gaussian-data">Gaussian data</a></li>
<li class="toctree-l4"><a class="reference internal" href="../stats/fit_statistics.html#poisson-data">Poisson data</a></li>
<li class="toctree-l4"><a class="reference internal" href="../stats/fit_statistics.html#poisson-data-with-background-measurement">Poisson data with background measurement</a></li>
<li class="toctree-l4"><a class="reference internal" href="../stats/fit_statistics.html#further-references">Further references</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../stats/index.html#reference-api">Reference/API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../stats/index.html#module-gammapy.stats">gammapy.stats Package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stats/index.html#functions">Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../stats/index.html#classes">Classes</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../utils/index.html">utils - Utilities</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../utils/index.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../utils/index.html#time-handling-in-gammapy">Time handling in Gammapy</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#time-format-and-scale">Time format and scale</a></li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#mission-elapsed-times-met">Mission elapsed times (MET)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#time-differences">Time differences</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../utils/index.html#energy-handling-in-gammapy">Energy handling in Gammapy</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#basics">Basics</a></li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#energy">Energy</a></li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#energybounds">EnergyBounds</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../utils/index.html#reference-api">Reference/API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#module-gammapy.utils.energy">gammapy.utils.energy Module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#classes">Classes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#module-gammapy.utils.units">gammapy.utils.units Module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#functions">Functions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#module-gammapy.utils.coordinates">gammapy.utils.coordinates Package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#id3">Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#variables">Variables</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#module-gammapy.utils.interpolation">gammapy.utils.interpolation Module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#id4">Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#id5">Classes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#module-gammapy.utils.table">gammapy.utils.table Module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#id6">Functions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#module-gammapy.utils.fits">gammapy.utils.fits Module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#gammapy-fits-utilities">Gammapy FITS utilities</a></li>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#id7">Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#id8">Classes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#module-gammapy.utils.random">gammapy.utils.random Module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#id9">Functions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#module-gammapy.utils.distributions">gammapy.utils.distributions Package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#id10">Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#id11">Classes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#module-gammapy.utils.scripts">gammapy.utils.scripts Module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#id12">Functions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#module-gammapy.utils.testing">gammapy.utils.testing Module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#id13">Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#id14">Classes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#module-gammapy.utils.wcs">gammapy.utils.wcs Module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#id15">Functions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#module-gammapy.utils.nddata">gammapy.utils.nddata Module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#id16">Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#id17">Classes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#module-gammapy.utils.time">gammapy.utils.time Module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#id18">Functions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#module-gammapy.utils.fitting">gammapy.utils.fitting Package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#id19">Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#id20">Classes</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../scripts/index.html">scripts - Command line tools</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../scripts/index.html#introduction">Introduction</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../scripts/index.html#execute">Execute</a></li>
<li class="toctree-l3"><a class="reference internal" href="../scripts/index.html#command-not-found">Command not found</a></li>
<li class="toctree-l3"><a class="reference internal" href="../scripts/index.html#example">Example</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../scripts/index.html#reference">Reference</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../scripts/index.html#gammapy">gammapy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../scripts/index.html#gammapy-check">check</a></li>
<li class="toctree-l4"><a class="reference internal" href="../scripts/index.html#gammapy-download">download</a></li>
<li class="toctree-l4"><a class="reference internal" href="../scripts/index.html#gammapy-image">image</a></li>
<li class="toctree-l4"><a class="reference internal" href="../scripts/index.html#gammapy-info">info</a></li>
<li class="toctree-l4"><a class="reference internal" href="../scripts/index.html#gammapy-jupyter">jupyter</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../scripts/index.html#implementation">Implementation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../scripts/index.html#limitations">Limitations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../scripts/index.html#plan">Plan</a></li>
<li class="toctree-l2"><a class="reference internal" href="../scripts/index.html#write-your-own-cli">Write your own CLI</a></li>
<li class="toctree-l2"><a class="reference internal" href="../scripts/index.html#reference-api">Reference/API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../scripts/index.html#module-gammapy.scripts">gammapy.scripts Package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../scripts/index.html#classes">Classes</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../catalog/index.html">catalog - Source catalogs</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../catalog/index.html#introduction">Introduction</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../catalog/index.html#available-catalogs">Available catalogs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../catalog/index.html#how-it-works">How it works</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../catalog/index.html#getting-started">Getting Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="../catalog/index.html#using-gammapy-catalog">Using <code class="docutils literal notranslate"><span class="pre">gammapy.catalog</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="../catalog/gammacat.html">gamma-cat</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../catalog/gammacat.html#catalog">Catalog</a></li>
<li class="toctree-l4"><a class="reference internal" href="../catalog/gammacat.html#data-collection">Data collection</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../catalog/index.html#reference-api">Reference/API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../catalog/index.html#module-gammapy.catalog">gammapy.catalog Package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../catalog/index.html#functions">Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../catalog/index.html#classes">Classes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../catalog/index.html#variables">Variables</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../astro/index.html">astro - Astrophysics</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../astro/index.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../astro/index.html#getting-started">Getting Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="../astro/index.html#sub-packages">Sub-packages</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../astro/source/index.html">Astrophysical source models (<code class="docutils literal notranslate"><span class="pre">gammapy.astro.source</span></code>)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../astro/source/index.html#introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../astro/source/index.html#getting-started">Getting Started</a></li>
<li class="toctree-l4"><a class="reference internal" href="../astro/source/index.html#using-gammapy-astro-source">Using <code class="docutils literal notranslate"><span class="pre">gammapy.astro.source</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../astro/source/index.html#reference-api">Reference/API</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../astro/population/index.html">Astrophysical source population models (<code class="docutils literal notranslate"><span class="pre">gammapy.astro.population</span></code>)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../astro/population/index.html#introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../astro/population/index.html#getting-started">Getting Started</a></li>
<li class="toctree-l4"><a class="reference internal" href="../astro/population/index.html#reference-api">Reference/API</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../astro/darkmatter/index.html">Dark matter (<code class="docutils literal notranslate"><span class="pre">gammapy.astro.darkmatter</span></code>)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../astro/darkmatter/index.html#introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../astro/darkmatter/index.html#other-packages">Other packages</a></li>
<li class="toctree-l4"><a class="reference internal" href="../astro/darkmatter/index.html#using-gammapy-spectrum">Using <code class="docutils literal notranslate"><span class="pre">gammapy.spectrum</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../astro/darkmatter/index.html#reference-api">Reference/API</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Developer Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../development/index.html">Developer documentation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../development/intro.html">How to contribute to Gammapy?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../development/setup.html">Gammapy project setup</a></li>
<li class="toctree-l2"><a class="reference internal" href="../development/howto.html">Developer HOWTO</a></li>
<li class="toctree-l2"><a class="reference internal" href="../development/release.html">How to make a Gammapy release</a></li>
<li class="toctree-l2"><a class="reference internal" href="../development/pigs/index.html">PIGs</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../development/pigs/pig-001.html">PIG 1 - PIG purpose and guidelines</a></li>
<li class="toctree-l3"><a class="reference internal" href="../development/pigs/pig-002.html">PIG 2 - Organization of low-level analysis code</a></li>
<li class="toctree-l3"><a class="reference internal" href="../development/pigs/pig-003.html">PIG 3 - Plan for dropping Python 2.7 support</a></li>
<li class="toctree-l3"><a class="reference internal" href="../development/pigs/pig-004.html">PIG 4 - Setup for tutorial notebooks and data</a></li>
<li class="toctree-l3"><a class="reference internal" href="../development/pigs/pig-005.html">PIG 5 - Gammapy 1.0 Roadmap</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../development/dataformats.html">Data Formats</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">gammapy</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../tutorials.html">Tutorial notebooks</a> &raquo;</li>
        
      <li>Spectral analysis with Gammapy</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/notebooks/spectrum_analysis.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput,
div.nbinput div.prompt,
div.nbinput div.input_area,
div.nbinput div[class*=highlight],
div.nbinput div[class*=highlight] pre,
div.nboutput,
div.nbinput div.prompt,
div.nbinput div.output_area,
div.nboutput div[class*=highlight],
div.nboutput div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput,
div.nboutput {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput,
    div.nboutput {
        flex-direction: column;
    }
}

/* input container */
div.nbinput {
    padding-top: 5px;
}

/* last container */
div.nblast {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput div.prompt,
div.nboutput div.prompt {
    min-width: 5ex;
    padding-top: 0.4em;
    padding-right: 0.4em;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput div.prompt,
    div.nboutput div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput div.prompt pre,
div.nboutput div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput div.input_area,
div.nboutput div.output_area {
    padding: 0.4em;
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput div.input_area,
    div.nboutput div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    background: #f5f5f5;
}

/* override MathJax center alignment in output cells */
div.nboutput div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput div.math p {
    text-align: left;
}

/* standard error */
div.nboutput div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast,
.nboutput.nblast {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast + .nbinput {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="admonition note">
<p class="admonition-title fa fa-exclamation-circle"><strong>This is a fixed-text formatted version of a Jupyter notebook</strong></p>
<ul class="simple">
<li>Try online <a class="reference external" href="https://mybinder.org/v2/gh/gammapy/gammapy-webpage/v0.11?urlpath=lab/tree/spectrum_analysis.ipynb"><img alt="Binder" src="https://mybinder.org/badge.svg" /></a></li>
<li>You can contribute with your own notebooks in this <a class="reference external" href="https://github.com/gammapy/gammapy/tree/master/tutorials">GitHub repository</a>.</li>
<li><strong>Source files:</strong> <a class="reference external" href="../_static/notebooks/spectrum_analysis.ipynb">spectrum_analysis.ipynb</a> | <a class="reference external" href="../_static/notebooks/spectrum_analysis.py">spectrum_analysis.py</a></li>
</ul>
</div>
<div class="section" id="Spectral-analysis-with-Gammapy">
<h1>Spectral analysis with Gammapy<a class="headerlink" href="#Spectral-analysis-with-Gammapy" title="Permalink to this headline">¶</a></h1>
<div class="section" id="Introduction">
<h2>Introduction<a class="headerlink" href="#Introduction" title="Permalink to this headline">¶</a></h2>
<p>This notebook explains in detail how to use the classes in <a class="reference internal" href="../spectrum/index.html"><span class="doc">gammapy.spectrum</span></a> and related ones. Note, that there is also <a class="reference internal" href="spectrum_pipe.html"><span class="doc">spectrum_pipe.ipynb</span></a> which explains how to do the analysis using a high-level interface. This notebook is aimed at advanced users who want to script taylor-made analysis pipelines and implement new methods.</p>
<p>Based on a datasets of 4 Crab observations with H.E.S.S. (simulated events for now) we will perform a full region based spectral analysis, i.e.&nbsp;extracting source and background counts from certain regions, and fitting them using the forward-folding approach. We will use the following classes</p>
<p>Data handling:</p>
<ul class="simple">
<li><a class="reference internal" href="../api/gammapy.data.DataStore.html"><span class="doc">gammapy.data.DataStore</span></a></li>
<li><a class="reference internal" href="../api/gammapy.data.DataStoreObservation.html"><span class="doc">gammapy.data.DataStoreObservation</span></a></li>
<li><a class="reference internal" href="../api/gammapy.data.ObservationStats.html"><span class="doc">gammapy.data.ObservationStats</span></a></li>
<li><a class="reference internal" href="../api/gammapy.data.ObservationSummary.html"><span class="doc">gammapy.data.ObservationSummary</span></a></li>
</ul>
<p>To extract the 1-dim spectral information:</p>
<ul class="simple">
<li><a class="reference internal" href="../api/gammapy.spectrum.SpectrumObservation.html"><span class="doc">gammapy.spectrum.SpectrumObservation</span></a></li>
<li><a class="reference internal" href="../api/gammapy.spectrum.SpectrumExtraction.html"><span class="doc">gammapy.spectrum.SpectrumExtraction</span></a></li>
<li><a class="reference internal" href="../api/gammapy.background.ReflectedRegionsBackgroundEstimator.html"><span class="doc">gammapy.background.ReflectedRegionsBackgroundEstimator</span></a></li>
</ul>
<p>For the global fit (using Sherpa and WSTAT in the background):</p>
<ul class="simple">
<li><a class="reference internal" href="../api/gammapy.spectrum.SpectrumFit.html"><span class="doc">gammapy.spectrum.SpectrumFit</span></a></li>
<li><a class="reference internal" href="../api/gammapy.spectrum.models.PowerLaw.html"><span class="doc">gammapy.spectrum.models.PowerLaw</span></a></li>
<li><a class="reference internal" href="../api/gammapy.spectrum.models.ExponentialCutoffPowerLaw.html"><span class="doc">gammapy.spectrum.models.ExponentialCutoffPowerLaw</span></a></li>
<li><a class="reference internal" href="../api/gammapy.spectrum.models.LogParabola.html"><span class="doc">gammapy.spectrum.models.LogParabola</span></a></li>
</ul>
<p>To compute flux points (a.k.a. “SED” = “spectral energy distribution”)</p>
<ul class="simple">
<li><a class="reference internal" href="../api/gammapy.spectrum.SpectrumResult.html"><span class="doc">gammapy.spectrum.SpectrumResult</span></a></li>
<li><a class="reference internal" href="../api/gammapy.spectrum.FluxPoints.html"><span class="doc">gammapy.spectrum.FluxPoints</span></a></li>
<li><a class="reference internal" href="../api/gammapy.spectrum.SpectrumEnergyGroupMaker.html"><span class="doc">gammapy.spectrum.SpectrumEnergyGroupMaker</span></a></li>
<li><a class="reference internal" href="../api/gammapy.spectrum.FluxPointEstimator.html"><span class="doc">gammapy.spectrum.FluxPointEstimator</span></a></li>
</ul>
<p>Feedback welcome!</p>
</div>
<div class="section" id="Setup">
<h2>Setup<a class="headerlink" href="#Setup" title="Permalink to this headline">¶</a></h2>
<p>As usual, we’ll start with some setup …</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Check package versions</span>
<span class="kn">import</span> <span class="nn">gammapy</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">astropy</span>
<span class="kn">import</span> <span class="nn">regions</span>
<span class="kn">import</span> <span class="nn">sherpa</span>

<span class="k">print</span><span class="p">(</span><span class="s2">&quot;gammapy:&quot;</span><span class="p">,</span> <span class="n">gammapy</span><span class="o">.</span><span class="n">__version__</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s2">&quot;numpy:&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">__version__</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s2">&quot;astropy&quot;</span><span class="p">,</span> <span class="n">astropy</span><span class="o">.</span><span class="n">__version__</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s2">&quot;regions&quot;</span><span class="p">,</span> <span class="n">regions</span><span class="o">.</span><span class="n">__version__</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s2">&quot;sherpa&quot;</span><span class="p">,</span> <span class="n">sherpa</span><span class="o">.</span><span class="n">__version__</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
gammapy: 0.11
numpy: 1.16.2
astropy 3.1.1
regions 0.3
sherpa 4.10.2
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">astropy.units</span> <span class="kn">as</span> <span class="nn">u</span>
<span class="kn">from</span> <span class="nn">astropy.coordinates</span> <span class="kn">import</span> <span class="n">SkyCoord</span><span class="p">,</span> <span class="n">Angle</span>
<span class="kn">from</span> <span class="nn">astropy.table</span> <span class="kn">import</span> <span class="n">vstack</span> <span class="k">as</span> <span class="n">vstack_table</span>
<span class="kn">from</span> <span class="nn">regions</span> <span class="kn">import</span> <span class="n">CircleSkyRegion</span>
<span class="kn">from</span> <span class="nn">gammapy.data</span> <span class="kn">import</span> <span class="n">DataStore</span><span class="p">,</span> <span class="n">Observations</span>
<span class="kn">from</span> <span class="nn">gammapy.data</span> <span class="kn">import</span> <span class="n">ObservationStats</span><span class="p">,</span> <span class="n">ObservationSummary</span>
<span class="kn">from</span> <span class="nn">gammapy.background.reflected</span> <span class="kn">import</span> <span class="n">ReflectedRegionsBackgroundEstimator</span>
<span class="kn">from</span> <span class="nn">gammapy.utils.energy</span> <span class="kn">import</span> <span class="n">EnergyBounds</span>
<span class="kn">from</span> <span class="nn">gammapy.spectrum</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">SpectrumExtraction</span><span class="p">,</span>
    <span class="n">SpectrumObservation</span><span class="p">,</span>
    <span class="n">SpectrumFit</span><span class="p">,</span>
    <span class="n">SpectrumResult</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">gammapy.spectrum.models</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">PowerLaw</span><span class="p">,</span>
    <span class="n">ExponentialCutoffPowerLaw</span><span class="p">,</span>
    <span class="n">LogParabola</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">gammapy.spectrum</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">FluxPoints</span><span class="p">,</span>
    <span class="n">SpectrumEnergyGroupMaker</span><span class="p">,</span>
    <span class="n">FluxPointEstimator</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">gammapy.maps</span> <span class="kn">import</span> <span class="n">Map</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Configure-logger">
<h2>Configure logger<a class="headerlink" href="#Configure-logger" title="Permalink to this headline">¶</a></h2>
<p>Most high level classes in gammapy have the possibility to turn on logging or debug output. We well configure the logger in the following. For more info see <a class="reference external" href="https://docs.python.org/2/howto/logging.html#logging-basic-tutorial">https://docs.python.org/2/howto/logging.html#logging-basic-tutorial</a></p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Setup the logger</span>
<span class="kn">import</span> <span class="nn">logging</span>

<span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">()</span>
<span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s2">&quot;gammapy.spectrum&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="s2">&quot;WARNING&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Load-Data">
<h2>Load Data<a class="headerlink" href="#Load-Data" title="Permalink to this headline">¶</a></h2>
<p>First, we select and load some H.E.S.S. observations of the Crab nebula (simulated events for now).</p>
<p>We will access the events, effective area, energy dispersion, livetime and PSF for containement correction.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">datastore</span> <span class="o">=</span> <span class="n">DataStore</span><span class="o">.</span><span class="n">from_dir</span><span class="p">(</span><span class="s2">&quot;$GAMMAPY_DATA/hess-dl3-dr1/&quot;</span><span class="p">)</span>
<span class="n">obs_ids</span> <span class="o">=</span> <span class="p">[</span><span class="mi">23523</span><span class="p">,</span> <span class="mi">23526</span><span class="p">,</span> <span class="mi">23559</span><span class="p">,</span> <span class="mi">23592</span><span class="p">]</span>
<span class="n">observations</span> <span class="o">=</span> <span class="n">datastore</span><span class="o">.</span><span class="n">get_observations</span><span class="p">(</span><span class="n">obs_ids</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Define-Target-Region">
<h2>Define Target Region<a class="headerlink" href="#Define-Target-Region" title="Permalink to this headline">¶</a></h2>
<p>The next step is to define a signal extraction region, also known as on region. In the simplest case this is just a <a class="reference external" href="http://astropy-regions.readthedocs.io/en/latest/api/regions.CircleSkyRegion.html#regions.CircleSkyRegion">CircleSkyRegion</a>, but here we will use the <code class="docutils literal notranslate"><span class="pre">Target</span></code> class in gammapy that is useful for book-keeping if you run several analysis in a script.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">target_position</span> <span class="o">=</span> <span class="n">SkyCoord</span><span class="p">(</span><span class="n">ra</span><span class="o">=</span><span class="mf">83.63</span><span class="p">,</span> <span class="n">dec</span><span class="o">=</span><span class="mf">22.01</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="s2">&quot;deg&quot;</span><span class="p">,</span> <span class="n">frame</span><span class="o">=</span><span class="s2">&quot;icrs&quot;</span><span class="p">)</span>
<span class="n">on_region_radius</span> <span class="o">=</span> <span class="n">Angle</span><span class="p">(</span><span class="s2">&quot;0.11 deg&quot;</span><span class="p">)</span>
<span class="n">on_region</span> <span class="o">=</span> <span class="n">CircleSkyRegion</span><span class="p">(</span><span class="n">center</span><span class="o">=</span><span class="n">target_position</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="n">on_region_radius</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Create-exclusion-mask">
<h2>Create exclusion mask<a class="headerlink" href="#Create-exclusion-mask" title="Permalink to this headline">¶</a></h2>
<p>We will use the reflected regions method to place off regions to estimate the background level in the on region. To make sure the off regions don’t contain gamma-ray emission, we create an exclusion mask.</p>
<p>Using <a class="reference external" href="http://gamma-sky.net/">http://gamma-sky.net/</a> we find that there’s only one known gamma-ray source near the Crab nebula: the AGN called <a class="reference external" href="http://gamma-sky.net/#/cat/tev/23">RGB J0521+212</a> at GLON = 183.604 deg and GLAT = -8.708 deg.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">exclusion_region</span> <span class="o">=</span> <span class="n">CircleSkyRegion</span><span class="p">(</span>
    <span class="n">center</span><span class="o">=</span><span class="n">SkyCoord</span><span class="p">(</span><span class="mf">183.604</span><span class="p">,</span> <span class="o">-</span><span class="mf">8.708</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="s2">&quot;deg&quot;</span><span class="p">,</span> <span class="n">frame</span><span class="o">=</span><span class="s2">&quot;galactic&quot;</span><span class="p">),</span>
    <span class="n">radius</span><span class="o">=</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">skydir</span> <span class="o">=</span> <span class="n">target_position</span><span class="o">.</span><span class="n">galactic</span>
<span class="n">exclusion_mask</span> <span class="o">=</span> <span class="n">Map</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
    <span class="n">npix</span><span class="o">=</span><span class="p">(</span><span class="mi">150</span><span class="p">,</span> <span class="mi">150</span><span class="p">),</span> <span class="n">binsz</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">skydir</span><span class="o">=</span><span class="n">skydir</span><span class="p">,</span> <span class="n">proj</span><span class="o">=</span><span class="s2">&quot;TAN&quot;</span><span class="p">,</span> <span class="n">coordsys</span><span class="o">=</span><span class="s2">&quot;GAL&quot;</span>
<span class="p">)</span>

<span class="n">mask</span> <span class="o">=</span> <span class="n">exclusion_mask</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">region_mask</span><span class="p">([</span><span class="n">exclusion_region</span><span class="p">],</span> <span class="n">inside</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="n">exclusion_mask</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">mask</span>
<span class="n">exclusion_mask</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>(&lt;Figure size 432x288 with 1 Axes&gt;,
 &lt;matplotlib.axes._subplots.WCSAxesSubplot at 0x1c1bbcdef0&gt;,
 None)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_spectrum_analysis_14_1.png" src="../_images/notebooks_spectrum_analysis_14_1.png" />
</div>
</div>
</div>
<div class="section" id="Estimate-background">
<h2>Estimate background<a class="headerlink" href="#Estimate-background" title="Permalink to this headline">¶</a></h2>
<p>Next we will manually perform a background estimate by placing <a class="reference internal" href="../background/reflected.html"><span class="doc">reflected regions</span></a> around the pointing position and looking at the source statistics. This will result in a <a class="reference internal" href="../api/gammapy.background.BackgroundEstimate.html"><span class="doc">gammapy.background.BackgroundEstimate</span></a> that serves as input for other classes in gammapy.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">background_estimator</span> <span class="o">=</span> <span class="n">ReflectedRegionsBackgroundEstimator</span><span class="p">(</span>
    <span class="n">observations</span><span class="o">=</span><span class="n">observations</span><span class="p">,</span>
    <span class="n">on_region</span><span class="o">=</span><span class="n">on_region</span><span class="p">,</span>
    <span class="n">exclusion_mask</span><span class="o">=</span><span class="n">exclusion_mask</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">background_estimator</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># print(background_estimator.result[0])</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">background_estimator</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">add_legend</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/Users/adonath/software/anaconda3/envs/gammapy-dev/lib/python3.7/site-packages/matplotlib/patches.py:75: UserWarning: Setting the &#39;color&#39; property will overridethe edgecolor or facecolor properties.
  warnings.warn(&#34;Setting the &#39;color&#39; property will override&#34;
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>(&lt;Figure size 576x576 with 1 Axes&gt;,
 &lt;matplotlib.axes._subplots.WCSAxesSubplot at 0x1c1be1a0b8&gt;,
 None)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_spectrum_analysis_18_2.png" src="../_images/notebooks_spectrum_analysis_18_2.png" />
</div>
</div>
</div>
<div class="section" id="Source-statistic">
<h2>Source statistic<a class="headerlink" href="#Source-statistic" title="Permalink to this headline">¶</a></h2>
<p>Next we’re going to look at the overall source statistics in our signal region. For more info about what debug plots you can create check out the <a class="reference internal" href="../api/gammapy.data.ObservationSummary.html#gammapy.data.ObservationSummary"><span class="std std-ref">ObservationSummary</span></a> class.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">stats</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">obs</span><span class="p">,</span> <span class="n">bkg</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">observations</span><span class="p">,</span> <span class="n">background_estimator</span><span class="o">.</span><span class="n">result</span><span class="p">):</span>
    <span class="n">stats</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ObservationStats</span><span class="o">.</span><span class="n">from_observation</span><span class="p">(</span><span class="n">obs</span><span class="p">,</span> <span class="n">bkg</span><span class="p">))</span>

<span class="k">print</span><span class="p">(</span><span class="n">stats</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

<span class="n">obs_summary</span> <span class="o">=</span> <span class="n">ObservationSummary</span><span class="p">(</span><span class="n">stats</span><span class="p">)</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">)</span>

<span class="n">obs_summary</span><span class="o">.</span><span class="n">plot_excess_vs_livetime</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax1</span><span class="p">)</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">122</span><span class="p">)</span>
<span class="n">obs_summary</span><span class="o">.</span><span class="n">plot_significance_vs_livetime</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
*** Observation summary report ***
Observation Id: 23526
Livetime: 0.437 h
On events: 201
Off events: 225
Alpha: 0.083
Bkg events in On region: 18.75
Excess: 182.25
Excess / Background: 9.72
Gamma rate: 6.95 1 / min
Bkg rate: 0.72 1 / min
Sigma: 21.86

</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>&lt;matplotlib.axes._subplots.AxesSubplot at 0x1c1bd2b160&gt;
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_spectrum_analysis_20_2.png" src="../_images/notebooks_spectrum_analysis_20_2.png" />
</div>
</div>
</div>
<div class="section" id="Extract-spectrum">
<h2>Extract spectrum<a class="headerlink" href="#Extract-spectrum" title="Permalink to this headline">¶</a></h2>
<p>Now, we’re going to extract a spectrum using the <a class="reference internal" href="../api/gammapy.spectrum.SpectrumExtraction.html"><span class="doc">SpectrumExtraction</span></a> class. We provide the reconstructed energy binning we want to use. It is expected to be a Quantity with unit energy, i.e.&nbsp;an array with an energy unit. We use a utility function to create it. We also provide the true energy binning to use.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">e_reco</span> <span class="o">=</span> <span class="n">EnergyBounds</span><span class="o">.</span><span class="n">equal_log_spacing</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="s2">&quot;TeV&quot;</span><span class="p">)</span>
<span class="n">e_true</span> <span class="o">=</span> <span class="n">EnergyBounds</span><span class="o">.</span><span class="n">equal_log_spacing</span><span class="p">(</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">100.0</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="s2">&quot;TeV&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Instantiate a <a class="reference internal" href="../api/gammapy.spectrum.SpectrumExtraction.html"><span class="doc">SpectrumExtraction</span></a> object that will do the extraction. The containment_correction parameter is there to allow for PSF leakage correction if one is working with full enclosure IRFs. We also compute a threshold energy and store the result in OGIP compliant files (pha, rmf, arf). This last step might be omitted though.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">ANALYSIS_DIR</span> <span class="o">=</span> <span class="s2">&quot;crab_analysis&quot;</span>

<span class="n">extraction</span> <span class="o">=</span> <span class="n">SpectrumExtraction</span><span class="p">(</span>
    <span class="n">observations</span><span class="o">=</span><span class="n">observations</span><span class="p">,</span>
    <span class="n">bkg_estimate</span><span class="o">=</span><span class="n">background_estimator</span><span class="o">.</span><span class="n">result</span><span class="p">,</span>
    <span class="n">containment_correction</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">extraction</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>

<span class="c1"># Add a condition on correct energy range in case it is not set by default</span>
<span class="n">extraction</span><span class="o">.</span><span class="n">compute_energy_threshold</span><span class="p">(</span><span class="n">method_lo</span><span class="o">=</span><span class="s2">&quot;area_max&quot;</span><span class="p">,</span> <span class="n">area_percent_lo</span><span class="o">=</span><span class="mf">10.0</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="n">extraction</span><span class="o">.</span><span class="n">spectrum_observations</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="c1"># Write output in the form of OGIP files: PHA, ARF, RMF, BKG</span>
<span class="c1"># extraction.run(observations=observations, bkg_estimate=background_estimator.result, outdir=ANALYSIS_DIR)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
*** Observation summary report ***
Observation Id: 23523
Livetime: 0.439 h
On events: 125
Off events: 98
Alpha: 0.083
Bkg events in On region: 8.17
Excess: 116.83
Excess / Background: 14.31
Gamma rate: 4.43 1 / min
Bkg rate: 0.01 1 / min
Sigma: 18.74
energy range: 0.88 TeV - 100.00 TeV
</pre></div></div>
</div>
</div>
<div class="section" id="Look-at-observations">
<h2>Look at observations<a class="headerlink" href="#Look-at-observations" title="Permalink to this headline">¶</a></h2>
<p>Now we will look at the files we just created. We will use the <a class="reference internal" href="../api/gammapy.spectrum.SpectrumObservation.html"><span class="doc">SpectrumObservation</span></a> object that are still in memory from the extraction step. Note, however, that you could also read them from disk if you have written them in the step above. The <code class="docutils literal notranslate"><span class="pre">ANALYSIS_DIR</span></code> folder contains 4 <code class="docutils literal notranslate"><span class="pre">FITS</span></code> files for each observation. These files are described in detail <a class="reference external" href="https://gamma-astro-data-formats.readthedocs.io/en/latest/spectra/ogip/index.html">here</a>.
In short, they correspond to the on vector, the off vector, the effectie area, and the energy dispersion.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># filename = ANALYSIS_DIR + &#39;/ogip_data/pha_obs23523.fits&#39;</span>
<span class="c1"># obs = SpectrumObservation.read(filename)</span>

<span class="c1"># Requires IPython widgets</span>
<span class="c1"># _ = extraction.spectrum_observations.peek()</span>

<span class="n">extraction</span><span class="o">.</span><span class="n">spectrum_observations</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">peek</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_spectrum_analysis_26_0.png" src="../_images/notebooks_spectrum_analysis_26_0.png" />
</div>
</div>
</div>
<div class="section" id="Fit-spectrum">
<h2>Fit spectrum<a class="headerlink" href="#Fit-spectrum" title="Permalink to this headline">¶</a></h2>
<p>Now we’ll fit a global model to the spectrum. First we do a joint likelihood fit to all observations. If you want to stack the observations see below. We will also produce a debug plot in order to show how the global fit matches one of the individual observations.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">model</span> <span class="o">=</span> <span class="n">PowerLaw</span><span class="p">(</span>
    <span class="n">index</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">amplitude</span><span class="o">=</span><span class="mf">2e-11</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">Unit</span><span class="p">(</span><span class="s2">&quot;cm-2 s-1 TeV-1&quot;</span><span class="p">),</span> <span class="n">reference</span><span class="o">=</span><span class="mi">1</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">TeV</span>
<span class="p">)</span>

<span class="n">joint_fit</span> <span class="o">=</span> <span class="n">SpectrumFit</span><span class="p">(</span><span class="n">obs_list</span><span class="o">=</span><span class="n">extraction</span><span class="o">.</span><span class="n">spectrum_observations</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">)</span>
<span class="n">joint_fit</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">joint_result</span> <span class="o">=</span> <span class="n">joint_fit</span><span class="o">.</span><span class="n">result</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">ax0</span><span class="p">,</span> <span class="n">ax1</span> <span class="o">=</span> <span class="n">joint_result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">ax0</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">joint_result</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

Fit result info
---------------
Model: PowerLaw

Parameters:

           name     value     error        unit      min max frozen
        --------- --------- --------- -------------- --- --- ------
            index 2.663e+00 7.092e-02                nan nan  False
        amplitude 2.911e-11 1.782e-12 cm-2 s-1 TeV-1 nan nan  False
        reference 1.000e+00 0.000e+00            TeV nan nan   True

Covariance:

           name     index   amplitude reference
        --------- --------- --------- ---------
            index 5.030e-03 7.184e-14 0.000e+00
        amplitude 7.184e-14 3.176e-24 0.000e+00
        reference 0.000e+00 0.000e+00 0.000e+00

Statistic: 42.231 (wstat)
Fit Range: [  0.87992254 100.        ] TeV

</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_spectrum_analysis_29_1.png" src="../_images/notebooks_spectrum_analysis_29_1.png" />
</div>
</div>
</div>
<div class="section" id="Compute-Flux-Points">
<h2>Compute Flux Points<a class="headerlink" href="#Compute-Flux-Points" title="Permalink to this headline">¶</a></h2>
<p>To round up our analysis we can compute flux points by fitting the norm of the global model in energy bands. We’ll use a fixed energy binning for now.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Define energy binning</span>
<span class="n">stacked_obs</span> <span class="o">=</span> <span class="n">extraction</span><span class="o">.</span><span class="n">spectrum_observations</span><span class="o">.</span><span class="n">stack</span><span class="p">()</span>

<span class="n">e_min</span><span class="p">,</span> <span class="n">e_max</span> <span class="o">=</span> <span class="n">stacked_obs</span><span class="o">.</span><span class="n">lo_threshold</span><span class="o">.</span><span class="n">to_value</span><span class="p">(</span><span class="s2">&quot;TeV&quot;</span><span class="p">),</span> <span class="mi">30</span>
<span class="n">ebounds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">e_min</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">e_max</span><span class="p">),</span> <span class="mi">15</span><span class="p">)</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">TeV</span>


<span class="n">seg</span> <span class="o">=</span> <span class="n">SpectrumEnergyGroupMaker</span><span class="p">(</span><span class="n">obs</span><span class="o">=</span><span class="n">stacked_obs</span><span class="p">)</span>
<span class="n">seg</span><span class="o">.</span><span class="n">compute_groups_fixed</span><span class="p">(</span><span class="n">ebounds</span><span class="o">=</span><span class="n">ebounds</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="n">seg</span><span class="o">.</span><span class="n">groups</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
SpectrumEnergyGroups:
energy_group_idx bin_idx_min bin_idx_max  bin_type     energy_min         energy_max
                                                          TeV                TeV
---------------- ----------- ----------- --------- ------------------ ------------------
               0           0          32 underflow               0.01 0.6812920690579611
               1          33          34    normal 0.6812920690579611 0.8799225435691069
               2          35          36    normal 0.8799225435691069 1.1364636663857242
               3          37          38    normal 1.1364636663857242  1.467799267622069
               4          39          40    normal  1.467799267622069 1.8957356524063753
               5          41          43    normal 1.8957356524063753  2.782559402207123
               6          44          45    normal  2.782559402207123  3.593813663804626
               7          46          47    normal  3.593813663804626 4.6415888336127775
               8          48          49    normal 4.6415888336127775  5.994842503189409
               9          50          51    normal  5.994842503189409  7.742636826811269
              10          52          53    normal  7.742636826811269               10.0
              11          54          55    normal               10.0 12.915496650148826
              12          56          57    normal 12.915496650148826 16.681005372000573
              13          58          59    normal 16.681005372000573  21.54434690031882
              14          60          62    normal  21.54434690031882 31.622776601683793
              15          63          71  overflow 31.622776601683793              100.0

</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">fpe</span> <span class="o">=</span> <span class="n">FluxPointEstimator</span><span class="p">(</span>
    <span class="n">obs</span><span class="o">=</span><span class="n">stacked_obs</span><span class="p">,</span> <span class="n">groups</span><span class="o">=</span><span class="n">seg</span><span class="o">.</span><span class="n">groups</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="n">joint_result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">model</span>
<span class="p">)</span>
<span class="n">flux_points</span> <span class="o">=</span> <span class="n">fpe</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">flux_points</span><span class="o">.</span><span class="n">table_formatted</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<i>Table length=14</i>
<table id="table120761220960" class="table-striped table-bordered table-condensed">
<thead><tr><th>e_ref</th><th>e_min</th><th>e_max</th><th>ref_dnde</th><th>ref_flux</th><th>ref_eflux</th><th>ref_e2dnde</th><th>norm</th><th>loglike</th><th>norm_err</th><th>norm_errp</th><th>norm_errn</th><th>norm_ul</th><th>sqrt_ts</th><th>ts</th><th>norm_scan [11]</th><th>dloglike_scan [11]</th><th>dnde</th><th>dnde_ul</th><th>dnde_err</th><th>dnde_errp</th><th>dnde_errn</th></tr></thead>
<thead><tr><th>TeV</th><th>TeV</th><th>TeV</th><th>1 / (cm2 s TeV)</th><th>1 / (cm2 s)</th><th>TeV / (cm2 s)</th><th>TeV / (cm2 s)</th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th>1 / (cm2 s TeV)</th><th>1 / (cm2 s TeV)</th><th>1 / (cm2 s TeV)</th><th>1 / (cm2 s TeV)</th><th>1 / (cm2 s TeV)</th></tr></thead>
<thead><tr><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th></tr></thead>
<tr><td>0.774</td><td>0.681</td><td>0.880</td><td>5.754e-11</td><td>1.148e-11</td><td>8.836e-12</td><td>3.449e-11</td><td>0.937</td><td>2.043</td><td>0.147</td><td>0.154</td><td>0.140</td><td>1.260</td><td>12.360</td><td>152.768</td><td>0.200 .. 5.000</td><td>56.84123283322248 .. 227.56429409107054</td><td>5.390e-11</td><td>7.252e-11</td><td>8.466e-12</td><td>8.878e-12</td><td>8.063e-12</td></tr>
<tr><td>1.000</td><td>0.880</td><td>1.136</td><td>2.911e-11</td><td>7.505e-12</td><td>7.458e-12</td><td>2.911e-11</td><td>0.923</td><td>0.313</td><td>0.100</td><td>0.103</td><td>0.096</td><td>1.136</td><td>17.748</td><td>314.976</td><td>0.200 .. 5.000</td><td>114.10827174442738 .. 487.8635987913784</td><td>2.687e-11</td><td>3.308e-11</td><td>2.905e-12</td><td>3.004e-12</td><td>2.808e-12</td></tr>
<tr><td>1.292</td><td>1.136</td><td>1.468</td><td>1.473e-11</td><td>4.905e-12</td><td>6.295e-12</td><td>2.457e-11</td><td>0.897</td><td>0.028</td><td>0.116</td><td>0.120</td><td>0.111</td><td>1.148</td><td>14.987</td><td>224.597</td><td>0.200 .. 5.000</td><td>78.37352113849738 .. 358.7153848076998</td><td>1.322e-11</td><td>1.691e-11</td><td>1.704e-12</td><td>1.773e-12</td><td>1.636e-12</td></tr>
<tr><td>1.668</td><td>1.468</td><td>1.896</td><td>7.454e-12</td><td>3.205e-12</td><td>5.313e-12</td><td>2.074e-11</td><td>1.160</td><td>1.398</td><td>0.151</td><td>0.157</td><td>0.145</td><td>1.487</td><td>14.582</td><td>212.631</td><td>0.200 .. 5.000</td><td>96.23812605916038 .. 228.88631642192877</td><td>8.646e-12</td><td>1.108e-11</td><td>1.125e-12</td><td>1.171e-12</td><td>1.080e-12</td></tr>
<tr><td>2.297</td><td>1.896</td><td>2.783</td><td>3.181e-12</td><td>2.852e-12</td><td>6.457e-12</td><td>1.678e-11</td><td>1.146</td><td>0.162</td><td>0.144</td><td>0.150</td><td>0.138</td><td>1.456</td><td>15.219</td><td>231.631</td><td>0.200 .. 5.000</td><td>101.3026355684861 .. 250.06999436390902</td><td>3.644e-12</td><td>4.632e-12</td><td>4.576e-13</td><td>4.757e-13</td><td>4.398e-13</td></tr>
<tr><td>3.162</td><td>2.783</td><td>3.594</td><td>1.358e-12</td><td>1.107e-12</td><td>3.478e-12</td><td>1.358e-11</td><td>1.212</td><td>1.338</td><td>0.218</td><td>0.231</td><td>0.206</td><td>1.699</td><td>10.563</td><td>111.582</td><td>0.200 .. 5.000</td><td>52.6130037801357 .. 111.00908572577995</td><td>1.646e-12</td><td>2.306e-12</td><td>2.962e-13</td><td>3.132e-13</td><td>2.798e-13</td></tr>
<tr><td>4.084</td><td>3.594</td><td>4.642</td><td>6.870e-13</td><td>7.232e-13</td><td>2.935e-12</td><td>1.146e-11</td><td>0.773</td><td>0.169</td><td>0.208</td><td>0.225</td><td>0.192</td><td>1.258</td><td>6.451</td><td>41.621</td><td>0.200 .. 5.000</td><td>14.673263320314994 .. 107.63144808194052</td><td>5.310e-13</td><td>8.643e-13</td><td>1.428e-13</td><td>1.545e-13</td><td>1.316e-13</td></tr>
<tr><td>5.275</td><td>4.642</td><td>5.995</td><td>3.476e-13</td><td>4.726e-13</td><td>2.477e-12</td><td>9.672e-12</td><td>1.045</td><td>1.303</td><td>0.282</td><td>0.308</td><td>0.258</td><td>1.709</td><td>6.764</td><td>45.750</td><td>0.200 .. 5.000</td><td>20.98476725592205 .. 65.24707414617606</td><td>3.632e-13</td><td>5.940e-13</td><td>9.815e-14</td><td>1.070e-13</td><td>8.984e-14</td></tr>
<tr><td>6.813</td><td>5.995</td><td>7.743</td><td>1.759e-13</td><td>3.089e-13</td><td>2.091e-12</td><td>8.164e-12</td><td>1.373</td><td>0.527</td><td>0.381</td><td>0.416</td><td>0.348</td><td>2.278</td><td>8.069</td><td>65.108</td><td>0.200 .. 5.000</td><td>25.852281091320584 .. 36.280213741056365</td><td>2.415e-13</td><td>4.006e-13</td><td>6.709e-14</td><td>7.319e-14</td><td>6.125e-14</td></tr>
<tr><td>8.799</td><td>7.743</td><td>10.000</td><td>8.900e-14</td><td>2.019e-13</td><td>1.765e-12</td><td>6.891e-12</td><td>0.928</td><td>1.879</td><td>0.389</td><td>0.444</td><td>0.340</td><td>1.919</td><td>4.215</td><td>17.769</td><td>0.200 .. 5.000</td><td>9.03652347498847 .. 34.74105291578883</td><td>8.258e-14</td><td>1.708e-13</td><td>3.466e-14</td><td>3.952e-14</td><td>3.028e-14</td></tr>
<tr><td>11.365</td><td>10.000</td><td>12.915</td><td>4.503e-14</td><td>1.319e-13</td><td>1.490e-12</td><td>5.816e-12</td><td>1.005</td><td>0.022</td><td>0.486</td><td>0.561</td><td>0.416</td><td>2.285</td><td>4.075</td><td>16.604</td><td>0.200 .. 5.000</td><td>6.108419580636659 .. 21.377936667842608</td><td>4.526e-14</td><td>1.029e-13</td><td>2.188e-14</td><td>2.525e-14</td><td>1.875e-14</td></tr>
<tr><td>14.678</td><td>12.915</td><td>16.681</td><td>2.279e-14</td><td>8.621e-14</td><td>1.257e-12</td><td>4.909e-12</td><td>0.257</td><td>1.183</td><td>0.326</td><td>0.441</td><td>0.231</td><td>1.396</td><td>1.193</td><td>1.422</td><td>0.200 .. 5.000</td><td>1.2176598223007438 .. 24.919486083034155</td><td>5.860e-15</td><td>3.180e-14</td><td>7.431e-15</td><td>1.006e-14</td><td>5.257e-15</td></tr>
<tr><td>18.957</td><td>16.681</td><td>21.544</td><td>1.153e-14</td><td>5.634e-14</td><td>1.061e-12</td><td>4.143e-12</td><td>0.873</td><td>0.041</td><td>0.680</td><td>0.854</td><td>0.529</td><td>2.944</td><td>2.360</td><td>5.571</td><td>0.200 .. 5.000</td><td>2.0491770958125324 .. 10.509205927120943</td><td>1.006e-14</td><td>3.394e-14</td><td>7.839e-15</td><td>9.842e-15</td><td>6.102e-15</td></tr>
<tr><td>26.102</td><td>21.544</td><td>31.623</td><td>4.920e-15</td><td>5.013e-14</td><td>1.290e-12</td><td>3.352e-12</td><td>0.000</td><td>0.591</td><td>0.000</td><td>0.264</td><td>0.000</td><td>1.047</td><td>0.000</td><td>0.000</td><td>0.200 .. 5.000</td><td>1.349562401383848 .. 19.54749490074336</td><td>7.648e-30</td><td>5.151e-15</td><td>1.995e-22</td><td>1.298e-15</td><td>7.648e-30</td></tr>
</table></div>
</div>
<p>Now we plot the flux points and their likelihood profiles. For the plotting of upper limits we choose a threshold of TS &lt; 4.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">flux_points</span><span class="o">.</span><span class="n">table</span><span class="p">[</span><span class="s2">&quot;is_ul&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">flux_points</span><span class="o">.</span><span class="n">table</span><span class="p">[</span><span class="s2">&quot;ts&quot;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">4</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">flux_points</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">energy_power</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">flux_unit</span><span class="o">=</span><span class="s2">&quot;erg-1 cm-2 s-1&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;darkorange&quot;</span>
<span class="p">)</span>
<span class="n">flux_points</span><span class="o">.</span><span class="n">to_sed_type</span><span class="p">(</span><span class="s2">&quot;e2dnde&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">plot_likelihood</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>&lt;matplotlib.axes._subplots.AxesSubplot at 0x1c1df68588&gt;
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_spectrum_analysis_35_1.png" src="../_images/notebooks_spectrum_analysis_35_1.png" />
</div>
</div>
<p>The final plot with the best fit model, flux points and residuals can be quickly made like this</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">spectrum_result</span> <span class="o">=</span> <span class="n">SpectrumResult</span><span class="p">(</span>
    <span class="n">points</span><span class="o">=</span><span class="n">flux_points</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="n">joint_result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">model</span>
<span class="p">)</span>
<span class="n">ax0</span><span class="p">,</span> <span class="n">ax1</span> <span class="o">=</span> <span class="n">spectrum_result</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">energy_range</span><span class="o">=</span><span class="n">joint_fit</span><span class="o">.</span><span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">fit_range</span><span class="p">,</span>
    <span class="n">energy_power</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">flux_unit</span><span class="o">=</span><span class="s2">&quot;erg-1 cm-2 s-1&quot;</span><span class="p">,</span>
    <span class="n">fig_kwargs</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">)),</span>
<span class="p">)</span>

<span class="n">ax0</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mf">0.4</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>(0.4, 50)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_spectrum_analysis_37_1.png" src="../_images/notebooks_spectrum_analysis_37_1.png" />
</div>
</div>
</div>
<div class="section" id="Stack-observations">
<h2>Stack observations<a class="headerlink" href="#Stack-observations" title="Permalink to this headline">¶</a></h2>
<p>And alternative approach to fitting the spectrum is stacking all observations first and the fitting a model to the stacked observation. This works as follows. A comparison to the joint likelihood fit is also printed.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">stacked_obs</span> <span class="o">=</span> <span class="n">extraction</span><span class="o">.</span><span class="n">spectrum_observations</span><span class="o">.</span><span class="n">stack</span><span class="p">()</span>

<span class="n">stacked_fit</span> <span class="o">=</span> <span class="n">SpectrumFit</span><span class="p">(</span><span class="n">obs_list</span><span class="o">=</span><span class="n">stacked_obs</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">)</span>
<span class="n">stacked_fit</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>OptimizeResult

    backend    : minuit
    method     : minuit
    success    : True
    nfev       : 31
    total stat : 30.35
    message    : Optimization terminated successfully.
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">stacked_result</span> <span class="o">=</span> <span class="n">stacked_fit</span><span class="o">.</span><span class="n">result</span>
<span class="k">print</span><span class="p">(</span><span class="n">stacked_result</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

Fit result info
---------------
Model: PowerLaw

Parameters:

           name     value     error        unit      min max frozen
        --------- --------- --------- -------------- --- --- ------
            index 2.666e+00 7.139e-02                nan nan  False
        amplitude 2.909e-11 1.784e-12 cm-2 s-1 TeV-1 nan nan  False
        reference 1.000e+00 0.000e+00            TeV nan nan   True

Covariance:

           name     index   amplitude reference
        --------- --------- --------- ---------
            index 5.097e-03 7.235e-14 0.000e+00
        amplitude 7.235e-14 3.183e-24 0.000e+00
        reference 0.000e+00 0.000e+00 0.000e+00

Statistic: 30.349 (wstat)
Fit Range: [  0.68129207 100.        ] TeV

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">stacked_table</span> <span class="o">=</span> <span class="n">stacked_result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">to_table</span><span class="p">(</span><span class="n">format</span><span class="o">=</span><span class="s2">&quot;.3g&quot;</span><span class="p">)</span>
<span class="n">stacked_table</span><span class="p">[</span><span class="s2">&quot;method&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;stacked&quot;</span>
<span class="n">joint_table</span> <span class="o">=</span> <span class="n">joint_result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">to_table</span><span class="p">(</span><span class="n">format</span><span class="o">=</span><span class="s2">&quot;.3g&quot;</span><span class="p">)</span>
<span class="n">joint_table</span><span class="p">[</span><span class="s2">&quot;method&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;joint&quot;</span>
<span class="n">total_table</span> <span class="o">=</span> <span class="n">vstack_table</span><span class="p">([</span><span class="n">stacked_table</span><span class="p">,</span> <span class="n">joint_table</span><span class="p">])</span>
<span class="k">print</span><span class="p">(</span>
    <span class="n">total_table</span><span class="p">[</span><span class="s2">&quot;method&quot;</span><span class="p">,</span> <span class="s2">&quot;index&quot;</span><span class="p">,</span> <span class="s2">&quot;index_err&quot;</span><span class="p">,</span> <span class="s2">&quot;amplitude&quot;</span><span class="p">,</span> <span class="s2">&quot;amplitude_err&quot;</span><span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
 method index index_err    amplitude     amplitude_err
                        1 / (cm2 s TeV) 1 / (cm2 s TeV)
------- ----- --------- --------------- ---------------
stacked  2.67    0.0714        2.91e-11        1.78e-12
  joint  2.67    0.0714        2.91e-11        1.78e-12
</pre></div></div>
</div>
</div>
<div class="section" id="Exercises">
<h2>Exercises<a class="headerlink" href="#Exercises" title="Permalink to this headline">¶</a></h2>
<p>Some things we might do:</p>
<ul class="simple">
<li>Fit a different spectral model (ECPL or CPL or …)</li>
<li>Use different method or parameters to compute the flux points</li>
<li>Do a chi^2 fit to the flux points and compare</li>
</ul>
<p>TODO: give pointers how to do this (and maybe write a notebook with solutions)</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Start exercises here</span>
</pre></div>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="spectrum_fitting_with_sherpa.html" class="btn btn-neutral float-right" title="Fitting gammapy spectra with sherpa" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="spectrum_pipe.html" class="btn btn-neutral" title="Spectrum analysis with Gammapy (run pipeline)" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, The Gammapy developers
      Last updated on 29 Mar 2019.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
        <script type="text/javascript" src="../_static/copybutton.js"></script>
        <script type="text/javascript" src="../_static/gammapy.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    

  

  <script type="text/javascript" src="../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>