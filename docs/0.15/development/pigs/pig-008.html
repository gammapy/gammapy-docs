

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>PIG 8 - Datasets &mdash; gammapy v0.15</title>
  

  
  
    <link rel="shortcut icon" href="../../_static/gammapy_logo.ico"/>
  
  
  
    <link rel="canonical" href="https://docs.gammapy.org/dev/development/pigs/pig-008.html"/>
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../_static/language_data.js"></script>
        <script type="text/javascript" src="../../_static/copybutton.js"></script>
        <script type="text/javascript" src="../../_static/gammapy.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
        <script type="text/javascript" src="https://unpkg.com/@jupyter-widgets/html-manager@^0.18.0/dist/embed-amd.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/graphviz.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/gammapy.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="PIG 9 - Event Sampling" href="pig-009.html" />
    <link rel="prev" title="PIG 7 - Models" href="pig-007.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> gammapy
          

          
          </a>

          
            
            
              <div class="version">
                0.15
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../overview.html">Overview</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../overview.html#workflow">Workflow</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../overview.html#data-reduction">Data reduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../overview.html#datasets">Datasets</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../overview.html#modeling-and-fitting">Modeling and Fitting</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../overview.html#time-analysis">Time analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../overview.html#simulation">Simulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../overview.html#other-topics">Other topics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../overview.html#what-next">What next?</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../install/index.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../install/dependencies.html">Gammapy Dependencies</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../install/dependencies.html#required-dependencies">Required dependencies</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../install/dependencies.html#optional-dependencies">Optional dependencies</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../install/dependencies.html#versions">Versions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../install/pip.html">Installation with pip</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../install/other.html">Other package managers</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../getting-started.html">Getting Started</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../getting-started.html#help">Help!?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../getting-started.html#check">Check</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../getting-started.html#download-tutorials">Download tutorials</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../getting-started.html#check-your-setup">Check your setup</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../getting-started.html#use-gammapy">Use Gammapy</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../getting-started.html#id2">Python</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../getting-started.html#id3">IPython</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../getting-started.html#python-script">Python script</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../getting-started.html#command-line">Command line</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../getting-started.html#jupyter-notebooks">Jupyter notebooks</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../getting-started.html#install-issues">Install issues</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/index.html">Tutorials</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/index.html#notebooks">Notebooks</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../notebooks/analysis_1.html">First analysis</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/analysis_1.html#Setup">Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/analysis_1.html#Analysis-configuration">Analysis configuration</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/analysis_1.html#Running-the-analysis">Running the analysis</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/analysis_1.html#Data-reduction">Data reduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/analysis_1.html#Save-dataset-to-disk">Save dataset to disk</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/analysis_1.html#Model-fitting">Model fitting</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/analysis_1.html#What’s-next">What’s next</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../notebooks/analysis_2.html">Second analysis</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/analysis_2.html#Defining-the-datastore-and-selecting-observations">Defining the datastore and selecting observations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/analysis_2.html#Preparing-reduced-datasets-geometry">Preparing reduced datasets geometry</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/analysis_2.html#Data-reduction">Data reduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/analysis_2.html#Save-dataset-to-disk">Save dataset to disk</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/analysis_2.html#Define-the-model">Define the model</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/analysis_2.html#Fit-the-model">Fit the model</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/analysis_2.html#Plot-the-fitted-spectrum">Plot the fitted spectrum</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../notebooks/cta.html">CTA with Gammapy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/cta.html#Introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/cta.html#Tutorial-overview">Tutorial overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/cta.html#Setup">Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/cta.html#CTA-1DC">CTA 1DC</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/cta.html#Events">Events</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/cta.html#IRFs">IRFs</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/cta.html#Source-models">Source models</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/cta.html#CTA-performance-files">CTA performance files</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/cta.html#Exercises">Exercises</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/cta.html#Next-steps">Next steps</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../notebooks/hess.html">H.E.S.S. data with Gammapy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/hess.html#DL3-DR1">DL3 DR1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/hess.html#Exercises">Exercises</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/hess.html#Next-steps">Next steps</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../notebooks/fermi_lat.html">Fermi-LAT data with Gammapy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/fermi_lat.html#Introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/fermi_lat.html#Setup">Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/fermi_lat.html#Events">Events</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/fermi_lat.html#Counts">Counts</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/fermi_lat.html#Exposure">Exposure</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/fermi_lat.html#Galactic-diffuse-background">Galactic diffuse background</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/fermi_lat.html#Isotropic-diffuse-background">Isotropic diffuse background</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/fermi_lat.html#PSF">PSF</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/fermi_lat.html#Fit">Fit</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/fermi_lat.html#Exercises">Exercises</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/fermi_lat.html#Summary">Summary</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../notebooks/cta_data_analysis.html">CTA data analysis with Gammapy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/cta_data_analysis.html#Introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/cta_data_analysis.html#Setup">Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/cta_data_analysis.html#Select-observations">Select observations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/cta_data_analysis.html#Make-sky-images">Make sky images</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/cta_data_analysis.html#Source-Detection">Source Detection</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/cta_data_analysis.html#Spatial-analysis">Spatial analysis</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/cta_data_analysis.html#Spectrum">Spectrum</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/cta_data_analysis.html#Exercises">Exercises</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/cta_data_analysis.html#What-next?">What next?</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../notebooks/analysis_3d.html">3D analysis</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/analysis_3d.html#Analysis-configuration">Analysis configuration</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/analysis_3d.html#Configuration-for-stacked-and-joint-analysis">Configuration for stacked and joint analysis</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/analysis_3d.html#Stacked-analysis">Stacked analysis</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/analysis_3d.html#Joint-analysis">Joint analysis</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/analysis_3d.html#Summary">Summary</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/analysis_3d.html#Exercises">Exercises</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../notebooks/analysis_mwl.html">Joint modeling, fitting, and serialization</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/analysis_mwl.html#Data-and-models-files">Data and models files</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/analysis_mwl.html#Reading-different-datasets">Reading different datasets</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/analysis_mwl.html#Datasets-serialization">Datasets serialization</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/analysis_mwl.html#Joint-analysis">Joint analysis</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../notebooks/simulate_3d.html">3D simulation and fitting</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/simulate_3d.html#Imports-and-versions">Imports and versions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/simulate_3d.html#Simulation">Simulation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/simulate_3d.html#Fit">Fit</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../notebooks/detect.html">Source detection with Gammapy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/detect.html#Introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/detect.html#Setup">Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/detect.html#Read-in-input-images">Read in input images</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/detect.html#Plot-images">Plot images</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/detect.html#Source-catalog">Source catalog</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/detect.html#Measurements">Measurements</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/detect.html#Compare-to-3FHL">Compare to 3FHL</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/detect.html#Exercises">Exercises</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/detect.html#What-next?">What next?</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../notebooks/spectrum_analysis.html">Spectral analysis with Gammapy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/spectrum_analysis.html#Introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/spectrum_analysis.html#Setup">Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/spectrum_analysis.html#Load-Data">Load Data</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/spectrum_analysis.html#Define-Target-Region">Define Target Region</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/spectrum_analysis.html#Create-exclusion-mask">Create exclusion mask</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/spectrum_analysis.html#Run-data-reduction-chain">Run data reduction chain</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/spectrum_analysis.html#Plot-off-regions">Plot off regions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/spectrum_analysis.html#Source-statistic">Source statistic</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/spectrum_analysis.html#Fit-spectrum">Fit spectrum</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/spectrum_analysis.html#Compute-Flux-Points">Compute Flux Points</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/spectrum_analysis.html#Stack-observations">Stack observations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/spectrum_analysis.html#Exercises">Exercises</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../notebooks/sed_fitting.html">Flux point fitting in Gammapy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/sed_fitting.html#Introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/sed_fitting.html#Setup">Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/sed_fitting.html#Load-spectral-points">Load spectral points</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/sed_fitting.html#Power-Law-Fit">Power Law Fit</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/sed_fitting.html#Exponential-Cut-Off-Powerlaw-Fit">Exponential Cut-Off Powerlaw Fit</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/sed_fitting.html#Log-Parabola-Fit">Log-Parabola Fit</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/sed_fitting.html#Exercises">Exercises</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/sed_fitting.html#What-next?">What next?</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../notebooks/light_curve.html">Light curve estimation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/light_curve.html#Introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/light_curve.html#Setup">Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/light_curve.html#Analysis-configuration">Analysis configuration</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/light_curve.html#Light-Curve-estimation:-by-observation">Light Curve estimation: by observation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/light_curve.html#Running-the-light-curve-extraction-in-1D">Running the light curve extraction in 1D</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/light_curve.html#Night-wise-LC-estimation">Night-wise LC estimation</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../notebooks/light_curve_flare.html">Light curve - Flare</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/light_curve_flare.html#Setup">Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/light_curve_flare.html#Select-the-data">Select the data</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/light_curve_flare.html#Define-time-intervals">Define time intervals</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/light_curve_flare.html#Filter-the-observations-list-in-time-intervals">Filter the observations list in time intervals</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/light_curve_flare.html#Building-1D-datasets-from-the-new-observations">Building 1D datasets from the new observations</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../notebooks/cta_sensitivity.html">Estimation of the CTA point source sensitivity</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/cta_sensitivity.html#Introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/cta_sensitivity.html#Setup">Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/cta_sensitivity.html#Define-analysis-region-and-energy-binning">Define analysis region and energy binning</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/cta_sensitivity.html#Load-IRFs">Load IRFs</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/cta_sensitivity.html#Determine-energy-dependent-integration-radius">Determine energy dependent integration radius</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/cta_sensitivity.html#Estimate-background">Estimate background</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/cta_sensitivity.html#Compute-sensitivity">Compute sensitivity</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/cta_sensitivity.html#Results">Results</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/cta_sensitivity.html#Exercises">Exercises</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../notebooks/spectrum_simulation.html">Spectrum simulation for CTA</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/spectrum_simulation.html#Setup">Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/spectrum_simulation.html#Simulation-of-a-single-spectrum">Simulation of a single spectrum</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/spectrum_simulation.html#Adding-a-user-defined-model">Adding a user defined model</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/spectrum_simulation.html#Exercises">Exercises</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/spectrum_simulation.html#What-next?">What next?</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../notebooks/image_analysis.html">Fitting 2D images with Gammapy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/image_analysis.html#Setup">Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/image_analysis.html#Prepare-modeling-input-data">Prepare modeling input data</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/image_analysis.html#Define-a-mask">Define a mask</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/image_analysis.html#Modeling-the-source">Modeling the source</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/image_analysis.html#Modeling-the-background">Modeling the background</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/image_analysis.html#Classical-Ring-Background-Analysis">Classical Ring Background Analysis</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/image_analysis.html#Exercises">Exercises</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../notebooks/overview.html">Getting started with Gammapy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/overview.html#Introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/overview.html#Setup">Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/overview.html#Maps">Maps</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/overview.html#Event-lists">Event lists</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/overview.html#Source-catalogs">Source catalogs</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/overview.html#Spectral-models-and-flux-points">Spectral models and flux points</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/overview.html#What-next?">What next?</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../notebooks/maps.html">Gammapy Maps</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/maps.html#Introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/maps.html#Setup">Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/maps.html#Creating-WCS-Maps">Creating WCS Maps</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/maps.html#Accessing-and-Modifying-Data">Accessing and Modifying Data</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/maps.html#Reading-and-Writing">Reading and Writing</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/maps.html#Visualizing-and-Plotting">Visualizing and Plotting</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/maps.html#Interpolating-and-Miscellaneous">Interpolating and Miscellaneous</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../notebooks/modeling.html">Modeling and fitting</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../notebooks/models.html">Model Gallery</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/models.html#Spatial-models">Spatial models</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/models.html#Spectral-models">Spectral models</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../notebooks/catalog.html">Source catalogs</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/catalog.html#List-available-catalogs">List available catalogs</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/catalog.html#Load-catalogs">Load catalogs</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/catalog.html#Select-a-source">Select a source</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/catalog.html#Pretty-print-source-information">Pretty-print source information</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/catalog.html#Source-models">Source models</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/catalog.html#Flux-points">Flux points</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/catalog.html#Lightcurves">Lightcurves</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/catalog.html#Catalog-table-and-source-dictionary">Catalog table and source dictionary</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/catalog.html#Exercises">Exercises</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/catalog.html#Next-steps">Next steps</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/index.html#scripts">Scripts</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../tutorials/survey_map.html">Survey map</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/index.html#extra-topics">Extra topics</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../notebooks/astro_dark_matter.html">Dark matter utilities</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/astro_dark_matter.html#Introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/astro_dark_matter.html#Setup">Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/astro_dark_matter.html#Profiles">Profiles</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/astro_dark_matter.html#J-Factors">J Factors</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/astro_dark_matter.html#Gamma-ray-spectra-at-production">Gamma-ray spectra at production</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/astro_dark_matter.html#Flux-maps">Flux maps</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../notebooks/background_model.html">Make template background model</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/background_model.html#Introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/background_model.html#Setup">Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/background_model.html#Select-off-data">Select off data</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/background_model.html#Background-model">Background model</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/background_model.html#Zenith-dependence">Zenith dependence</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/background_model.html#Index-tables">Index tables</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/background_model.html#Exercises">Exercises</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../notebooks/mcmc_sampling.html">Fitting and error estimation with MCMC</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/mcmc_sampling.html#Introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/mcmc_sampling.html#Simulate-an-observation">Simulate an observation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/mcmc_sampling.html#Estimate-parameter-correlations-with-MCMC">Estimate parameter correlations with MCMC</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/mcmc_sampling.html#Plot-the-results">Plot the results</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/mcmc_sampling.html#Plot-the-model-dispersion">Plot the model dispersion</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/mcmc_sampling.html#Fun-Zone">Fun Zone</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/mcmc_sampling.html#PeVatrons-in-CTA-?">PeVatrons in CTA ?</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../notebooks/pulsar_analysis.html">Pulsar analysis with Gammapy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/pulsar_analysis.html#Introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/pulsar_analysis.html#Opening-the-data">Opening the data</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/pulsar_analysis.html#Phasogram">Phasogram</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/pulsar_analysis.html#Phase-resolved-map">Phase-resolved map</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../notebooks/pulsar_analysis.html#Phase-resolved-spectrum">Phase-resolved spectrum</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../howto.html">How To</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../howto.html#access-iact-data">Access IACT data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../howto.html#check-irfs">Check IRFs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../howto.html#extract-1d-spectra">Extract 1D spectra</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../howto.html#extract-a-lightcurve">Extract a lightcurve</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../howto.html#compute-source-significance">Compute source significance</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../howto.html#compute-cumulative-significance">Compute cumulative significance</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../howto.html#detect-sources-in-a-map">Detect sources in a map</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../howto.html#astrophysical-source-modeling">Astrophysical source modeling</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../references.html">References</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../references.html#publications">Publications</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../references.html#glossary">Glossary</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../references.html#other-gamma-ray-packages">Other gamma-ray packages</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../references.html#other-useful-packages">Other useful packages</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../changelog.html">Changelog</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../changelog.html#dec-3-2019">0.15 (Dec 3, 2019)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../changelog.html#summary">Summary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../changelog.html#pull-requests">Pull Requests</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../changelog.html#sep-30-2019">0.14 (Sep 30, 2019)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../changelog.html#id2">Summary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../changelog.html#id3">Pull Requests</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../changelog.html#jul-26-2019">0.13 (Jul 26, 2019)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../changelog.html#id4">Summary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../changelog.html#id5">Pull Requests</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../changelog.html#may-30-2019">0.12 (May 30, 2019)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../changelog.html#id6">Summary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../changelog.html#id7">Pull Requests</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../changelog.html#mar-29-2019">0.11 (Mar 29, 2019)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../changelog.html#id8">Summary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../changelog.html#id9">Pull requests</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../changelog.html#jan-28-2019">0.10 (Jan 28, 2019)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../changelog.html#id10">Summary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../changelog.html#id11">Pull requests</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../changelog.html#nov-29-2018">0.9 (Nov 29, 2018)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../changelog.html#id12">Summary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../changelog.html#id13">Pull requests</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../changelog.html#sep-23-2018">0.8 (Sep 23, 2018)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../changelog.html#id14">Summary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../changelog.html#id15">Pull requests</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../changelog.html#feb-28-2018">0.7 (Feb 28, 2018)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../changelog.html#id16">Summary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../changelog.html#id17">Pull requests</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../changelog.html#apr-28-2017">0.6 (Apr 28, 2017)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../changelog.html#id18">Summary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../changelog.html#id19">Pull requests</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../changelog.html#nov-22-2016">0.5 (Nov 22, 2016)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../changelog.html#id20">Summary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../changelog.html#id21">Pull requests</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../changelog.html#apr-20-2016">0.4 (Apr 20, 2016)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../changelog.html#id22">Summary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../changelog.html#id23">Pull requests</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../changelog.html#aug-13-2015">0.3 (Aug 13, 2015)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../changelog.html#id24">Summary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../changelog.html#id25">Pull requests</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../changelog.html#apr-13-2015">0.2 (Apr 13, 2015)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../changelog.html#id26">Summary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../changelog.html#id27">Pull requests</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../changelog.html#aug-25-2014">0.1 (Aug 25, 2014)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../changelog.html#id28">Summary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../changelog.html#id29">Pull requests</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Gammapy Package</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../analysis/index.html">analysis - High-level interface</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../analysis/index.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../analysis/index.html#getting-started">Getting started</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../analysis/index.html#configuration-and-methods">Configuration and methods</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../analysis/index.html#general-settings">General settings</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../analysis/index.html#observations-selection">Observations selection</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../analysis/index.html#data-reduction-and-datasets">Data reduction and datasets</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../analysis/index.html#model">Model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../analysis/index.html#fitting">Fitting</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../analysis/index.html#flux-points">Flux points</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../analysis/index.html#residuals">Residuals</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../analysis/index.html#using-the-high-level-interface">Using the high-level interface</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../analysis/index.html#reference-api">Reference/API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../analysis/index.html#module-gammapy.analysis">gammapy.analysis Package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../analysis/index.html#classes">Classes</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../modeling/index.html">modeling - Models and fitting</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../modeling/index.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../modeling/index.html#getting-started">Getting Started</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../modeling/index.html#spectral-models">Spectral Models</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../modeling/index.html#spatial-models">Spatial Models</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../modeling/index.html#skymodel-and-skydiffusecube">SkyModel and SkyDiffuseCube</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../modeling/index.html#fitting">Fitting</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../modeling/index.html#reference-api">Reference/API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../modeling/index.html#module-gammapy.modeling">gammapy.modeling Package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../modeling/index.html#functions">Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../modeling/index.html#classes">Classes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../modeling/index.html#module-gammapy.modeling.models">gammapy.modeling.models Package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../modeling/index.html#id1">Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../modeling/index.html#id2">Classes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../modeling/index.html#variables">Variables</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../cube/index.html">cube - Map cube analysis</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../cube/index.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cube/index.html#getting-started">Getting Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cube/index.html#safe-data-range-handling">Safe Data Range Handling</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cube/index.html#stacking-of-datasets">Stacking of Datasets</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cube/index.html#combining-data-reduction-steps">Combining Data Reduction Steps</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cube/index.html#ring-background-estimation">Ring Background Estimation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cube/index.html#using-gammapy-cube">Using <code class="xref py py-obj docutils literal notranslate"><span class="pre">gammapy.cube</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cube/index.html#reference-api">Reference/API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../cube/index.html#module-gammapy.cube">gammapy.cube Package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../cube/index.html#functions">Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cube/index.html#classes">Classes</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../spectrum/index.html">spectrum - 1D spectrum analysis</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../spectrum/index.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../spectrum/index.html#getting-started">Getting Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../spectrum/index.html#using-gammapy-spectrum">Using <code class="xref py py-obj docutils literal notranslate"><span class="pre">gammapy.spectrum</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../spectrum/fitting.html">Spectral Fitting</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../spectrum/fitting.html#getting-started">Getting Started</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../spectrum/fitting.html#interactive-sherpa-fit">Interactive Sherpa Fit</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../spectrum/reflected.html">Reflected regions background</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../spectrum/reflected.html#overview">Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../spectrum/reflected.html#using-regions">Using regions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../spectrum/reflected.html#the-reflected-region-finder">The reflected region finder</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../spectrum/reflected.html#using-the-reflected-background-estimator">Using the reflected background estimator</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../spectrum/index.html#reference-api">Reference/API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../spectrum/index.html#module-gammapy.spectrum">gammapy.spectrum Package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../spectrum/index.html#functions">Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../spectrum/index.html#classes">Classes</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../time/index.html">time - Time analysis</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../time/index.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../time/index.html#lightcurve">Lightcurve</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../time/index.html#light-curve-extraction">Light Curve Extraction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../time/index.html#variability-and-periodicity-tests">Variability and periodicity tests</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../time/index.html#tutorials">Tutorials</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../time/index.html#using-gammapy-time">Using <code class="xref py py-obj docutils literal notranslate"><span class="pre">gammapy.time</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../time/period.html">Period detection and plotting</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../time/period.html#introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../time/period.html#getting-started">Getting Started</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../time/period.html#example">Example</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../time/index.html#reference-api">Reference/API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../time/index.html#module-gammapy.time">gammapy.time Package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../time/index.html#functions">Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../time/index.html#classes">Classes</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../detect/index.html">detect - Source detection</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../detect/index.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../detect/index.html#computation-of-ts-images">Computation of TS images</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../detect/index.html#computation-of-li-ma-significance-images">Computation of Li &amp; Ma significance images</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../detect/index.html#using-gammapy-detect">Using <code class="xref py py-obj docutils literal notranslate"><span class="pre">gammapy.detect</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../../detect/index.html#reference-api">Reference/API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../detect/index.html#module-gammapy.detect">gammapy.detect Package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../detect/index.html#functions">Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../detect/index.html#classes">Classes</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../data/index.html">data - Data and observations</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../data/index.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../data/index.html#getting-started">Getting Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../data/index.html#using-gammapy-data">Using <code class="xref py py-obj docutils literal notranslate"><span class="pre">gammapy.data</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../../data/index.html#reference-api">Reference/API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../data/index.html#module-gammapy.data">gammapy.data Package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../data/index.html#classes">Classes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../data/index.html#variables">Variables</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../irf/index.html">irf - Instrument response functions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../irf/index.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../irf/index.html#getting-started">Getting Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../irf/index.html#effective-area">Effective area</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../irf/index.html#background">Background</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../irf/index.html#psf">PSF</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../irf/index.html#energy-dispersion">Energy Dispersion</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../irf/index.html#using-gammapy-irf">Using <code class="xref py py-obj docutils literal notranslate"><span class="pre">gammapy.irf</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../irf/theory.html">IRF Theory</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../irf/aeff.html">Effective area</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../irf/edisp.html">Energy dispersion</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../irf/index.html#reference-api">Reference/API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../irf/index.html#module-gammapy.irf">gammapy.irf Package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../irf/index.html#functions">Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../irf/index.html#classes">Classes</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../maps/index.html">maps - Sky maps</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../maps/index.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../maps/index.html#getting-started">Getting Started</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../maps/index.html#constructing-with-factory-methods">Constructing with Factory Methods</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../maps/index.html#indexing-and-slicing">Indexing and Slicing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../maps/index.html#accessor-methods">Accessor Methods</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../maps/index.html#interface-with-mapcoord-and-skycoord">Interface with <code class="xref py py-obj docutils literal notranslate"><span class="pre">MapCoord</span></code> and <code class="xref py py-obj docutils literal notranslate"><span class="pre">SkyCoord</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../maps/index.html#differential-and-integral-maps">Differential and integral maps</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../maps/index.html#mapcoord">MapCoord</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../maps/index.html#interpolation">Interpolation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../maps/index.html#iterating-by-image">Iterating by image</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../maps/index.html#fits-i-o">FITS I/O</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../maps/index.html#visualization">Visualization</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../maps/index.html#examples">Examples</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../maps/index.html#creating-counts-cubes-from-event-lists">Creating counts cubes from event lists</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../maps/index.html#generating-a-cutout-of-a-model-cube">Generating a Cutout of a Model Cube</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../maps/index.html#using-gammapy-maps">Using <code class="xref py py-obj docutils literal notranslate"><span class="pre">gammapy.maps</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../maps/hpxmap.html">HEALPix-based Maps</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../maps/hpxmap.html#healpix-geometry">HEALPix Geometry</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../maps/plotting.html">Image plotting</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../maps/plotting.html#colormaps">Colormaps</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../maps/index.html#reference-api">Reference/API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../maps/index.html#module-gammapy.maps">gammapy.maps Package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../maps/index.html#functions">Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../maps/index.html#classes">Classes</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../catalog/index.html">catalog - Source catalogs</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../catalog/index.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../catalog/index.html#tutorials">Tutorials</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../catalog/index.html#reference-api">Reference/API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../catalog/index.html#module-gammapy.catalog">gammapy.catalog Package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../catalog/index.html#classes">Classes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../catalog/index.html#variables">Variables</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../astro/index.html">astro - Astrophysics</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../astro/index.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../astro/index.html#getting-started">Getting Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../astro/index.html#sub-packages">Sub-packages</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../astro/source/index.html">Astrophysical source models (<code class="xref py py-obj docutils literal notranslate"><span class="pre">gammapy.astro.source</span></code>)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../astro/source/index.html#introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../astro/source/index.html#getting-started">Getting Started</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../astro/source/index.html#using-gammapy-astro-source">Using <code class="xref py py-obj docutils literal notranslate"><span class="pre">gammapy.astro.source</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../astro/source/index.html#reference-api">Reference/API</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../astro/population/index.html">Astrophysical source population models (<code class="xref py py-obj docutils literal notranslate"><span class="pre">gammapy.astro.population</span></code>)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../astro/population/index.html#introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../astro/population/index.html#getting-started">Getting Started</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../astro/population/index.html#reference-api">Reference/API</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../astro/darkmatter/index.html">Dark matter (<code class="xref py py-obj docutils literal notranslate"><span class="pre">gammapy.astro.darkmatter</span></code>)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../astro/darkmatter/index.html#introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../astro/darkmatter/index.html#other-packages">Other packages</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../astro/darkmatter/index.html#using-gammapy-spectrum">Using <code class="xref py py-obj docutils literal notranslate"><span class="pre">gammapy.spectrum</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../astro/darkmatter/index.html#reference-api">Reference/API</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../stats/index.html">stats - Statistics</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../stats/index.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../stats/index.html#getting-started">Getting Started</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../stats/index.html#li-ma-significance">Li &amp; Ma Significance</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../stats/index.html#confidence-intervals">Confidence Intervals</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../stats/index.html#using-gammapy-stats">Using <code class="xref py py-obj docutils literal notranslate"><span class="pre">gammapy.stats</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../stats/feldman_cousins.html">Feldman and Cousins Confidence Intervals</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../stats/feldman_cousins.html#examples">Examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../stats/feldman_cousins.html#acceptance-interval-fixing">Acceptance Interval Fixing</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../stats/feldman_cousins.html#sensitivity">Sensitivity</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../stats/feldman_cousins.html#general-case">General Case</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../stats/feldman_cousins.html#verification">Verification</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../stats/fit_statistics.html">Fit statistics</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../stats/fit_statistics.html#introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../stats/fit_statistics.html#gaussian-data">Gaussian data</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../stats/fit_statistics.html#poisson-data">Poisson data</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../stats/fit_statistics.html#poisson-data-with-background-measurement">Poisson data with background measurement</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../stats/fit_statistics.html#further-references">Further references</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../stats/index.html#reference-api">Reference/API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../stats/index.html#module-gammapy.stats">gammapy.stats Package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../stats/index.html#functions">Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../stats/index.html#classes">Classes</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../utils/index.html">utils - Utilities</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../utils/index.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../utils/index.html#time-handling-in-gammapy">Time handling in Gammapy</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../utils/index.html#time-format-and-scale">Time format and scale</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../utils/index.html#mission-elapsed-times-met">Mission elapsed times (MET)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../utils/index.html#time-differences">Time differences</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../utils/index.html#reference-api">Reference/API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../utils/index.html#module-gammapy.utils.units">gammapy.utils.units Module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../utils/index.html#functions">Functions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../utils/index.html#module-gammapy.utils.coordinates">gammapy.utils.coordinates Package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../utils/index.html#id3">Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../utils/index.html#variables">Variables</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../utils/index.html#module-gammapy.utils.integrate">gammapy.utils.integrate Module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../utils/index.html#id4">Functions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../utils/index.html#module-gammapy.utils.interpolation">gammapy.utils.interpolation Module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../utils/index.html#id5">Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../utils/index.html#classes">Classes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../utils/index.html#module-gammapy.utils.table">gammapy.utils.table Module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../utils/index.html#id6">Functions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../utils/index.html#module-gammapy.utils.fits">gammapy.utils.fits Module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../utils/index.html#gammapy-fits-utilities">Gammapy FITS utilities</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../utils/index.html#id7">Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../utils/index.html#id8">Classes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../utils/index.html#module-gammapy.utils.random">gammapy.utils.random Package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../utils/index.html#id9">Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../utils/index.html#id10">Classes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../utils/index.html#module-gammapy.utils.regions">gammapy.utils.regions Module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../utils/index.html#id11">Functions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../utils/index.html#module-gammapy.utils.scripts">gammapy.utils.scripts Module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../utils/index.html#id12">Functions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../utils/index.html#module-gammapy.utils.testing">gammapy.utils.testing Module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../utils/index.html#id13">Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../utils/index.html#id14">Classes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../utils/index.html#module-gammapy.utils.nddata">gammapy.utils.nddata Module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../utils/index.html#id15">Classes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../utils/index.html#module-gammapy.utils.time">gammapy.utils.time Module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../utils/index.html#id16">Functions</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../scripts/index.html">scripts - Command line tools</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../scripts/index.html#introduction">Introduction</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../scripts/index.html#execute">Execute</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../scripts/index.html#command-not-found">Command not found</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../scripts/index.html#example">Example</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../scripts/index.html#reference">Reference</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../scripts/index.html#gammapy">gammapy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../scripts/index.html#gammapy-analysis">analysis</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../scripts/index.html#gammapy-check">check</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../scripts/index.html#gammapy-download">download</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../scripts/index.html#gammapy-info">info</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../scripts/index.html#gammapy-jupyter">jupyter</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../scripts/index.html#implementation">Implementation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../scripts/index.html#limitations">Limitations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../scripts/index.html#plan">Plan</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../scripts/index.html#write-your-own-cli">Write your own CLI</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../scripts/index.html#reference-api">Reference/API</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Developer Documentation</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Developer documentation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../intro.html">How to contribute to Gammapy?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../setup.html">Gammapy project setup</a></li>
<li class="toctree-l2"><a class="reference internal" href="../howto.html">Developer HOWTO</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release.html">How to make a Gammapy release</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">PIGs</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="pig-001.html">PIG 1 - PIG purpose and guidelines</a></li>
<li class="toctree-l3"><a class="reference internal" href="pig-002.html">PIG 2 - Organization of low-level analysis code</a></li>
<li class="toctree-l3"><a class="reference internal" href="pig-003.html">PIG 3 - Plan for dropping Python 2.7 support</a></li>
<li class="toctree-l3"><a class="reference internal" href="pig-004.html">PIG 4 - Setup for tutorial notebooks and data</a></li>
<li class="toctree-l3"><a class="reference internal" href="pig-005.html">PIG 5 - Gammapy 1.0 Roadmap</a></li>
<li class="toctree-l3"><a class="reference internal" href="pig-006.html">PIG 6 - CTA observation handling</a></li>
<li class="toctree-l3"><a class="reference internal" href="pig-007.html">PIG 7 - Models</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">PIG 8 - Datasets</a></li>
<li class="toctree-l3"><a class="reference internal" href="pig-009.html">PIG 9 - Event Sampling</a></li>
<li class="toctree-l3"><a class="reference internal" href="pig-010.html">PIG 10 - Regions</a></li>
<li class="toctree-l3"><a class="reference internal" href="pig-011.html">PIG 11 - Light curves</a></li>
<li class="toctree-l3"><a class="reference internal" href="pig-012.html">PIG 12 - High-level interface</a></li>
<li class="toctree-l3"><a class="reference internal" href="pig-013.html">PIG 13 - Gammapy dependencies and distribution</a></li>
<li class="toctree-l3"><a class="reference internal" href="pig-014.html">PIG 14 - Uncertainty estimation</a></li>
<li class="toctree-l3"><a class="reference internal" href="pig-016.html">PIG 16 - Gammapy package structure</a></li>
<li class="toctree-l3"><a class="reference internal" href="pig-018.html">PIG 18 - Documentation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../dataformats.html">Data Formats</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">gammapy</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">Developer documentation</a> &raquo;</li>
        
          <li><a href="index.html">PIGs</a> &raquo;</li>
        
      <li>PIG 8 - Datasets</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/development/pigs/pig-008.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="pig-8-datasets">
<span id="pig-008"></span><h1>PIG 8 - Datasets<a class="headerlink" href="#pig-8-datasets" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><p>Author: Axel Donath, Christoph Deil, Regis Terrier &amp; Atreyee Sinha</p></li>
<li><p>Created: Jan 4th, 2019</p></li>
<li><p>Withdrawn: Nov 30th, 2019</p></li>
<li><p>Status: withdrawn</p></li>
<li><p>Discussion: <a class="reference external" href="https://github.com/gammapy/gammapy/pull/1986">GH 1986</a></p></li>
</ul>
<div class="section" id="abstract">
<h2>Abstract<a class="headerlink" href="#abstract" title="Permalink to this headline">¶</a></h2>
<p>An essential analysis feature of Gammapy will be the possibility to fit models
to gamma-ray data. This includes the simple use-case of fitting spectral,
spatial and combined models to binned datasets, but also includes more advanced
scenarios such as joint-likelihood fitting of a model across multiple IACT observations,
joint-likelihood fitting of IACT and Fermi-LAT data, combined analysis of gamma-ray
data with flux points or a combined spectral and cube analysis. The joint-likelihood
approach also allows for combining different event types in a single analysis.</p>
<p>For this reason we propose to introduce the abstraction layer of a <code class="docutils literal notranslate"><span class="pre">Dataset</span></code> in Gammapy.
A dataset bundles the reduced data with a parametric source model, background model,
instrument response functions and the fit statistics function. It evaluates the model
and returns the log-likelihood of the data, given the current model parameters.
This approach allows to introduce a uniform fitting interface represented by a single
<code class="docutils literal notranslate"><span class="pre">Fit</span></code> class, independent of the type of the analysis (spectral, spatial, cube). In
addition Datasets can be combined by adding their log-likelihood values, linking
and concatenating their model parameters. This enables all combinations
of a joint-likelihood analyses described above.</p>
</div>
<div class="section" id="proposal">
<h2>Proposal<a class="headerlink" href="#proposal" title="Permalink to this headline">¶</a></h2>
<p>In general the proposal includes three basic types of classes: <code class="docutils literal notranslate"><span class="pre">Dataset</span></code>, <code class="docutils literal notranslate"><span class="pre">Datasets</span></code>
and <code class="docutils literal notranslate"><span class="pre">Fit</span> <span class="pre">``.</span> <span class="pre">The</span> <span class="pre">``Dataset</span></code> bundles the model and data, the <code class="docutils literal notranslate"><span class="pre">Datasets</span></code> class combines
multiple datasets for joint-likelhood fitting and the <code class="docutils literal notranslate"><span class="pre">Fit</span></code> class represents the
interface to the optimization methods, which are implemented in <code class="docutils literal notranslate"><span class="pre">gammapy.utils.fitting</span></code>.
Here is an illustration of the proposed API:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">gammapy.utils.fitting</span> <span class="k">import</span> <span class="n">Dataset</span><span class="p">,</span> <span class="n">Datasets</span><span class="p">,</span> <span class="n">Fit</span>

<span class="n">dataset</span> <span class="o">=</span> <span class="n">Dataset</span><span class="p">()</span>

<span class="n">dataset</span><span class="o">.</span><span class="n">stat</span><span class="p">()</span>

<span class="n">fit</span> <span class="o">=</span> <span class="n">Fit</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span>
<span class="n">fit</span><span class="o">.</span><span class="n">optimize</span><span class="p">()</span>

<span class="n">datasets</span> <span class="o">=</span> <span class="n">Datasets</span><span class="p">([</span><span class="n">Dataset</span><span class="p">(),</span> <span class="n">Dataset</span><span class="p">()])</span>

<span class="n">fit</span> <span class="o">=</span> <span class="n">Fit</span><span class="p">(</span><span class="n">datasets</span><span class="p">)</span>
<span class="n">fit</span><span class="o">.</span><span class="n">optimize</span><span class="p">()</span>

<span class="c1"># or for convenience</span>
<span class="n">datasets</span> <span class="o">=</span> <span class="p">[</span><span class="n">Dataset</span><span class="p">(),</span> <span class="n">Dataset</span><span class="p">()]</span>

<span class="n">fit</span> <span class="o">=</span> <span class="n">Fit</span><span class="p">(</span><span class="n">datasets</span><span class="p">)</span>
<span class="n">fit</span><span class="o">.</span><span class="n">optimize</span><span class="p">()</span>
</pre></div>
</div>
<p>To enabled the different analysis use-cases we propose to introduce a <code class="docutils literal notranslate"><span class="pre">MapDataset</span></code>,
<code class="docutils literal notranslate"><span class="pre">SpectrumDataset</span></code>, <code class="docutils literal notranslate"><span class="pre">SpectrumDatasetOnOff</span></code> and <code class="docutils literal notranslate"><span class="pre">FluxPointsDataset</span></code>.</p>
<div class="section" id="dataset">
<h3>Dataset<a class="headerlink" href="#dataset" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">Dataset</span></code> class is the abstract base class for all datasets. It defines the minimal required
interface for a dataset to work with the <code class="docutils literal notranslate"><span class="pre">Fit</span></code> class and basic user API. It serves
as a base class for all built-in datasets, as well as for user defined ones:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">gammapy.utils.fitting</span> <span class="k">import</span> <span class="n">Dataset</span>


<span class="k">class</span> <span class="nc">UserDataset</span><span class="p">(</span><span class="n">Dataset</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">mask_fit</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mask_safe</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">model</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mask_safe</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mask_fit</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">stat_per_bin</span><span class="p">():</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">evaluate</span><span class="p">()</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>
</pre></div>
</div>
<p>Any dataset derived from the base class has to define a <code class="docutils literal notranslate"><span class="pre">.stat_per_bin()</span></code> method,
that returns the log-likelihood given the current model parameters and a <code class="docutils literal notranslate"><span class="pre">.parameters</span></code>
attribute, which defines the parameters passed on to the <code class="docutils literal notranslate"><span class="pre">Fit</span></code> class.</p>
<p>The dataset also (optionally) defines two kinds of masks: the <code class="docutils literal notranslate"><span class="pre">mask_safe</span></code> and <code class="docutils literal notranslate"><span class="pre">mask_fit</span></code>.
The main purpose is that safe data range defined by <code class="docutils literal notranslate"><span class="pre">mask_safe</span></code> is set in advance
e.g. during data reduction and not modified later, while the <code class="docutils literal notranslate"><span class="pre">mask_fit</span></code> can be
modified by users to manually define the fit range or by algorithms e.g. flux point computation.
For likelihood evaluation both mask are combined by the <code class="docutils literal notranslate"><span class="pre">Dataset</span></code> base class.</p>
</div>
<div class="section" id="datasets">
<h3>Datasets<a class="headerlink" href="#datasets" title="Permalink to this headline">¶</a></h3>
<p>To combine multiple datasets in a joint-likelihood analysis we propose to introduce
a <code class="docutils literal notranslate"><span class="pre">Datasets</span></code> class. Its responsibility is to add up the log-likelihood values of
the individual datasets and join the parameter lists. The <code class="docutils literal notranslate"><span class="pre">Datasets</span></code> class
also represents the main interface to the <code class="docutils literal notranslate"><span class="pre">Fit</span></code> class.</p>
<p>The following example shows how a joint-likelihood analysis of multiple observations
is supposed to work:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">gammapy.utils.fitting</span> <span class="k">import</span> <span class="n">Datasets</span>
<span class="kn">from</span> <span class="nn">gammapy.cube</span> <span class="k">import</span> <span class="n">SkyModel</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">SkyModel</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>

<span class="n">map_datasets</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">obs_id</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">123</span><span class="p">,</span> <span class="mi">124</span><span class="p">,</span> <span class="o">...</span><span class="p">]:</span>
    <span class="n">bkg_model</span> <span class="o">=</span> <span class="n">BackgroundModel</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s2">&quot;obs-</span><span class="si">{}</span><span class="s2">/background.fits&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">obs_id</span><span class="p">))</span>
    <span class="n">dataset</span> <span class="o">=</span> <span class="n">MapDataset</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span> <span class="n">background</span><span class="o">=</span><span class="n">bkg_model</span><span class="p">)</span>
    <span class="n">map_datasets</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span>

<span class="n">datasets</span> <span class="o">=</span> <span class="n">Datasets</span><span class="p">(</span><span class="n">map_datasets</span><span class="p">)</span>
<span class="n">datasets</span><span class="o">.</span><span class="n">stat</span><span class="p">()</span>

<span class="n">fit</span> <span class="o">=</span> <span class="n">Fit</span><span class="p">(</span><span class="n">datasets</span><span class="p">)</span>
</pre></div>
</div>
<p>The linking of parameters of the spectral model is natively achieved, as the same
instance of the spectral model is passed to two different datasets, while the
background model is created for every dataset separately.</p>
<p>A joined spectral fit across multiple observations:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">SpectralModel</span><span class="p">()</span>

<span class="n">spectrum_dataset_1</span> <span class="o">=</span> <span class="n">SpectrumDataset</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="o">...</span><span class="p">)</span>
<span class="n">spectrum_dataset_2</span> <span class="o">=</span> <span class="n">SpectrumDataset</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="o">...</span><span class="p">)</span>

<span class="n">datasets</span> <span class="o">=</span> <span class="n">Datasets</span><span class="p">([</span><span class="n">spectrum_dataset_1</span><span class="p">,</span> <span class="n">spectrum_dataset_2</span><span class="p">])</span>

<span class="n">fit</span> <span class="o">=</span> <span class="n">Fit</span><span class="p">(</span><span class="n">datasets</span><span class="p">)</span>
<span class="n">fit</span><span class="o">.</span><span class="n">optimize</span><span class="p">()</span>
</pre></div>
</div>
<p>Combined spectral / flux points analysis:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">SpectralModel</span><span class="p">()</span>

<span class="n">spectrum_dataset</span> <span class="o">=</span> <span class="n">SpectrumDataset</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">)</span>

<span class="n">flux_points</span> <span class="o">=</span> <span class="n">FluxPoints</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="n">flux_point_dataset</span> <span class="o">=</span> <span class="n">FluxPointsDataset</span><span class="p">(</span><span class="n">flux_points</span><span class="o">=</span><span class="n">flux_points</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span> <span class="n">likelihood</span><span class="o">=</span><span class="s2">&quot;chi2&quot;</span><span class="p">)</span>

<span class="n">datasets</span> <span class="o">=</span> <span class="n">Datasets</span><span class="p">([</span><span class="n">flux_point_dataset</span><span class="p">,</span> <span class="n">spectrum_dataset</span><span class="p">])</span>

<span class="n">fit</span> <span class="o">=</span> <span class="n">Fit</span><span class="p">(</span><span class="n">datasets</span><span class="p">)</span>
<span class="n">fit</span><span class="o">.</span><span class="n">optimize</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="mapdataset">
<h3>MapDataset<a class="headerlink" href="#mapdataset" title="Permalink to this headline">¶</a></h3>
<p>To enable the standard combined spectral and spatial analysis we propose to
introduce a <code class="docutils literal notranslate"><span class="pre">MapDataset</span></code> class. A <code class="docutils literal notranslate"><span class="pre">MapDataset</span></code> bundles the counts data, source model,
IRFs, background model corresponding to a given event selection.</p>
<p>It is supposed to work as following:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">gammapy.cube</span> <span class="k">import</span> <span class="n">MapDataset</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">SkyModel</span><span class="p">()</span>
<span class="n">background</span> <span class="o">=</span> <span class="n">BackgroundModel</span><span class="p">()</span>

<span class="n">counts</span> <span class="o">=</span> <span class="n">Map</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s2">&quot;counts.fits&quot;</span><span class="p">)</span>
<span class="n">exposure</span> <span class="o">=</span> <span class="n">Map</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s2">&quot;exposure.fits&quot;</span><span class="p">)</span>
<span class="n">edisp</span> <span class="o">=</span> <span class="n">EDispMap</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s2">&quot;edisp.fits&quot;</span><span class="p">)</span>
<span class="n">psf</span> <span class="o">=</span> <span class="n">PSFMap</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s2">&quot;psf.fits&quot;</span><span class="p">)</span>

<span class="n">dataset</span> <span class="o">=</span> <span class="n">MapDataset</span><span class="p">(</span>
    <span class="n">counts</span><span class="o">=</span><span class="n">counts</span><span class="p">,</span>
    <span class="n">exposure</span><span class="o">=</span><span class="n">exposure</span><span class="p">,</span>
    <span class="n">edisp</span><span class="o">=</span><span class="n">edisp</span><span class="p">,</span>
    <span class="n">psf</span><span class="o">=</span><span class="n">psf</span><span class="p">,</span>
    <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span>
    <span class="n">background</span><span class="o">=</span><span class="n">background_model</span><span class="p">,</span>
    <span class="n">likelihood</span><span class="o">=</span><span class="s2">&quot;cash&quot;</span>
    <span class="n">mask_fit</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">mask_safe</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">stat</span><span class="o">=</span><span class="s2">&quot;cash&quot;</span>
    <span class="p">)</span>

<span class="n">fit</span> <span class="o">=</span> <span class="n">Fit</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span>
<span class="n">fit</span><span class="o">.</span><span class="n">optimize</span><span class="p">()</span>
</pre></div>
</div>
<p>For the psf argument three values are possible: <code class="docutils literal notranslate"><span class="pre">None</span></code>, <code class="docutils literal notranslate"><span class="pre">PSFKernel()</span></code>
or <code class="docutils literal notranslate"><span class="pre">PSFMap</span></code>. In the first case the PSF convolution is skipped. In the
second case a single PSF for the whole map is assumed. In the last
case a spatially varying PSF is handled. The same holds for the <code class="docutils literal notranslate"><span class="pre">edisp</span></code>
argument.</p>
<p>In the proposed implementation the counts map and background model must be
defined on the same map geometry. A separate setup step in <code class="docutils literal notranslate"><span class="pre">MapDataset.__init__</span></code>
creates cutouts of the exposure map for the individual model components and assigns
the corresponding IRFs to the model component and bundles all into the already
existing <code class="docutils literal notranslate"><span class="pre">MapEvaluator()</span></code> object. The list of model evaluators is cached on the
<code class="docutils literal notranslate"><span class="pre">MapDataset</span></code> and used later to efficiently compute the predicted number of counts.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">stat</span></code> argument allows to choose between built-in fit statistics
such as <code class="docutils literal notranslate"><span class="pre">cash</span></code> or <code class="docutils literal notranslate"><span class="pre">cstat</span></code> for convenience.</p>
</div>
<div class="section" id="mapdatasetonoff">
<h3>MapDatasetOnOff<a class="headerlink" href="#mapdatasetonoff" title="Permalink to this headline">¶</a></h3>
<p>For on-off based analyses a <code class="docutils literal notranslate"><span class="pre">MapDatasetOnOff</span></code> will be introduced. It inherits
most of its functionality from the <code class="docutils literal notranslate"><span class="pre">MapDataset</span></code>, but implements in addition the
handling of <code class="docutils literal notranslate"><span class="pre">counts_off</span></code> and <code class="docutils literal notranslate"><span class="pre">acceptance</span></code> and <code class="docutils literal notranslate"><span class="pre">acceptance_off</span></code> information:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">gammapy.cube</span> <span class="k">import</span> <span class="n">MapDatasetOnOff</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">SkyModel</span><span class="p">()</span>
<span class="n">background_model</span> <span class="o">=</span> <span class="n">BackgroundModel</span><span class="p">()</span>

<span class="n">counts</span> <span class="o">=</span> <span class="n">Map</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s2">&quot;counts.fits&quot;</span><span class="p">)</span>
<span class="n">counts_off</span> <span class="o">=</span> <span class="n">Map</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s2">&quot;counts_off.fits&quot;</span><span class="p">)</span>

<span class="n">acceptance</span> <span class="o">=</span> <span class="n">Map</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s2">&quot;acceptance.fits&quot;</span><span class="p">)</span>
<span class="n">acceptance_off</span> <span class="o">=</span> <span class="n">Map</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s2">&quot;acceptance_off.fits&quot;</span><span class="p">)</span>

<span class="n">exposure</span> <span class="o">=</span> <span class="n">Map</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s2">&quot;exposure.fits&quot;</span><span class="p">)</span>
<span class="n">edisp</span> <span class="o">=</span> <span class="n">EdispMap</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s2">&quot;edisp.fits&quot;</span><span class="p">)</span>
<span class="n">psf</span> <span class="o">=</span> <span class="n">PSFMap</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s2">&quot;psf.fits&quot;</span><span class="p">)</span>

<span class="n">dataset_onoff</span> <span class="o">=</span> <span class="n">MapDatasetOnOff</span><span class="p">(</span>
    <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span>
    <span class="n">background_model</span><span class="o">=</span><span class="n">background_model</span><span class="p">,</span>
    <span class="n">counts</span><span class="o">=</span><span class="n">counts</span><span class="p">,</span>
    <span class="n">counts_off</span><span class="o">=</span><span class="n">counts_off</span><span class="p">,</span>
    <span class="n">acceptance</span><span class="o">=</span><span class="n">acceptance</span><span class="p">,</span>
    <span class="n">aceptance_off</span><span class="o">=</span><span class="n">acceptance_off</span><span class="p">,</span>
    <span class="n">exposure</span><span class="o">=</span><span class="n">exposure</span><span class="p">,</span>
    <span class="n">edisp</span><span class="o">=</span><span class="n">edisp</span><span class="p">,</span>
    <span class="n">psf</span><span class="o">=</span><span class="n">psf</span><span class="p">,</span>
    <span class="n">mask_fit</span><span class="o">=</span><span class="n">mask_fit</span><span class="p">,</span>
    <span class="n">mask_safe</span><span class="o">=</span><span class="n">mask_safe</span><span class="p">,</span>
    <span class="n">stat</span><span class="o">=</span><span class="s2">&quot;wstat&quot;</span>
    <span class="p">)</span>

<span class="n">fit</span> <span class="o">=</span> <span class="n">Fit</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span>
<span class="n">fit</span><span class="o">.</span><span class="n">optimize</span><span class="p">()</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">background_model</span></code> can be defined optionally for simulation or
fitting to the <code class="docutils literal notranslate"><span class="pre">counts_off</span></code> data.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">MapDatasetOnOff</span></code> additionally implements the following methods
needed for the evaluation of the fit statistic:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dataset</span> <span class="o">=</span> <span class="n">MapDatasetOnOff</span><span class="p">()</span>
<span class="n">dataset</span><span class="o">.</span><span class="n">alpha</span>  <span class="c1"># defined by acceptance / acceptance_off</span>
<span class="n">dataset</span><span class="o">.</span><span class="n">background</span>  <span class="c1"># defined by alpha * counts_off</span>
<span class="n">dataset</span><span class="o">.</span><span class="n">npred_sig</span><span class="p">()</span>  <span class="c1"># defined by npred - background</span>
</pre></div>
</div>
</div>
<div class="section" id="spectrumdataset">
<h3>SpectrumDataset<a class="headerlink" href="#spectrumdataset" title="Permalink to this headline">¶</a></h3>
<p>For spectral analysis we propose to introduce a <code class="docutils literal notranslate"><span class="pre">SpectrumDataset</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">gammapy.spectrum</span> <span class="k">import</span> <span class="n">SpectrumDataset</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">SpectralModel</span><span class="p">()</span>
<span class="n">background_model</span> <span class="o">=</span> <span class="n">SpectralBackgroundModel</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="n">edisp</span> <span class="o">=</span> <span class="n">EnergyDispersion</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>

<span class="n">counts</span> <span class="o">=</span> <span class="n">CountsSpectrum</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="n">exposure</span> <span class="o">=</span> <span class="n">CountsSpectrum</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>

<span class="n">dataset</span> <span class="o">=</span> <span class="n">SpectrumDataset</span><span class="p">(</span>
    <span class="n">counts</span><span class="o">=</span><span class="n">counts</span><span class="p">,</span>
    <span class="n">exposure</span><span class="o">=</span><span class="n">exposure</span><span class="p">,</span>
    <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span>
    <span class="n">background_model</span><span class="o">=</span><span class="n">background_model</span><span class="p">,</span>
    <span class="n">mask_fit</span><span class="o">=</span><span class="n">mask_fit</span><span class="p">,</span>
    <span class="n">mask_safe</span><span class="o">=</span><span class="n">mask_safe</span><span class="p">,</span>
    <span class="n">edisp</span><span class="o">=</span><span class="n">edisp</span><span class="p">,</span>
    <span class="n">stat</span><span class="o">=</span><span class="s2">&quot;cash&quot;</span>
    <span class="p">)</span>

<span class="n">dataset</span><span class="o">.</span><span class="n">npred</span><span class="p">()</span>
<span class="n">dataset</span><span class="o">.</span><span class="n">stat_per_bin</span><span class="p">()</span>
<span class="n">dataset</span><span class="o">.</span><span class="n">stat</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="spectrumdatasetonoff">
<h3>SpectrumDatasetOnOff<a class="headerlink" href="#spectrumdatasetonoff" title="Permalink to this headline">¶</a></h3>
<p>For on-off based spectral analysis we propose to introduce a <code class="docutils literal notranslate"><span class="pre">SpectrumDatasetOnOff</span></code>
class which again inherits from <code class="docutils literal notranslate"><span class="pre">SpectrumDataset</span></code> and handles the additional information
accordingly:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">gammapy.spectrum</span> <span class="k">import</span> <span class="n">SpectrumDatasetOnOff</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">SpectralModel</span><span class="p">()</span>

<span class="n">edisp</span> <span class="o">=</span> <span class="n">EnergyDispersion</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>

<span class="n">counts</span> <span class="o">=</span> <span class="n">CountsSpectrum</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="n">counts_off</span> <span class="o">=</span> <span class="n">CountsSpectrum</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>

<span class="n">aeff</span> <span class="o">=</span> <span class="n">EffectiveAreaTable</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>

<span class="n">dataset</span> <span class="o">=</span> <span class="n">SpectrumDatasetOnOff</span><span class="p">(</span>
    <span class="n">counts</span><span class="o">=</span><span class="n">counts</span><span class="p">,</span>
    <span class="n">counts_off</span><span class="o">=</span><span class="n">counts_off</span><span class="p">,</span>
    <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span>
    <span class="n">exposure</span><span class="o">=</span><span class="n">exposure</span><span class="p">,</span>
    <span class="n">acceptance</span><span class="o">=</span><span class="n">acceptance</span><span class="p">,</span>
    <span class="n">acceptance_off</span><span class="o">=</span><span class="n">acceptance_off</span><span class="p">,</span>
    <span class="n">edisp</span><span class="o">=</span><span class="n">edisp</span><span class="p">,</span>
    <span class="n">stat</span><span class="o">=</span><span class="s2">&quot;wstat&quot;</span><span class="p">,</span>
    <span class="p">)</span>

<span class="n">dataset</span><span class="o">.</span><span class="n">npred</span><span class="p">()</span>
<span class="n">dataset</span><span class="o">.</span><span class="n">stat_per_bin</span><span class="p">()</span>
<span class="n">dataset</span><span class="o">.</span><span class="n">stat</span><span class="p">()</span>
</pre></div>
</div>
<p>We propose to refactor the existing <code class="docutils literal notranslate"><span class="pre">SpectrumObservation</span></code> object into the
<code class="docutils literal notranslate"><span class="pre">SpectrumDatasetsOnOff</span></code> class.</p>
</div>
<div class="section" id="fluxpointsdataset">
<h3>FluxPointsDataset<a class="headerlink" href="#fluxpointsdataset" title="Permalink to this headline">¶</a></h3>
<p>For fitting of flux points we propose to introduce a <code class="docutils literal notranslate"><span class="pre">FluxPointsDataset</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">gammapy.spectrum</span> <span class="k">import</span> <span class="n">FluxPointsDataset</span>

<span class="n">flux_points</span> <span class="o">=</span> <span class="n">FluxPoints</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s2">&quot;flux_points.ecsv&quot;</span><span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">PowerLaw</span><span class="p">()</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="n">FluxPointsDataset</span><span class="p">(</span>
    <span class="n">flux_points</span><span class="o">=</span><span class="n">flux_points</span><span class="p">,</span>
    <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span>
    <span class="n">mask_safe</span><span class="o">=</span><span class="n">mask_safe</span>
    <span class="n">mask_fit</span><span class="o">=</span><span class="n">mask_fit</span><span class="p">,</span>
    <span class="n">stat</span><span class="o">=</span><span class="s2">&quot;chi2&quot;</span>
    <span class="p">)</span>

<span class="n">fit</span> <span class="o">=</span> <span class="n">Fit</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span>
<span class="n">fit</span><span class="o">.</span><span class="n">optimize</span><span class="p">()</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">FluxPoint</span></code> class also supports the <code class="docutils literal notranslate"><span class="pre">likelihood</span></code> format, which has to be implemented
in a special way in the <code class="docutils literal notranslate"><span class="pre">FluxPointsDataset</span></code>. The <code class="docutils literal notranslate"><span class="pre">likelihood</span></code> format stores the
likelihood of the flux point, depending on energy and amplitude. Given a predicted
flux by the spectral model the likelihood can be directly interpolated. This could
be supported by a specific option <code class="docutils literal notranslate"><span class="pre">FluxPointsDataset(stat=&quot;likelihood&quot;)</span></code> or similar.</p>
</div>
<div class="section" id="dataset-helper-convenience-methods">
<h3>Dataset helper / convenience methods<a class="headerlink" href="#dataset-helper-convenience-methods" title="Permalink to this headline">¶</a></h3>
<p>We propose to implement a few convenience methods on all datasets. E.g.
a <code class="docutils literal notranslate"><span class="pre">.residuals()</span></code> method, which computes the residual for the given data
and state of the model:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dataset</span><span class="o">.</span><span class="n">residuals</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s2">&quot;diff&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>A selection of methods for the residual computation would ne available, such
as <code class="docutils literal notranslate"><span class="pre">data</span> <span class="pre">-</span> <span class="pre">model</span></code>, <code class="docutils literal notranslate"><span class="pre">(data</span> <span class="pre">-</span> <span class="pre">model)</span> <span class="pre">/</span> <span class="pre">model</span></code> and <code class="docutils literal notranslate"><span class="pre">(data</span> <span class="pre">-</span> <span class="pre">model)</span> <span class="pre">/</span> <span class="pre">sqrt(model)</span></code>.</p>
<p>For counts based datasets an <code class="docutils literal notranslate"><span class="pre">.excess()</span></code> method can be implmented.</p>
<p>All dataset objects should implement a <code class="docutils literal notranslate"><span class="pre">__str__</span></code> method, so that the following
works:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span>
</pre></div>
</div>
<p>Specific to each dataset information on the model, model parameters, data and
fit statistics is printed.</p>
<p>We propose to implement a <code class="docutils literal notranslate"><span class="pre">.peek()</span></code> method on all datasets:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dataset</span><span class="o">.</span><span class="n">peek</span><span class="p">()</span>
</pre></div>
</div>
<p>In an interactive environment this will show a default visualisation of the
dataset including model, data, IRFs and residuals.</p>
</div>
<div class="section" id="simulation-of-mapdataset-and-spectrumdataset">
<h3>Simulation of MapDataset and SpectrumDataset<a class="headerlink" href="#simulation-of-mapdataset-and-spectrumdataset" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">MapDataset</span></code> and <code class="docutils literal notranslate"><span class="pre">SpectrumDataset</span></code> classes will be the central classes
for map and spectrum based analyses. In many cases it’s useful to simulate
counts from a predicted number of counts model. The direct sampling of
binned data for the datasets could be supported as following (illustrated
for the <code class="docutils literal notranslate"><span class="pre">MapDataset</span></code>):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># allow counts=None on init</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="n">MapDataset</span><span class="p">(</span><span class="n">counts</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

<span class="c1"># to sample a counts map from npred</span>
<span class="n">dataset</span><span class="o">.</span><span class="n">counts</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">fake</span><span class="p">(</span><span class="n">random_seed</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="n">fit</span> <span class="o">=</span> <span class="n">Fit</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span>
<span class="n">fit</span><span class="o">.</span><span class="n">optimize</span><span class="p">()</span>
</pre></div>
</div>
<p>Which calls <code class="docutils literal notranslate"><span class="pre">np.random.poisson()</span></code> internally on the npred map and returns
the resulting map. This works equivalently for the <code class="docutils literal notranslate"><span class="pre">SpectrumDataset</span></code>,
<code class="docutils literal notranslate"><span class="pre">SpectrumDatasetOnOff</span></code> and <code class="docutils literal notranslate"><span class="pre">MapDatasetOnOff</span></code>. The on-off dataset require
a background model for this to work.</p>
<p>Unbinned simulation (sampling of event lists) is addressed in a separate PIG.</p>
</div>
<div class="section" id="dataset-serialization">
<h3>Dataset serialization<a class="headerlink" href="#dataset-serialization" title="Permalink to this headline">¶</a></h3>
<p>For convenience all dataset classes should support serialization, implemented
via <code class="docutils literal notranslate"><span class="pre">.read()</span></code> and <code class="docutils literal notranslate"><span class="pre">.write()</span></code> methods. For now we only consider the serialization
of the data of the datasets and not the of the model, which might always stay
separate. As the dataset has to orchestrate the serialization of multiple objects,
such as different kind of maps, flux-points etc. one option is to introduce the
serialization with a YAML based index file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dataset</span> <span class="o">=</span> <span class="n">MapDataset</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s2">&quot;dataset.yaml&quot;</span><span class="p">)</span>
<span class="n">dataset</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;dataset.yaml&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Where the index file points to the various files needed for initialization of the
dataset. Here is an example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dataset</span><span class="p">:</span>
    <span class="nb">type</span><span class="p">:</span> <span class="nb">map</span><span class="o">-</span><span class="n">dataset</span>
    <span class="n">counts</span><span class="p">:</span> <span class="s2">&quot;obs-123/counts.fits&quot;</span>
    <span class="n">exposure</span><span class="p">:</span> <span class="s2">&quot;obs-123/exposure.fits&quot;</span>
    <span class="n">edisp</span><span class="p">:</span> <span class="s2">&quot;obs-123/edisp.fits&quot;</span>
    <span class="n">psf</span><span class="p">:</span> <span class="s2">&quot;obs-123/psf.fits&quot;</span>
    <span class="n">background</span><span class="o">-</span><span class="n">model</span><span class="p">:</span> <span class="s2">&quot;obs-123/background.fits&quot;</span>
    <span class="n">model</span><span class="p">:</span> <span class="s2">&quot;model.yaml&quot;</span> <span class="c1"># optionally</span>
</pre></div>
</div>
<p>Addtionally we propose to introduce a single FITS file serializiaton for writing /
reading datasets to and from disk:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dataset</span> <span class="o">=</span> <span class="n">MapDataset</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s2">&quot;dataset.fits&quot;</span><span class="p">)</span>
<span class="n">dataset</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;dataset.fits&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">SpectrumDatasetOnOff</span></code> in addition implements serialisation to the standard
OGIP format described on the <a class="reference external" href="https://gamma-astro-data-formats.readthedocs.io/en/latest/spectra/ogip/index.html">gamma-astro-data-formats PHA</a> page.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">Datasets</span></code> object could be serialized equivalently as a list of datasets:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span> <span class="n">dataset</span><span class="p">:</span>
    <span class="nb">type</span><span class="p">:</span> <span class="n">spectrum</span><span class="o">-</span><span class="n">dataset</span>
    <span class="n">maps</span><span class="p">:</span>
        <span class="n">counts</span><span class="p">:</span> <span class="s2">&quot;obs-123/counts.fits&quot;</span>
        <span class="n">exposure</span><span class="p">:</span> <span class="s2">&quot;obs-123/exposure.fits&quot;</span>
        <span class="n">edisp</span><span class="p">:</span> <span class="s2">&quot;obs-123/edisp.fits&quot;</span>
    <span class="n">model</span><span class="p">:</span> <span class="s2">&quot;model.yaml&quot;</span>
    <span class="n">background</span><span class="o">-</span><span class="n">model</span><span class="p">:</span> <span class="s2">&quot;obs-123/background.fits&quot;</span>
    <span class="n">likelihood</span><span class="p">:</span> <span class="s2">&quot;wstat&quot;</span>

<span class="o">-</span> <span class="n">dataset</span><span class="p">:</span>
    <span class="nb">type</span><span class="p">:</span> <span class="n">spectrum</span><span class="o">-</span><span class="n">dataset</span>
    <span class="n">maps</span><span class="p">:</span>
        <span class="n">counts</span><span class="p">:</span> <span class="s2">&quot;obs-124/counts.fits&quot;</span>
        <span class="n">exposure</span><span class="p">:</span> <span class="s2">&quot;obs-124/exposure.fits&quot;</span>
        <span class="n">edisp</span><span class="p">:</span> <span class="s2">&quot;obs-124/edisp.fits&quot;</span>
    <span class="n">model</span><span class="p">:</span> <span class="s2">&quot;model.yaml&quot;</span>
    <span class="n">background</span><span class="o">-</span><span class="n">model</span><span class="p">:</span> <span class="s2">&quot;obs-124/background.fits&quot;</span>
    <span class="n">likelihood</span><span class="p">:</span> <span class="s2">&quot;wstat&quot;</span>

<span class="o">-</span> <span class="n">dataset</span><span class="p">:</span>
    <span class="nb">type</span><span class="p">:</span> <span class="n">flux</span><span class="o">-</span><span class="n">point</span><span class="o">-</span><span class="n">dataset</span>
    <span class="n">flux</span><span class="o">-</span><span class="n">points</span> <span class="p">:</span> <span class="s2">&quot;fermipy-flux-points.fits&quot;</span>
    <span class="n">model</span><span class="p">:</span> <span class="s2">&quot;spectral-model.yaml&quot;</span>
    <span class="n">likelihood</span><span class="p">:</span> <span class="s2">&quot;template&quot;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="task-list">
<h2>Task List<a class="headerlink" href="#task-list" title="Permalink to this headline">¶</a></h2>
<p>This is a proposal for a list of pull requests implementing the proposed changes,
ordered by priority:</p>
<p>1. Refactor the current <code class="docutils literal notranslate"><span class="pre">FluxPointFit</span></code> into a <code class="docutils literal notranslate"><span class="pre">FluxPointsDataset</span></code> class
and make it work with the current <code class="docutils literal notranslate"><span class="pre">Fit</span></code> class. Ensure that the <code class="docutils literal notranslate"><span class="pre">Fit</span></code> class
supports the old inheritance scheme as well as the new dataset on init.
Update tests and tutorials (<a class="reference external" href="https://github.com/gammapy/gammapy/pull/2023">#2023</a>).</p>
<p>2. Refactor the current <code class="docutils literal notranslate"><span class="pre">MapFit</span></code> into the <code class="docutils literal notranslate"><span class="pre">MapDataset</span></code> class. Only support a
fixed energy dispersion and psf first. Use the current <code class="docutils literal notranslate"><span class="pre">MapEvaluator</span></code> for model
evaluation, but split out the background evaluation. Update test and tutorials
(<a class="reference external" href="https://github.com/gammapy/gammapy/issues/2026">#2026</a>)</p>
<p>3. Implement the <code class="docutils literal notranslate"><span class="pre">Datasets</span></code> class in <code class="docutils literal notranslate"><span class="pre">gammapy.utils.fitting.datasets</span></code>, add tests
using multiple <code class="docutils literal notranslate"><span class="pre">MapDataset</span></code>. Change the <code class="docutils literal notranslate"><span class="pre">Fit</span></code> interface to take a <code class="docutils literal notranslate"><span class="pre">Datasets</span></code>
object or list of <code class="docutils literal notranslate"><span class="pre">MapDataset</span></code> on input (<a class="reference external" href="https://github.com/gammapy/gammapy/issues/2030">#2030</a>).</p>
<p>4. Enable joint-likelihood analyses by filtering the <code class="docutils literal notranslate"><span class="pre">Datasets.parameters</span></code> for
unique parameters only. Add a tutorial for joint-likelihood fitting of multiple
observations (<a class="reference external" href="https://github.com/gammapy/gammapy/issues/2045">#2045</a>).</p>
<p>5. Implement <code class="docutils literal notranslate"><span class="pre">MapDataset.setup()</span></code> method, using a list of <code class="docutils literal notranslate"><span class="pre">MapEvaluator</span></code>
objects. Add an <code class="docutils literal notranslate"><span class="pre">.evaluation_radius()</span></code> attribute to all the spatial models.
Only support a fixed PSF and edisp per model component (<a class="reference external" href="https://github.com/gammapy/gammapy/issues/2071">#2071</a>).</p>
<p>6. Add support for psf maps to <code class="docutils literal notranslate"><span class="pre">MapDataset.setup()</span></code>. Extend the <code class="docutils literal notranslate"><span class="pre">.setup()</span></code> method
to look up the correct PSF for the given model component. A <code class="docutils literal notranslate"><span class="pre">PSFMap</span></code> has to be
passed on <code class="docutils literal notranslate"><span class="pre">MapDataset.__init__()</span></code> (<strong>v0.14</strong>).</p>
<p>7. Add support for energy dispersion maps to <code class="docutils literal notranslate"><span class="pre">MapDataset</span></code>. Extend the <code class="docutils literal notranslate"><span class="pre">.setup()</span></code>
method to look up the correct EDisp for a given model component. An <code class="docutils literal notranslate"><span class="pre">EdispMap</span></code>
has to be passed on <code class="docutils literal notranslate"><span class="pre">MapDataset.__init__()</span></code> (<strong>v0.14</strong>).</p>
<p>8. Add tutorial for joint-likelihood fitting of IACT and Fermi-LAT data, based
on the joint-crab dataset (<strong>v0.14</strong>).</p>
<ol class="arabic simple" start="9">
<li><p>Add a <code class="docutils literal notranslate"><span class="pre">name</span></code> attribute to datasets and a <code class="docutils literal notranslate"><span class="pre">Datasets.__getitem__</span></code> method (<strong>v0.14</strong>).</p></li>
<li><p>Implement dataset serialization to yaml (<strong>v0.14</strong>).</p></li>
<li><p>Implement datasets serialization to a single FITS file (<a class="reference external" href="https://github.com/gammapy/gammapy/issues/2264">#2264</a>).</p></li>
</ol>
<p>12. Add the direct likelihood evaluation to the <code class="docutils literal notranslate"><span class="pre">FluxPointsDataset</span></code>, by
interpolating flux point likelihood profiles (<strong>v0.14</strong>).</p>
<ol class="arabic simple" start="13">
<li><p>Implement <code class="docutils literal notranslate"><span class="pre">MapDataset.fake()</span></code>, <code class="docutils literal notranslate"><span class="pre">SpectrumDataset.fake()</span></code> and <code class="docutils literal notranslate"><span class="pre">SpectrumDatasetOnOff.fake()</span></code> methods (<strong>v0.14</strong>).</p></li>
</ol>
<p>14. Implement convenience helper methods <code class="docutils literal notranslate"><span class="pre">.residuals()</span></code>, <code class="docutils literal notranslate"><span class="pre">.peek()</span></code> and <code class="docutils literal notranslate"><span class="pre">.__str__</span></code> for
all datasets (<strong>v0.14</strong>).</p>
</div>
<div class="section" id="outlook">
<h2>Outlook<a class="headerlink" href="#outlook" title="Permalink to this headline">¶</a></h2>
<div class="section" id="parallel-evaluation-of-datasets">
<h3>Parallel evaluation of datasets<a class="headerlink" href="#parallel-evaluation-of-datasets" title="Permalink to this headline">¶</a></h3>
<p>For efficient joint-likelihood fits of multiple observations, parallel processing
should be used. The obvious entry point is to evaluate one dataset per process and
join the likelihoods at the end. The current handling of model references
(the same model instance is passed to different datasets to achieve a generic
parameter linking by updating the model parameters in place), sets a limitation
on the parallel evaluation, because Python objects can’t easily be shared between
multiple processes. We are aware of this issue, but propose to solve it later,
because it does not affect the proposed API for datasets.</p>
</div>
<div class="section" id="lazy-loading-of-datasets">
<h3>Lazy loading of Datasets<a class="headerlink" href="#lazy-loading-of-datasets" title="Permalink to this headline">¶</a></h3>
<p>For the use-case of inspecting or stacking individual datasets (e.g. MapDataset per observation)
it could be advantegeous to implement a lazy-loading or generator interface for
<code class="docutils literal notranslate"><span class="pre">Datasets.read()</span></code>. Such that the individual datasets are only read from disk on
requests and are not loaded in memory when calling <code class="docutils literal notranslate"><span class="pre">.read()</span></code>. We leave this question
un-addressed in this PR but mention it for completeness.</p>
</div>
</div>
<div class="section" id="decision">
<h2>Decision<a class="headerlink" href="#decision" title="Permalink to this headline">¶</a></h2>
<p>The authors decided to withdraw the PIG. Most of the proposed changes are implemented.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="pig-009.html" class="btn btn-neutral float-right" title="PIG 9 - Event Sampling" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="pig-007.html" class="btn btn-neutral float-left" title="PIG 7 - Models" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, The Gammapy developers
      <span class="lastupdated">
        Last updated on 03 Dec 2019.
      </span>

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>