<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Models &mdash; gammapy v0.19</title><link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/graphviz.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/plot_directive.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/gammapy.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/sg_gallery.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/sg_gallery-binder.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/sg_gallery-dataframe.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/sg_gallery-rendered-html.css" type="text/css" /><link rel="shortcut icon" href="../../_static/gammapy_logo.ico"/>
    <link rel="canonical" href="https://docs.gammapy.org/dev/tutorials/api/models.html"/>
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/language_data.js"></script>
        <script src="../../_static/copybutton.js"></script>
        <script src="../../_static/gammapy.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "tex2jax_ignore|mathjax_ignore|document", "processClass": "tex2jax_process|mathjax_process|math|output_area"}})</script>
        <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Modelling" href="model_management.html" />
    <link rel="prev" title="Source catalogs" href="catalog.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html" class="icon icon-home"> gammapy
          </a>
              <div class="version">
                0.19
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption"><span class="caption-text">User Guide</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../overview/index.html">Overview</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../overview/analysis.html">Gamma-ray data analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../overview/package.html">Package Structure</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../overview/package.html#data-access-and-selection-dl3">Data access and selection (DL3)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../overview/package.html#data-reduction-dl3-to-dl4">Data reduction (DL3 to DL4)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../overview/package.html#datasets-dl4">Datasets (DL4)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../overview/package.html#modeling-and-fitting-dl4-to-dl5">Modeling and Fitting (DL4 to DL5)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../overview/package.html#high-level-analysis-interface">High Level Analysis Interface</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../overview/package.html#other">Other</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../overview/package.html#what-next">What next?</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../overview/dependencies.html">Dependencies</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../overview/dependencies.html#required-dependencies">Required dependencies</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../overview/dependencies.html#optional-dependencies">Optional dependencies</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../getting-started/index.html">Getting started</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../getting-started/quickstart.html">Quickstart</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../getting-started/quickstart.html#installation-using-anaconda">Installation using Anaconda</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../getting-started/quickstart.html#download-tutorials">Download tutorials</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../getting-started/quickstart.html#what-next">What next?</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../getting-started/install.html">Installation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../getting-started/install.html#using-anaconda">Using Anaconda</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../getting-started/install.html#using-virtual-environments">Using virtual environments</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../getting-started/install.html#using-pip">Using pip</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../getting-started/install.html#using-other-package-managers">Using other package managers</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../getting-started/usage.html">Using Gammapy</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../getting-started/usage.html#jupyter-notebooks">Jupyter notebooks</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../getting-started/usage.html#id2">Python</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../getting-started/usage.html#id3">IPython</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../getting-started/usage.html#python-scripts">Python scripts</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../getting-started/troubleshooting.html">Troubleshooting</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../getting-started/troubleshooting.html#check-your-setup">Check your setup</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../getting-started/troubleshooting.html#install-issues">Install issues</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../getting-started/troubleshooting.html#help">Help!?</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Tutorials</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../index.html#introduction">Introduction</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../starting/analysis_1.html">High level interface</a></li>
<li class="toctree-l3"><a class="reference internal" href="../starting/analysis_2.html">Low level API</a></li>
<li class="toctree-l3"><a class="reference internal" href="../starting/overview.html">Data structures</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#data-exploration">Data exploration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../data/cta.html">CTA with Gammapy</a></li>
<li class="toctree-l3"><a class="reference internal" href="../data/hess.html">H.E.S.S. with Gammapy</a></li>
<li class="toctree-l3"><a class="reference internal" href="../data/fermi_lat.html">Fermi-LAT with Gammapy</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#data-analysis">Data analysis</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../index.html#d-spectral">1D Spectral</a></li>
<li class="toctree-l3"><a class="reference internal" href="../index.html#d-image">2D Image</a></li>
<li class="toctree-l3"><a class="reference internal" href="../index.html#d-cube">3D Cube</a></li>
<li class="toctree-l3"><a class="reference internal" href="../index.html#time">Time</a></li>
</ul>
</li>
<li class="toctree-l2 current"><a class="reference internal" href="../index.html#package-api">Package / API</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="makers.html">Makers - Data reduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="catalog.html">Source catalogs</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Models</a></li>
<li class="toctree-l3"><a class="reference internal" href="model_management.html">Modelling</a></li>
<li class="toctree-l3"><a class="reference internal" href="fitting.html">Fitting</a></li>
<li class="toctree-l3"><a class="reference internal" href="maps.html">Maps</a></li>
<li class="toctree-l3"><a class="reference internal" href="mask_maps.html">Mask maps</a></li>
<li class="toctree-l3"><a class="reference internal" href="astro_dark_matter.html">Dark matter spatial and spectral models</a></li>
<li class="toctree-l3"><a class="reference internal" href="datasets.html">Datasets - Reduced data, IRFs, models</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#scripts">Scripts</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../survey_map.html">Survey map</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../modeling/gallery/index.html">Model gallery</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../modeling/gallery/index.html#spatial-models">Spatial models</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../modeling/gallery/spatial/plot_constant.html">Constant spatial model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../modeling/gallery/spatial/plot_disk.html">Disk spatial model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../modeling/gallery/spatial/plot_gauss.html">Gaussian spatial model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../modeling/gallery/spatial/plot_gen_gauss.html">Generalized gaussian spatial model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../modeling/gallery/spatial/plot_point.html">Point spatial model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../modeling/gallery/spatial/plot_shell.html">Shell spatial model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../modeling/gallery/spatial/plot_shell2.html">Shell2 spatial model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../modeling/gallery/spatial/plot_template.html">Template spatial model</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../modeling/gallery/index.html#spectral-models">Spectral models</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../modeling/gallery/spectral/plot_absorbed.html">EBL absorbption spectral model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../modeling/gallery/spectral/plot_broken_powerlaw.html">Broken power law spectral model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../modeling/gallery/spectral/plot_compound.html">Compound spectral model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../modeling/gallery/spectral/plot_constant_spectral.html">Constant spectral model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../modeling/gallery/spectral/plot_exp_cutoff_powerlaw.html">Exponential cutoff power law spectral model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../modeling/gallery/spectral/plot_exp_cutoff_powerlaw_3fgl.html">Exponential cutoff power law spectral model used for 3FGL</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../modeling/gallery/spectral/plot_gauss_spectral.html">Gaussian spectral model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../modeling/gallery/spectral/plot_logparabola.html">Log parabola spectral model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../modeling/gallery/spectral/plot_naima.html">Naima spectral model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../modeling/gallery/spectral/plot_piecewise_norm_spectral.html">Piecewise  norm spectral model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../modeling/gallery/spectral/plot_powerlaw.html">Power law spectral model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../modeling/gallery/spectral/plot_powerlaw2.html">Power law 2 spectral model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../modeling/gallery/spectral/plot_smooth_broken_powerlaw.html">Smooth broken power law spectral model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../modeling/gallery/spectral/plot_super_exp_cutoff_powerlaw_3fgl.html">Super exponential cutoff power law model used for 3FGL</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../modeling/gallery/spectral/plot_super_exp_cutoff_powerlaw_4fgl.html">Super exponential cutoff power law model used for 4FGL</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../modeling/gallery/spectral/plot_template_spectral.html">Template spectral model</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../modeling/gallery/index.html#temporal-models">Temporal models</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../modeling/gallery/temporal/plot_constant_temporal.html">Constant temporal model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../modeling/gallery/temporal/plot_expdecay_temporal.html">ExpDecay temporal model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../modeling/gallery/temporal/plot_gaussian_temporal.html">Gaussian temporal model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../modeling/gallery/temporal/plot_linear_temporal.html">Linear temporal model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../modeling/gallery/temporal/plot_powerlaw_temporal.html">PowerLaw temporal model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../modeling/gallery/temporal/plot_sine_temporal.html">Sine temporal model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../modeling/gallery/temporal/plot_template_temporal.html">Light curve temporal model</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../howto.html">How-to</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../howto.html#spell-and-pronounce-gammapy">Spell and pronounce Gammapy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../howto.html#access-iact-dl3-data">Access IACT DL3 data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../howto.html#select-observations">Select observations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../howto.html#make-a-on-axis-equivalent-livetime-map">Make a on-axis equivalent livetime map</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../howto.html#check-irfs">Check IRFs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../howto.html#model-2d-images">Model 2D images</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../howto.html#extract-1d-spectra">Extract 1D spectra</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../howto.html#extract-a-lightcurve">Extract a lightcurve</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../howto.html#choose-units-for-plotting">Choose units for plotting</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../howto.html#compute-source-significance">Compute source significance</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../howto.html#compute-cumulative-significance">Compute cumulative significance</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../howto.html#detect-sources-in-a-map">Detect sources in a map</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../howto.html#astrophysical-source-modeling">Astrophysical source modeling</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../howto.html#implement-a-custom-model">Implement a custom model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../howto.html#implement-an-energy-dependent-spatial-models">Implement an energy dependent spatial models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../howto.html#reduce-memory-budget-for-large-datasets">Reduce memory budget for large datasets</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../howto.html#copy-part-of-a-data-store">Copy part of a data store</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../howto.html#interpolate-maps-onto-a-different-geometry">Interpolate maps onto a different geometry</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../howto.html#suppress-warnings">Suppress warnings</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../references.html">Glossary and references</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../references.html#glossary">Glossary</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../references.html#publications">References</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../references.html#other-gamma-ray-packages">Other gamma-ray packages</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../references.html#other-useful-packages">Other useful packages</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../changelog.html">Changelog</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../changelog.html#nov-22nd-2021">0.19 (Nov 22nd, 2021)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../changelog.html#pull-requests">Pull Requests</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../changelog.html#nov-19th-2020">0.18.2 (Nov 19th, 2020)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../changelog.html#id2">Pull Requests</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../changelog.html#nov-6th-2020">0.18.1 (Nov 6th, 2020)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../changelog.html#id3">Pull Requests</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../changelog.html#nov-4th-2020">0.18 (Nov 4th, 2020)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../changelog.html#id4">Pull Requests</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../changelog.html#apr-1-2020">0.17 (Apr 1, 2020)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../changelog.html#summary">Summary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../changelog.html#id5">Pull Requests</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../changelog.html#feb-1-2020">0.16 (Feb 1, 2020)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../changelog.html#id6">Summary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../changelog.html#id7">Pull Requests</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../changelog.html#dec-3-2019">0.15 (Dec 3, 2019)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../changelog.html#id8">Summary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../changelog.html#id9">Pull Requests</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../changelog.html#sep-30-2019">0.14 (Sep 30, 2019)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../changelog.html#id10">Summary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../changelog.html#id11">Pull Requests</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../changelog.html#jul-26-2019">0.13 (Jul 26, 2019)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../changelog.html#id12">Summary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../changelog.html#id13">Pull Requests</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../changelog.html#may-30-2019">0.12 (May 30, 2019)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../changelog.html#id14">Summary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../changelog.html#id15">Pull Requests</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../changelog.html#mar-29-2019">0.11 (Mar 29, 2019)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../changelog.html#id16">Summary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../changelog.html#id17">Pull requests</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../changelog.html#jan-28-2019">0.10 (Jan 28, 2019)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../changelog.html#id18">Summary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../changelog.html#id19">Pull requests</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../changelog.html#nov-29-2018">0.9 (Nov 29, 2018)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../changelog.html#id20">Summary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../changelog.html#id21">Pull requests</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../changelog.html#sep-23-2018">0.8 (Sep 23, 2018)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../changelog.html#id22">Summary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../changelog.html#id23">Pull requests</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../changelog.html#feb-28-2018">0.7 (Feb 28, 2018)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../changelog.html#id24">Summary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../changelog.html#id25">Pull requests</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../changelog.html#apr-28-2017">0.6 (Apr 28, 2017)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../changelog.html#id26">Summary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../changelog.html#id27">Pull requests</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../changelog.html#nov-22-2016">0.5 (Nov 22, 2016)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../changelog.html#id28">Summary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../changelog.html#id29">Pull requests</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../changelog.html#apr-20-2016">0.4 (Apr 20, 2016)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../changelog.html#id30">Summary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../changelog.html#id31">Pull requests</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../changelog.html#aug-13-2015">0.3 (Aug 13, 2015)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../changelog.html#id32">Summary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../changelog.html#id33">Pull requests</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../changelog.html#apr-13-2015">0.2 (Apr 13, 2015)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../changelog.html#id34">Summary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../changelog.html#id35">Pull requests</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../changelog.html#aug-25-2014">0.1 (Aug 25, 2014)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../changelog.html#id36">Summary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../changelog.html#id37">Pull requests</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference external" href="https://gammapy.org/news.html#releases">List of releases</a></li>
</ul>
<p class="caption"><span class="caption-text">Gammapy Package</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../analysis/index.html">analysis - High level interface</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../analysis/index.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../analysis/index.html#using-gammapy-analysis">Using <code class="xref py py-obj docutils literal notranslate"><span class="pre">gammapy.analysis</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="../starting/analysis_1.html">High level interface</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../analysis/index.html#reference-api">Reference/API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../analysis/index.html#module-gammapy.analysis">gammapy.analysis Package</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../data/index.html">data - DL3 data access and observations</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../data/index.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../data/index.html#getting-started">Getting started</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../data/index.html#the-index-tables">The index tables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../data/index.html#working-with-event-lists">Working with event lists</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../data/index.html#combining-event-lists-and-gtis">Combining event lists and GTIs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../data/index.html#writing-event-lists-and-gtis-to-file">Writing event lists and GTIs to file</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../data/index.html#using-gammapy-data">Using <code class="xref py py-obj docutils literal notranslate"><span class="pre">gammapy.data</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="../data/cta.html">CTA with Gammapy</a></li>
<li class="toctree-l3"><a class="reference internal" href="../data/hess.html">H.E.S.S. with Gammapy</a></li>
<li class="toctree-l3"><a class="reference internal" href="../data/fermi_lat.html">Fermi-LAT with Gammapy</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../data/index.html#reference-api">Reference/API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../data/index.html#module-gammapy.data">gammapy.data Package</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../makers/index.html">makers - Data reduction</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../makers/index.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../makers/index.html#using-gammapy-makers">Using <code class="xref py py-obj docutils literal notranslate"><span class="pre">gammapy.makers</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="makers.html">Makers - Data reduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../starting/analysis_2.html">Low level API</a></li>
<li class="toctree-l3"><a class="reference internal" href="../analysis/3D/analysis_3d.html">3D detailed analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="../analysis/3D/simulate_3d.html">3D map simulation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../analysis/1D/spectral_analysis.html">Spectral analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="../analysis/1D/spectrum_simulation.html">1D spectrum simulation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../makers/fov.html">FoV background</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../makers/reflected.html">Reflected regions background</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../makers/ring.html">Ring background</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../makers/index.html#reference-api">Reference/API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../makers/index.html#module-gammapy.makers">gammapy.makers Package</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../datasets/index.html">datasets - Reduced datasets</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../datasets/index.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../datasets/index.html#types-of-supported-datasets">Types of supported datasets</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../datasets/index.html#predicted-counts">Predicted counts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../datasets/index.html#stacking-multiple-datasets">Stacking Multiple Datasets</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../datasets/index.html#joint-analysis">Joint Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../datasets/index.html#using-gammapy-datasets">Using <code class="xref py py-obj docutils literal notranslate"><span class="pre">gammapy.datasets</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="datasets.html">Datasets - Reduced data, IRFs, models</a></li>
<li class="toctree-l3"><a class="reference internal" href="model_management.html">Modelling</a></li>
<li class="toctree-l3"><a class="reference internal" href="../analysis/1D/sed_fitting.html">Flux point fitting</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../datasets/index.html#reference-api">Reference/API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../datasets/index.html#module-gammapy.datasets">gammapy.datasets Package</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="../../modeling/index.html">modeling - Models and fitting</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../modeling/index.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../modeling/index.html#built-in-models">Built-in models</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../modeling/index.html#using-gammapy-modeling">Using <code class="xref py py-obj docutils literal notranslate"><span class="pre">gammapy.modeling</span></code></a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">Models</a></li>
<li class="toctree-l3"><a class="reference internal" href="fitting.html">Fitting</a></li>
<li class="toctree-l3"><a class="reference internal" href="model_management.html">Modelling</a></li>
<li class="toctree-l3"><a class="reference internal" href="../analysis/3D/analysis_3d.html">3D detailed analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="../analysis/1D/spectral_analysis.html">Spectral analysis</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../modeling/index.html#reference-api">Reference/API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../modeling/index.html#module-gammapy.modeling">gammapy.modeling Package</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../modeling/index.html#module-gammapy.modeling.models">gammapy.modeling.models Package</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../estimators/index.html">estimators - High level estimators</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../estimators/index.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../estimators/index.html#getting-started">Getting started</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../estimators/index.html#flux-maps">Flux maps</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../estimators/index.html#flux-points">Flux points</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../estimators/index.html#using-gammapy-estimators">Using <code class="xref py py-obj docutils literal notranslate"><span class="pre">gammapy.estimators</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="../analysis/time/light_curve.html">Light curves</a></li>
<li class="toctree-l3"><a class="reference internal" href="../analysis/time/light_curve_flare.html">Light curves for flares</a></li>
<li class="toctree-l3"><a class="reference internal" href="../analysis/2D/detect.html">Source detection and significance maps</a></li>
<li class="toctree-l3"><a class="reference internal" href="../analysis/1D/spectral_analysis.html">Spectral analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="../analysis/3D/analysis_3d.html">3D detailed analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="../analysis/3D/flux_profiles.html">Flux Profile Estimation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../estimators/index.html#reference-api">Reference/API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../estimators/index.html#module-gammapy.estimators">gammapy.estimators Package</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../irf/index.html">irf - Instrument response functions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../irf/index.html#introduction">Introduction</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../irf/index.html#irf-axis-naming">IRF axis naming</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../irf/index.html#getting-started">Getting started</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../irf/index.html#using-gammapy-irf">Using <code class="xref py py-obj docutils literal notranslate"><span class="pre">gammapy.irf</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../irf/theory.html">IRF Theory</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../irf/aeff.html">Effective area</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../irf/edisp.html">Energy Dispersion</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../irf/psf.html">Point Spread Function</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../irf/bkg.html">Background</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../irf/index.html#reference-api">Reference/API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../irf/index.html#module-gammapy.irf">gammapy.irf Package</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../maps/index.html">maps - Sky maps</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../maps/index.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../maps/index.html#getting-started">Getting started</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../maps/index.html#differential-and-integral-maps">Differential and integral maps</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../maps/index.html#accessor-methods">Accessor methods</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../maps/index.html#interface-with-mapcoord-and-skycoord">Interface with <code class="xref py py-obj docutils literal notranslate"><span class="pre">MapCoord</span></code> and <code class="xref py py-obj docutils literal notranslate"><span class="pre">SkyCoord</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../maps/index.html#mapcoord">MapCoord</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../maps/index.html#using-gammapy-maps">Using <code class="xref py py-obj docutils literal notranslate"><span class="pre">gammapy.maps</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="maps.html">Maps</a></li>
<li class="toctree-l3"><a class="reference internal" href="../analysis/3D/analysis_3d.html">3D detailed analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="../analysis/3D/simulate_3d.html">3D map simulation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../data/fermi_lat.html">Fermi-LAT with Gammapy</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../maps/hpxmap.html">HEALPix-based maps</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../maps/regionmap.html">RegionGeom and RegionNDMap</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../maps/index.html#reference-api">Reference/API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../maps/index.html#module-gammapy.maps">gammapy.maps Package</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../catalog/index.html">catalog - Source catalogs</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../catalog/index.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../catalog/index.html#using-gammapy-catalog">Using <code class="xref py py-obj docutils literal notranslate"><span class="pre">gammapy.catalog</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="catalog.html">Source catalogs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../starting/overview.html">Data structures</a></li>
<li class="toctree-l3"><a class="reference internal" href="../analysis/1D/sed_fitting.html">Flux point fitting</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../catalog/index.html#reference-api">Reference/API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../catalog/index.html#module-gammapy.catalog">gammapy.catalog Package</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../astro/index.html">astro - Astrophysics</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../astro/index.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../astro/index.html#getting-started">Getting started</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../astro/index.html#sub-packages">Sub-packages</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../astro/source/index.html">Astrophysical source models (<code class="xref py py-obj docutils literal notranslate"><span class="pre">gammapy.astro.source</span></code>)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../astro/population/index.html">Astrophysical source population models (<code class="xref py py-obj docutils literal notranslate"><span class="pre">gammapy.astro.population</span></code>)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../astro/darkmatter/index.html">Dark matter (<code class="xref py py-obj docutils literal notranslate"><span class="pre">gammapy.astro.darkmatter</span></code>)</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../scripts/index.html">scripts - Command line tools</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../scripts/index.html#introduction">Introduction</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../scripts/index.html#execute">Execute</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../scripts/index.html#running-config-driven-data-reduction">Running config driven data reduction</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../scripts/index.html#write-your-own-cli">Write your own CLI</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../scripts/index.html#troubleshooting">Troubleshooting</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../scripts/index.html#command-not-found">Command not found</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../scripts/index.html#reference">Reference</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../scripts/index.html#gammapy">gammapy</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../stats/index.html">stats - Statistics</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../stats/index.html#introduction">Introduction</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../stats/index.html#notations">Notations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../stats/index.html#counts-and-fit-statistics">Counts and fit statistics</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../stats/index.html#estimating-ts">Estimating TS</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../stats/index.html#counts-statistics-classes">Counts statistics classes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../stats/index.html#cash-counts-statistic">Cash counts statistic</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../stats/index.html#wstat-counts-statistic">WStat counts statistic</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../stats/index.html#using-gammapy-stats">Using <code class="xref py py-obj docutils literal notranslate"><span class="pre">gammapy.stats</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../stats/fit_statistics.html">Fit statistics</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../stats/wstat_derivation.html">Derivation of the WStat formula</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../stats/index.html#reference-api">Reference/API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../stats/index.html#module-gammapy.stats">gammapy.stats Package</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../visualization/index.html">visualization - Plotting and visualization</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../visualization/index.html#getting-started">Getting started</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../visualization/index.html#colormaps">Colormaps</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../visualization/index.html#survey-panel-plots">Survey panel plots</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../visualization/index.html#reference-api">Reference/API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../visualization/index.html#module-gammapy.visualization">gammapy.visualization Package</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../utils/index.html">utils - Utilities</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../utils/index.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../utils/index.html#time-handling-in-gammapy">Time handling in Gammapy</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../utils/index.html#time-format-and-scale">Time format and scale</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../utils/index.html#mission-elapsed-times-met">Mission elapsed times (MET)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../utils/index.html#time-differences">Time differences</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../utils/index.html#reference-api">Reference/API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../utils/index.html#module-gammapy.utils.units">gammapy.utils.units Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../utils/index.html#module-gammapy.utils.coordinates">gammapy.utils.coordinates Package</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../utils/index.html#module-gammapy.utils.integrate">gammapy.utils.integrate Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../utils/index.html#module-gammapy.utils.interpolation">gammapy.utils.interpolation Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../utils/index.html#module-gammapy.utils.table">gammapy.utils.table Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../utils/index.html#module-gammapy.utils.fits">gammapy.utils.fits Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../utils/index.html#module-gammapy.utils.random">gammapy.utils.random Package</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../utils/index.html#module-gammapy.utils.regions">gammapy.utils.regions Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../utils/index.html#module-gammapy.utils.scripts">gammapy.utils.scripts Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../utils/index.html#module-gammapy.utils.testing">gammapy.utils.testing Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../utils/index.html#module-gammapy.utils.time">gammapy.utils.time Module</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Developer Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../development/index.html">Developer documentation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../development/intro.html">How to contribute to Gammapy?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../development/release.html">How to make a Gammapy release</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../development/setup.html">Gammapy project setup</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../development/howto.html">Developer How To</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../development/pigs/index.html">PIGs</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../development/pigs/pig-001.html">PIG 1 - PIG purpose and guidelines</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../development/pigs/pig-002.html">PIG 2 - Organization of low level analysis code</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../development/pigs/pig-003.html">PIG 3 - Plan for dropping Python 2.7 support</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../development/pigs/pig-004.html">PIG 4 - Setup for tutorial notebooks and data</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../development/pigs/pig-005.html">PIG 5 - Gammapy 1.0 roadmap</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../development/pigs/pig-006.html">PIG 6 - CTA observation handling</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../development/pigs/pig-007.html">PIG 7 - Models</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../development/pigs/pig-008.html">PIG 8 - Datasets</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../development/pigs/pig-009.html">PIG 9 - Event sampling</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../development/pigs/pig-010.html">PIG 10 - Regions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../development/pigs/pig-011.html">PIG 11 - Light curves</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../development/pigs/pig-012.html">PIG 12 - High level interface</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../development/pigs/pig-013.html">PIG 13 - Gammapy dependencies and distribution</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../development/pigs/pig-014.html">PIG 14 - Uncertainty estimation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../development/pigs/pig-016.html">PIG 16 - Gammapy package structure</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../development/pigs/pig-018.html">PIG 18 - Documentation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../development/pigs/pig-019.html">PIG 19 - Gammapy package structure follow up</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../development/pigs/pig-020.html">PIG 20 - Global Model API</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../development/pigs/pig-021.html">PIG 21 - Models improvements</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../development/pigs/pig-022.html">PIG 22 - Unified flux estimators API</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">gammapy</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../index.html">Tutorials</a> &raquo;</li>
      <li>Models</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/tutorials/api/models.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="admonition note">
<p class="admonition-title fa fa-exclamation-circle"><strong>This is a fixed-text formatted version of a Jupyter notebook</strong></p>
<ul class="simple">
<li><p>Try online<a class="reference external" href="https://mybinder.org/v2/gh/gammapy/gammapy-webpage/v0.19?urlpath=lab/tree/api/models.ipynb"><img alt="Binder" src="https://static.mybinder.org/badge.svg" /></a></p></li>
<li><p>You may download all the notebooks in the documentation as a <a class="reference external" href="../../_downloads/notebooks-0.19.tar">tar file</a>.</p></li>
<li><p><strong>Source files:</strong> <a class="reference external" href="../../_static/notebooks/models.ipynb">models.ipynb</a> | <a class="reference external" href="../../_static/notebooks/models.py">models.py</a></p></li>
</ul>
</div>
<div class="section" id="Models">
<h1>Models<a class="headerlink" href="#Models" title="Permalink to this headline">¶</a></h1>
<p>This is an introduction and overview on how to work with models in Gammapy.</p>
<p>The sub-package <code class="docutils literal notranslate"><a href='../../modeling/index.html'>gammapy.modeling</a></code> contains all the functionality related to modeling and fitting data. This includes spectral, spatial and temporal model classes, as well as the fit and parameter API. We will cover the following topics in order:</p>
<ol class="arabic simple">
<li><p><a class="reference external" href="#Spectral-Models">Spectral Models</a></p></li>
<li><p><a class="reference external" href="#Spatial-Models">Spatial Models</a></p></li>
<li><p><a class="reference external" href="#Temporal-Models">Temporal Models</a></p></li>
<li><p><a class="reference external" href="#SkyModel">SkyModel</a></p></li>
<li><p><a class="reference external" href="#Modifying-model-parameters">Modifying model parameters</a></p></li>
<li><p><a class="reference external" href="#Model-Lists-and-Serialisation">Model Lists and Serialisation</a></p></li>
<li><p><a class="reference external" href="#Models-with-shared-parameter">Models with shared parameter</a></p></li>
<li><p><a class="reference external" href="#Implementing-a-Custom-Model">Implementing as Custom Model</a></p></li>
<li><p><a class="reference external" href="#Models-with-energy-dependent-morphology">Energy dependent models</a></p></li>
</ol>
<p>The models follow a naming scheme which contains the category as a suffix to the class name. An overview of all the available models can be found in the <a class="reference external" href="..\/modeling/gallery/index.html#spectral-models">model gallery</a>.</p>
<p>Note that there are separate tutorials, <a class="reference internal" href="model_management.html"><span class="doc">model_management</span></a> and <a class="reference internal" href="fitting.html"><span class="doc">fitting</span></a> that explains about <code class="docutils literal notranslate"><a href='../../modeling/index.html'>gammapy.modeling</a></code>, the Gammapy modeling and fitting framework. You have to read that to learn how to work with models in order to analyse data.</p>
<div class="section" id="Setup">
<h2>Setup<a class="headerlink" href="#Setup" title="Permalink to this headline">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">astropy</span> <span class="kn">import</span> <span class="n">units</span> <span class="k">as</span> <span class="n">u</span>
<span class="kn">from</span> <span class="nn">gammapy.maps</span> <span class="kn">import</span> <span class="n">Map</span><span class="p">,</span> <span class="n">WcsGeom</span><span class="p">,</span> <span class="n">MapAxis</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Spectral-models">
<h2>Spectral models<a class="headerlink" href="#Spectral-models" title="Permalink to this headline">¶</a></h2>
<p>All models are imported from the <code class="docutils literal notranslate"><a href='../../modeling/index.html#module-gammapy.modeling.models'>gammapy.modeling.models</a></code> namespace. Let’s start with a <code class="docutils literal notranslate"><span class="pre">PowerLawSpectralModel</span></code>:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">gammapy.modeling.models</span> <span class="kn">import</span> <span class="n">PowerLawSpectralModel</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">pwl</span> <span class="o">=</span> <span class="n">PowerLawSpectralModel</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pwl</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
PowerLawSpectralModel

  type      name     value         unit        error   min max frozen link
-------- --------- ---------- -------------- --------- --- --- ------ ----
spectral     index 2.0000e+00                0.000e+00 nan nan  False
spectral amplitude 1.0000e-12 cm-2 s-1 TeV-1 0.000e+00 nan nan  False
spectral reference 1.0000e+00            TeV 0.000e+00 nan nan   True
</pre></div></div>
</div>
<p>To get a list of all available spectral models you can import and print the spectral model registry or take a look at the <a class="reference external" href="..\/modeling/gallery/index.html#spectral-models">model gallery</a>:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">gammapy.modeling.models</span> <span class="kn">import</span> <span class="n">SPECTRAL_MODEL_REGISTRY</span>

<span class="nb">print</span><span class="p">(</span><span class="n">SPECTRAL_MODEL_REGISTRY</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Registry
--------

ConstantSpectralModel                  : [&#39;ConstantSpectralModel&#39;, &#39;const&#39;]
CompoundSpectralModel                  : [&#39;CompoundSpectralModel&#39;, &#39;compound&#39;]
PowerLawSpectralModel                  : [&#39;PowerLawSpectralModel&#39;, &#39;pl&#39;]
PowerLaw2SpectralModel                 : [&#39;PowerLaw2SpectralModel&#39;, &#39;pl-2&#39;]
BrokenPowerLawSpectralModel            : [&#39;BrokenPowerLawSpectralModel&#39;, &#39;bpl&#39;]
SmoothBrokenPowerLawSpectralModel      : [&#39;SmoothBrokenPowerLawSpectralModel&#39;, &#39;sbpl&#39;]
PiecewiseNormSpectralModel             : [&#39;PiecewiseNormSpectralModel&#39;, &#39;piecewise-norm&#39;]
ExpCutoffPowerLawSpectralModel         : [&#39;ExpCutoffPowerLawSpectralModel&#39;, &#39;ecpl&#39;]
ExpCutoffPowerLaw3FGLSpectralModel     : [&#39;ExpCutoffPowerLaw3FGLSpectralModel&#39;, &#39;ecpl-3fgl&#39;]
SuperExpCutoffPowerLaw3FGLSpectralModel: [&#39;SuperExpCutoffPowerLaw3FGLSpectralModel&#39;, &#39;secpl-3fgl&#39;]
SuperExpCutoffPowerLaw4FGLSpectralModel: [&#39;SuperExpCutoffPowerLaw4FGLSpectralModel&#39;, &#39;secpl-4fgl&#39;]
LogParabolaSpectralModel               : [&#39;LogParabolaSpectralModel&#39;, &#39;lp&#39;]
TemplateSpectralModel                  : [&#39;TemplateSpectralModel&#39;, &#39;template&#39;]
GaussianSpectralModel                  : [&#39;GaussianSpectralModel&#39;, &#39;gauss&#39;]
EBLAbsorptionNormSpectralModel         : [&#39;EBLAbsorptionNormSpectralModel&#39;, &#39;ebl-norm&#39;]
NaimaSpectralModel                     : [&#39;NaimaSpectralModel&#39;, &#39;naima&#39;]
ScaleSpectralModel                     : [&#39;ScaleSpectralModel&#39;, &#39;scale&#39;]
PowerLawNormSpectralModel              : [&#39;PowerLawNormSpectralModel&#39;, &#39;pl-norm&#39;]
LogParabolaNormSpectralModel           : [&#39;LogParabolaNormSpectralModel&#39;, &#39;lp-norm&#39;]
ExpCutoffPowerLawNormSpectralModel     : [&#39;ExpCutoffPowerLawNormSpectralModel&#39;, &#39;ecpl-norm&#39;]

</pre></div></div>
</div>
<p>Spectral models all come with default parameters. Different parameter values can be passed on creation of the model, either as a string defining the value and unit or as an <code class="docutils literal notranslate"><span class="pre">astropy.units.Quantity</span></code> object directly:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">amplitude</span> <span class="o">=</span> <span class="mf">1e-12</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">Unit</span><span class="p">(</span><span class="s2">&quot;TeV-1 cm-2 s-1&quot;</span><span class="p">)</span>
<span class="n">pwl</span> <span class="o">=</span> <span class="n">PowerLawSpectralModel</span><span class="p">(</span><span class="n">amplitude</span><span class="o">=</span><span class="n">amplitude</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="mf">2.2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>For convenience a <code class="docutils literal notranslate"><span class="pre">str</span></code> specifying the value and unit can be passed as well:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">pwl</span> <span class="o">=</span> <span class="n">PowerLawSpectralModel</span><span class="p">(</span><span class="n">amplitude</span><span class="o">=</span><span class="s2">&quot;2.7e-12 TeV-1 cm-2 s-1&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="mf">2.2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pwl</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
PowerLawSpectralModel

  type      name     value         unit        error   min max frozen link
-------- --------- ---------- -------------- --------- --- --- ------ ----
spectral     index 2.2000e+00                0.000e+00 nan nan  False
spectral amplitude 2.7000e-12 cm-2 s-1 TeV-1 0.000e+00 nan nan  False
spectral reference 1.0000e+00            TeV 0.000e+00 nan nan   True
</pre></div></div>
</div>
<p>The model can be evaluated at given energies by calling the model instance:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">energy</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">30</span><span class="p">]</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">TeV</span>
<span class="n">dnde</span> <span class="o">=</span> <span class="n">pwl</span><span class="p">(</span><span class="n">energy</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dnde</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[2.70000000e-12 2.40822469e-13 1.70358483e-14 1.51948705e-15] 1 / (cm2 s TeV)
</pre></div></div>
</div>
<p>The returned quantity is a differential photon flux.</p>
<p>For spectral models you can additionally compute the integrated and energy flux in a given energy range:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">flux</span> <span class="o">=</span> <span class="n">pwl</span><span class="o">.</span><span class="n">integral</span><span class="p">(</span><span class="n">energy_min</span><span class="o">=</span><span class="mi">1</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">TeV</span><span class="p">,</span> <span class="n">energy_max</span><span class="o">=</span><span class="mi">10</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">TeV</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">flux</span><span class="p">)</span>

<span class="n">eflux</span> <span class="o">=</span> <span class="n">pwl</span><span class="o">.</span><span class="n">energy_flux</span><span class="p">(</span><span class="n">energy_min</span><span class="o">=</span><span class="mi">1</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">TeV</span><span class="p">,</span> <span class="n">energy_max</span><span class="o">=</span><span class="mi">10</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">TeV</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">eflux</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
2.108034597491956e-12 1 / (cm2 s)
4.982075849517389e-12 TeV / (cm2 s)
</pre></div></div>
</div>
<p>This also works for a list or an array of integration boundaries:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">energy</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">30</span><span class="p">]</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">TeV</span>
<span class="n">flux</span> <span class="o">=</span> <span class="n">pwl</span><span class="o">.</span><span class="n">integral</span><span class="p">(</span><span class="n">energy_min</span><span class="o">=</span><span class="n">energy</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">energy_max</span><span class="o">=</span><span class="n">energy</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">flux</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[1.64794383e-12 4.60090769e-13 1.03978226e-13] 1 / (cm2 s)
</pre></div></div>
</div>
<p>In some cases it can be useful to find use the inverse of a spectral model, to find the energy at which a given flux is reached:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">dnde</span> <span class="o">=</span> <span class="mf">2.7e-12</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">Unit</span><span class="p">(</span><span class="s2">&quot;TeV-1 cm-2 s-1&quot;</span><span class="p">)</span>
<span class="n">energy</span> <span class="o">=</span> <span class="n">pwl</span><span class="o">.</span><span class="n">inverse</span><span class="p">(</span><span class="n">dnde</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">energy</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
1.0 TeV
</pre></div></div>
</div>
<p>As a convenience you can also plot any spectral model in a given energy range:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">pwl</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">energy_bounds</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">]</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">TeV</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;AxesSubplot:xlabel=&#39;Energy [TeV]&#39;, ylabel=&#39;dnde [1 / (cm2 s TeV)]&#39;&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_api_models_23_1.png" src="../../_images/tutorials_api_models_23_1.png" />
</div>
</div>
<div class="section" id="Norm-Spectral-Models">
<h3>Norm Spectral Models<a class="headerlink" href="#Norm-Spectral-Models" title="Permalink to this headline">¶</a></h3>
<p>Normed spectral models are a special class of Spectral Models, which have a dimension-less normalisation. These spectral models feature a norm parameter instead of amplitude and are named using the <code class="docutils literal notranslate"><span class="pre">NormSpectralModel</span></code> suffix. They <strong>must</strong> be used along with another spectral model, as a multiplicative correction factor according to their spectral shape. They can be typically used for adjusting template based models, or adding a EBL correction to some analytic model.</p>
<p>To check if a given <code class="docutils literal notranslate"><span class="pre">SpectralModel</span></code> is a norm model, you can simply look at the <code class="docutils literal notranslate"><span class="pre">is_norm_spectral_model</span></code> property</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># To see the available norm models shipped with gammapy:</span>
<span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">SPECTRAL_MODEL_REGISTRY</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">model</span><span class="o">.</span><span class="n">is_norm_spectral_model</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;class &#39;gammapy.modeling.models.spectral.PiecewiseNormSpectralModel&#39;&gt;
&lt;class &#39;gammapy.modeling.models.spectral.EBLAbsorptionNormSpectralModel&#39;&gt;
&lt;class &#39;gammapy.modeling.models.spectral.PowerLawNormSpectralModel&#39;&gt;
&lt;class &#39;gammapy.modeling.models.spectral.LogParabolaNormSpectralModel&#39;&gt;
&lt;class &#39;gammapy.modeling.models.spectral.ExpCutoffPowerLawNormSpectralModel&#39;&gt;
</pre></div></div>
</div>
<p>As an example, we see the <code class="docutils literal notranslate"><span class="pre">PowerLawNormSpectralModel</span></code></p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">gammapy.modeling.models</span> <span class="kn">import</span> <span class="n">PowerLawNormSpectralModel</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">pwl_norm</span> <span class="o">=</span> <span class="n">PowerLawNormSpectralModel</span><span class="p">(</span><span class="n">tilt</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pwl_norm</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
PowerLawNormSpectralModel

  type      name     value    unit   error   min max frozen link
-------- --------- ---------- ---- --------- --- --- ------ ----
spectral      norm 1.0000e+00      0.000e+00 nan nan  False
spectral      tilt 1.0000e-01      0.000e+00 nan nan   True
spectral reference 1.0000e+00  TeV 0.000e+00 nan nan   True
</pre></div></div>
</div>
<p>We can check the correction introduced at each energy</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">energy</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">30</span><span class="p">]</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">TeV</span>
<span class="n">pwl_norm</span><span class="p">(</span><span class="n">energy</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="math notranslate nohighlight">
$$[1.1279449,~1,~0.89595846,~0.79432823,~0.7116851] \; \mathrm{}$$</div></div>
</div>
<p>A typical use case of a norm model would be in applying spectral correction to a <code class="docutils literal notranslate"><span class="pre">TemplateSpectralModel</span></code>. A template model is defined by custom tabular values provided at initialization.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">gammapy.modeling.models</span> <span class="kn">import</span> <span class="n">TemplateSpectralModel</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">energy</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">30</span><span class="p">]</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">TeV</span>
<span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="mi">40</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">Unit</span><span class="p">(</span><span class="s2">&quot;TeV-1 s-1 cm-2&quot;</span><span class="p">)</span>
<span class="n">template</span> <span class="o">=</span> <span class="n">TemplateSpectralModel</span><span class="p">(</span><span class="n">energy</span><span class="p">,</span> <span class="n">values</span><span class="p">)</span>
<span class="n">template</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">energy_bounds</span><span class="o">=</span><span class="p">[</span><span class="mf">0.2</span><span class="p">,</span> <span class="mi">50</span><span class="p">]</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">TeV</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;template model&quot;</span><span class="p">)</span>
<span class="n">normed_template</span> <span class="o">=</span> <span class="n">template</span> <span class="o">*</span> <span class="n">pwl_norm</span>
<span class="n">normed_template</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">energy_bounds</span><span class="o">=</span><span class="p">[</span><span class="mf">0.2</span><span class="p">,</span> <span class="mi">50</span><span class="p">]</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">TeV</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;normed_template model&quot;</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_api_models_34_0.png" src="../../_images/tutorials_api_models_34_0.png" />
</div>
</div>
</div>
<div class="section" id="Compound-Spectral-Model">
<h3>Compound Spectral Model<a class="headerlink" href="#Compound-Spectral-Model" title="Permalink to this headline">¶</a></h3>
<p>A <code class="docutils literal notranslate"><span class="pre">CompoundSpectralModel</span></code> is an arithmetic combination of two spectral models. The model <code class="docutils literal notranslate"><span class="pre">normed_template</span></code> created in the preceding example is an example of a <code class="docutils literal notranslate"><span class="pre">CompoundSpectralModel</span></code></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="n">normed_template</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
CompoundSpectralModel
    Component 1 : TemplateSpectralModel

    Component 2 : PowerLawNormSpectralModel

  type      name     value    unit   error   min max frozen link
-------- --------- ---------- ---- --------- --- --- ------ ----
spectral      norm 1.0000e+00      0.000e+00 nan nan  False
spectral      tilt 1.0000e-01      0.000e+00 nan nan   True
spectral reference 1.0000e+00  TeV 0.000e+00 nan nan   True
    Operator : mul

</pre></div></div>
</div>
<p>To create an additive model, you can do simply:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">model_add</span> <span class="o">=</span> <span class="n">pwl</span> <span class="o">+</span> <span class="n">template</span>
<span class="nb">print</span><span class="p">(</span><span class="n">model_add</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
CompoundSpectralModel
    Component 1 : PowerLawSpectralModel

  type      name     value         unit        error   min max frozen link
-------- --------- ---------- -------------- --------- --- --- ------ ----
spectral     index 2.2000e+00                0.000e+00 nan nan  False
spectral amplitude 2.7000e-12 cm-2 s-1 TeV-1 0.000e+00 nan nan  False
spectral reference 1.0000e+00            TeV 0.000e+00 nan nan   True
    Component 2 : TemplateSpectralModel

    Operator : add

</pre></div></div>
</div>
</div>
</div>
<div class="section" id="Spatial-models">
<h2>Spatial models<a class="headerlink" href="#Spatial-models" title="Permalink to this headline">¶</a></h2>
<p>Spatial models are imported from the same <code class="docutils literal notranslate"><a href='../../modeling/index.html#module-gammapy.modeling.models'>gammapy.modeling.models</a></code> namespace, let’s start with a <code class="docutils literal notranslate"><span class="pre">GaussianSpatialModel</span></code>:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">gammapy.modeling.models</span> <span class="kn">import</span> <span class="n">GaussianSpatialModel</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">gauss</span> <span class="o">=</span> <span class="n">GaussianSpatialModel</span><span class="p">(</span><span class="n">lon_0</span><span class="o">=</span><span class="s2">&quot;0 deg&quot;</span><span class="p">,</span> <span class="n">lat_0</span><span class="o">=</span><span class="s2">&quot;0 deg&quot;</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="s2">&quot;0.2 deg&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">gauss</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
GaussianSpatialModel

  type   name   value    unit   error      min        max    frozen link
------- ----- ---------- ---- --------- ---------- --------- ------ ----
spatial lon_0 0.0000e+00  deg 0.000e+00        nan       nan  False
spatial lat_0 0.0000e+00  deg 0.000e+00 -9.000e+01 9.000e+01  False
spatial sigma 2.0000e-01  deg 0.000e+00  0.000e+00       nan  False
spatial     e 0.0000e+00      0.000e+00  0.000e+00 1.000e+00   True
spatial   phi 0.0000e+00  deg 0.000e+00        nan       nan   True
</pre></div></div>
</div>
<p>Again you can check the <code class="docutils literal notranslate"><span class="pre">SPATIAL_MODELS</span></code> registry to see which models are available or take a look at the <a class="reference external" href="..\/modeling/gallery/index.html#spatial-models">model gallery</a>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">gammapy.modeling.models</span> <span class="kn">import</span> <span class="n">SPATIAL_MODEL_REGISTRY</span>

<span class="nb">print</span><span class="p">(</span><span class="n">SPATIAL_MODEL_REGISTRY</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Registry
--------

ConstantSpatialModel           : [&#39;ConstantSpatialModel&#39;, &#39;const&#39;]
TemplateSpatialModel           : [&#39;TemplateSpatialModel&#39;, &#39;template&#39;]
DiskSpatialModel               : [&#39;DiskSpatialModel&#39;, &#39;disk&#39;]
GaussianSpatialModel           : [&#39;GaussianSpatialModel&#39;, &#39;gauss&#39;]
GeneralizedGaussianSpatialModel: [&#39;GeneralizedGaussianSpatialModel&#39;, &#39;gauss-general&#39;]
PointSpatialModel              : [&#39;PointSpatialModel&#39;, &#39;point&#39;]
ShellSpatialModel              : [&#39;ShellSpatialModel&#39;, &#39;shell&#39;]
Shell2SpatialModel             : [&#39;Shell2SpatialModel&#39;, &#39;shell2&#39;]

</pre></div></div>
</div>
<p>The default coordinate frame for all spatial models is <code class="docutils literal notranslate"><span class="pre">&quot;icrs&quot;</span></code>, but the frame can be modified using the <code class="docutils literal notranslate"><span class="pre">frame</span></code> argument:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">gauss</span> <span class="o">=</span> <span class="n">GaussianSpatialModel</span><span class="p">(</span>
    <span class="n">lon_0</span><span class="o">=</span><span class="s2">&quot;0 deg&quot;</span><span class="p">,</span> <span class="n">lat_0</span><span class="o">=</span><span class="s2">&quot;0 deg&quot;</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="s2">&quot;0.2 deg&quot;</span><span class="p">,</span> <span class="n">frame</span><span class="o">=</span><span class="s2">&quot;galactic&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<p>You can specify any valid <code class="docutils literal notranslate"><span class="pre">astropy.coordinates</span></code> frame. The center position of the model can be retrieved as a <code class="docutils literal notranslate"><span class="pre">astropy.coordinates.SkyCoord</span></code> object using <code class="docutils literal notranslate"><span class="pre">SpatialModel.position</span></code>:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="n">gauss</span><span class="o">.</span><span class="n">position</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;SkyCoord (Galactic): (l, b) in deg
    (0., 0.)&gt;
</pre></div></div>
</div>
<p>Spatial models can be evaluated again by calling the instance:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">lon</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">]</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">deg</span>
<span class="n">lat</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">]</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">deg</span>

<span class="n">flux_per_omega</span> <span class="o">=</span> <span class="n">gauss</span><span class="p">(</span><span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">flux_per_omega</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[13061.88470839 10172.60603928] 1 / sr
</pre></div></div>
</div>
<p>The returned quantity corresponds to a surface brightness. Spatial model can be also evaluated using <code class="docutils literal notranslate"><a href='../../api/gammapy.maps.Map.html#gammapy.maps.Map'>gammapy.maps.Map</a></code> and <code class="docutils literal notranslate"><a href='../../api/gammapy.maps.Geom.html#gammapy.maps.Geom'>gammapy.maps.Geom</a></code> objects:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">m</span> <span class="o">=</span> <span class="n">Map</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">skydir</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">width</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">binsz</span><span class="o">=</span><span class="mf">0.02</span><span class="p">,</span> <span class="n">frame</span><span class="o">=</span><span class="s2">&quot;galactic&quot;</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">quantity</span> <span class="o">=</span> <span class="n">gauss</span><span class="o">.</span><span class="n">evaluate_geom</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">geom</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">add_cbar</span><span class="o">=</span><span class="kc">True</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_api_models_52_0.png" src="../../_images/tutorials_api_models_52_0.png" />
</div>
</div>
<p>Again for convenience the model can be plotted directly:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">gauss</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">add_cbar</span><span class="o">=</span><span class="kc">True</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_api_models_54_0.png" src="../../_images/tutorials_api_models_54_0.png" />
</div>
</div>
<p>All spatial models have an associated sky region to it e.g. to illustrate the extend of the model on a sky image. The returned object is an <code class="docutils literal notranslate"><span class="pre">regions.SkyRegion</span></code> object:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="n">gauss</span><span class="o">.</span><span class="n">to_region</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Region: EllipseSkyRegion
center: &lt;SkyCoord (Galactic): (l, b) in deg
    (0., 0.)&gt;
width: 0.6000000000000001 deg
height: 0.6000000000000001 deg
angle: 0.0 deg
</pre></div></div>
</div>
<p>Now we can plot the region on an sky image:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># create and plot the model</span>
<span class="n">gauss_elongated</span> <span class="o">=</span> <span class="n">GaussianSpatialModel</span><span class="p">(</span>
    <span class="n">lon_0</span><span class="o">=</span><span class="s2">&quot;0 deg&quot;</span><span class="p">,</span> <span class="n">lat_0</span><span class="o">=</span><span class="s2">&quot;0 deg&quot;</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="s2">&quot;0.2 deg&quot;</span><span class="p">,</span> <span class="n">e</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">phi</span><span class="o">=</span><span class="s2">&quot;45 deg&quot;</span>
<span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">gauss_elongated</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">add_cbar</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># add region illustration</span>
<span class="n">region</span> <span class="o">=</span> <span class="n">gauss_elongated</span><span class="o">.</span><span class="n">to_region</span><span class="p">()</span>
<span class="n">region_pix</span> <span class="o">=</span> <span class="n">region</span><span class="o">.</span><span class="n">to_pixel</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">wcs</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_artist</span><span class="p">(</span><span class="n">region_pix</span><span class="o">.</span><span class="n">as_artist</span><span class="p">(</span><span class="n">ec</span><span class="o">=</span><span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="s2">&quot;None&quot;</span><span class="p">));</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_api_models_58_0.png" src="../../_images/tutorials_api_models_58_0.png" />
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">.to_region()</span></code> method can also be useful to write e.g. ds9 region files using <code class="docutils literal notranslate"><span class="pre">write_ds9</span></code> from the <code class="docutils literal notranslate"><span class="pre">regions</span></code> package:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">regions</span> <span class="kn">import</span> <span class="n">write_ds9</span>

<span class="n">regions</span> <span class="o">=</span> <span class="p">[</span><span class="n">gauss</span><span class="o">.</span><span class="n">to_region</span><span class="p">(),</span> <span class="n">gauss_elongated</span><span class="o">.</span><span class="n">to_region</span><span class="p">()]</span>

<span class="n">filename</span> <span class="o">=</span> <span class="s2">&quot;regions.reg&quot;</span>
<span class="n">write_ds9</span><span class="p">(</span>
    <span class="n">regions</span><span class="p">,</span>
    <span class="n">filename</span><span class="p">,</span>
    <span class="n">coordsys</span><span class="o">=</span><span class="s2">&quot;galactic&quot;</span><span class="p">,</span>
    <span class="n">fmt</span><span class="o">=</span><span class="s2">&quot;.4f&quot;</span><span class="p">,</span>
    <span class="n">radunit</span><span class="o">=</span><span class="s2">&quot;deg&quot;</span><span class="p">,</span>
    <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
WARNING: AstropyDeprecationWarning: The write_ds9 function is deprecated and may be removed in a future version.
        Use `regions.Regions.write` instead. [warnings]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">!</span>cat regions.reg
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
# Region file format: DS9 astropy/regions
galactic
ellipse(0.0000,0.0000,0.3000,0.3000,0.0000)
ellipse(96.3373,-60.1886,0.2142,0.3000,45.0000)
</pre></div></div>
</div>
</div>
<div class="section" id="Temporal-models">
<h2>Temporal models<a class="headerlink" href="#Temporal-models" title="Permalink to this headline">¶</a></h2>
<p>Temporal models are imported from the same <code class="docutils literal notranslate"><a href='../../modeling/index.html#module-gammapy.modeling.models'>gammapy.modeling.models</a></code> namespace, let’s start with a <code class="docutils literal notranslate"><span class="pre">GaussianTemporalModel</span></code>:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">gammapy.modeling.models</span> <span class="kn">import</span> <span class="n">GaussianTemporalModel</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[34]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">gauss_temp</span> <span class="o">=</span> <span class="n">GaussianTemporalModel</span><span class="p">(</span><span class="n">t_ref</span><span class="o">=</span><span class="mf">59240.0</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">d</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mf">2.0</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">d</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">gauss_temp</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
GaussianTemporalModel

  type    name   value    unit   error   min max frozen link
-------- ----- ---------- ---- --------- --- --- ------ ----
temporal t_ref 5.9240e+04    d 0.000e+00 nan nan  False
temporal sigma 2.0000e+00    d 0.000e+00 nan nan  False
</pre></div></div>
</div>
<p>To check the <code class="docutils literal notranslate"><span class="pre">TEMPORAL_MODELS</span></code> registry to see which models are available:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[35]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">gammapy.modeling.models</span> <span class="kn">import</span> <span class="n">TEMPORAL_MODEL_REGISTRY</span>

<span class="nb">print</span><span class="p">(</span><span class="n">TEMPORAL_MODEL_REGISTRY</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Registry
--------

ConstantTemporalModel          : [&#39;ConstantTemporalModel&#39;, &#39;const&#39;]
LinearTemporalModel            : [&#39;LinearTemporalModel&#39;, &#39;linear&#39;]
LightCurveTemplateTemporalModel: [&#39;LightCurveTemplateTemporalModel&#39;, &#39;template&#39;]
ExpDecayTemporalModel          : [&#39;ExpDecayTemporalModel&#39;, &#39;exp-decay&#39;]
GaussianTemporalModel          : [&#39;GaussianTemporalModel&#39;, &#39;gauss&#39;]
PowerLawTemporalModel          : [&#39;PowerLawTemporalModel&#39;, &#39;powerlaw&#39;]
SineTemporalModel              : [&#39;SineTemporalModel&#39;, &#39;sinus&#39;]

</pre></div></div>
</div>
<p>Temporal models can be evaluated on <code class="docutils literal notranslate"><span class="pre">astropy.time.Time</span></code> objects. The returned quantity is a dimensionless number</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[36]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">astropy.time</span> <span class="kn">import</span> <span class="n">Time</span>

<span class="n">time</span> <span class="o">=</span> <span class="n">Time</span><span class="p">(</span><span class="s2">&quot;2021-01-29 00:00:00.000&quot;</span><span class="p">)</span>
<span class="n">gauss_temp</span><span class="p">(</span><span class="n">time</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[36]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="math notranslate nohighlight">
$$0.32465247 \; \mathrm{}$$</div></div>
</div>
<p>As for other models, they can be plotted in a given time range</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[37]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">time</span> <span class="o">=</span> <span class="n">Time</span><span class="p">([</span><span class="mf">59233.0</span><span class="p">,</span> <span class="mi">59250</span><span class="p">],</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;mjd&quot;</span><span class="p">)</span>
<span class="n">gauss_temp</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[37]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;AxesSubplot:xlabel=&#39;Time [mjd]&#39;, ylabel=&#39;Norm / A.U.&#39;&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_api_models_71_1.png" src="../../_images/tutorials_api_models_71_1.png" />
</div>
</div>
</div>
<div class="section" id="SkyModel">
<h2>SkyModel<a class="headerlink" href="#SkyModel" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><a href='../../api/gammapy.modeling.models.SkyModel.html#gammapy.modeling.models.SkyModel'>gammapy.modeling.models.SkyModel</a></code> class combines a spectral, and optionally, a spatial model and a temporal. It can be created from existing spectral, spatial and temporal model components:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[38]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">gammapy.modeling.models</span> <span class="kn">import</span> <span class="n">SkyModel</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">SkyModel</span><span class="p">(</span>
    <span class="n">spectral_model</span><span class="o">=</span><span class="n">pwl</span><span class="p">,</span>
    <span class="n">spatial_model</span><span class="o">=</span><span class="n">gauss</span><span class="p">,</span>
    <span class="n">temporal_model</span><span class="o">=</span><span class="n">gauss_temp</span><span class="p">,</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;my-source&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
SkyModel

  Name                      : my-source
  Datasets names            : None
  Spectral model type       : PowerLawSpectralModel
  Spatial  model type       : GaussianSpatialModel
  Temporal model type       : GaussianTemporalModel
  Parameters:
    index                   :      2.200   +/-    0.00
    amplitude               :   2.70e-12   +/- 0.0e+00 1 / (cm2 s TeV)
    reference    (frozen)   :      1.000       TeV
    lon_0                   :      0.000   +/-    0.00 deg
    lat_0                   :      0.000   +/-    0.00 deg
    sigma                   :      0.200   +/-    0.00 deg
    e            (frozen)   :      0.000
    phi          (frozen)   :      0.000       deg
    t_ref                   :  59240.000   +/-    0.00 d
    sigma                   :      2.000   +/-    0.00 d


</pre></div></div>
</div>
<p>It is good practice to specify a name for your sky model, so that you can access it later by name and have meaningful identifier you serilisation. If you don’t define a name, a unique random name is generated:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[39]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">model_without_name</span> <span class="o">=</span> <span class="n">SkyModel</span><span class="p">(</span><span class="n">spectral_model</span><span class="o">=</span><span class="n">pwl</span><span class="p">,</span> <span class="n">spatial_model</span><span class="o">=</span><span class="n">gauss</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">model_without_name</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
ZNry7RGz
</pre></div></div>
</div>
<p>The individual components of the source model can be accessed using <code class="docutils literal notranslate"><span class="pre">.spectral_model</span></code>, <code class="docutils literal notranslate"><span class="pre">.spatial_model</span></code> and <code class="docutils literal notranslate"><span class="pre">.temporal_model</span></code>:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[40]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">model</span><span class="o">.</span><span class="n">spectral_model</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[40]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;gammapy.modeling.models.spectral.PowerLawSpectralModel at 0x12a832790&gt;
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[41]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">model</span><span class="o">.</span><span class="n">spatial_model</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[41]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;gammapy.modeling.models.spatial.GaussianSpatialModel at 0x12b1a5550&gt;
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[42]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">model</span><span class="o">.</span><span class="n">temporal_model</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[42]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;gammapy.modeling.models.temporal.GaussianTemporalModel at 0x12b7f7190&gt;
</pre></div></div>
</div>
<p>And can be used as you have seen already seen above:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[43]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">model</span><span class="o">.</span><span class="n">spectral_model</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">energy_bounds</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">TeV</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_api_models_82_0.png" src="../../_images/tutorials_api_models_82_0.png" />
</div>
</div>
<p>Note that the gammapy fitting can interface only with a <code class="docutils literal notranslate"><span class="pre">SkyModel</span></code> and <strong>not</strong> its individual components. So, it is customary to work with <code class="docutils literal notranslate"><span class="pre">SkyModel</span></code> even if you are not doing a 3D fit. Since the amplitude parameter resides on the <code class="docutils literal notranslate"><span class="pre">SpectralModel</span></code>, specifying a spectral component is compulsory. The temporal and spatial components are optional. The temporal model needs to be specified only for timing analysis. In some cases (e.g. when doing a spectral analysis) there is no need for a spatial
component either, and only a spectral model is associated with the source.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[44]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">model_spectrum</span> <span class="o">=</span> <span class="n">SkyModel</span><span class="p">(</span><span class="n">spectral_model</span><span class="o">=</span><span class="n">pwl</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;source-spectrum&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">model_spectrum</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
SkyModel

  Name                      : source-spectrum
  Datasets names            : None
  Spectral model type       : PowerLawSpectralModel
  Spatial  model type       :
  Temporal model type       :
  Parameters:
    index                   :      2.200   +/-    0.00
    amplitude               :   2.70e-12   +/- 0.0e+00 1 / (cm2 s TeV)
    reference    (frozen)   :      1.000       TeV


</pre></div></div>
</div>
<p>Additionally the spatial model of <code class="docutils literal notranslate"><a href='../../api/gammapy.modeling.models.SkyModel.html#gammapy.modeling.models.SkyModel'>gammapy.modeling.models.SkyModel</a></code> can be used to represent source models based on templates, where the spatial and energy axes are correlated. It can be created e.g. from an existing FITS file:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[45]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">gammapy.modeling.models</span> <span class="kn">import</span> <span class="n">TemplateSpatialModel</span>
<span class="kn">from</span> <span class="nn">gammapy.modeling.models</span> <span class="kn">import</span> <span class="n">PowerLawNormSpectralModel</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[46]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">diffuse_cube</span> <span class="o">=</span> <span class="n">TemplateSpatialModel</span><span class="o">.</span><span class="n">read</span><span class="p">(</span>
    <span class="s2">&quot;$GAMMAPY_DATA/fermi-3fhl-gc/gll_iem_v06_gc.fits.gz&quot;</span><span class="p">,</span> <span class="n">normalize</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>
<span class="n">diffuse</span> <span class="o">=</span> <span class="n">SkyModel</span><span class="p">(</span><span class="n">PowerLawNormSpectralModel</span><span class="p">(),</span> <span class="n">diffuse_cube</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">diffuse</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
SkyModel

  Name                      : 5wzmdYwZ
  Datasets names            : None
  Spectral model type       : PowerLawNormSpectralModel
  Spatial  model type       : TemplateSpatialModel
  Temporal model type       :
  Parameters:
    norm                    :      1.000   +/-    0.00
    tilt         (frozen)   :      0.000
    reference    (frozen)   :      1.000       TeV


</pre></div></div>
</div>
<p>Note that if the spatial model is not normalized over the sky it has to be combined with a normalized spectral model, for example <code class="docutils literal notranslate"><a href='../../api/gammapy.modeling.models.PowerLawNormSpectralModel.html#gammapy.modeling.models.PowerLawNormSpectralModel'>gammapy.modeling.models.PowerLawNormSpectralModel</a></code>. This is the only case in <code class="docutils literal notranslate"><span class="pre">gammapy.models.SkyModel</span></code> where the unit is fully attached to the spatial model.</p>
</div>
<div class="section" id="Modifying-model-parameters">
<h2>Modifying model parameters<a class="headerlink" href="#Modifying-model-parameters" title="Permalink to this headline">¶</a></h2>
<p>Model parameters can be modified (eg: frozen, values changed, etc at any point), eg:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[47]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Freezing a parameter</span>
<span class="n">model</span><span class="o">.</span><span class="n">spectral_model</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">frozen</span> <span class="o">=</span> <span class="kc">True</span>
<span class="c1"># Making a parameter free</span>
<span class="n">model</span><span class="o">.</span><span class="n">spectral_model</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">frozen</span> <span class="o">=</span> <span class="kc">False</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[48]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Changing a value</span>
<span class="n">model</span><span class="o">.</span><span class="n">spectral_model</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="mi">3</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[49]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Setting min and max ranges on parameters</span>
<span class="n">model</span><span class="o">.</span><span class="n">spectral_model</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">min</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">model</span><span class="o">.</span><span class="n">spectral_model</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">max</span> <span class="o">=</span> <span class="mf">5.0</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[50]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Visualise the model as a table</span>
<span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">to_table</span><span class="p">()</span><span class="o">.</span><span class="n">show_in_notebook</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[50]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<i>Table length=10</i>
<table id="table5039022816-125096" class="table-striped table-bordered table-condensed">
<thead><tr><th>idx</th><th>type</th><th>name</th><th>value</th><th>unit</th><th>error</th><th>min</th><th>max</th><th>frozen</th><th>link</th></tr></thead>
<tr><td>0</td><td>spectral</td><td>index</td><td>3.0000e+00</td><td></td><td>0.000e+00</td><td>1.000e+00</td><td>5.000e+00</td><td>False</td><td></td></tr>
<tr><td>1</td><td>spectral</td><td>amplitude</td><td>2.7000e-12</td><td>cm-2 s-1 TeV-1</td><td>0.000e+00</td><td>nan</td><td>nan</td><td>False</td><td></td></tr>
<tr><td>2</td><td>spectral</td><td>reference</td><td>1.0000e+00</td><td>TeV</td><td>0.000e+00</td><td>nan</td><td>nan</td><td>True</td><td></td></tr>
<tr><td>3</td><td>spatial</td><td>lon_0</td><td>0.0000e+00</td><td>deg</td><td>0.000e+00</td><td>nan</td><td>nan</td><td>False</td><td></td></tr>
<tr><td>4</td><td>spatial</td><td>lat_0</td><td>0.0000e+00</td><td>deg</td><td>0.000e+00</td><td>-9.000e+01</td><td>9.000e+01</td><td>False</td><td></td></tr>
<tr><td>5</td><td>spatial</td><td>sigma</td><td>2.0000e-01</td><td>deg</td><td>0.000e+00</td><td>0.000e+00</td><td>nan</td><td>False</td><td></td></tr>
<tr><td>6</td><td>spatial</td><td>e</td><td>0.0000e+00</td><td></td><td>0.000e+00</td><td>0.000e+00</td><td>1.000e+00</td><td>True</td><td></td></tr>
<tr><td>7</td><td>spatial</td><td>phi</td><td>0.0000e+00</td><td>deg</td><td>0.000e+00</td><td>nan</td><td>nan</td><td>True</td><td></td></tr>
<tr><td>8</td><td>temporal</td><td>t_ref</td><td>5.9240e+04</td><td>d</td><td>0.000e+00</td><td>nan</td><td>nan</td><td>False</td><td></td></tr>
<tr><td>9</td><td>temporal</td><td>sigma</td><td>2.0000e+00</td><td>d</td><td>0.000e+00</td><td>nan</td><td>nan</td><td>False</td><td></td></tr>
</table><style>table.dataTable {clear: both; width: auto !important; margin: 0 !important;}
.dataTables_info, .dataTables_length, .dataTables_filter, .dataTables_paginate{
display: inline-block; margin-right: 1em; }
.paginate_button { margin-right: 5px; }
</style>
<script>

var astropy_sort_num = function(a, b) {
    var a_num = parseFloat(a);
    var b_num = parseFloat(b);

    if (isNaN(a_num) && isNaN(b_num))
        return ((a < b) ? -1 : ((a > b) ? 1 : 0));
    else if (!isNaN(a_num) && !isNaN(b_num))
        return ((a_num < b_num) ? -1 : ((a_num > b_num) ? 1 : 0));
    else
        return isNaN(a_num) ? -1 : 1;
}

require.config({paths: {
    datatables: 'https://cdn.datatables.net/1.10.12/js/jquery.dataTables.min'
}});
require(["datatables"], function(){
    console.log("$('#table5039022816-125096').dataTable()");

jQuery.extend( jQuery.fn.dataTableExt.oSort, {
    "optionalnum-asc": astropy_sort_num,
    "optionalnum-desc": function (a,b) { return -astropy_sort_num(a, b); }
});

    $('#table5039022816-125096').dataTable({
        order: [],
        pageLength: 50,
        lengthMenu: [[10, 25, 50, 100, 500, 1000, -1], [10, 25, 50, 100, 500, 1000, 'All']],
        pagingType: "full_numbers",
        columnDefs: [{targets: [0, 3, 5, 6, 7], type: "optionalnum"}]
    });
});
</script></div>
</div>
<p>You can use the interactive boxes to choose model parameters by name, type or other attrributes mentioned in the column names.</p>
</div>
<div class="section" id="Model-lists-and-serialisation">
<h2>Model lists and serialisation<a class="headerlink" href="#Model-lists-and-serialisation" title="Permalink to this headline">¶</a></h2>
<p>In a typical analysis scenario a model consists of multiple model components, or a “catalog” or “source library”. To handle this list of multiple model components, Gammapy has a <code class="docutils literal notranslate"><span class="pre">Models</span></code> class:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[51]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">gammapy.modeling.models</span> <span class="kn">import</span> <span class="n">Models</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[52]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">models</span> <span class="o">=</span> <span class="n">Models</span><span class="p">([</span><span class="n">model</span><span class="p">,</span> <span class="n">diffuse</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">models</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Models

Component 0: SkyModel

  Name                      : my-source
  Datasets names            : None
  Spectral model type       : PowerLawSpectralModel
  Spatial  model type       : GaussianSpatialModel
  Temporal model type       : GaussianTemporalModel
  Parameters:
    index                   :      3.000   +/-    0.00
    amplitude               :   2.70e-12   +/- 0.0e+00 1 / (cm2 s TeV)
    reference    (frozen)   :      1.000       TeV
    lon_0                   :      0.000   +/-    0.00 deg
    lat_0                   :      0.000   +/-    0.00 deg
    sigma                   :      0.200   +/-    0.00 deg
    e            (frozen)   :      0.000
    phi          (frozen)   :      0.000       deg
    t_ref                   :  59240.000   +/-    0.00 d
    sigma                   :      2.000   +/-    0.00 d

Component 1: SkyModel

  Name                      : 5wzmdYwZ
  Datasets names            : None
  Spectral model type       : PowerLawNormSpectralModel
  Spatial  model type       : TemplateSpatialModel
  Temporal model type       :
  Parameters:
    norm                    :      1.000   +/-    0.00
    tilt         (frozen)   :      0.000
    reference    (frozen)   :      1.000       TeV


</pre></div></div>
</div>
<p>Individual model components in the list can be accessed by their name:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[53]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="n">models</span><span class="p">[</span><span class="s2">&quot;my-source&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
SkyModel

  Name                      : my-source
  Datasets names            : None
  Spectral model type       : PowerLawSpectralModel
  Spatial  model type       : GaussianSpatialModel
  Temporal model type       : GaussianTemporalModel
  Parameters:
    index                   :      3.000   +/-    0.00
    amplitude               :   2.70e-12   +/- 0.0e+00 1 / (cm2 s TeV)
    reference    (frozen)   :      1.000       TeV
    lon_0                   :      0.000   +/-    0.00 deg
    lat_0                   :      0.000   +/-    0.00 deg
    sigma                   :      0.200   +/-    0.00 deg
    e            (frozen)   :      0.000
    phi          (frozen)   :      0.000       deg
    t_ref                   :  59240.000   +/-    0.00 d
    sigma                   :      2.000   +/-    0.00 d


</pre></div></div>
</div>
<p><strong>Note:</strong>To make the access by name unambiguous, models are required to have a unique name, otherwise an error will be thrown.</p>
<p>To see which models are available you can use the <code class="docutils literal notranslate"><span class="pre">.names</span></code> attribute:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[54]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">names</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&#39;my-source&#39;, &#39;5wzmdYwZ&#39;]
</pre></div></div>
</div>
<p>Note that a <code class="docutils literal notranslate"><span class="pre">SkyModel</span></code> object can be evaluated for a given longitude, latitude, and energy, but the <code class="docutils literal notranslate"><span class="pre">Models</span></code> object cannot. This <code class="docutils literal notranslate"><span class="pre">Models</span></code> container object will be assigned to <code class="docutils literal notranslate"><span class="pre">Dataset</span></code> or <code class="docutils literal notranslate"><span class="pre">Datasets</span></code> together with the data to be fitted as explained in other analysis tutorials (see for example the <a class="reference internal" href="../analysis/2D/modeling_2D.html"><span class="doc">modeling</span></a> notebook).</p>
<p>The <code class="docutils literal notranslate"><span class="pre">Models</span></code> class also has in place <code class="docutils literal notranslate"><span class="pre">.append()</span></code> and <code class="docutils literal notranslate"><span class="pre">.extend()</span></code> methods:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[55]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">model_copy</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;my-source-copy&quot;</span><span class="p">)</span>
<span class="n">models</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">model_copy</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>This list of models can be also serialised to a custom YAML based format:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[56]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">models_yaml</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">to_yaml</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">models_yaml</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Template file already exits, and overwrite is False
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
components:
-   name: my-source
    type: SkyModel
    spectral:
        type: PowerLawSpectralModel
        parameters:
        -   name: index
            value: 3.0
        -   name: amplitude
            value: 2.7e-12
            unit: cm-2 s-1 TeV-1
        -   name: reference
            value: 1.0
            unit: TeV
            frozen: true
    spatial:
        type: GaussianSpatialModel
        frame: galactic
        parameters:
        -   name: lon_0
            value: 0.0
            unit: deg
        -   name: lat_0
            value: 0.0
            unit: deg
        -   name: sigma
            value: 0.2
            unit: deg
        -   name: e
            value: 0.0
            frozen: true
        -   name: phi
            value: 0.0
            unit: deg
            frozen: true
    temporal:
        type: GaussianTemporalModel
        parameters:
        -   name: t_ref
            value: 59240.0
            unit: d
        -   name: sigma
            value: 2.0
            unit: d
-   name: 5wzmdYwZ
    type: SkyModel
    spectral:
        type: PowerLawNormSpectralModel
        parameters:
        -   name: norm
            value: 1.0
        -   name: tilt
            value: 0.0
            frozen: true
        -   name: reference
            value: 1.0
            unit: TeV
            frozen: true
    spatial:
        type: TemplateSpatialModel
        frame: galactic
        parameters: []
        filename: /Users/adonath/github/gammapy/gammapy-data/fermi-3fhl-gc/gll_iem_v06_gc.fits.gz
        normalize: false
        unit: 1 / (cm2 MeV s sr)
-   name: my-source-copy
    type: SkyModel
    spectral:
        type: PowerLawSpectralModel
        parameters:
        -   name: index
            value: 3.0
        -   name: amplitude
            value: 2.7e-12
            unit: cm-2 s-1 TeV-1
        -   name: reference
            value: 1.0
            unit: TeV
            frozen: true
    spatial:
        type: GaussianSpatialModel
        frame: galactic
        parameters:
        -   name: lon_0
            value: 0.0
            unit: deg
        -   name: lat_0
            value: 0.0
            unit: deg
        -   name: sigma
            value: 0.2
            unit: deg
        -   name: e
            value: 0.0
            frozen: true
        -   name: phi
            value: 0.0
            unit: deg
            frozen: true
    temporal:
        type: GaussianTemporalModel
        parameters:
        -   name: t_ref
            value: 59240.0
            unit: d
        -   name: sigma
            value: 2.0
            unit: d

</pre></div></div>
</div>
<p>The structure of the yaml files follows the structure of the python objects. The <code class="docutils literal notranslate"><span class="pre">components</span></code> listed correspond to the <code class="docutils literal notranslate"><span class="pre">SkyModel</span></code> and <code class="docutils literal notranslate"><span class="pre">SkyDiffuseCube</span></code> components of the <code class="docutils literal notranslate"><span class="pre">Models</span></code>. For each <code class="docutils literal notranslate"><span class="pre">SkyModel</span></code> we have information about its <code class="docutils literal notranslate"><span class="pre">name</span></code>, <code class="docutils literal notranslate"><span class="pre">type</span></code> (corresponding to the tag attribute) and sub-mobels (i.e <code class="docutils literal notranslate"><span class="pre">spectral</span></code> model and eventually <code class="docutils literal notranslate"><span class="pre">spatial</span></code> model). Then the spatial and spectral models are defined by their type and parameters. The <code class="docutils literal notranslate"><span class="pre">parameters</span></code> keys name/value/unit are
mandatory, while the keys min/max/frozen are optionnals (so you can prepare shorter files).</p>
<p>If you want to write this list of models to disk and read it back later you can use:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[57]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">models</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;models.yaml&quot;</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Template file already exits, and overwrite is False
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[58]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">models_read</span> <span class="o">=</span> <span class="n">Models</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s2">&quot;models.yaml&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Additionally the models can exported and imported togeter with the data using the <code class="docutils literal notranslate"><span class="pre">Datasets.read()</span></code> and <code class="docutils literal notranslate"><span class="pre">Datasets.write()</span></code> methods as shown in the <a class="reference internal" href="../analysis/3D/analysis_mwl.html"><span class="doc">analysis_mwl</span></a> notebook.</p>
</div>
<div class="section" id="Models-with-shared-parameter">
<h2>Models with shared parameter<a class="headerlink" href="#Models-with-shared-parameter" title="Permalink to this headline">¶</a></h2>
<p>A model parameter can be shared with other models, for example we can define two power-law models with the same spectral index but different amplitudes:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[59]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">pwl2</span> <span class="o">=</span> <span class="n">PowerLawSpectralModel</span><span class="p">()</span>
<span class="n">pwl2</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">pwl</span><span class="o">.</span><span class="n">index</span>
<span class="n">pwl</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="mf">2.3</span>  <span class="c1"># also update pwl2 as the parameter object is now the same as shown below</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pwl</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pwl2</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Parameter(name=&#39;index&#39;, value=2.3, factor=2.3, scale=1.0, unit=Unit(dimensionless), min=1.0, max=5.0, frozen=False, id=0x12a84c580)
Parameter(name=&#39;index&#39;, value=2.3, factor=2.3, scale=1.0, unit=Unit(dimensionless), min=1.0, max=5.0, frozen=False, id=0x12a84c580)
</pre></div></div>
</div>
<p>In the YAML files the shared parameter is flagged by the additional <code class="docutils literal notranslate"><span class="pre">link</span></code> entry that follows the convention <code class="docutils literal notranslate"><span class="pre">parameter.name&#64;unique_id</span></code>:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[60]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">models</span> <span class="o">=</span> <span class="n">Models</span><span class="p">(</span>
    <span class="p">[</span><span class="n">SkyModel</span><span class="p">(</span><span class="n">pwl</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;source1&quot;</span><span class="p">),</span> <span class="n">SkyModel</span><span class="p">(</span><span class="n">pwl2</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;source2&quot;</span><span class="p">)]</span>
<span class="p">)</span>
<span class="n">models_yaml</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">to_yaml</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">models_yaml</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
components:
-   name: source1
    type: SkyModel
    spectral:
        type: PowerLawSpectralModel
        parameters:
        -   name: index
            value: 2.3
            link: index@G4MENRRX
        -   name: amplitude
            value: 2.7e-12
            unit: cm-2 s-1 TeV-1
        -   name: reference
            value: 1.0
            unit: TeV
            frozen: true
-   name: source2
    type: SkyModel
    spectral:
        type: PowerLawSpectralModel
        parameters:
        -   name: index
            value: 2.3
            link: index@G4MENRRX
        -   name: amplitude
            value: 1.0e-12
            unit: cm-2 s-1 TeV-1
        -   name: reference
            value: 1.0
            unit: TeV
            frozen: true

</pre></div></div>
</div>
</div>
<div class="section" id="Implementing-a-custom-model">
<h2>Implementing a custom model<a class="headerlink" href="#Implementing-a-custom-model" title="Permalink to this headline">¶</a></h2>
<p>In order to add a user defined spectral model you have to create a SpectralModel subclass. This new model class should include:</p>
<ul class="simple">
<li><p>a tag used for serialization (it can be the same as the class name)</p></li>
<li><p>an instantiation of each Parameter with their unit, default values and frozen status</p></li>
<li><p>the evaluate function where the mathematical expression for the model is defined.</p></li>
</ul>
<p>As an example we will use a PowerLawSpectralModel plus a Gaussian (with fixed width). First we define the new custom model class that we name <code class="docutils literal notranslate"><span class="pre">MyCustomSpectralModel</span></code>:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[61]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">gammapy.modeling.models</span> <span class="kn">import</span> <span class="n">SpectralModel</span><span class="p">,</span> <span class="n">Parameter</span>


<span class="k">class</span> <span class="nc">MyCustomSpectralModel</span><span class="p">(</span><span class="n">SpectralModel</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;My custom spectral model, parametrising a power law plus a Gaussian spectral line.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    amplitude : `astropy.units.Quantity`</span>
<span class="sd">        Amplitude of the spectra model.</span>
<span class="sd">    index : `astropy.units.Quantity`</span>
<span class="sd">        Spectral index of the model.</span>
<span class="sd">    reference : `astropy.units.Quantity`</span>
<span class="sd">        Reference energy of the power law.</span>
<span class="sd">    mean : `astropy.units.Quantity`</span>
<span class="sd">        Mean value of the Gaussian.</span>
<span class="sd">    width : `astropy.units.Quantity`</span>
<span class="sd">        Sigma width of the Gaussian line.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">tag</span> <span class="o">=</span> <span class="s2">&quot;MyCustomSpectralModel&quot;</span>
    <span class="n">amplitude</span> <span class="o">=</span> <span class="n">Parameter</span><span class="p">(</span><span class="s2">&quot;amplitude&quot;</span><span class="p">,</span> <span class="s2">&quot;1e-12 cm-2 s-1 TeV-1&quot;</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">index</span> <span class="o">=</span> <span class="n">Parameter</span><span class="p">(</span><span class="s2">&quot;index&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">reference</span> <span class="o">=</span> <span class="n">Parameter</span><span class="p">(</span><span class="s2">&quot;reference&quot;</span><span class="p">,</span> <span class="s2">&quot;1 TeV&quot;</span><span class="p">,</span> <span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">mean</span> <span class="o">=</span> <span class="n">Parameter</span><span class="p">(</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span> <span class="s2">&quot;1 TeV&quot;</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">width</span> <span class="o">=</span> <span class="n">Parameter</span><span class="p">(</span><span class="s2">&quot;width&quot;</span><span class="p">,</span> <span class="s2">&quot;0.1 TeV&quot;</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">evaluate</span><span class="p">(</span><span class="n">energy</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">amplitude</span><span class="p">,</span> <span class="n">reference</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">width</span><span class="p">):</span>
        <span class="n">pwl</span> <span class="o">=</span> <span class="n">PowerLawSpectralModel</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span>
            <span class="n">energy</span><span class="o">=</span><span class="n">energy</span><span class="p">,</span>
            <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">,</span>
            <span class="n">amplitude</span><span class="o">=</span><span class="n">amplitude</span><span class="p">,</span>
            <span class="n">reference</span><span class="o">=</span><span class="n">reference</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">gauss</span> <span class="o">=</span> <span class="n">amplitude</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">((</span><span class="n">energy</span> <span class="o">-</span> <span class="n">mean</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">width</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">pwl</span> <span class="o">+</span> <span class="n">gauss</span>
</pre></div>
</div>
</div>
<p>It is good practice to also implement a docstring for the model, defining the parameters and also definig a <code class="docutils literal notranslate"><span class="pre">tag</span></code>, which specifies the name of the model for serialisation. Also note that gammapy assumes that all SpectralModel evaluate functions return a flux in unit of <code class="docutils literal notranslate"><span class="pre">&quot;cm-2</span> <span class="pre">s-1</span> <span class="pre">TeV-1&quot;</span></code> (or equivalent dimensions).</p>
<p>This model can now be used as any other spectral model in Gammapy:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[62]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">my_custom_model</span> <span class="o">=</span> <span class="n">MyCustomSpectralModel</span><span class="p">(</span><span class="n">mean</span><span class="o">=</span><span class="s2">&quot;3 TeV&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">my_custom_model</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
MyCustomSpectralModel

  type      name     value         unit        error      min    max frozen link
-------- --------- ---------- -------------- --------- --------- --- ------ ----
spectral amplitude 1.0000e-12 cm-2 s-1 TeV-1 0.000e+00 0.000e+00 nan  False
spectral     index 2.0000e+00                0.000e+00 0.000e+00 nan  False
spectral reference 1.0000e+00            TeV 0.000e+00       nan nan   True
spectral      mean 3.0000e+00            TeV 0.000e+00 0.000e+00 nan  False
spectral     width 1.0000e-01            TeV 0.000e+00 0.000e+00 nan   True
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[63]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">my_custom_model</span><span class="o">.</span><span class="n">integral</span><span class="p">(</span><span class="mi">1</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">TeV</span><span class="p">,</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">TeV</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[63]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="math notranslate nohighlight">
$$1.1442739 \times 10^{-12} \; \mathrm{\frac{1}{s\,cm^{2}}}$$</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[64]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">my_custom_model</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">energy_bounds</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">TeV</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[64]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;AxesSubplot:xlabel=&#39;Energy [TeV]&#39;, ylabel=&#39;dnde [1 / (cm2 s TeV)]&#39;&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_api_models_118_1.png" src="../../_images/tutorials_api_models_118_1.png" />
</div>
</div>
<p>As a next step we can also register the custom model in the <code class="docutils literal notranslate"><span class="pre">SPECTRAL_MODELS</span></code> registry, so that it becomes available for serilisation:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[65]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">SPECTRAL_MODEL_REGISTRY</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">MyCustomSpectralModel</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[66]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">model</span> <span class="o">=</span> <span class="n">SkyModel</span><span class="p">(</span><span class="n">spectral_model</span><span class="o">=</span><span class="n">my_custom_model</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;my-source&quot;</span><span class="p">)</span>
<span class="n">models</span> <span class="o">=</span> <span class="n">Models</span><span class="p">([</span><span class="n">model</span><span class="p">])</span>
<span class="n">models</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;my-custom-models.yaml&quot;</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[67]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">!</span>cat my-custom-models.yaml
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
components:
-   name: my-source
    type: SkyModel
    spectral:
        type: MyCustomSpectralModel
        parameters:
        -   name: amplitude
            value: 1.0e-12
            unit: cm-2 s-1 TeV-1
        -   name: index
            value: 2.0
        -   name: reference
            value: 1.0
            unit: TeV
            frozen: true
        -   name: mean
            value: 3.0
            unit: TeV
        -   name: width
            value: 0.1
            unit: TeV
            frozen: true
covariance: my-custom-models_covariance.dat
</pre></div></div>
</div>
<p>Similarly you can also create custom spatial models and add them to the <code class="docutils literal notranslate"><span class="pre">SPATIAL_MODELS</span></code> registry. In that case gammapy assumes that the evaluate function return a normalized quantity in “sr-1” such as the model integral over the whole sky is one.</p>
</div>
<div class="section" id="Models-with-energy-dependent-morphology">
<h2>Models with energy dependent morphology<a class="headerlink" href="#Models-with-energy-dependent-morphology" title="Permalink to this headline">¶</a></h2>
<p>A common science case in the study of extended sources is to probe for energy dependent morphology, eg: in Supernova Remnants or Pulsar Wind Nebulae. Traditionally, this has been done by splitting the data into energy bands and doing individual fits of the morphology in these energy bands.</p>
<p><code class="docutils literal notranslate"><span class="pre">SkyModel</span></code> offers a natural framework to simultaneously model the energy and morphology, e.g. spatial extent described by a parametric model expression with energy dependent parameters.</p>
<p>The models shipped within gammapy use a “factorised” representation of the source model, where the spatial (<span class="math notranslate nohighlight">\(l,b\)</span>), energy (<span class="math notranslate nohighlight">\(E\)</span>) and time (<span class="math notranslate nohighlight">\(t\)</span>) dependence are independent model components and not correlated:</p>
<div class="math notranslate nohighlight">
\[f(l, b, E, t) = F(l, b) \cdot G(E) \cdot H(t)\]</div>
<p>To use full 3D models, ie $f(l, b, E) = F(l, b, E) <span class="math">\cdot `G(E) $, you have to implement your own custom ``SpatialModel`</span>. Note that it is still necessary to multiply by a <code class="docutils literal notranslate"><span class="pre">SpectralModel</span></code>, <span class="math notranslate nohighlight">\(G(E)\)</span> to be dimensionally consistent.</p>
<p>In this example, we create Gaussian Spatial Model with the extension varying with energy. For simplicity, we assume a linear dependence on energy and parameterize this by specifying the extension at 2 energies. You can add more complex dependences, probably motivated by physical models.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[68]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">gammapy.modeling.models</span> <span class="kn">import</span> <span class="n">SpatialModel</span>
<span class="kn">from</span> <span class="nn">astropy.coordinates.angle_utilities</span> <span class="kn">import</span> <span class="n">angular_separation</span>


<span class="k">class</span> <span class="nc">MyCustomGaussianModel</span><span class="p">(</span><span class="n">SpatialModel</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;My custom Energy Dependent Gaussian model.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    lon_0, lat_0 : `~astropy.coordinates.Angle`</span>
<span class="sd">        Center position</span>
<span class="sd">    sigma_1TeV : `~astropy.coordinates.Angle`</span>
<span class="sd">        Width of the Gaussian at 1 TeV</span>
<span class="sd">    sigma_10TeV : `~astropy.coordinates.Angle`</span>
<span class="sd">        Width of the Gaussian at 10 TeV</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">tag</span> <span class="o">=</span> <span class="s2">&quot;MyCustomGaussianModel&quot;</span>
    <span class="n">is_energy_dependent</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">lon_0</span> <span class="o">=</span> <span class="n">Parameter</span><span class="p">(</span><span class="s2">&quot;lon_0&quot;</span><span class="p">,</span> <span class="s2">&quot;0 deg&quot;</span><span class="p">)</span>
    <span class="n">lat_0</span> <span class="o">=</span> <span class="n">Parameter</span><span class="p">(</span><span class="s2">&quot;lat_0&quot;</span><span class="p">,</span> <span class="s2">&quot;0 deg&quot;</span><span class="p">,</span> <span class="nb">min</span><span class="o">=-</span><span class="mi">90</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>

    <span class="n">sigma_1TeV</span> <span class="o">=</span> <span class="n">Parameter</span><span class="p">(</span><span class="s2">&quot;sigma_1TeV&quot;</span><span class="p">,</span> <span class="s2">&quot;2.0 deg&quot;</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">sigma_10TeV</span> <span class="o">=</span> <span class="n">Parameter</span><span class="p">(</span><span class="s2">&quot;sigma_10TeV&quot;</span><span class="p">,</span> <span class="s2">&quot;0.2 deg&quot;</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">evaluate</span><span class="p">(</span><span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="n">energy</span><span class="p">,</span> <span class="n">lon_0</span><span class="p">,</span> <span class="n">lat_0</span><span class="p">,</span> <span class="n">sigma_1TeV</span><span class="p">,</span> <span class="n">sigma_10TeV</span><span class="p">):</span>

        <span class="n">sep</span> <span class="o">=</span> <span class="n">angular_separation</span><span class="p">(</span><span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="n">lon_0</span><span class="p">,</span> <span class="n">lat_0</span><span class="p">)</span>

        <span class="c1"># Compute sigma for the given energy using linear interpolation in log energy</span>
        <span class="n">sigma_nodes</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">Quantity</span><span class="p">([</span><span class="n">sigma_1TeV</span><span class="p">,</span> <span class="n">sigma_10TeV</span><span class="p">])</span>
        <span class="n">energy_nodes</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">TeV</span>
        <span class="n">log_s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">sigma_nodes</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s2">&quot;deg&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
        <span class="n">log_en</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">energy_nodes</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s2">&quot;TeV&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
        <span class="n">log_e</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">energy</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s2">&quot;TeV&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
        <span class="n">sigma</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">log_e</span><span class="p">,</span> <span class="n">log_en</span><span class="p">,</span> <span class="n">log_s</span><span class="p">))</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">deg</span>

        <span class="n">exponent</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">sep</span> <span class="o">/</span> <span class="n">sigma</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>
        <span class="n">norm</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">sigma</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">norm</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">exponent</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Serialisation of this model can be achieved as explained in the previous section. You can now use it as stadard <code class="docutils literal notranslate"><span class="pre">SpatialModel</span></code> in your analysis. Note that this is still a <code class="docutils literal notranslate"><span class="pre">SpatialModel</span></code>, and not a <code class="docutils literal notranslate"><span class="pre">SkyModel</span></code>, so it needs to be multiplied by a <code class="docutils literal notranslate"><span class="pre">SpectralModel</span></code> as before.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[69]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">spatial_model</span> <span class="o">=</span> <span class="n">MyCustomGaussianModel</span><span class="p">()</span>
<span class="n">spectral_model</span> <span class="o">=</span> <span class="n">PowerLawSpectralModel</span><span class="p">()</span>
<span class="n">sky_model</span> <span class="o">=</span> <span class="n">SkyModel</span><span class="p">(</span>
    <span class="n">spatial_model</span><span class="o">=</span><span class="n">spatial_model</span><span class="p">,</span> <span class="n">spectral_model</span><span class="o">=</span><span class="n">spectral_model</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[70]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">spatial_model</span><span class="o">.</span><span class="n">evaluation_radius</span>
</pre></div>
</div>
</div>
<p>To visualise it, we evaluate it on a 3D geom.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[71]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">energy_axis</span> <span class="o">=</span> <span class="n">MapAxis</span><span class="o">.</span><span class="n">from_energy_bounds</span><span class="p">(</span>
    <span class="n">energy_min</span><span class="o">=</span><span class="mf">0.1</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">TeV</span><span class="p">,</span> <span class="n">energy_max</span><span class="o">=</span><span class="mf">10.0</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">TeV</span><span class="p">,</span> <span class="n">nbin</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;energy_true&quot;</span>
<span class="p">)</span>
<span class="n">geom</span> <span class="o">=</span> <span class="n">WcsGeom</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
    <span class="n">skydir</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">width</span><span class="o">=</span><span class="mf">5.0</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">,</span> <span class="n">binsz</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="p">[</span><span class="n">energy_axis</span><span class="p">]</span>
<span class="p">)</span>

<span class="n">spatial_model</span><span class="o">.</span><span class="n">plot_grid</span><span class="p">(</span><span class="n">geom</span><span class="o">=</span><span class="n">geom</span><span class="p">,</span> <span class="n">add_cbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">3</span><span class="p">));</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_api_models_130_0.png" src="../../_images/tutorials_api_models_130_0.png" />
</div>
</div>
<p>For computational purposes, it is useful to specify a <code class="docutils literal notranslate"><span class="pre">evaluation_radius</span></code> for <code class="docutils literal notranslate"><span class="pre">SpatialModels</span></code> - this gives a size on which to compute the model. Though optional, it is highly recommended for Custom Spatial Models. This can be done, for ex, by defining the following function inside the above class:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[72]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nd">@property</span>
<span class="k">def</span> <span class="nf">evaluation_radius</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Evaluation radius (`~astropy.coordinates.Angle`).&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="mi">5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">sigma_1TeV</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sigma_10TeV</span><span class="o">.</span><span class="n">value</span><span class="p">])</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">deg</span>
</pre></div>
</div>
</div>
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="catalog.html" class="btn btn-neutral float-left" title="Source catalogs" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="model_management.html" class="btn btn-neutral float-right" title="Modelling" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, The Gammapy developers.
      <span class="lastupdated">Last updated on 22 Nov 2021.
      </span></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>