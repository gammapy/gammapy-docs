{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Spectral analysis with energy-dependent directional cuts"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Prerequisites \n",
    "\n",
    "- Understanding the basic data reduction performed in a [1D analysis](spectral_analysis.ipynb);\n",
    "- understanding the difference between a [point-like](https://gamma-astro-data-formats.readthedocs.io/en/latest/irfs/point_like/index.html) and a [full-enclosure](https://gamma-astro-data-formats.readthedocs.io/en/latest/irfs/full_enclosure/index.html) IRF.\n",
    "\n",
    "## Context\n",
    "\n",
    "As already explained in these tutorials, in a [1D spectral analysis](spectral_analysis.ipynb) the background is estimated from the field of view of the observation. In particular, the source and background events are counted within a circular ON region enclosing the source. The background to be subtracted is then estimated from one or more OFF regions with an expected background rate similar to the one in the ON region (i.e. from regions with similar acceptance).\n",
    "\n",
    "*Full-containment* IRFs have no directional cut applied, when employed for a 1D analysis, it is required to apply a correction to the IRF accounting for flux leaking out of the ON region. This correction is typically obtained by integrating the PSF within the ON region.\n",
    "\n",
    "When computing a *point-like* IRFs, a directional cut around the assumed source position is applied to the simulated events. For this IRF type, no PSF component is provided. The size of the ON and OFF regions used for the spectrum extraction should then reflect this cut, since a response computed within a specific region around the source is being provided.\n",
    "\n",
    "The directional cut is typically an angular distance from the assumed source position, $\\theta$. \n",
    "The [gamma-astro-data-format](https://gamma-astro-data-formats.readthedocs.io/en/latest/) specifications offer two different ways to store this information:\n",
    "* if the same $\\theta$ cut is applied at all energies and offsets, [a `RAD_MAX` keyword](https://gamma-astro-data-formats.readthedocs.io/en/latest/irfs/point_like/#rad-max) is added to the header of the data units containing IRF components. This should be used to define the size of the ON and OFF regions;\n",
    "* in case an energy- (and offset-) dependent $\\theta$ cut is applied, its values are stored in additional `FITS` data unit, named [`RAD_MAX_2D`](https://gamma-astro-data-formats.readthedocs.io/en/latest/irfs/point_like/#rad-max-2d). \n",
    "\n",
    "`Gammapy` provides a class to automatically read this values, `~gammapy.irf.RadMax2D`, for both cases (fixed or energy-dependent $\\theta$ cut). In this notebook we will focus on how to perform a spectral extraction with a point-like IRF with an energy-dependent $\\theta$ cut. We remark that in this case a `~regions.PointSkyRegion` (and not a `~regions.CircleSkyRegion`) should be used to define the ON region. If a geometry based on a `~regions.PointSkyRegion` is fed to the spectra and the background `Makers`, the latter will automatically use the values stored in the `RAD_MAX` keyword / table for defining the size of the ON and OFF regions.\n",
    "\n",
    "Beside the definition of the ON region during the data reduction, the remaining steps are identical to the other [1D spectral analysis example](spectral_analysis.ipynb), so we will not detail the data reduction steps already presented in the other tutorial.\n",
    "\n",
    "**Objective: perform the data reduction and analysis of 2 Crab Nebula observations of MAGIC and fit the resulting datasets.**\n",
    "\n",
    "## Introduction\n",
    "\n",
    "We load two MAGIC observations in the [gammapy-data](https://github.com/gammapy/gammapy-data) containing IRF component with a $\\theta$ cut.\n",
    "\n",
    "We define the ON region, this time as a `PointSkyRegion` instead of a `CircleSkyRegion`, i.e. we specify only the center of our ON region. We create a `RegionGeom` adding to the region the estimated energy axis of the `~gammapy.datasets.SpectrumDataset` object we want to produce. The corresponding dataset maker will automatically use the $\\theta$ values in `~gammapy.irf.RadMax2D` to set the appropriate ON region sizes (based on the offset on the observation and on the estimated energy binning).\n",
    "\n",
    "In order to define the OFF regions it is recommended to use a `~gammapy.makers.WobbleRegionsFinder`, that uses fixed positions for the OFF regions. In the different estimated energy bins we will have OFF regions centered at the same positions, but with changing size. As for the `SpectrumDataSetMaker`, the `BackgroundMaker` will use the values in `~gammapy.irf.RadMax2D` to define the sizes of the OFF regions.\n",
    "\n",
    "Once the datasets with the ON and OFF counts are created, we can perform a 1D likelihood fit, exactly as illustrated in the previous example."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Setup\n",
    "\n",
    "As usual, we'll start with some setup ..."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-12T21:50:16.804777Z",
     "iopub.status.busy": "2022-05-12T21:50:16.803833Z",
     "iopub.status.idle": "2022-05-12T21:50:17.432402Z",
     "shell.execute_reply": "2022-05-12T21:50:17.431321Z"
    }
   },
   "outputs": [],
   "source": [
    "%matplotlib inline\n",
    "import matplotlib.pyplot as plt"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-12T21:50:17.442391Z",
     "iopub.status.busy": "2022-05-12T21:50:17.441953Z",
     "iopub.status.idle": "2022-05-12T21:50:17.926380Z",
     "shell.execute_reply": "2022-05-12T21:50:17.925695Z"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "gammapy: 0.20\n",
      "numpy: 1.22.3\n",
      "astropy 5.0.4\n",
      "regions 0.5\n"
     ]
    }
   ],
   "source": [
    "# Check package versions\n",
    "import gammapy\n",
    "import numpy as np\n",
    "import astropy\n",
    "import regions\n",
    "\n",
    "print(\"gammapy:\", gammapy.__version__)\n",
    "print(\"numpy:\", np.__version__)\n",
    "print(\"astropy\", astropy.__version__)\n",
    "print(\"regions\", regions.__version__)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-12T21:50:17.952539Z",
     "iopub.status.busy": "2022-05-12T21:50:17.952236Z",
     "iopub.status.idle": "2022-05-12T21:50:18.806903Z",
     "shell.execute_reply": "2022-05-12T21:50:18.803783Z"
    }
   },
   "outputs": [],
   "source": [
    "import astropy.units as u\n",
    "from astropy.coordinates import SkyCoord\n",
    "from regions import PointSkyRegion\n",
    "from gammapy.data import DataStore\n",
    "from gammapy.maps import MapAxis, RegionGeom, Map\n",
    "from gammapy.modeling import Fit\n",
    "from gammapy.datasets import (\n",
    "    Datasets,\n",
    "    SpectrumDataset,\n",
    "    SpectrumDatasetOnOff,\n",
    ")\n",
    "from gammapy.modeling.models import (\n",
    "    create_crab_spectral_model,\n",
    "    SkyModel,\n",
    "    LogParabolaSpectralModel,\n",
    ")\n",
    "from gammapy.makers import (\n",
    "    SpectrumDatasetMaker,\n",
    "    WobbleRegionsFinder,\n",
    "    ReflectedRegionsBackgroundMaker,\n",
    "    SafeMaskMaker,\n",
    ")\n",
    "from gammapy.utils.scripts import make_path\n",
    "from gammapy.visualization import plot_spectrum_datasets_off_regions"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Load data\n",
    "\n",
    "We load the two MAGIC observations of the Crab Nebula containing the `RAD_MAX_2D` table."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-12T21:50:18.829353Z",
     "iopub.status.busy": "2022-05-12T21:50:18.828952Z",
     "iopub.status.idle": "2022-05-12T21:50:18.862154Z",
     "shell.execute_reply": "2022-05-12T21:50:18.859448Z"
    }
   },
   "outputs": [],
   "source": [
    "data_store = DataStore.from_dir(\"$GAMMAPY_DATA/magic/rad_max/data\")\n",
    "observations = data_store.get_observations(\n",
    "    required_irf=[\"aeff\", \"edisp\", \"rad_max\"]\n",
    ")"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "A `RadMax2D` attribute, containing the `RAD_MAX_2D` table, is automatically loaded in the observation. As we can see from the IRF component axes, the table has a single offset value and 28 estimated energy values."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-12T21:50:18.870742Z",
     "iopub.status.busy": "2022-05-12T21:50:18.870139Z",
     "iopub.status.idle": "2022-05-12T21:50:18.949968Z",
     "shell.execute_reply": "2022-05-12T21:50:18.947575Z"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "RadMax2D\n",
      "--------\n",
      "\n",
      "  axes  : ['energy', 'offset']\n",
      "  shape : (20, 1)\n",
      "  ndim  : 2\n",
      "  unit  : deg\n",
      "  dtype : >f4\n",
      "\n"
     ]
    }
   ],
   "source": [
    "rad_max = observations[\"5029747\"].rad_max\n",
    "print(rad_max)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "We can also plot the rad max value against the energy:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-12T21:50:18.962067Z",
     "iopub.status.busy": "2022-05-12T21:50:18.961686Z",
     "iopub.status.idle": "2022-05-12T21:50:19.757505Z",
     "shell.execute_reply": "2022-05-12T21:50:19.752051Z"
    }
   },
   "outputs": [
    {
     "data": {
      "image/png": "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aNEievToQUFBwde/eA8ePMiKFaF7sZo1a/at00eHnXPOOTz55JMAPPnkk4we/e1H8dx5553k5eWxceNGpk+fzrBhw3jqqaei3v6UU05h+vTpFBUVsXnzZt58802Acms+8sgjadasGfPnzwdg+vTpFbZHrCksytGycQqDjj6SN1ZviXcpIg2GmTFz5kxmzJhBRkYG3bt3JzU1lTvuuCPitsuWLWPw4MH079+f22+/nZtvvpmUlBSee+45Jk+eTL9+/ejfvz/z5s0DQpeqTpgwgf79+7N///5v7Ov666/n9ddfJyMjg9dff/3r/oH8/HxGjhwZsZbyti/pvPPOIyMjgz59+vCzn/2MU089FaDCmv/yl78wfvx4TjjhBNydFi1aRKwlVizUSV531OTzLP701sfc/cpq5t8wnKNapNbIZ4rE06pVq751GajUHnv27KFp06ZA6PLczZs388ADD3xrvbL+H81sobt/uzc/SjqyqMDwnqHzjG+u0akoEYm/2bNn079/f3r37s27777LzTffXGOfrQ7uCmSkN6VDy0a8sXorYwZ3jnc5ItLAXXjhhVx44YVx+WwdWVTAzBjeM5331n3BgYNF8S5HRCRuFBYRDMtMZ//BIuav3xbvUkRqRF3rx5RvCur/T2ERwfHHtKZRcqIuoZUGITU1lW3btikw6igPP88iNTX2F+SozyKC1ORETspow9xVW/ndOZHvIhWpyzp27EheXl4gz0OQmnH4SXmxFmhYmNkI4AFCz+B+3N3LHHrRzI4D5gMXunutG6N3WGY6r6/cwrqte+jetlm8yxEJTHJycsyfsCb1Q2CnocwsEXgEOBPIAsaYWVY5690NvBpULdU1tEfoEtq5q3QqSkQapiD7LAYDue6+3t0LgenAt+95h4nA80Ct/U18VItUendorru5RaTBCjIsOgCbSkznhed9zcw6AOcBUwKsIyaGZbZl4Sc72LG3MPLKIiL1TJBhUVZPcOlLLP4ITHb3Cm9iMLPxZpZjZjnx6ngbnplOscPba9XxJyINT5BhkQd0KjHdESj9DMNsYLqZbQQuAB41s3NL78jdp7p7trtnp6WlBVRuxfp0aEGbpkfoEloRaZCCvBpqAZBhZl2Bz4CLgLElV3D3ry+7MLMngJfc/YUAa6qyhARjaI80Xl3xOYeKiklK1C0qItJwBPYbz90PAVcTuspp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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "rad_max.plot_rad_max_vs_energy();"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Define the ON region\n",
    "\n",
    "To use the `RAD_MAX_2D` values to define the sizes of the ON and OFF regions **it is necessary to specify the ON region as a [`PointSkyRegion`](https://astropy-regions.readthedocs.io/en/stable/api/regions.PointSkyRegion.html).**"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-12T21:50:19.778329Z",
     "iopub.status.busy": "2022-05-12T21:50:19.775511Z",
     "iopub.status.idle": "2022-05-12T21:50:19.785728Z",
     "shell.execute_reply": "2022-05-12T21:50:19.784166Z"
    }
   },
   "outputs": [],
   "source": [
    "target_position = SkyCoord(ra=83.63, dec=22.01, unit=\"deg\", frame=\"icrs\")\n",
    "on_region = PointSkyRegion(target_position)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Run data reduction chain\n",
    "\n",
    "We begin with the configuration of the dataset maker classes:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-12T21:50:19.797580Z",
     "iopub.status.busy": "2022-05-12T21:50:19.796963Z",
     "iopub.status.idle": "2022-05-12T21:50:19.831232Z",
     "shell.execute_reply": "2022-05-12T21:50:19.829894Z"
    }
   },
   "outputs": [],
   "source": [
    "# true and estimated energy axes\n",
    "energy_axis = MapAxis.from_energy_bounds(\n",
    "    50, 1e5, nbin=5, per_decade=True, unit=\"GeV\", name=\"energy\"\n",
    ")\n",
    "energy_axis_true = MapAxis.from_energy_bounds(\n",
    "    10, 1e5, nbin=10, per_decade=True, unit=\"GeV\", name=\"energy_true\"\n",
    ")\n",
    "\n",
    "# geometry defining the ON region and SpectrumDataset based on it\n",
    "geom = RegionGeom.create(region=on_region, axes=[energy_axis])\n",
    "\n",
    "dataset_empty = SpectrumDataset.create(\n",
    "    geom=geom, energy_axis_true=energy_axis_true\n",
    ")"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "The `SpectrumDataset` is now based on a geometry consisting of a single coordinate and an estimated energy axis. The `SpectrumDatasetMaker` and `ReflectedRegionsBackgroundMaker` will take care of producing ON and OFF with the proper sizes, automatically adopting the $\\theta$ values in `Observation.rad_max`.\n",
    "\n",
    "As explained in the introduction, we use a `WobbleRegionsFinder`, to determine the OFF positions. The parameter `n_off_positions` specifies the number of OFF regions to be considered."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-12T21:50:19.845277Z",
     "iopub.status.busy": "2022-05-12T21:50:19.844808Z",
     "iopub.status.idle": "2022-05-12T21:50:19.849712Z",
     "shell.execute_reply": "2022-05-12T21:50:19.848685Z"
    }
   },
   "outputs": [],
   "source": [
    "dataset_maker = SpectrumDatasetMaker(\n",
    "    containment_correction=False, selection=[\"counts\", \"exposure\", \"edisp\"]\n",
    ")\n",
    "\n",
    "# tell the background maker to use the WobbleRegionsFinder, let us use 1 off\n",
    "region_finder = WobbleRegionsFinder(n_off_regions=3)\n",
    "bkg_maker = ReflectedRegionsBackgroundMaker(region_finder=region_finder)\n",
    "\n",
    "# use the energy threshold specified in the DL3 files\n",
    "safe_mask_masker = SafeMaskMaker(methods=[\"aeff-default\"])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-12T21:50:19.854450Z",
     "iopub.status.busy": "2022-05-12T21:50:19.854164Z",
     "iopub.status.idle": "2022-05-12T21:50:20.503268Z",
     "shell.execute_reply": "2022-05-12T21:50:20.501242Z"
    }
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "No default upper safe energy threshold defined for obs 5029747\n",
      "No default upper safe energy threshold defined for obs 5029748\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "CPU times: user 575 ms, sys: 22 ms, total: 597 ms\n",
      "Wall time: 641 ms\n"
     ]
    }
   ],
   "source": [
    "%%time\n",
    "datasets = Datasets()\n",
    "\n",
    "# create a counts map for visualisation later...\n",
    "counts = Map.create(skydir=target_position, width=3)\n",
    "\n",
    "for observation in observations:\n",
    "    dataset = dataset_maker.run(\n",
    "        dataset_empty.copy(name=str(observation.obs_id)), observation\n",
    "    )\n",
    "    counts.fill_events(observation.events)\n",
    "    dataset_on_off = bkg_maker.run(dataset, observation)\n",
    "    dataset_on_off = safe_mask_masker.run(dataset_on_off, observation)\n",
    "    datasets.append(dataset_on_off)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "No we can plot the off regions and target positions on top of the counts map:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-12T21:50:20.508919Z",
     "iopub.status.busy": "2022-05-12T21:50:20.508505Z",
     "iopub.status.idle": "2022-05-12T21:50:20.797275Z",
     "shell.execute_reply": "2022-05-12T21:50:20.793506Z"
    },
    "nbsphinx-thumbnail": {
     "tooltip": "Perform a point like spectral analysis with energy dependent offset cut."
    }
   },
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "ax = counts.plot()\n",
    "geom.plot_region(ax=ax, kwargs_point={\"color\": \"k\", \"marker\": \"*\"})\n",
    "plot_spectrum_datasets_off_regions(ax=ax, datasets=datasets)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Fit spectrum\n",
    "\n",
    "We perform a joint likelihood fit of the two datasets.    \n",
    "For this particular datasets we select a fit range between $80\\,{\\rm GeV}$ and $20\\,{\\rm TeV}$."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-12T21:50:20.803859Z",
     "iopub.status.busy": "2022-05-12T21:50:20.803527Z",
     "iopub.status.idle": "2022-05-12T21:50:20.808848Z",
     "shell.execute_reply": "2022-05-12T21:50:20.807860Z"
    }
   },
   "outputs": [],
   "source": [
    "e_min = 80 * u.GeV\n",
    "e_max = 20 * u.TeV\n",
    "\n",
    "for dataset in datasets:\n",
    "    dataset.mask_fit = dataset.counts.geom.energy_mask(e_min, e_max)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-12T21:50:20.813197Z",
     "iopub.status.busy": "2022-05-12T21:50:20.812890Z",
     "iopub.status.idle": "2022-05-12T21:50:24.124444Z",
     "shell.execute_reply": "2022-05-12T21:50:24.119297Z"
    }
   },
   "outputs": [],
   "source": [
    "spectral_model = LogParabolaSpectralModel(\n",
    "    amplitude=1e-12 * u.Unit(\"cm-2 s-1 TeV-1\"),\n",
    "    alpha=2,\n",
    "    beta=0.1,\n",
    "    reference=1 * u.TeV,\n",
    ")\n",
    "model = SkyModel(spectral_model=spectral_model, name=\"crab\")\n",
    "\n",
    "datasets.models = [model]\n",
    "\n",
    "fit = Fit()\n",
    "result = fit.run(datasets=datasets)\n",
    "\n",
    "# we make a copy here to compare it later\n",
    "best_fit_model = model.copy()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Fit quality and model residuals"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "We can access the results dictionary to see if the fit converged:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-12T21:50:24.133364Z",
     "iopub.status.busy": "2022-05-12T21:50:24.132572Z",
     "iopub.status.idle": "2022-05-12T21:50:24.158499Z",
     "shell.execute_reply": "2022-05-12T21:50:24.150390Z"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "OptimizeResult\n",
      "\n",
      "\tbackend    : minuit\n",
      "\tmethod     : migrad\n",
      "\tsuccess    : True\n",
      "\tmessage    : Optimization terminated successfully.\n",
      "\tnfev       : 223\n",
      "\ttotal stat : 23.98\n",
      "\n",
      "CovarianceResult\n",
      "\n",
      "\tbackend    : minuit\n",
      "\tmethod     : hesse\n",
      "\tsuccess    : True\n",
      "\tmessage    : Hesse terminated successfully.\n",
      "\n"
     ]
    }
   ],
   "source": [
    "print(result)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "and check the best-fit parameters"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-12T21:50:24.196900Z",
     "iopub.status.busy": "2022-05-12T21:50:24.191908Z",
     "iopub.status.idle": "2022-05-12T21:50:24.218982Z",
     "shell.execute_reply": "2022-05-12T21:50:24.213037Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div><i>Table length=4</i>\n",
       "<table id=\"table6057358288\" class=\"table-striped table-bordered table-condensed\">\n",
       "<thead><tr><th>model</th><th>type</th><th>name</th><th>value</th><th>unit</th><th>error</th><th>min</th><th>max</th><th>frozen</th><th>is_norm</th><th>link</th></tr></thead>\n",
       "<thead><tr><th>str4</th><th>str8</th><th>str9</th><th>float64</th><th>str14</th><th>float64</th><th>float64</th><th>float64</th><th>bool</th><th>bool</th><th>str1</th></tr></thead>\n",
       "<tr><td>crab</td><td>spectral</td><td>amplitude</td><td>4.3046e-11</td><td>cm-2 s-1 TeV-1</td><td>3.455e-12</td><td>nan</td><td>nan</td><td>False</td><td>True</td><td></td></tr>\n",
       "<tr><td>crab</td><td>spectral</td><td>reference</td><td>1.0000e+00</td><td>TeV</td><td>0.000e+00</td><td>nan</td><td>nan</td><td>True</td><td>False</td><td></td></tr>\n",
       "<tr><td>crab</td><td>spectral</td><td>alpha</td><td>2.5819e+00</td><td></td><td>1.088e-01</td><td>nan</td><td>nan</td><td>False</td><td>False</td><td></td></tr>\n",
       "<tr><td>crab</td><td>spectral</td><td>beta</td><td>1.9574e-01</td><td></td><td>6.591e-02</td><td>nan</td><td>nan</td><td>False</td><td>False</td><td></td></tr>\n",
       "</table></div>"
      ],
      "text/plain": [
       "<Table length=4>\n",
       "model   type      name     value         unit        error     min     max   frozen is_norm link\n",
       " str4   str8      str9    float64       str14       float64  float64 float64  bool    bool  str1\n",
       "----- -------- --------- ---------- -------------- --------- ------- ------- ------ ------- ----\n",
       " crab spectral amplitude 4.3046e-11 cm-2 s-1 TeV-1 3.455e-12     nan     nan  False    True     \n",
       " crab spectral reference 1.0000e+00            TeV 0.000e+00     nan     nan   True   False     \n",
       " crab spectral     alpha 2.5819e+00                1.088e-01     nan     nan  False   False     \n",
       " crab spectral      beta 1.9574e-01                6.591e-02     nan     nan  False   False     "
      ]
     },
     "execution_count": 15,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "datasets.models.to_parameters_table()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "A simple way to inspect the model residuals is using the function `~SpectrumDataset.plot_fit()`"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-12T21:50:24.247576Z",
     "iopub.status.busy": "2022-05-12T21:50:24.245149Z",
     "iopub.status.idle": "2022-05-12T21:50:25.193351Z",
     "shell.execute_reply": "2022-05-12T21:50:25.191967Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(0.1, 120)"
      ]
     },
     "execution_count": 16,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "iVBORw0KGgoAAAANSUhEUgAAAgsAAAGtCAYAAACY8jegAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjUuMiwgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy8qNh9FAAAACXBIWXMAAAsTAAALEwEAmpwYAAA0CElEQVR4nO3dfZzVdZ3//8dLQIFQVMD9pkSAmQiCqIxaumimaCuaqeVV5SVqq26rv3W/9rUL2nJzv/nTMi3Fi0X7tl5sWyqbZpoC1VKClqmIosgq2lcULxFNLl7fP+YMjTjzmXOGOXPOzHncb7e5zZzP+Vy8zvBhzvO8P+/P+x2ZiSRJUns2qXUBkiSpvhkWJElSIcOCJEkqZFiQJEmFDAuSJKlQ31oXUAtDhw7NkSNH1roMSZK6xQMPPPBSZg7r7PYNGRZGjhzJggULal2GJEndIiL+e2O29zKEJEkqZFiQJEmFenxYiIjDI+LqiLgtIqbUuh5JknqbuuyzEBHXAVOB5Zm5c6vlBwPfBfoA12TmRZl5K3BrRGwFXAz8ogYlS1LZVq9ezbJly3j77bdrXYp6mf79+zN8+HD69evXpfuty7AAzAQuB25oWRARfYArgAOBZcD8iLg9MxeWVvly6XlJqmvLli1j8803Z+TIkURErctRL5GZrFixgmXLljFq1Kgu3XddXobIzLnAyxss3gN4MjOXZOY7wE3AJ6PZvwB3ZuaD7e0zIk6LiAURseDFF1+sXvGS1IG3336bIUOGGBTUpSKCIUOGVKXFqi7DQju2A55t9XhZadnZwAHAURFxRnsbZ+aMzJyUmZOGDev0raaS1CUMCqqGap1X9XoZoi1t/QYyMy8DLuvuYiRJahQ9KSwsAz7Q6vFw4Pka1SJJXefS8fDaM123v8Ej4JyHC1fp06cP48ePZ82aNey0005cf/31DBw4sFOHO/HEE5k6dSpHHXUUp556Kueeey5jx45tc93Zs2ez6aab8tGPfrSiY7QMpjd06NAO1/3qV7/K5MmTOeCAAyo6RlfW0JVmzpzJlClT2Hbbbbv1uK31pLAwH9ghIkYBzwHHAMdVsoOIOBQ49EMf+lAVypOkTnrtGZj+Wtftb/rgDlcZMGAAf/jDHwA4/vjjufLKKzn33HPXP7927Vr69OlT8aGvueaawudnz57NoEGDKg4Llfinf/qnqu27FmbOnMnOO+9c07BQl30WIuJGYB6wY0Qsi4hTMnMNcBZwF/AYcEtmPlrJfjNzVmaeNnhwx/+Rerujr5rH0VfNq3UZkurAX//1X/Pkk08ye/ZsPvaxj3Hccccxfvx41q5dy3nnnUdTUxMTJkzgqquuApp73Z911lmMHTuWQw45hOXLl6/f13777bd+OP2f//zn7Lbbbuyyyy58/OMfZ+nSpVx55ZVceumlTJw4kV/96le8+OKLHHnkkTQ1NdHU1MRvfvMbAFasWMGUKVPYddddOf3008nM99S9du1aTjzxRHbeeWfGjx/PpZdeCjS3dPz4xz8G4I477mDMmDHss88+/N3f/R1Tp04FYPr06Zx88snst99+jB49mssu+8vV7MMPP5zdd9+dcePGMWPGjA5/fxu+ToCXX36Zww8/nAkTJrDXXnvxxz/+cf1xL7744vXb7rzzzixdupSlS5ey0047MW3aNMaNG8eUKVN46623+PGPf8yCBQs4/vjjmThxIm+99Rbnn38+Y8eOZcKECfzDP/xDmf/KG6cuWxYy89h2lt8B3NHN5UhSr7VmzRruvPNODj74YADuv/9+HnnkEUaNGsWMGTMYPHgw8+fP589//jN77703U6ZM4fe//z2PP/44Dz/8MC+88AJjx47l5JNPftd+X3zxRaZNm8bcuXMZNWoUL7/8MltvvTVnnHEGgwYNWv8md9xxx3HOOeewzz778Mwzz3DQQQfx2GOP8fWvf5199tmHr371q/zsZz9r8037D3/4A8899xyPPPIIAK+++uq7nn/77bc5/fTT19dw7LHvfmtZtGgR9913H2+88QY77rgjX/jCF+jXrx/XXXcdW2+9NW+99RZNTU0ceeSRDBkypM3fX1uvE+BrX/sau+66K7feeiv33nsvn//859e35LRn8eLF3HjjjVx99dV85jOf4T/+4z/47Gc/y+WXX87FF1/MpEmTePnll/npT3/KokWLiIj3vOZqqcuWBVXXMytW8dCyV/nd0y9z4CVzeGbFqlqXJKmbvfXWW0ycOJFJkyYxYsQITjnlFAD22GOP9ffo/+IXv+CGG25g4sSJ7LnnnqxYsYLFixczd+5cjj32WPr06cO2227L/vvv/579//a3v2Xy5Mnr97X11lu3Wcc999zDWWedxcSJEznssMN4/fXXeeONN5g7dy6f/exnATjkkEPYaqut3rPt6NGjWbJkCWeffTY///nP2WKLLd71/KJFixg9evT6GjYMC4cccgibbbYZQ4cOZZtttuGFF14A4LLLLmOXXXZhr7324tlnn2Xx4sXt/h7be52//vWv+dznPgfA/vvvz4oVK3jtteJLTaNGjWLixIkA7L777ixduvQ962yxxRb079+fU089lZ/85Ced7mdSqbpsWVBlKr2c8NCyV3l79ToAFi9fyZTvzGGX4VuWte3Np3+k0vIk1aHWfRZae9/73rf+58zke9/7HgcddNC71rnjjjs6vEUvM8u6jW/dunXMmzePAQMGvOe5jrbfaquteOihh7jrrru44ooruOWWW7juuuveVUORzTbbbP3Pffr0Yc2aNcyePZt77rmHefPmMXDgQPbbb7/CcQvae51tHTsi6Nu3L+vWrVu/rPW+N6znrbfees8++vbty/33388vf/lLbrrpJi6//HLuvffewtfZFRoqLNR7B8eWN/1K35C/t/zzbLN2eccrlmy/+oc0j5jdbPXq1dz8p4PL2/jSjntZS+odDjroIH7wgx+w//77069fP5544gm22247Jk+ezFVXXcXnP/95li9fzn333cdxx727v/lHPvIRzjzzTJ5++ul3XYbYfPPNef3119evN2XKFC6//HLOO+88oPnSwsSJE5k8eTI/+tGP+PKXv8ydd97JK6+88p76XnrpJTbddFOOPPJItt9+e0488cR3PT9mzBiWLFnC0qVLGTlyJDfffHOHr/m1115jq622YuDAgSxatIjf/va3heu39zpb6v/KV77C7NmzGTp0KFtssQUjR47kP//zPwF48MEHefrppzusafPNN+eNN94AYOXKlaxatYq/+Zu/Ya+99qK73s8aKixk5ixg1qRJk6bVupautM3a5RX1pB59yRwWL18JwCYBo4cNhnPL3L6MXta10NmgJdWFwSO69v/W4BFdsptTTz2VpUuXsttuu5GZDBs2jFtvvZVPfepT3HvvvYwfP54Pf/jD7Lvvvu/ZdtiwYcyYMYMjjjiCdevWsc0223D33Xdz6KGHctRRR3Hbbbfxve99j8suu4wzzzyTCRMmsGbNGiZPnsyVV17J1772NY499lh222039t13X0aMeO9reu655zjppJPWf1L/1re+9a7nBwwYwPe//30OPvhghg4dyh577NHhaz744IO58sormTBhAjvuuCN77bVX4frtvc7p06dz0kknMWHCBAYOHMj1118PwJFHHrn+0k5TUxMf/vCHO6zpxBNP5IwzzmDAgAHceeedfPKTn+Ttt98mM9d36qy26KiZpjeaNGlStvTWrSedfsObPriisPDMilVM+c4c3l69jh22GcS1JzQxYkiZ170qPFZ3MSyoJ3nsscfYaaedal1GQ1i5ciWDBg0iMznzzDPZYYcdOOecc2pdVlW1dX5FxAOZOamz+7SDY53ozk6HI4YMZJfhW7LnqK25+9x9yw8KdcoOm5Lac/XVVzNx4kTGjRvHa6+9xumnn17rknokWxaqaPk3dii7L8GBf/7fPJXvZx192IS1bB9/4u7N/rG8A5UxWluXqbBlobOf+CvptNm6wyZA/36b2GFTdc2WBVVTNVoWGqrPQnd3cNxm7XKOfv/Py1p38dN/mWRzHX1YnMPL3rZb3/AqvLa6vjvR9MoO870+23D2Njd0vCK8Kyi09ViStHEaKizUooNjuW/kB27Q6XD7YYPq81NvhS0YnW1Z2Gb64N73u5OkHso+C3Xi2hOa6N+v+Z9j+2HNnQ57uu7qS9Abf3eSVE8aqmWhnrV0OoT6vo7e2b4EFQ/+VEFNPeV3J20M7/hRLdmyoKqxL4FUv/r06cPEiRPXf1100UW1Lqnqbr31VhYuXFjrMnokWxbqSE/4xFBJjRvVl2B69eqS1P5wz73ZrbfeytSpUxk7dmytS+lxGqplISIOjYgZHU3moa5hXwKpa3RX/5/XXnuNHXfckccffxxonnjp6quvBuCGG25gwoQJ7LLLLusnSGpveuk5c+asb7HYddddeeONN/jTn/7E5MmTmThxIjvvvDO/+tWv3nP8+fPn89GPfpRddtmFPfbYgzfeeIO3336bk046ifHjx7Prrrty3333ATBz5kzOOuus9dtOnTqV2bNnAzBo0CAuuOCC9ZNBvfDCC/zXf/0Xt99+O+eddx4TJ07kqaee4rLLLls/1fMxxxxTld9pb9FQLQu9dbjnemVfAqnzWvcPKur/09n/Wy2zTrb40pe+xNFHH83ll1/OiSeeyBe/+EVeeeUVpk2bxqOPPsqFF17Ib37zG4YOHbp+GuYvfvGLbU4vffHFF3PFFVew9957s3LlSvr378+MGTM46KCDuOCCC1i7di2rVr078LzzzjscffTR3HzzzTQ1NfH6668zYMAAvvvd7wLw8MMPs2jRIqZMmcITTzxR+NrefPNN9tprLy688EL+8R//kauvvpovf/nLHHbYYUydOpWjjjoKgIsuuoinn36azTbbrNumeu6pGiosSFJPVI3+P+1dhjjwwAP593//d84880weeughAO69916OOuoohg4dCvxlGuZ77rnnXX0AWqaX3nvvvTn33HM5/vjjOeKIIxg+fDhNTU2cfPLJrF69msMPP/xdQQXg8ccf5/3vfz9NTc0tkC3TTf/617/m7LPPBponhvrgBz/YYVjYdNNNmTp1KtA81fPdd9/d5noTJkzg+OOP5/DDD+fwww8v3GejMyyoqmxRkDqn9f+d7hxLZN26dTz22GMMGDCAl19+meHDh7c7DXN700uff/75HHLIIdxxxx3stdde3HPPPUyePJm5c+fys5/9jM997nOcd955fP7zn1+/TSVTPQOFUz3369dv/b5app5uy89+9jPmzp3L7bffzje+8Q0effRR+vb1bbEt/lZUn7p6Fr6i4zjlturctSc0rZ/8rdr9fy699FJ22mkn/vmf/5mTTz6ZefPm8fGPf5xPfepTnHPOOQwZMmT9NMztTS/91FNPMX78eMaPH8+8efNYtGgRAwYMYLvttmPatGm8+eabPPjgg+8KC2PGjOH5559n/vz5NDU18cYbbzBgwID1Uz3vv//+PPHEEzzzzDPsuOOOvP7663z/+99n3bp1PPfcc9x///0dvrbWUz2vW7eOZ599lo997GPss88+/Nu//RsrV65kyy23rMrvtaczLKg+dedcF1Kdq0b/nw37LBx88MGcfPLJXHPNNdx///1svvnmTJ48mW9+85t8/etf54ILLmDfffelT58+7LrrrsycObPd6aW/853vcN9999GnTx/Gjh3LJz7xCW666Sa+/e1v069fPwYNGsQNN7x7OPdNN92Um2++mbPPPpu33nqLAQMGcM899/C3f/u3nHHGGYwfP56+ffsyc+ZMNttsM/bee29GjRrF+PHj2Xnnndltt906fM3HHHMM06ZN47LLLuOmm27ilFNO4bXXXiMzOeeccwwKBZxIqprqdDpnteK/kWqgMxNJOSiTyuVEUhupuyeSkqSuYkhQLTXUOAuZOSszTxs82KZnSZLK1VBhQZLqRSNeAlb1Veu8MixIUjfr378/K1asMDCoS2UmK1asoH///l2+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\n",
      "text/plain": [
       "<Figure size 576x504 with 2 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "ax_spectrum, ax_residuals = datasets[0].plot_fit()\n",
    "ax_spectrum.set_ylim(0.1, 120)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "For more ways of assessing fit quality, please refer to the dedicated [modeling and fitting tutorial](../2D/modeling_2D.ipynb)."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Compare against the literature\n",
    "Let us compare the spectrum we obtained against a [previous measurement by MAGIC](https://ui.adsabs.harvard.edu/abs/2015JHEAp...5...30A/abstract)."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-12T21:50:25.200045Z",
     "iopub.status.busy": "2022-05-12T21:50:25.199115Z",
     "iopub.status.idle": "2022-05-12T21:50:25.819960Z",
     "shell.execute_reply": "2022-05-12T21:50:25.807667Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(1e-13, 1e-10)"
      ]
     },
     "execution_count": 17,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "plot_kwargs = {\n",
    "    \"energy_bounds\": [0.08, 20] * u.TeV,\n",
    "    \"sed_type\": \"e2dnde\",\n",
    "    \"yunits\": u.Unit(\"TeV cm-2 s-1\"),\n",
    "    \"xunits\": u.GeV,\n",
    "}\n",
    "\n",
    "crab_magic_lp = create_crab_spectral_model(\"magic_lp\")\n",
    "\n",
    "best_fit_model.spectral_model.plot(\n",
    "    ls=\"-\", lw=1.5, color=\"crimson\", label=\"best fit\", **plot_kwargs\n",
    ")\n",
    "best_fit_model.spectral_model.plot_error(\n",
    "    facecolor=\"crimson\", alpha=0.4, **plot_kwargs\n",
    ")\n",
    "crab_magic_lp.plot(\n",
    "    ls=\"--\", lw=1.5, color=\"k\", label=\"MAGIC reference\", **plot_kwargs\n",
    ")\n",
    "\n",
    "plt.legend()\n",
    "plt.ylim([1e-13, 1e-10])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.9.12"
  },
  "latex_envs": {
   "LaTeX_envs_menu_present": true,
   "autoclose": false,
   "autocomplete": true,
   "bibliofile": "biblio.bib",
   "cite_by": "apalike",
   "current_citInitial": 1,
   "eqLabelWithNumbers": true,
   "eqNumInitial": 1,
   "hotkeys": {
    "equation": "Ctrl-E",
    "itemize": "Ctrl-I"
   },
   "labels_anchors": false,
   "latex_user_defs": false,
   "report_style_numbering": false,
   "user_envs_cfg": false
  },
  "nbsphinx": {
   "orphan": true
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
