{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "c7e483bd",
   "metadata": {},
   "source": [
    "\n",
    "<div class=\"alert alert-info\">\n",
    "\n",
    "**This is a fixed-text formatted version of a Jupyter notebook**\n",
    "\n",
    "- Try online[![Binder](https://static.mybinder.org/badge.svg)](https://mybinder.org/v2/gh/gammapy/gammapy-webpage/v0.20?urlpath=lab/tree/tutorials/analysis/3D/analysis_mwl.ipynb)\n",
    "- You may download all the notebooks as a [tar file](../../../_downloads/notebooks-0.20.tar).\n",
    "- **Source files:**\n",
    "[analysis_mwl.ipynb](../../../_static/notebooks/analysis_mwl.ipynb) |\n",
    "[analysis_mwl.py](../../../_static/notebooks/analysis_mwl.py)\n",
    "</div>\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "50fb27e2",
   "metadata": {},
   "source": [
    "# Multi instrument joint 3D and 1D analysis\n",
    "\n",
    "## Prerequisites\n",
    "\n",
    "- Handling of Fermi-LAT data with gammapy [see the corresponding tutorial](../../data/fermi_lat.ipynb)\n",
    "- Knowledge of spectral analysis to produce 1D On-Off datasets, [see the following tutorial](../1D/spectral_analysis.ipynb)\n",
    "- Using flux points to directly fit a model (without forward-folding)  [see the SED fitting tutorial](../1D/sed_fitting.ipynb)\n",
    "\n",
    "## Context\n",
    "\n",
    "Some science studies require to combine heterogeneous data from various instruments to extract physical information. In particular, it is often useful to add flux measurements of a source at different energies to an analysis to better constrain the wide-band spectral parameters. This can be done using a joint fit of heterogeneous datasets.\n",
    " \n",
    "**Objectives: Constrain the spectral parameters of the gamma-ray emission from the Crab nebula between 10 GeV and 100 TeV, using a 3D Fermi dataset, a H.E.S.S. reduced spectrum and HAWC flux points.**\n",
    "\n",
    "## Proposed approach\n",
    "\n",
    "This tutorial illustrates how to perform a joint modeling and fitting of the Crab Nebula spectrum using different datasets.\n",
    "The spectral parameters are optimized by combining a 3D analysis of Fermi-LAT data, a ON/OFF spectral analysis of HESS data, and flux points from HAWC.\n",
    "\n",
    "In this tutorial we are going to use pre-made datasets. We prepared maps of the Crab region as seen by Fermi-LAT using the same event selection than the [3FHL catalog](https://arxiv.org/abs/1702.00664) (7 years of data with energy from 10 GeV to 2 TeV). For the HESS ON/OFF analysis we used two observations from the [first public data release](https://arxiv.org/abs/1810.04516) with a significant signal from energy of about 600 GeV to 10 TeV. These observations have an offset of 0.5° and a zenith angle of 45-48°. The HAWC flux points data are taken from a [recent analysis](https://arxiv.org/pdf/1905.12518.pdf) based on 2.5 years of data with energy between 300 Gev and 300 TeV. \n",
    "\n",
    "## The setup\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "1e4c5ed8",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-12T21:50:30.013186Z",
     "iopub.status.busy": "2022-05-12T21:50:30.012809Z",
     "iopub.status.idle": "2022-05-12T21:50:31.892519Z",
     "shell.execute_reply": "2022-05-12T21:50:31.891286Z"
    }
   },
   "outputs": [],
   "source": [
    "from astropy import units as u\n",
    "import matplotlib.pyplot as plt\n",
    "from gammapy.modeling import Fit\n",
    "from gammapy.modeling.models import Models, create_crab_spectral_model\n",
    "from gammapy.datasets import Datasets, FluxPointsDataset, SpectrumDatasetOnOff\n",
    "from gammapy.estimators import FluxPoints, FluxPointsEstimator\n",
    "from gammapy.maps import MapAxis\n",
    "from pathlib import Path"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "853ae624",
   "metadata": {},
   "source": [
    "## Data and models files\n",
    "\n",
    "\n",
    "The datasets serialization produce YAML files listing the datasets and models. In the following cells we show an example containning only the Fermi-LAT dataset and the Crab model. \n",
    "\n",
    "Fermi-LAT-3FHL_datasets.yaml:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "f4347cf9",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-12T21:50:31.901639Z",
     "iopub.status.busy": "2022-05-12T21:50:31.900992Z",
     "iopub.status.idle": "2022-05-12T21:50:32.077194Z",
     "shell.execute_reply": "2022-05-12T21:50:32.076330Z"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "datasets:\r\n",
      "- name: Fermi-LAT\r\n",
      "  type: MapDataset\r\n",
      "  filename: Fermi-LAT-3FHL_data_Fermi-LAT.fits\r\n"
     ]
    }
   ],
   "source": [
    "!cat $GAMMAPY_DATA/fermi-3fhl-crab/Fermi-LAT-3FHL_datasets.yaml"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "cd98da35",
   "metadata": {},
   "source": [
    "We used as model a point source with a log-parabola spectrum. The initial parameters were taken from the latest Fermi-LAT catalog [4FGL](https://arxiv.org/abs/1902.10045), then we have re-optimized the spectral parameters for our dataset in the 10 GeV - 2 TeV energy range (fixing the source position).\n",
    "\n",
    "Fermi-LAT-3FHL_models.yaml:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "55080b6a",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-12T21:50:32.091615Z",
     "iopub.status.busy": "2022-05-12T21:50:32.091092Z",
     "iopub.status.idle": "2022-05-12T21:50:32.219769Z",
     "shell.execute_reply": "2022-05-12T21:50:32.218434Z"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "components:\r\n",
      "-   name: Crab Nebula\r\n",
      "    type: SkyModel\r\n",
      "    spectral:\r\n",
      "        type: LogParabolaSpectralModel\r\n",
      "        parameters:\r\n",
      "        -   name: amplitude\r\n",
      "            value: 0.018182745349064267\r\n",
      "            unit: cm-2 s-1 TeV-1\r\n",
      "            min: .nan\r\n",
      "            max: .nan\r\n",
      "            frozen: false\r\n",
      "            error: 0.003026327991562108\r\n",
      "        -   name: reference\r\n",
      "            value: 5.054833602905273e-05\r\n",
      "            unit: TeV\r\n",
      "            min: .nan\r\n",
      "            max: .nan\r\n",
      "            frozen: true\r\n",
      "            error: 0.0\r\n",
      "        -   name: alpha\r\n",
      "            value: 1.652368617859867\r\n",
      "            unit: ''\r\n",
      "            min: .nan\r\n",
      "            max: .nan\r\n",
      "            frozen: false\r\n",
      "            error: 0.05762513693893088\r\n",
      "        -   name: beta\r\n",
      "            value: 0.03921700077803329\r\n",
      "            unit: ''\r\n",
      "            min: .nan\r\n",
      "            max: .nan\r\n",
      "            frozen: false\r\n",
      "            error: 0.00521472221220211\r\n",
      "    spatial:\r\n",
      "        type: PointSpatialModel\r\n",
      "        frame: icrs\r\n",
      "        parameters:\r\n",
      "        -   name: lon_0\r\n",
      "            value: 83.63310241699219\r\n",
      "            unit: deg\r\n",
      "            min: .nan\r\n",
      "            max: .nan\r\n",
      "            frozen: true\r\n",
      "            error: 0.0\r\n",
      "        -   name: lat_0\r\n",
      "            value: 22.019899368286133\r\n",
      "            unit: deg\r\n",
      "            min: -90.0\r\n",
      "            max: 90.0\r\n",
      "            frozen: true\r\n",
      "            error: 0.0\r\n",
      "-   type: FoVBackgroundModel\r\n",
      "    datasets_names:\r\n",
      "    - Fermi-LAT\r\n",
      "    spectral:\r\n",
      "        type: PowerLawNormSpectralModel\r\n",
      "        parameters:\r\n",
      "        -   name: norm\r\n",
      "            value: 1.3004625872247901\r\n",
      "            unit: ''\r\n",
      "            min: 0.0\r\n",
      "            max: .nan\r\n",
      "            frozen: false\r\n",
      "            error: 0.07512322002655547\r\n",
      "        -   name: tilt\r\n",
      "            value: 0.0\r\n",
      "            unit: ''\r\n",
      "            min: .nan\r\n",
      "            max: .nan\r\n",
      "            frozen: true\r\n",
      "            error: 0.0\r\n",
      "        -   name: reference\r\n",
      "            value: 1.0\r\n",
      "            unit: TeV\r\n",
      "            min: .nan\r\n",
      "            max: .nan\r\n",
      "            frozen: true\r\n",
      "            error: 0.0\r\n"
     ]
    }
   ],
   "source": [
    "!cat $GAMMAPY_DATA/fermi-3fhl-crab/Fermi-LAT-3FHL_models.yaml"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "774ffb1c",
   "metadata": {},
   "source": [
    "## Reading  different datasets\n",
    "\n",
    "\n",
    "### Fermi-LAT 3FHL: map dataset for 3D analysis\n",
    "For now we let's use the datasets serialization only to read the 3D `MapDataset` associated to Fermi-LAT 3FHL data and models."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "a0dc904a",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-12T21:50:32.227964Z",
     "iopub.status.busy": "2022-05-12T21:50:32.227327Z",
     "iopub.status.idle": "2022-05-12T21:50:32.256166Z",
     "shell.execute_reply": "2022-05-12T21:50:32.254399Z"
    }
   },
   "outputs": [],
   "source": [
    "path = Path(\"$GAMMAPY_DATA/fermi-3fhl-crab\")\n",
    "filename = path / \"Fermi-LAT-3FHL_datasets.yaml\"\n",
    "\n",
    "datasets = Datasets.read(filename=filename)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "54aad17c",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-12T21:50:32.262954Z",
     "iopub.status.busy": "2022-05-12T21:50:32.262437Z",
     "iopub.status.idle": "2022-05-12T21:50:32.318899Z",
     "shell.execute_reply": "2022-05-12T21:50:32.316325Z"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Models\n",
      "\n",
      "Component 0: SkyModel\n",
      "\n",
      "  Name                      : Crab Nebula\n",
      "  Datasets names            : None\n",
      "  Spectral model type       : LogParabolaSpectralModel\n",
      "  Spatial  model type       : PointSpatialModel\n",
      "  Temporal model type       : \n",
      "  Parameters:\n",
      "    amplitude                     :   1.82e-02   +/- 3.0e-03 1 / (cm2 s TeV)\n",
      "    reference             (frozen):      0.000       TeV         \n",
      "    alpha                         :      1.652   +/-    0.06             \n",
      "    beta                          :      0.039   +/-    0.01             \n",
      "    lon_0                 (frozen):     83.633       deg         \n",
      "    lat_0                 (frozen):     22.020       deg         \n",
      "\n",
      "Component 1: FoVBackgroundModel\n",
      "\n",
      "  Name                      : Fermi-LAT-bkg\n",
      "  Datasets names            : ['Fermi-LAT']\n",
      "  Spectral model type       : PowerLawNormSpectralModel\n",
      "  Parameters:\n",
      "    norm                          :      1.300   +/-    0.08             \n",
      "    tilt                  (frozen):      0.000                   \n",
      "    reference             (frozen):      1.000       TeV         \n",
      "\n",
      "\n"
     ]
    }
   ],
   "source": [
    "models = Models.read(path / \"Fermi-LAT-3FHL_models.yaml\")\n",
    "print(models)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "033c1550",
   "metadata": {},
   "source": [
    "We get the Crab model in order to share it with the other datasets"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "15e01bba",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-12T21:50:32.341573Z",
     "iopub.status.busy": "2022-05-12T21:50:32.341059Z",
     "iopub.status.idle": "2022-05-12T21:50:32.349063Z",
     "shell.execute_reply": "2022-05-12T21:50:32.347662Z"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "SkyModel\n",
      "\n",
      "  Name                      : Crab Nebula\n",
      "  Datasets names            : None\n",
      "  Spectral model type       : LogParabolaSpectralModel\n",
      "  Spatial  model type       : PointSpatialModel\n",
      "  Temporal model type       : \n",
      "  Parameters:\n",
      "    amplitude                     :   1.82e-02   +/- 3.0e-03 1 / (cm2 s TeV)\n",
      "    reference             (frozen):      0.000       TeV         \n",
      "    alpha                         :      1.652   +/-    0.06             \n",
      "    beta                          :      0.039   +/-    0.01             \n",
      "    lon_0                 (frozen):     83.633       deg         \n",
      "    lat_0                 (frozen):     22.020       deg         \n",
      "\n",
      "\n"
     ]
    }
   ],
   "source": [
    "print(models[\"Crab Nebula\"])"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "0067b739",
   "metadata": {},
   "source": [
    "### HESS-DL3: 1D ON/OFF dataset for spectral fitting\n",
    "\n",
    "The ON/OFF datasets can be read from PHA files following the [OGIP standards](https://heasarc.gsfc.nasa.gov/docs/heasarc/ofwg/docs/spectra/ogip_92_007/node5.html).\n",
    "We read the PHA files from each observation, and compute a stacked dataset for simplicity.\n",
    "Then the Crab spectral model previously defined is added to the dataset."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "e9a4ed09",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-12T21:50:32.362358Z",
     "iopub.status.busy": "2022-05-12T21:50:32.360837Z",
     "iopub.status.idle": "2022-05-12T21:50:32.512253Z",
     "shell.execute_reply": "2022-05-12T21:50:32.511251Z"
    }
   },
   "outputs": [],
   "source": [
    "datasets_hess = Datasets()\n",
    "\n",
    "for obs_id in [23523, 23526]:\n",
    "    dataset = SpectrumDatasetOnOff.read(\n",
    "        f\"$GAMMAPY_DATA/joint-crab/spectra/hess/pha_obs{obs_id}.fits\"\n",
    "    )\n",
    "    datasets_hess.append(dataset)\n",
    "\n",
    "dataset_hess = datasets_hess.stack_reduce(name=\"HESS\")\n",
    "\n",
    "datasets.append(dataset_hess)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "23d1ae26",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-12T21:50:32.520613Z",
     "iopub.status.busy": "2022-05-12T21:50:32.519394Z",
     "iopub.status.idle": "2022-05-12T21:50:32.527537Z",
     "shell.execute_reply": "2022-05-12T21:50:32.525871Z"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Datasets\n",
      "--------\n",
      "\n",
      "Dataset 0: \n",
      "\n",
      "  Type       : MapDataset\n",
      "  Name       : Fermi-LAT\n",
      "  Instrument : \n",
      "  Models     : \n",
      "\n",
      "Dataset 1: \n",
      "\n",
      "  Type       : SpectrumDatasetOnOff\n",
      "  Name       : HESS\n",
      "  Instrument : \n",
      "  Models     : \n",
      "\n",
      "\n"
     ]
    }
   ],
   "source": [
    "print(datasets)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "9b94ea88",
   "metadata": {},
   "source": [
    "### HAWC: 1D dataset for flux point fitting\n",
    "\n",
    "The HAWC flux point are taken from https://arxiv.org/pdf/1905.12518.pdf Then these flux points are read from a pre-made FITS file and passed to a `FluxPointsDataset` together with the source spectral model.\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "e5131b2f",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-12T21:50:32.536745Z",
     "iopub.status.busy": "2022-05-12T21:50:32.536368Z",
     "iopub.status.idle": "2022-05-12T21:50:32.592032Z",
     "shell.execute_reply": "2022-05-12T21:50:32.588931Z"
    }
   },
   "outputs": [],
   "source": [
    "# read flux points from https://arxiv.org/pdf/1905.12518.pdf\n",
    "filename = \"$GAMMAPY_DATA/hawc_crab/HAWC19_flux_points.fits\"\n",
    "flux_points_hawc = FluxPoints.read(\n",
    "    filename, reference_model=create_crab_spectral_model(\"meyer\")\n",
    ")\n",
    "\n",
    "dataset_hawc = FluxPointsDataset(data=flux_points_hawc, name=\"HAWC\")\n",
    "\n",
    "datasets.append(dataset_hawc)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "ce286f37",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-12T21:50:32.598562Z",
     "iopub.status.busy": "2022-05-12T21:50:32.598239Z",
     "iopub.status.idle": "2022-05-12T21:50:32.603413Z",
     "shell.execute_reply": "2022-05-12T21:50:32.602400Z"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Datasets\n",
      "--------\n",
      "\n",
      "Dataset 0: \n",
      "\n",
      "  Type       : MapDataset\n",
      "  Name       : Fermi-LAT\n",
      "  Instrument : \n",
      "  Models     : \n",
      "\n",
      "Dataset 1: \n",
      "\n",
      "  Type       : SpectrumDatasetOnOff\n",
      "  Name       : HESS\n",
      "  Instrument : \n",
      "  Models     : \n",
      "\n",
      "Dataset 2: \n",
      "\n",
      "  Type       : FluxPointsDataset\n",
      "  Name       : HAWC\n",
      "  Instrument : \n",
      "  Models     : \n",
      "\n",
      "\n"
     ]
    }
   ],
   "source": [
    "print(datasets)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "eab8a039",
   "metadata": {},
   "source": [
    "## Datasets serialization\n",
    "\n",
    "The `datasets` object contains each dataset previously defined. \n",
    "It can be saved on disk as datasets.yaml, models.yaml, and several data files specific to each dataset. Then the `datasets` can be rebuild later from these files."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "8a726f64",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-12T21:50:32.614285Z",
     "iopub.status.busy": "2022-05-12T21:50:32.613516Z",
     "iopub.status.idle": "2022-05-12T21:50:32.994771Z",
     "shell.execute_reply": "2022-05-12T21:50:32.992698Z"
    }
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "HDU 'MASK_FIT' not found\n"
     ]
    }
   ],
   "source": [
    "path = Path(\"crab-3datasets\")\n",
    "path.mkdir(exist_ok=True)\n",
    "\n",
    "filename = path / \"crab_10GeV_100TeV_datasets.yaml\"\n",
    "\n",
    "datasets.write(filename, overwrite=True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "91fc1cc8",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-12T21:50:33.001186Z",
     "iopub.status.busy": "2022-05-12T21:50:33.000535Z",
     "iopub.status.idle": "2022-05-12T21:50:33.148944Z",
     "shell.execute_reply": "2022-05-12T21:50:33.147749Z"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "datasets:\r\n",
      "- name: Fermi-LAT\r\n",
      "  type: MapDataset\r\n",
      "  filename: Fermi-LAT.fits\r\n",
      "- name: HESS\r\n",
      "  type: SpectrumDatasetOnOff\r\n",
      "  filename: pha_obsHESS.fits\r\n",
      "- name: HAWC\r\n",
      "  type: FluxPointsDataset\r\n",
      "  filename: HAWC.fits\r\n"
     ]
    }
   ],
   "source": [
    "!cat crab-3datasets/crab_10GeV_100TeV_datasets.yaml"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "20a7c0aa",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-12T21:50:33.186760Z",
     "iopub.status.busy": "2022-05-12T21:50:33.180239Z",
     "iopub.status.idle": "2022-05-12T21:50:33.326734Z",
     "shell.execute_reply": "2022-05-12T21:50:33.325486Z"
    }
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "No reference model set for FluxMaps. Assuming point source with E^-2 spectrum.\n"
     ]
    }
   ],
   "source": [
    "datasets = Datasets.read(filename)\n",
    "datasets.models = models"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "id": "135958b9",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-12T21:50:33.334203Z",
     "iopub.status.busy": "2022-05-12T21:50:33.333611Z",
     "iopub.status.idle": "2022-05-12T21:50:33.339820Z",
     "shell.execute_reply": "2022-05-12T21:50:33.338907Z"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Datasets\n",
      "--------\n",
      "\n",
      "Dataset 0: \n",
      "\n",
      "  Type       : MapDataset\n",
      "  Name       : Fermi-LAT\n",
      "  Instrument : \n",
      "  Models     : ['Crab Nebula', 'Fermi-LAT-bkg']\n",
      "\n",
      "Dataset 1: \n",
      "\n",
      "  Type       : SpectrumDatasetOnOff\n",
      "  Name       : HESS\n",
      "  Instrument : \n",
      "  Models     : ['Crab Nebula']\n",
      "\n",
      "Dataset 2: \n",
      "\n",
      "  Type       : FluxPointsDataset\n",
      "  Name       : HAWC\n",
      "  Instrument : \n",
      "  Models     : ['Crab Nebula']\n",
      "\n",
      "\n"
     ]
    }
   ],
   "source": [
    "print(datasets)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "26a3bb12",
   "metadata": {},
   "source": [
    "## Joint analysis\n",
    "\n",
    "We run the fit on the `Datasets` object that include a dataset for each instrument\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "id": "8c0568a6",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-12T21:50:33.346443Z",
     "iopub.status.busy": "2022-05-12T21:50:33.345398Z",
     "iopub.status.idle": "2022-05-12T21:50:36.126645Z",
     "shell.execute_reply": "2022-05-12T21:50:36.120625Z"
    }
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "HDU 'MASK_FIT' not found\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "OptimizeResult\n",
      "\n",
      "\tbackend    : minuit\n",
      "\tmethod     : migrad\n",
      "\tsuccess    : True\n",
      "\tmessage    : Optimization terminated successfully.\n",
      "\tnfev       : 302\n",
      "\ttotal stat : -12697.22\n",
      "\n",
      "CovarianceResult\n",
      "\n",
      "\tbackend    : minuit\n",
      "\tmethod     : hesse\n",
      "\tsuccess    : True\n",
      "\tmessage    : Hesse terminated successfully.\n",
      "\n",
      "CPU times: user 2.25 s, sys: 47.4 ms, total: 2.3 s\n",
      "Wall time: 2.74 s\n"
     ]
    }
   ],
   "source": [
    "%%time\n",
    "fit_joint = Fit()\n",
    "results_joint = fit_joint.run(datasets=datasets)\n",
    "print(results_joint)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "b344fd30",
   "metadata": {},
   "source": [
    "Let's display only the parameters of the Crab spectral model"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "id": "3d3f8bfe",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-12T21:50:36.143019Z",
     "iopub.status.busy": "2022-05-12T21:50:36.130477Z",
     "iopub.status.idle": "2022-05-12T21:50:36.153215Z",
     "shell.execute_reply": "2022-05-12T21:50:36.151903Z"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "LogParabolaSpectralModel\n",
      "\n",
      "  type      name     value         unit        error   min max frozen is_norm link\n",
      "-------- --------- ---------- -------------- --------- --- --- ------ ------- ----\n",
      "spectral amplitude 3.9740e-03 cm-2 s-1 TeV-1 3.125e-04 nan nan  False    True     \n",
      "spectral reference 5.0548e-05            TeV 0.000e+00 nan nan   True   False     \n",
      "spectral     alpha 1.2634e+00                1.707e-02 nan nan  False   False     \n",
      "spectral      beta 6.1321e-02                9.448e-04 nan nan  False   False     \n"
     ]
    }
   ],
   "source": [
    "crab_spec = datasets[0].models[\"Crab Nebula\"].spectral_model\n",
    "print(crab_spec)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "1d06d0ce",
   "metadata": {},
   "source": [
    "We can compute flux points for Fermi-LAT and HESS datasets in order plot them together with the HAWC flux point."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "id": "fb8fc6ee",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-12T21:50:36.159416Z",
     "iopub.status.busy": "2022-05-12T21:50:36.158941Z",
     "iopub.status.idle": "2022-05-12T21:50:40.411016Z",
     "shell.execute_reply": "2022-05-12T21:50:40.406767Z"
    }
   },
   "outputs": [],
   "source": [
    "# compute Fermi-LAT and HESS flux points\n",
    "energy_edges = MapAxis.from_energy_bounds(\"10 GeV\", \"2 TeV\", nbin=5).edges\n",
    "\n",
    "flux_points_fermi = FluxPointsEstimator(\n",
    "    energy_edges=energy_edges,\n",
    "    source=\"Crab Nebula\",\n",
    ").run([datasets[\"Fermi-LAT\"]])\n",
    "\n",
    "\n",
    "energy_edges = MapAxis.from_bounds(\n",
    "    1, 15, nbin=6, interp=\"log\", unit=\"TeV\"\n",
    ").edges\n",
    "\n",
    "flux_points_hess = FluxPointsEstimator(\n",
    "    energy_edges=energy_edges, source=\"Crab Nebula\", selection_optional=[\"ul\"]\n",
    ").run([datasets[\"HESS\"]])"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "10764c00",
   "metadata": {},
   "source": [
    "Now, Let's plot the Crab spectrum fitted and the flux points of each instrument.\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "id": "5d5599c4",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-12T21:50:40.420487Z",
     "iopub.status.busy": "2022-05-12T21:50:40.419464Z",
     "iopub.status.idle": "2022-05-12T21:50:41.328029Z",
     "shell.execute_reply": "2022-05-12T21:50:41.326506Z"
    },
    "nbsphinx-thumbnail": {
     "tooltip": "Joint 3D analysis using 3D Fermi datasets, a H.E.S.S. reduced spectrum and HAWC flux points."
    }
   },
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 576x432 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "# display spectrum and flux points\n",
    "plt.figure(figsize=(8, 6))\n",
    "\n",
    "energy_bounds = [0.01, 300] * u.TeV\n",
    "sed_type = \"e2dnde\"\n",
    "\n",
    "ax = crab_spec.plot(\n",
    "    energy_bounds=energy_bounds, sed_type=sed_type, label=\"Model\"\n",
    ")\n",
    "crab_spec.plot_error(ax=ax, energy_bounds=energy_bounds, sed_type=sed_type)\n",
    "\n",
    "flux_points_fermi.plot(ax=ax, sed_type=sed_type, label=\"Fermi-LAT\")\n",
    "flux_points_hess.plot(ax=ax, sed_type=sed_type, label=\"HESS\")\n",
    "flux_points_hawc.plot(ax=ax, sed_type=sed_type, label=\"HAWC\")\n",
    "\n",
    "ax.set_xlim(energy_bounds)\n",
    "plt.legend();"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a5cee491",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.9.12"
  },
  "nbsphinx": {
   "orphan": true
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
