{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "e5e18a78",
   "metadata": {},
   "source": [
    "\n",
    "<div class=\"alert alert-info\">\n",
    "\n",
    "**This is a fixed-text formatted version of a Jupyter notebook**\n",
    "\n",
    "- Try online[![Binder](https://static.mybinder.org/badge.svg)](https://mybinder.org/v2/gh/gammapy/gammapy-webpage/v0.20?urlpath=lab/tree/tutorials/analysis/time/light_curve.ipynb)\n",
    "- You may download all the notebooks as a [tar file](../../../_downloads/notebooks-0.20.tar).\n",
    "- **Source files:**\n",
    "[light_curve.ipynb](../../../_static/notebooks/light_curve.ipynb) |\n",
    "[light_curve.py](../../../_static/notebooks/light_curve.py)\n",
    "</div>\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "4da67254",
   "metadata": {},
   "source": [
    "# Light curves\n",
    "\n",
    "## Prerequisites\n",
    "\n",
    "- Knowledge of the high level interface to perform data reduction, see [first gammapy analysis with the high level interface tutorial](../../starting/analysis_1.ipynb)\n",
    "\n",
    "## Context\n",
    "\n",
    "This tutorial presents how light curve extraction is performed in gammapy, i.e. how to measure the flux of a source\n",
    "in different time bins.\n",
    "\n",
    "Cherenkov telescopes usually work with observing runs and distribute data according to this basic time interval. A typical use case is to look for variability of a source on various time binnings: observation run-wise binning, nightly, weekly etc.\n",
    "\n",
    "**Objective: The Crab nebula is not known to be variable at TeV energies, so we expect constant brightness within statistical and systematic errors. Compute per-observation and nightly fluxes of the four Crab nebula observations from the H.E.S.S. first public test data release [o](https://www.mpi-hd.mpg.de/hfm/HESS/pages/dl3-dr1/) to check it.**\n",
    "\n",
    "## Proposed approach\n",
    "\n",
    "We will demonstrate how to compute a `~gammapy.estimators.LightCurve` from 3D reduced datasets (`~gammapy.datasets.MapDataset`) as well as 1D ON-OFF spectral datasets (`~gammapy.datasets.SpectrumDatasetOnOff`). \n",
    "\n",
    "The data reduction will be performed with the high level interface for the data reduction. Then we will use the `~gammapy.estimators.LightCurveEstimator` class, which  is able to extract a light curve independently of the dataset type. \n",
    "\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "f1863dc3",
   "metadata": {},
   "source": [
    "## Setup\n",
    "\n",
    "As usual, we'll start with some general imports..."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "e0e5995a",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-12T21:49:38.715573Z",
     "iopub.status.busy": "2022-05-12T21:49:38.715456Z",
     "iopub.status.idle": "2022-05-12T21:49:39.991535Z",
     "shell.execute_reply": "2022-05-12T21:49:39.990501Z"
    }
   },
   "outputs": [],
   "source": [
    "%matplotlib inline\n",
    "import matplotlib.pyplot as plt\n",
    "\n",
    "import astropy.units as u\n",
    "from astropy.coordinates import SkyCoord\n",
    "import logging\n",
    "\n",
    "from astropy.time import Time\n",
    "\n",
    "log = logging.getLogger(__name__)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "7fdfcadc",
   "metadata": {},
   "source": [
    "Now let's import gammapy specific classes and functions"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "18290806",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-12T21:49:39.997521Z",
     "iopub.status.busy": "2022-05-12T21:49:39.997361Z",
     "iopub.status.idle": "2022-05-12T21:49:41.099178Z",
     "shell.execute_reply": "2022-05-12T21:49:41.098156Z"
    }
   },
   "outputs": [],
   "source": [
    "from gammapy.modeling.models import PowerLawSpectralModel\n",
    "from gammapy.modeling.models import PointSpatialModel\n",
    "from gammapy.modeling.models import SkyModel, Models\n",
    "from gammapy.modeling import Fit\n",
    "from gammapy.estimators import LightCurveEstimator\n",
    "from gammapy.analysis import Analysis, AnalysisConfig"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "26c2155b",
   "metadata": {},
   "source": [
    "## Analysis configuration \n",
    "For the 1D and 3D extraction, we will use the same CrabNebula configuration than in the notebook analysis_1.ipynb using the high level interface of Gammapy.\n",
    "\n",
    "From the high level interface, the data reduction for those observations is performed as followed"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "306f55b3",
   "metadata": {},
   "source": [
    "### Building the 3D analysis configuration\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "a7bdb13e",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-12T21:49:41.109537Z",
     "iopub.status.busy": "2022-05-12T21:49:41.108867Z",
     "iopub.status.idle": "2022-05-12T21:49:41.133594Z",
     "shell.execute_reply": "2022-05-12T21:49:41.130997Z"
    }
   },
   "outputs": [],
   "source": [
    "conf_3d = AnalysisConfig()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "a4cd165f",
   "metadata": {},
   "source": [
    "#### Definition of the data selection\n",
    "\n",
    "Here we use the Crab runs from the HESS DL3 data release 1"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "3745acb2",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-12T21:49:41.144227Z",
     "iopub.status.busy": "2022-05-12T21:49:41.143515Z",
     "iopub.status.idle": "2022-05-12T21:49:41.159009Z",
     "shell.execute_reply": "2022-05-12T21:49:41.157219Z"
    }
   },
   "outputs": [],
   "source": [
    "conf_3d.observations.obs_ids = [23523, 23526, 23559, 23592]"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "4450f322",
   "metadata": {},
   "source": [
    "#### Definition of the dataset geometry"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "ed3d3d18",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-12T21:49:41.164795Z",
     "iopub.status.busy": "2022-05-12T21:49:41.164294Z",
     "iopub.status.idle": "2022-05-12T21:49:41.172474Z",
     "shell.execute_reply": "2022-05-12T21:49:41.169403Z"
    }
   },
   "outputs": [],
   "source": [
    "# We want a 3D analysis\n",
    "conf_3d.datasets.type = \"3d\"\n",
    "\n",
    "# We want to extract the data by observation and therefore to not stack them\n",
    "conf_3d.datasets.stack = False\n",
    "\n",
    "# Here is the WCS geometry of the Maps\n",
    "conf_3d.datasets.geom.wcs.skydir = dict(\n",
    "    frame=\"icrs\", lon=83.63308 * u.deg, lat=22.01450 * u.deg\n",
    ")\n",
    "conf_3d.datasets.geom.wcs.binsize = 0.02 * u.deg\n",
    "conf_3d.datasets.geom.wcs.width = dict(width=1 * u.deg, height=1 * u.deg)\n",
    "\n",
    "# We define a value for the IRF Maps binsize\n",
    "conf_3d.datasets.geom.wcs.binsize_irf = 0.2 * u.deg\n",
    "\n",
    "# Define energy binning for the Maps\n",
    "conf_3d.datasets.geom.axes.energy = dict(\n",
    "    min=0.7 * u.TeV, max=10 * u.TeV, nbins=5\n",
    ")\n",
    "conf_3d.datasets.geom.axes.energy_true = dict(\n",
    "    min=0.3 * u.TeV, max=20 * u.TeV, nbins=20\n",
    ")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "5a5b30a8",
   "metadata": {},
   "source": [
    "### Run the 3D data reduction"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "371fc6a8",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-12T21:49:41.180635Z",
     "iopub.status.busy": "2022-05-12T21:49:41.180254Z",
     "iopub.status.idle": "2022-05-12T21:49:44.593850Z",
     "shell.execute_reply": "2022-05-12T21:49:44.593017Z"
    }
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "Setting logging config: {'level': 'INFO', 'filename': None, 'filemode': None, 'format': None, 'datefmt': None}\n",
      "Fetching observations.\n",
      "Observations selected: 4 out of 4.\n",
      "Number of selected observations: 4\n",
      "Creating reference dataset and makers.\n",
      "Creating the background Maker.\n",
      "No background maker set. Check configuration.\n",
      "Start the data reduction loop.\n",
      "Computing dataset for observation 23523\n",
      "Running MapDatasetMaker\n",
      "Running SafeMaskMaker\n",
      "Computing dataset for observation 23526\n",
      "Running MapDatasetMaker\n",
      "Running SafeMaskMaker\n",
      "Computing dataset for observation 23559\n",
      "Running MapDatasetMaker\n",
      "Running SafeMaskMaker\n",
      "Computing dataset for observation 23592\n",
      "Running MapDatasetMaker\n",
      "Running SafeMaskMaker\n"
     ]
    }
   ],
   "source": [
    "analysis_3d = Analysis(conf_3d)\n",
    "analysis_3d.get_observations()\n",
    "analysis_3d.get_datasets()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "6039d2ed",
   "metadata": {},
   "source": [
    "### Define the model to be used\n",
    "\n",
    "Here we don't try to fit the model parameters to the whole dataset, but we use predefined values instead. "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "03b3299d",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-12T21:49:44.599669Z",
     "iopub.status.busy": "2022-05-12T21:49:44.599289Z",
     "iopub.status.idle": "2022-05-12T21:49:44.627221Z",
     "shell.execute_reply": "2022-05-12T21:49:44.625667Z"
    }
   },
   "outputs": [],
   "source": [
    "target_position = SkyCoord(ra=83.63308, dec=22.01450, unit=\"deg\")\n",
    "spatial_model = PointSpatialModel(\n",
    "    lon_0=target_position.ra, lat_0=target_position.dec, frame=\"icrs\"\n",
    ")\n",
    "\n",
    "spectral_model = PowerLawSpectralModel(\n",
    "    index=2.702,\n",
    "    amplitude=4.712e-11 * u.Unit(\"1 / (cm2 s TeV)\"),\n",
    "    reference=1 * u.TeV,\n",
    ")\n",
    "\n",
    "sky_model = SkyModel(\n",
    "    spatial_model=spatial_model, spectral_model=spectral_model, name=\"crab\"\n",
    ")\n",
    "# Now we freeze these parameters that we don't want the light curve estimator to change\n",
    "sky_model.parameters[\"index\"].frozen = True\n",
    "sky_model.parameters[\"lon_0\"].frozen = True\n",
    "sky_model.parameters[\"lat_0\"].frozen = True"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "b32d0bf0",
   "metadata": {},
   "source": [
    "We assign them the model to be fitted to each dataset"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "ce4106b8",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-12T21:49:44.632250Z",
     "iopub.status.busy": "2022-05-12T21:49:44.631952Z",
     "iopub.status.idle": "2022-05-12T21:49:44.643328Z",
     "shell.execute_reply": "2022-05-12T21:49:44.642522Z"
    }
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "Reading model.\n",
      "Models\n",
      "\n",
      "Component 0: SkyModel\n",
      "\n",
      "  Name                      : crab\n",
      "  Datasets names            : None\n",
      "  Spectral model type       : PowerLawSpectralModel\n",
      "  Spatial  model type       : PointSpatialModel\n",
      "  Temporal model type       : \n",
      "  Parameters:\n",
      "    index                 (frozen):      2.702                   \n",
      "    amplitude                     :   4.71e-11   +/- 0.0e+00 1 / (cm2 s TeV)\n",
      "    reference             (frozen):      1.000       TeV         \n",
      "    lon_0                 (frozen):     83.633       deg         \n",
      "    lat_0                 (frozen):     22.015       deg         \n",
      "\n",
      "Component 1: FoVBackgroundModel\n",
      "\n",
      "  Name                      : MC_6mfCo-bkg\n",
      "  Datasets names            : ['MC_6mfCo']\n",
      "  Spectral model type       : PowerLawNormSpectralModel\n",
      "  Parameters:\n",
      "    norm                          :      1.000   +/-    0.00             \n",
      "    tilt                  (frozen):      0.000                   \n",
      "    reference             (frozen):      1.000       TeV         \n",
      "\n",
      "Component 2: FoVBackgroundModel\n",
      "\n",
      "  Name                      : XRKs3EVL-bkg\n",
      "  Datasets names            : ['XRKs3EVL']\n",
      "  Spectral model type       : PowerLawNormSpectralModel\n",
      "  Parameters:\n",
      "    norm                          :      1.000   +/-    0.00             \n",
      "    tilt                  (frozen):      0.000                   \n",
      "    reference             (frozen):      1.000       TeV         \n",
      "\n",
      "Component 3: FoVBackgroundModel\n",
      "\n",
      "  Name                      : BF3KNxcT-bkg\n",
      "  Datasets names            : ['BF3KNxcT']\n",
      "  Spectral model type       : PowerLawNormSpectralModel\n",
      "  Parameters:\n",
      "    norm                          :      1.000   +/-    0.00             \n",
      "    tilt                  (frozen):      0.000                   \n",
      "    reference             (frozen):      1.000       TeV         \n",
      "\n",
      "Component 4: FoVBackgroundModel\n",
      "\n",
      "  Name                      : NHA6yjbb-bkg\n",
      "  Datasets names            : ['NHA6yjbb']\n",
      "  Spectral model type       : PowerLawNormSpectralModel\n",
      "  Parameters:\n",
      "    norm                          :      1.000   +/-    0.00             \n",
      "    tilt                  (frozen):      0.000                   \n",
      "    reference             (frozen):      1.000       TeV         \n",
      "\n",
      "\n"
     ]
    }
   ],
   "source": [
    "models = Models([sky_model])\n",
    "analysis_3d.set_models(models)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "72c2b5d4",
   "metadata": {},
   "source": [
    "## Light Curve estimation by observation\n",
    "\n",
    "We can now create the light curve estimator.\n",
    "\n",
    "We pass it the list of datasets and the name of the model component for which we want to build the light curve. \n",
    "We can optionally ask for parameters reoptimization during fit, that is most of the time to fit background normalization in each time bin. \n",
    "\n",
    "If we don't set any time interval, the `~gammapy.estimators.LightCurveEstimator` is determines the flux of each dataset and places it at the corresponding time in the light curve. \n",
    "Here one dataset equals to one observing run."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "5460e99e",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-12T21:49:44.649254Z",
     "iopub.status.busy": "2022-05-12T21:49:44.648914Z",
     "iopub.status.idle": "2022-05-12T21:49:51.271528Z",
     "shell.execute_reply": "2022-05-12T21:49:51.268011Z"
    }
   },
   "outputs": [],
   "source": [
    "lc_maker_3d = LightCurveEstimator(\n",
    "    energy_edges=[1, 10] * u.TeV, source=\"crab\", reoptimize=False\n",
    ")\n",
    "lc_3d = lc_maker_3d.run(analysis_3d.datasets)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "d7c007da",
   "metadata": {},
   "source": [
    "The LightCurve object contains a table which we can explore."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "35f9e5bd",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-12T21:49:51.305077Z",
     "iopub.status.busy": "2022-05-12T21:49:51.303625Z",
     "iopub.status.idle": "2022-05-12T21:49:51.837210Z",
     "shell.execute_reply": "2022-05-12T21:49:51.836077Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<AxesSubplot:xlabel='Time [iso]', ylabel='dnde (1 / (cm2 s TeV))'>"
      ]
     },
     "execution_count": 10,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "iVBORw0KGgoAAAANSUhEUgAAAakAAAE6CAYAAACs3q22AAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjUuMiwgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy8qNh9FAAAACXBIWXMAAAsTAAALEwEAmpwYAAA3IklEQVR4nO3de5wU1Z3//9ebi0FEQVGyKhoQiMagggLGNUZIRBF1xQRFckNlUXaj0Vx2f/qNWZP96hpNvn69xHtQcfUrERPwEgQ1F10vMYgrUUATBC+jbEBUxAsC8vn9cWqwaWamu5np6WLm/Xw86kFX1emq91QPc/pUnTqliMDMzCyPOtQ6gJmZWWNcSZmZWW65kjIzs9xyJWVmZrnlSsrMzHLLlZSZmeVWp1oHaGt23nnn6NOnT61jmJltNebNm/dGROzS0DpXUi2sT58+PPXUU7WOYWa21ZD0cmPrfLrPzMxyy5WUmZnllispMzPLLV+TMrM2Yd26ddTV1bFmzZpaR7FGdOnShd69e9O5c+ey3+NKyszahLq6Orbffnv69OmDpFrHsSIRwcqVK6mrq6Nv375lv8+n+8ysTVizZg09e/Z0BZVTkujZs2fFLV1XUmbWZlRaQY27/gnGXf9EldJYsS35AuFKysysBaxZs4Zhw4ZxwAEH8NnPfpYLLrigyfJz586lY8eO3HXXXRuX9enTh/32249BgwYxZMiQFsk1depUBgwYwIABA5g6derG5UuXLuXggw9mwIABjBs3jrVr127yvjlz5jBo0CAGDRpEt27d2HvvvRk0aBDf/OY3N9vHKaecwvXXX7/JspkzZzJ69Ojm/wAR4algAvYCpgB3FSwbA9wI3A0c2dT7DzrooDCz1rdw4cKK33PSdY/HSdc93iL737BhQ6xevToiItauXRvDhg2LJ554osGy69evjxEjRsTRRx8d06dP37j8U5/6VKxYsWKL9n/44YfH0qVLN1m2cuXK6Nu3b6xcuTLefPPN6Nu3b7z55psREXHiiSfGHXfcERERZ5xxRlxzzTVNbnvu3LkNrlu8fHXcNG1GDB8+fJPl48aNi1tvvXWz8g19TsBT0cjf1Kq1pCTtIen3khZJWiDp7AbKdJH0J0nzszI/buY+b5K0XNJzRctHSXpB0mJJ5za1jYhYEhETi5bNjIhJwCnAuOZkNLN8eGXl+8yve5snl77JyMse5pWV7zdre5Lo1q0bkHoarlu3rtHTW1dddRVf+cpX6NWrV1nbfvHFFxk1ahQHHXQQhx12GM8//3xZ75szZw4jR45kp512Yscdd2TkyJHMnj2biOB3v/sdY8eOBWDChAnMnDmzrG3edtttDBs2jEGDBnHGGWfw0UcfcejhI3j++edZtmwZAO+//z4PPfQQY8aMKWubTanm6b71wPci4jPA54BvSdq3qMyHwBcj4gBgEDBK0ucKC0jqJWn7omX9G9nnLcCoorIdgauBo4F9gfH1OSTtJ+m+oqmp35rzs22Z2Vao/hrUuOuf4MjLH2bNug0A/HX5uxx5+cPNvkb10UcfMWjQIHr16sXIkSM5+OCDNyvz2muvMWPGDCZPnrzZOkkceeSRHHTQQdxwww0bl59++ulcddVVzJs3j5/97Gf88z//c1l5XnvtNfbYY4+N87179+a1115j5cqV9OjRg06dOm2yvJRFixbxy1/+kscee4xnnnmGjh07cs9dv6Rjx458+ctf5s477wTgnnvuYcSIEWy//fYltlha1bqgR8QyYFn2erWkRcDuwMKCMgG8m812zqYo2tThwD9JGh0RayRNAk4ANjvZGRGPSOpTtHgYsDgilgBImgYcDyyMiGeBY0v9LEpfh34C3B8RT5cqb2b5V19BNTa/JTp27MgzzzzD22+/zQknnMBzzz3HwIEDNylzzjnncMkll9CxY8fN3v/YY4+x2267sXz5ckaOHMk+++zDgQceyOOPP86JJ564sdyHH34IwM0338wVV1wBwOLFixk9ejTbbLMNffv2ZcaMGfWXKzYhqdHlpfz2t79l3rx5DB06FIAPPviATtv1AGD8+PH8y7/8C2effTbTpk1r8NrVlmiV+6SyimMw8GQD6zoC84D+wNURsUmZiJguqS8wTdJ04DRgZAW73x14tWC+Dtj8683HeXoCFwGDJZ0XERcDZwFHAN0l9Y+I6xp433HAcf37N9bIM7Na++UZh2x8PfKyh/nr8vQduYOg3y7dNlnfHD169GD48OHMnj17s0rqqaee4uSTTwbgjTfeYNasWXTq1IkxY8aw2267AdCrVy9OOOEE/vSnPzFo0CB69OjBM888s9l+Tj31VE499VQAhg8fzi233ELhUxh69+7NH/7wh43zdXV1DB8+nJ133pm3336b9evX06lTJ+rq6jbu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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "lc_3d.plot(axis_name=\"time\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "f0b74583",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-12T21:49:51.843065Z",
     "iopub.status.busy": "2022-05-12T21:49:51.842784Z",
     "iopub.status.idle": "2022-05-12T21:49:51.906157Z",
     "shell.execute_reply": "2022-05-12T21:49:51.905000Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div><i>Table length=4</i>\n",
       "<table id=\"table6144365760\" class=\"table-striped table-bordered table-condensed\">\n",
       "<thead><tr><th>time_min</th><th>time_max</th><th>e_min [1]</th><th>e_max [1]</th><th>flux [1]</th><th>flux_err [1]</th></tr></thead>\n",
       "<thead><tr><th></th><th></th><th>TeV</th><th>TeV</th><th>1 / (cm2 s)</th><th>1 / (cm2 s)</th></tr></thead>\n",
       "<thead><tr><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th></tr></thead>\n",
       "<tr><td>53343.922340092584</td><td>53343.94186555555</td><td>1.191457161449437</td><td>10.000000000000002</td><td>2.0380210271197794e-11</td><td>2.1205833943560366e-12</td></tr>\n",
       "<tr><td>53343.954215092584</td><td>53343.97369425925</td><td>1.191457161449437</td><td>10.000000000000002</td><td>2.061095350246212e-11</td><td>2.1406685689437862e-12</td></tr>\n",
       "<tr><td>53345.96198129629</td><td>53345.98149518518</td><td>1.191457161449437</td><td>10.000000000000002</td><td>2.1806916394335914e-11</td><td>2.78937151632376e-12</td></tr>\n",
       "<tr><td>53347.91319657407</td><td>53347.932710462956</td><td>1.191457161449437</td><td>10.000000000000002</td><td>2.5084878816023824e-11</td><td>2.914172443640524e-12</td></tr>\n",
       "</table></div>"
      ],
      "text/plain": [
       "<Table length=4>\n",
       "     time_min           time_max          e_min [1]         e_max [1]             flux [1]             flux_err [1]     \n",
       "                                             TeV               TeV              1 / (cm2 s)            1 / (cm2 s)      \n",
       "     float64            float64            float64           float64              float64                float64        \n",
       "------------------ ------------------ ----------------- ------------------ ---------------------- ----------------------\n",
       "53343.922340092584  53343.94186555555 1.191457161449437 10.000000000000002 2.0380210271197794e-11 2.1205833943560366e-12\n",
       "53343.954215092584  53343.97369425925 1.191457161449437 10.000000000000002  2.061095350246212e-11 2.1406685689437862e-12\n",
       " 53345.96198129629  53345.98149518518 1.191457161449437 10.000000000000002 2.1806916394335914e-11   2.78937151632376e-12\n",
       " 53347.91319657407 53347.932710462956 1.191457161449437 10.000000000000002 2.5084878816023824e-11  2.914172443640524e-12"
      ]
     },
     "execution_count": 11,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "table = lc_3d.to_table(format=\"lightcurve\", sed_type=\"flux\")\n",
    "table[\"time_min\", \"time_max\", \"e_min\", \"e_max\", \"flux\", \"flux_err\"]"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "119e987e",
   "metadata": {},
   "source": [
    "## Running the light curve extraction in 1D"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "984489eb",
   "metadata": {},
   "source": [
    "### Building the 1D analysis configuration\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "f99be5e9",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-12T21:49:51.911705Z",
     "iopub.status.busy": "2022-05-12T21:49:51.911390Z",
     "iopub.status.idle": "2022-05-12T21:49:51.917772Z",
     "shell.execute_reply": "2022-05-12T21:49:51.916685Z"
    }
   },
   "outputs": [],
   "source": [
    "conf_1d = AnalysisConfig()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "b553432f",
   "metadata": {},
   "source": [
    "#### Definition of the data selection\n",
    "\n",
    "Here we use the Crab runs from the HESS DL3 data release 1"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "05d73e44",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-12T21:49:51.922390Z",
     "iopub.status.busy": "2022-05-12T21:49:51.921845Z",
     "iopub.status.idle": "2022-05-12T21:49:51.927045Z",
     "shell.execute_reply": "2022-05-12T21:49:51.926205Z"
    }
   },
   "outputs": [],
   "source": [
    "conf_1d.observations.obs_ids = [23523, 23526, 23559, 23592]"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "69fa58d7",
   "metadata": {},
   "source": [
    "#### Definition of the dataset geometry"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "id": "c0ef28da",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-12T21:49:51.931837Z",
     "iopub.status.busy": "2022-05-12T21:49:51.931194Z",
     "iopub.status.idle": "2022-05-12T21:49:51.940510Z",
     "shell.execute_reply": "2022-05-12T21:49:51.939457Z"
    }
   },
   "outputs": [],
   "source": [
    "# We want a 1D analysis\n",
    "conf_1d.datasets.type = \"1d\"\n",
    "\n",
    "# We want to extract the data by observation and therefore to not stack them\n",
    "conf_1d.datasets.stack = False\n",
    "\n",
    "# Here we define the ON region and make sure that PSF leakage is corrected\n",
    "conf_1d.datasets.on_region = dict(\n",
    "    frame=\"icrs\",\n",
    "    lon=83.63308 * u.deg,\n",
    "    lat=22.01450 * u.deg,\n",
    "    radius=0.1 * u.deg,\n",
    ")\n",
    "conf_1d.datasets.containment_correction = True\n",
    "\n",
    "# Finally we define the energy binning for the spectra\n",
    "conf_1d.datasets.geom.axes.energy = dict(\n",
    "    min=0.7 * u.TeV, max=10 * u.TeV, nbins=5\n",
    ")\n",
    "conf_1d.datasets.geom.axes.energy_true = dict(\n",
    "    min=0.3 * u.TeV, max=20 * u.TeV, nbins=20\n",
    ")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "12827f44",
   "metadata": {},
   "source": [
    "### Run the 1D data reduction"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "id": "35118d1c",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-12T21:49:51.946337Z",
     "iopub.status.busy": "2022-05-12T21:49:51.945753Z",
     "iopub.status.idle": "2022-05-12T21:49:53.612253Z",
     "shell.execute_reply": "2022-05-12T21:49:53.610034Z"
    }
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "Setting logging config: {'level': 'INFO', 'filename': None, 'filemode': None, 'format': None, 'datefmt': None}\n",
      "Fetching observations.\n",
      "Observations selected: 4 out of 4.\n",
      "Number of selected observations: 4\n",
      "Reducing spectrum datasets.\n",
      "Creating the background Maker.\n",
      "No background maker set. Check configuration.\n"
     ]
    }
   ],
   "source": [
    "analysis_1d = Analysis(conf_1d)\n",
    "analysis_1d.get_observations()\n",
    "analysis_1d.get_datasets()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "ab252db9",
   "metadata": {},
   "source": [
    "### Define the model to be used\n",
    "\n",
    "Here we don't try to fit the model parameters to the whole dataset, but we use predefined values instead. "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "id": "b7f9877d",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-12T21:49:53.636264Z",
     "iopub.status.busy": "2022-05-12T21:49:53.635011Z",
     "iopub.status.idle": "2022-05-12T21:49:53.666152Z",
     "shell.execute_reply": "2022-05-12T21:49:53.662287Z"
    }
   },
   "outputs": [],
   "source": [
    "target_position = SkyCoord(ra=83.63308, dec=22.01450, unit=\"deg\")\n",
    "\n",
    "spectral_model = PowerLawSpectralModel(\n",
    "    index=2.702,\n",
    "    amplitude=4.712e-11 * u.Unit(\"1 / (cm2 s TeV)\"),\n",
    "    reference=1 * u.TeV,\n",
    ")\n",
    "\n",
    "sky_model = SkyModel(spectral_model=spectral_model, name=\"crab\")\n",
    "# Now we freeze these parameters that we don't want the light curve estimator to change\n",
    "sky_model.parameters[\"index\"].frozen = True"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "3caf1c3e",
   "metadata": {},
   "source": [
    "We assign the model to be fitted to each dataset. We can use the same `~gammapy.modeling.models.SkyModel` as before."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "id": "e6440902",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-12T21:49:53.685513Z",
     "iopub.status.busy": "2022-05-12T21:49:53.684665Z",
     "iopub.status.idle": "2022-05-12T21:49:53.709804Z",
     "shell.execute_reply": "2022-05-12T21:49:53.708805Z"
    }
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "Reading model.\n",
      "Models\n",
      "\n",
      "Component 0: SkyModel\n",
      "\n",
      "  Name                      : crab\n",
      "  Datasets names            : None\n",
      "  Spectral model type       : PowerLawSpectralModel\n",
      "  Spatial  model type       : \n",
      "  Temporal model type       : \n",
      "  Parameters:\n",
      "    index                 (frozen):      2.702                   \n",
      "    amplitude                     :   4.71e-11   +/- 0.0e+00 1 / (cm2 s TeV)\n",
      "    reference             (frozen):      1.000       TeV         \n",
      "\n",
      "\n"
     ]
    }
   ],
   "source": [
    "models = Models([sky_model])\n",
    "analysis_1d.set_models(models)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "6948b905",
   "metadata": {},
   "source": [
    "### Extracting the light curve"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "id": "24a76e12",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-12T21:49:53.718289Z",
     "iopub.status.busy": "2022-05-12T21:49:53.717978Z",
     "iopub.status.idle": "2022-05-12T21:49:54.391050Z",
     "shell.execute_reply": "2022-05-12T21:49:54.389530Z"
    }
   },
   "outputs": [],
   "source": [
    "lc_maker_1d = LightCurveEstimator(\n",
    "    energy_edges=[1, 10] * u.TeV, source=\"crab\", reoptimize=False\n",
    ")\n",
    "lc_1d = lc_maker_1d.run(analysis_1d.datasets)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "id": "7351a354",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-12T21:49:54.405741Z",
     "iopub.status.busy": "2022-05-12T21:49:54.404850Z",
     "iopub.status.idle": "2022-05-12T21:49:54.425447Z",
     "shell.execute_reply": "2022-05-12T21:49:54.423765Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "['energy', 'time']"
      ]
     },
     "execution_count": 19,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "lc_1d.geom.axes.names"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "id": "cdcdd22e",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-12T21:49:54.444807Z",
     "iopub.status.busy": "2022-05-12T21:49:54.444381Z",
     "iopub.status.idle": "2022-05-12T21:49:54.523387Z",
     "shell.execute_reply": "2022-05-12T21:49:54.522013Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div><i>Table length=4</i>\n",
       "<table id=\"table6149957472\" class=\"table-striped table-bordered table-condensed\">\n",
       "<thead><tr><th>time_min</th><th>time_max</th><th>e_ref [1]</th><th>e_min [1]</th><th>e_max [1]</th><th>flux [1]</th><th>flux_err [1]</th><th>ts [1]</th><th>sqrt_ts [1]</th><th>npred [1,4]</th><th>npred_excess [1,4]</th><th>stat [1]</th><th>is_ul [1]</th><th>counts [1,4]</th><th>success [1]</th></tr></thead>\n",
       "<thead><tr><th></th><th></th><th>TeV</th><th>TeV</th><th>TeV</th><th>1 / (cm2 s)</th><th>1 / (cm2 s)</th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th></tr></thead>\n",
       "<thead><tr><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>bool</th><th>float64</th><th>bool</th></tr></thead>\n",
       "<tr><td>53343.922340092584</td><td>53343.94186555555</td><td>3.4517490659800822</td><td>1.191457161449437</td><td>10.000000000000002</td><td>2.2143915082283826e-11</td><td>2.46043438709985e-12</td><td>9669.93681384043</td><td>98.3358368746635</td><td>80.99951140280142 .. nan</td><td>80.99950408935547 .. nan</td><td>-344.46719038026515</td><td>False</td><td>81.0 .. nan</td><td>True</td></tr>\n",
       "<tr><td>53343.954215092584</td><td>53343.97369425925</td><td>3.4517490659800822</td><td>1.191457161449437</td><td>10.000000000000002</td><td>1.8788302509399298e-11</td><td>2.2297607397555523e-12</td><td>8464.484921386465</td><td>92.00263540457124</td><td>nan .. nan</td><td>nan .. nan</td><td>-290.30784403249163</td><td>False</td><td>nan .. nan</td><td>True</td></tr>\n",
       "<tr><td>53345.96198129629</td><td>53345.98149518518</td><td>3.4517490659800822</td><td>1.191457161449437</td><td>10.000000000000002</td><td>2.1553175393191787e-11</td><td>3.0180475449692493e-12</td><td>6065.962232361473</td><td>77.88428745492554</td><td>nan .. nan</td><td>nan .. nan</td><td>-194.37024721988715</td><td>False</td><td>nan .. nan</td><td>True</td></tr>\n",
       "<tr><td>53347.91319657407</td><td>53347.932710462956</td><td>3.4517490659800822</td><td>1.191457161449437</td><td>10.000000000000002</td><td>2.485367385298985e-11</td><td>3.2356719941454455e-12</td><td>7019.342401645411</td><td>83.78151587101662</td><td>nan .. 58.99955742868726</td><td>nan .. 58.99955749511719</td><td>-226.71637961887058</td><td>False</td><td>nan .. 59.0</td><td>True</td></tr>\n",
       "</table></div>"
      ],
      "text/plain": [
       "<Table length=4>\n",
       "     time_min           time_max          e_ref [1]          e_min [1]         e_max [1]             flux [1]        ...    npred_excess [1,4]          stat [1]      is_ul [1] counts [1,4] success [1]\n",
       "                                             TeV                TeV               TeV              1 / (cm2 s)       ...                                                                                \n",
       "     float64            float64            float64            float64           float64              float64         ...         float64                float64          bool     float64        bool   \n",
       "------------------ ------------------ ------------------ ----------------- ------------------ ---------------------- ... ------------------------ ------------------- --------- ------------ -----------\n",
       "53343.922340092584  53343.94186555555 3.4517490659800822 1.191457161449437 10.000000000000002 2.2143915082283826e-11 ... 80.99950408935547 .. nan -344.46719038026515     False  81.0 .. nan        True\n",
       "53343.954215092584  53343.97369425925 3.4517490659800822 1.191457161449437 10.000000000000002 1.8788302509399298e-11 ...               nan .. nan -290.30784403249163     False   nan .. nan        True\n",
       " 53345.96198129629  53345.98149518518 3.4517490659800822 1.191457161449437 10.000000000000002 2.1553175393191787e-11 ...               nan .. nan -194.37024721988715     False   nan .. nan        True\n",
       " 53347.91319657407 53347.932710462956 3.4517490659800822 1.191457161449437 10.000000000000002  2.485367385298985e-11 ... nan .. 58.99955749511719 -226.71637961887058     False  nan .. 59.0        True"
      ]
     },
     "execution_count": 20,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "lc_1d.to_table(sed_type=\"flux\", format=\"lightcurve\")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "d212ca33",
   "metadata": {},
   "source": [
    "### Compare results\n",
    "\n",
    "Finally we compare the result for the 1D and 3D lightcurve in a single figure:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "id": "59adc2c6",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-12T21:49:54.529217Z",
     "iopub.status.busy": "2022-05-12T21:49:54.528680Z",
     "iopub.status.idle": "2022-05-12T21:49:54.931827Z",
     "shell.execute_reply": "2022-05-12T21:49:54.929275Z"
    },
    "nbsphinx-thumbnail": {
     "tooltip": "Compute per-observation and nightly fluxes of four Crab nebula observations."
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<matplotlib.legend.Legend at 0x16cbf05e0>"
      ]
     },
     "execution_count": 21,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "ax = lc_1d.plot(marker=\"o\", label=\"1D\")\n",
    "lc_3d.plot(ax=ax, marker=\"o\", label=\"3D\")\n",
    "plt.legend()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "fbde5e44",
   "metadata": {},
   "source": [
    "## Night-wise LC estimation\n",
    "\n",
    "Here we want to extract a night curve per night. We define the time intervals that cover the three nights."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "id": "a0f4712d",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-12T21:49:54.960746Z",
     "iopub.status.busy": "2022-05-12T21:49:54.959932Z",
     "iopub.status.idle": "2022-05-12T21:49:54.964898Z",
     "shell.execute_reply": "2022-05-12T21:49:54.963765Z"
    }
   },
   "outputs": [],
   "source": [
    "time_intervals = [\n",
    "    Time([53343.5, 53344.5], format=\"mjd\", scale=\"utc\"),\n",
    "    Time([53345.5, 53346.5], format=\"mjd\", scale=\"utc\"),\n",
    "    Time([53347.5, 53348.5], format=\"mjd\", scale=\"utc\"),\n",
    "]"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "86784c1f",
   "metadata": {},
   "source": [
    "To compute the LC on the time intervals defined above, we pass the `LightCurveEstimator` the list of time intervals. \n",
    "\n",
    "Internally, datasets are grouped per time interval and a flux extraction is performed for each group."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "id": "e719ab3c",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-12T21:49:54.970697Z",
     "iopub.status.busy": "2022-05-12T21:49:54.970372Z",
     "iopub.status.idle": "2022-05-12T21:49:58.513804Z",
     "shell.execute_reply": "2022-05-12T21:49:58.510930Z"
    }
   },
   "outputs": [
    {
     "data": {
      "image/png": "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Ll26rHO8Na+++iq//e1vefLJJ5kzZw61tbXceeed1NbWcvjhh3PXXXcBMH36dMaOHUvfvn1buWI5CWpr4205450fnMuLQlJqab8damtrmTNnDkuWLOGwww7j5ZdfZscdd1znnLPOOotLLrmE2mY+IJ988kmGDBnCggULGDduHNtttx277rorTz31FEcdddTa81atWgXAzTffzBVXXAHA66+/zsSJE+nWrRvDhw9n6tSphHGg65LU4vHWPProo8yePZvdd98dgBUrVqxt9U2aNInvfOc7nHnmmUyZMqXZZ1EVJXLZGorDE5NzWVbc++7qPUJLCcIH2qBtytY7r3///owZM4YZM2asl5hmzZrFsceGyUYXLlzIAw88QJcuXTj00EMZMmQIAIMHD+awww7j2WefZeTIkfTv3585c+asH85JJ3HSSScB4RnTLbfcwrBhw9a+PnToUP7whz+s3a+rq2PMmDEMGjSIJUuWUF9fT5cuXairq1tbdilmxgknnMBFF1203mt777037777Li+88AJPPfXUes+cEpHD50dxdM507FweTZoCXXuGrwdtE/Y74L333mPJkiVAaEk88sgjbLfdduud99ZbbzF37lzmzp3LkUceyTXXXMOhhx7KRx99xLJlywD46KOPmDlzJjvuuCMbbLABw4cP5+677wZCcnjhhRdi1Wn8+PHMnDmTxYsXs3jxYmbOnMn48eORxNixY9f2CLz11ls55JCma+Gtb7/99uOee+5hwYKwXNv777/P22+HicElcfTRR3PCCScwceJEevToEauO5eO98pxzWbfhcBiyG3xiH/jaM2G/A959913Gjh3LTjvtxO677864ceM4+OCDAbjuuuu47rr1li9bx3/+8x/22Wcfdt55Z0aPHs1BBx3EhAlhgYE777yTm266aW1X9HvvvTdeiBtuyP/8z/+w++67s/vuu/PDH/6QDTfcEIBLLrmEyy+/nK233ppFixZxyimntHq9HXbYgQsuuIADDjiAnXbaiXHjxq3t8ADhdt4LL7ywtkWYuE7aK0/N3Zt16xs1apT5ekwuSa+++irbb799297kA2wT19zPSdLsEusjxVLTb3PrvueZsc5dOfM7HS4vTfwZk3N54gkpX3J4my4OT0zOOZdWObxNF4cnJuecS6XyrceUNZ6YnEsxM/PZxVOs4s/oO+nPvnOmY+cyoEePHixatKjyH36uXQrrMVWsG3lhgG0n7C7uLSbnUmro0KHU1dXx3nvvVbsqFdOY4ZwroFv3HgweshnL11QikGQWCpS0IfBbYBgwFzjazBY3c95cYBnQANRXshegJybnUqpr166VWRk1RRZ+WF/tKnTY6gZY3dBQmYsn0xo6B3jUzC6WdE60f3YL5441s4WVrpAnJudc1axYXaEP9LxI5hnTIcCY6OtbgT/QcmJKhCcm51zVeGIqQYn1ytvYzN4FMLN3JbW0dokBMyUZcL2ZTW7hvA7zxOScq5oVazwxlRS/xTRIUvHUNJOLE4ekR4BNmnnfuW2ozd5mNj9KXA9Les3MnmjD+2PzxOSccynVhqECC0t1RjCz/UuU8R9Jm0atpU2BBS1cY3707wJJU4HRgCcm51y++K28loU7eYk8Y5oOnABcHP273oy6knoDNWa2LPr6AODHlaqQJybnXNUsW539XnmVo6QGV18M3CXpFOAd4CgASUOAG81sIrAxMDWqTxfg12Y2o1IV8sTknKuaD9d4YiolicRkZouA/Zo5Ph+YGH39JrBzxSsT8cTknKuaZavXVLsKqdZZp6PyxOSccynlick55xK2dJXfymuJpKQ6P6SOJybnXNUsWeG98krxFpNzziXsg5WemErxxOSccwn7YKXfyivFE5Nzzrn0ULR1Qp6YnHNV85G3mEryFpNzziVsuffKa5EQNTX5W502Dk9Mzrmq+cgTU2mds8Hkick551JJfivPOecSt8KfMZXkick55xK2cqXPlVeKJybnnEvYqlU+wLYlSm7Zi9TxxOScq5qVfiuvZcktFJg6npiccy6lvMXknHMJW+0r2Jbkicm5nPhgZWO1q1ARG/TI32DL+oQS0139fgrA0Uu/n0h5ZdM585InJpc/y1fn84F6HhPTmoRWsDWzRMsrlyRaTJKOAn4EbA+MNrNZLZw3AbgCqAVuNLOLK1Wn/P2f7pxzOSCFKYnibB30MnA48ESJutQCVwMHAjsAkyTt0NGCW+ItJpc7K3LaYoKu1a5A2SXVgmlsbEy0vHJJosVkZq/GKGs08LqZvRmdOwU4BPhbJerkicnlTn4TU/7Ur0nmGVPhVl5S5ZVNep4xbQb8q2i/DtijUoV5YnLOuZRqQ4tpkKTiZ0OTzWxy0XUeATZp5n3nmtm9carSzDGLW7m2ipWYJNUAOwNDgBXAK2b2n0pVyrmO8BmrsyOpXnlrW0xZ6p7etklcF5rZqJZeNLP9O1ibOmDzov2hwPwOXrNFJROTpK2As4H9gX8C7wE9gG0kLQeuB241s3z2z3WZtMwTU2Y0rl6ZUEGNyZZXBgJSNIzpOWCEpOHAPOBY4AstnayQUb8IbGlmP5a0BbCJmT0bp7DWWkwXANcCX7HCnxwfFzw4qtjxwK1xCnMuCUtWra52FVxcaxJKFIW/nZMqryxETQJTEkk6DLgK2Aj4vaQ5ZjZe0hBCt/CJZlYv6QzgIUJ38V+Z2SslLnsN0Ah8FvgxsAz4HbB7nDqVTExmNqnEawuAX8QpxDnnXNsl1CtvKjC1mePzgYlF+w8AD8S87B5mtqukv0bvXSypW9w6xX3GNBjYm4+fMb0MzPJbeC6NlmSsS3CnVp9Q67Zwwyep8spBqbqV11ZrorFPBiBpI0ILKpbWnjGNBc4BNgT+CiwgPGM6FNhK0j3A/5rZB+2qunMVsOgjf8aUGYklpsZkyysDQSK38irkSkIrbLCkC4EjgR/EfXNrLaaJwKlm9k7TFyR1AQ4GxhHuHTrnnCujrLaYzOxOSbOB/Qg59tDCQN44WktMP2upW7iZ1QPT4hbkXFIWLfcWU2asSfhWXlLllYOy22KStCdhWNHV0X5fSXuY2TNx3t9aYnpB0kvAb4DfmdnSjlXXucpbvNyfMWVGQ0I/q0JiSqq8MgjdxbOZmAi9uXct2v+omWMtam32v82AnwH7Av+QNE3SMZJ6tqemzjnn4gpLq8fZUkjFQ4yijnKxZxpqrbt4A6Hf+kNRV78DCQOrrpD0qJl9sX11dq5yPlyRnb+KO72GhG67rm0xZes2bzpzTixvSvo6oZUE8FXgzbhvjp3BzGy1pL8BrwK7EaY+dy51lnliyo7GpCbctYTLK4+UtobiOJ3QM+8HhG/+o8Bpcd/camKKppI4BpgE9AamAIe0pYeFc0nyxJQhSQ2FLLSYsjT0MsPjmKIJGI5t7/tbG8f0FOE5093AaS2tbOicc668sjyOKRpQeyowjKI8Y2Ynx3l/ay2m7wFPNJ0nz7k0W+EtpuxI+taa38pLyr3An4BHgDZ/01vr/PBHAEnbEB5ibWxmO0raCfi8mV3Q9vo6V1krV2brAbdzLcluXqKXmZ3d3jfHXSz+BkLraQ2Amb1IB+4fOueca0W0HlNGu4vfL2li66c1L26vvF5m9myTb4D/WepSabkPsHVFhvVaxm79F9KrtoHZY6dzxDNjmbu8b7Wr1aqUrcfUVmcC35e0GlhNCMfMbIM4b26t88MW0Tx5C6NFAwszxR4JvNuhajtXIat9ocDMeGjvmRUvo5CUJNiu71Jmjb2P2UsGVbTMz8wpx1VS2xpqlZl1KPO31mKaRphC4gzCarXbSZoHvAUc15GCnXMuCYWkBFCjsJ8VGe6VV1jBdriZ/UTS5sCm5VrBVgBm9gawv6TeQI2ZLetIpZ2rpNUrk5mo854NLwbgyPfPSaS8PBr/1ISKlzF7zDS267uUGkFDI/z9w34JlPvPjl8iw+OYWHcF258AHwJXU44VbIHNJF3Z9GCheWlmX29LTatN0pbAuUA/MztS0qHAQcBg4Gozq/x9Bedcoo54dj9mjbmXXrUN/P3Dfhzx7H7VrlIsGZ/EtaIr2K4AZrenVlHT7TZgE0LmnGxmV7TzWr8irP20wMx2bPLaBOAKwjr0N5rZxS1dx8zeBE6JFjjEzKYB0yQNIExW64kpB9YktIJtYXhfUuXlUgIfvHNXbLD2mdL4vxwYlVvxYssiw4mpcivYAovM7NZ2Vqwe+JaZPS+pLzBb0sNm9rfCCdGS7SuKbw1K2trMXm9yrVuAXxISHUXn1hKah+OAOuA5SdMJSeqiJtc4OZomozk/iK7jcmD1qmRu5TU2NiZaXi7V1CZTztqHTAmVVyZJ5CVJRwE/ArYHRrc0w4+kucAywoDZejMbVeKyFV3Btt2/cWb2LlHPPTNbJulVwvRGfys67TPA/5M00cxWSjoVOIywcm7xtZ6QNKyZYkYDr0ctISQV5vG7iNDCKil6QHcx8KCZPd/WGJ1zrmKSWyjwZeBwQge31ow1s4WlTpBUQ+gg910qsYKtme0Z90KlREllF2Cd1QvN7G5Jw4Epku4GTia0fuLaDPhX0X4dsEeJegwELgR2kfQ9wuJV+wP9opbadc2853PA54ZvuRVLVmSnN09c/Xtm6y/IOOpXJ9NdvHArL6nycimxFkz2WkxKqLt4IWGUqywza5T0v2a2F/Bae64Re9mL9pLUB/gdcJaZfdD0dTO7NGrpXAtsZWYftuXyzRxrcV4/M1tEmI692HqdO5q85z7gvk+N3PXUhcvyd8umf8/8rfnYmNTy2Y2WbHl55LfySmpDrhgkqfgW3GQzm1zm6hgwU5IB17dy/ZmSjgD+rz1zrVY0MUnqSkhKd5rZ/7Vwzr7AjoT7kecRxkzFVQdsXrQ/FJjfvto651y61MTPTAtLPfOR9AihI1pT55rZvTHL2NvM5kd9Ax6W9JqZPdHCud8kLJPUIGkF5Zz5oSCa9aHOzFZJGgPsBNxmZktKvEfATcCrZnZ5C+fsQpiH7yDCPck7JF1gZnEfkj0HjIhuB84jzN/3hZjvbZP6BuP9D3P4l/Hg/LWYWLMymXIKa/skVV4edYndg7hjCh/wSZVXJuW6k2dm+5fhGvOjfxdImkp4xt9sYqr0zA8FvwNGSdqakGymA7+mSSeFJvYGjgdekjQnOvZ9M3ug6JxewFHRAF4knQCc2PRCkn4DjCE0V+uA88zsJjOrl3QGYfn3WuBXZvZKzJjaZE1jI/M+XFGJS1dZv2pXoPzqE/oDopCYkiovj7p0TaactYkpofLKQEpPd/HiyRWirw8Aflzi/IrO/FDQGCWBw4BfmNlVhYFTLTGzP9PKaAEze7LJ/hpCC6rpeZNKXOMB4IGWXnfOuayqTaBXXvS5fhWwEfB7SXPMbLykIYSxoROBjYGpUaLsAvzazGaUuGxFZ34oWCNpEnAC8LnoWHb+9CiD1Q2N/OuDPLaYcshv5WVHYrfyapItr0ySaDCZ2VTCM/6mx+cT3RWLhuTs3IbLdmjmh7jrMZ0E7AVcaGZvRc907mhDJZ1zzrWBiLqMx/gvhSo68wMA0WwNXy/af4swMLXTWFVvzH1/VbWr4eKoT2iKoEIv2KTKy6OuPZIpp9BiSqq8Msno5OJQ4ZkfXGRNQyPzF/utvExoSGjAayExJVVeHnliall6V6dtkaThZvaWmd0paTaVmPnBOedc9WQsLwHcA+wm6VEz24+0zvyQF/UNxoKl/pA7ExoSvpWXVHk5VNMtoc4I0T2xxMorA5FMr7wyq5F0HrCNpG82fbGlMa3rXaTUi5JqJX1F0k8k7d3ktdj3C51zzrWdott5rW0pciywktDo6dvMFktrLabrCYNgnwWulPRHMytkwcOBC9pY6cyqb2hkyRJ/xpQJjUlNtmsJl5c/XbslM+qkJnrGlFR55aBsrmA7wcwukdTdzFocgNua1hLTaDPbCUDSL4FrJP0fMInMLLVVHg0NjSxd6r3yMiGpRGGemDoqqUSh6JZYlhITtGmuvLQ4ibBw66GUmBmiNa0lprU3ZM2sHjhN0g+Bx4A+7S3UOedc6zKXluDVaEHBjSS9WHS8MInrTnEu0lpimiVpQvHUE2b2Y0nzCctUdBqNDY0sX7a82tVwcbR9lv1slZcjXbsn3GJKqLxyyGLnBzObJGkTwvyln2/vdVpbKPC4Fo7fCNzY3kJdy3438BIAjlh0dpVr4pyrqvR1bIjFzP5N26YvWk/cZS9qCUtTDCt+T9yuf3lgjcaKjyrf+aGxf5i1I4mycstiz3ySzfJypHuP7omUU1NTk2h55ZK1vCTpLjM7WtJLrLtoa1lv5RXcR+gC+BJtmO/IOedc+2WwxXRm9O/BHblI3MQ0NG6my6vGxkZWLa/8ANvGxpD3kyjLtd+wXsvYrf9CetU2MHvsdI54Zixzl3dobbROqXuPZMb4n1h/flReIsWVhcjeXHlm9m7079sduU7c/yselHSAmc3sSGGZ1tgAKz5IoJxo3rUkysqph/au/P+mhaQkwXZ9lzJr7H3MXjKo4uXmTc+e2emMUA1ZazFJWsa6t/DWUdal1YGnCYtE1QBraOP67c7lTSEpQfirtletj2Vy5SVBbcYSU2FJdUk/Bv4N3E7IF1+kjDM/FPwvYT2ml8w6ad/YxkZY9VEC5UQfcEmUlVPjnzyg4mXMHjud7foupUbQ0Ah//7BfxcvNY3eYnj19us5SMpaXio03sz2K9q+V9AxwaZw3x10o8J/Ay502KTnXxBHPjGVFQy1mISkd8czYalfJ5VAG58oraJD0xWi+1RpJXwRi31aI++fKu8AfJD0IrJ2XpzN1F8caYVUCf7NGnR8SKSuvFPfvrfabu6Lf2mdK45+aEJVb8WJzp3ev7Mz2XQ1J5BxJlwGfA1YDbwAnmdmSZs6bQJhuqBa40cxKLRb7hejcKwjPnJ6MjsUSNzG9FW3dKJqmyDnnXGUIJTVX3sPA98ysXtIlwPeAdUb4R2NZrwbGAXXAc5KmR6ubr8fM5gKHtLdCcZdWP7+9BeSGNcKaBLpwFwZrJlFWXtXUJlPO2t4PCZWXQ329V17LEppdvElv66cJy6A3NRp43czeBJA0hZB4mk1MHRV35oeHgaMKzTtJA4ApZja+EpVKJSOZJbR9ue6OS/qeezrv8WdCH09MJbWhV94gSbOK9ieb2eR2FHky8Ntmjm8G/Ktovw7Yo5nzyiLurbyNiu85mtliSYMrUyXnnHOiTeOYFprZqBavJT0CbNLMS+ea2b3ROecC9cCdLVSnqYp1houbmBokbWFm7wBI+kQlK5VOluycaD7/WvvVJvRXeOFDI6nycqift5hKKtfMD2a2f6nXJZ1AmEZovxZ6X9cBmxftDwXml7jeT4FLm9xl+5aZxVr5PG73pXOBP0u6XdLtwBOEB2SujArT3Ow78D/MHjudYb2WVbtKzrkqqlG8rSOi3nZnA583s5bW9nkOGCFpuKRuhCXUp5e47IFN77IBE+PWKW7nhxmSdgX2JDTpvmFmC+MWkgfb9PmAyRWe6sanuSmT2qQGbRZaTD5ItL0G9PLvXUvC0uqJPL/8JdAdeDgq72kzO13SEEK38IlRj70zCOss1QK/MrNXSlyzNlpefRWApJ5RGbGU/L9C0rCo2x9RIrq/yesCNjOzurgFupb5NDfOuWK1lR+Sh5lt3cLx+RS1cszsAeCBmJe9A3hU0s2Exz4nA7fGrVNrf65cFs2Pdy8wG3gP6AFsDYwF9gPOI9x/zLV/fNjv44GUFTJ7zLT1p7mpcJm5HMab2DOmmmTLy6FBvb3F1JIwu3g2e3ya2aXRmkz7EUL5iZk9FPf9ra1ge5SkHQgT8J0MbAosB14lZM4LzcwH3JTJEc/ux6wx99KrtiFMc/PsftWuknOuihJoMFWMmT0IPNie97b650o0svfc9lw8V0TFnyXMXTWA2Us3AmD80weFgz52s+26JjQ5SeGv2aTKy6GB3iuvpKw1mCT92cz2aWb5izatSOHtaOecSyEpsSmJysbM9on+7dCqmZ6Y4lINdE1g+cvCc4skysqrpL53Nf6z6qiBPWJ31OqUMpaX1pJ0u5kd39qxlrTWK6+LmfncOM45lzABXbK2tvrHPlm8I6kLsFvcN7fWYnpaUh0wA5hR6DreKdXUQI/eCZQTPVRKoqy86tYzmXIKrdukysuhgT39+VwpWWsxSfoe8H2gp6QPCocJS2rEnruvtV55o6Lphw4EfiFpM+DPhJ4WfywMnnLOOVdmZZjVIWlmdhFwkaSLzKzdswPF6ZX3NnAdcJ2krsC+wATgAknvmdlB7S08U2pqoVe/ypdT6PmXRFk5VdMt2WdMiZWXQ318afWSlN3VJ++X1NvMPpJ0HLArcEWUT1rVpv8rzGwN8Fi0EbWgnHPOlVkYYFvtWrTbtcDOknYGvgvcBNwGfCbOmzv054qZzevI+7NENbV06d2hHpCxywESKSuvuvVI5rlFTdRiSqq8PPLZxUurzW5mqjczk3QIoaV0UzSDeSzejo6ppraG3htUvkNCbZeQmJIoK6+SShSKPjQ8MbVfv16emFqS8RbTsqgjxHHAp6Ol2WP/sLM844VzzuWXCjOMt76l0DHAKuAUM/s3YQXcy+K+ud0tJkmTzey09r4/a2pra+nbv0/ly4laTEmUlVfdeyYzaLNwKy+p8vKod7d0fqqmRdZmfiiIktHlRfvvEJ4xxdLaANsNW3qJNiz65Jxzrm2yeCsvqbny3gPeZt313i3aH9yG+mZely41DBrUq+LlnMUlAAzyBlO79Uho0GahxZRUea7zyVqDqVxz5bX2jOlNYIyZDS/atjSz4cB/OlKwc865lglRq3hb2ki6Pc6xlrTWYvoFMAB4p5nXLo1biHN5dPyq86pdBZdnGZz5oUjl5sozs6tLvHZV3ELyoEuXGjYeWPlbea7jevf2W2suH5Lo/CDpMuBzhPns3gBOMrMlzZw3F1gGNBDGKY1q5pyyzJVX8laepH1aeX0DSTvGLcw551w8IrHu4g8DO5rZTsA/gFJz3I01s5HNJSUIc+VFz5cuM7MNoq2vmQ1sy9x5rd3KO0LSpYTZxWcTOkP0ALYGxgKfAL4Vt7As696lhi28R0Im9O7tgzZdPiTRYjKzmUW7TwNHluGa35M0ABhByBmF40/EeX9rt/K+EV38SOAoYFNgBfAqcL2Z/bm9FXfOOVdaFfo1nAz8toXXDJgpyQif/y3empP0ZeBMYCgwB9gT+Avw2TiViDO7+GLghmjrtLp3qWHbjXwW6SzYoI8PeHXZJ9GWHneDJM0q2p9cnDgkPQJs0sz7zjWze6NzzgXqgTtbKGNvM5svaTDwsKTXSrSAzgR2B542s7GStgPOjxuMz5XnnHMp1YYG08KWnvsAmNn+JcsJE6weDOxnZtbcOWY2P/p3gaSpwGigpcS00sxWSkJSdzN7TdK2sSLBE1NsPbrUsPUAn1g1C/r18l55LvvCzA+J9MqbAJwNfMbMlrdwTm+gxsyWRV8fAPy4xGXrJPUHphFaV4uB+XHr5InJOedSKqFHTL8EuhMSCITbb6dLGgLcaGYTgY2BqdHrXYBfm9mMli5oZodFX/5I0uNAP8LK57HESkySehF6321hZqdKGgFsa2b3xy0o67rW1jC0n49jyoIBfbzF5PIhic4PZrZ1C8fnE82JamZvAjvHvaak283s+Oi9fywcA46P8/64y17cTJjCfK9ovw64IG4lnXPOtU2WpyRi/ZkfainXzA9FtjKzYyRNAjCzFVI6vxuV0rVWbNLfe3tlweA+Po7J5UPWPmYTmfmhyGpJPYmmMZe0FaEF5ZxzrkIUc0uLpGZ+KDiPMPvD5pLuBPYGTmxzrTOsS40Y2Nv7imSBt5hcLih7LaYi90vqbWYfSToO2BW4wszejvPmWC0mM3sYOJyQjH4DjDKzP7Svvs4551ojwgd0nC2FrgWWS9oZ+C5hXb+yrWC7a5ND70b/biFpCzN7vi01dS4Jg3v7s0CXDxluMdWbmUk6hNBSuikaxBtLa/em/jf6twcwCniBkMh3Ap4BSs4+7pxzrv0yvB7TsqgjxHHAp6NeebHvsZdsBZrZWDMbS2iG7Wpmo8xsN2AX4PUOVNo551wJ4VaeYm0pdAyhg9wpZvZvYDPgsrhvjvs0fzsze6mwY2YvSxrZllo6l5SBPXyArcuHrN7Ji5LR5UX771CuZ0xFXpV0I3AHocv4cYSlL5xzzlWEUDpbQxUXNzGdBPw/wlTmEGaUvbYiNXKug/p7i8nlRFZbTB0Vt7v4SjP7uZkdFm0/N7OVla6cc851Vll+xiTpzDjHWhJ3Ete9gR8RllJf+x4z2zJuQc4lpW9PHwjtckBQk9JBSjGcAFzR5NiJzRxrVtzf4JuAbwCzgYa4NXPOOdd+WXvGFM2n+gVguKTpRS/1BRbFvU7cxLTUzGKvpeFcNW3gLSaXA2GhwGrXos2eIkzEMIiPx8ECLANejHuRuL/Bj0u6DPg/iiZv9ZkfnHOucrLWYormwnubj5dIape4iWmP6N/iNeUN+GxHCnfOOdeyrPXKk/RnM9tH0jKi1SgKLwFmZhvEuU6sxBTN/uBcJgzu67OLu+wTpHURwFK+CBAtfdFurU3i+s1Sr5vZ5aVed845117JDLCV9BPgEKARWACcGC2r3vS8CYRedbXAjWZ2cTOXm0pY4gJJvzOzI9pTp9Y6I/aNtlGEAbabRdvpwA7tKdA551wMCrfy4mwddJmZ7WRmI4H7gR+uV5UwCevVwIGEz/5JkprLAcW1afdwopItJjM7P6rUTMIkrsui/R8Bd7e3UOecc61L4kaemX1QtNubdZ8NFYwGXjezNwEkTSG0sv7W9HItfN0mcTs/bEFYs71gNTCsvYU655wrLXQXT+YZk6QLgS8BS4Hm+hRsBvyraL+OjzvFFdtZ0geE6veMvoZKdH4AbgeelTSVkAUPA26N+V7nnHPt0Ia0NEjSrKL9yWY2ee11pEeATZp537lmdq+ZnQucG62hdAZwXoyqrNciMrPa+FVuWdxeeRdKehDYNzp0kpn9tRwVcM4517w2rGC70MxGtfSime0f8zq/Bn7P+ompDti8aH8osF4HiXKJPUQ+GkzrA2qdcy4hSdzJkzTCzP4Z7X4eeK2Z054DRkgaDswDjiVMPVQRPneLc86lVEKjmC6WtC2hu/jbhF7XSBpC6BY+0czqJZ0BPEToLv4rM3ulUhXyxOScc2mVQGZqaaxRNJZpYtH+A8ADla+RJybnnEslkb258srFE5NzzqVReQbPZpInJuecSylPTM4551Ikmbny0sgTk3POpZS3mJxzzqWGSKy7eOp4YnLOubTqpJnJE5NzzqVUUpO4po0nJuecS6nOmZY8MTnnXDp14odMnpiccy6lvLu4c8651BDeXdw551zKdNK85InJOefSqg0LBeaKJybnnEupTpqXPDE551xaddK85InJOedSq5NmJk9MzjmXQr5QoHPOuXQR1CSQlyT9BDgEaAQWACdGy6o3PW8usAxoAOrNbFSl6lRTqQs755zrIMXcOuYyM9vJzEYC9wM/LHHuWDMbWcmkBN5ics65lEpmoUAz+6BotzdgFS+0FZ6YnHMupZLqLi7pQuBLwFJgbAunGTBTkgHXm9nkStXHb+U551wKxb2LF+WuQZJmFW2nrXMt6RFJLzezHQJgZuea2ebAncAZLVRpbzPbFTgQ+JqkT5c55LW8xeScc2kVv8W0sNRzHzPbP+Z1fg38HjivmWvMj/5dIGkqMBp4InYN28BbTM45l1I1UqytIySNKNr9PPBaM+f0ltS38DVwAPByhwouwVtMzjmXUgk9YrpY0raE7uJvA6cDSBoC3GhmE4GNganR3H1dgF+b2YxKVcgTk3POpZGS6fxgZke0cHw+MDH6+k1g58rXJvDE5JxzqeUzPzjnnEsJXyjQOedc6nTSvOSJyTnn0qqjPe6yyhOTc86lVefMS56YnHMurTppXvLE5JxzaaSEuounkScm55xLKV8o0DnnXKp4i8k551yqeGJyzjmXIsksFJhGnpiccy6FOvPMD77shXPOuVTxFpNzzqVUZ20xeWJyzrk0kk9J5JxzLkWEz/zgnHMubTppZvLE5JxzKdVZu4t3il55kraUdJOke4qOHSrpBkn3SjqgmvVzzrnmFObLa23Lm9QnJkm/krRA0stNjk+Q9HdJr0s6p9Q1zOxNMzulybFpZnYqcCJwTNkr7pxzHaSYW1nKkr4tySQNauH12J+5HZWFW3m3AL8EbisckFQLXA2MA+qA5yRNB2qBi5q8/2QzW1Di+j+IruWcc6mihJpDkjYnfJ6+08LrzX7mmtnfKlGf1CcmM3tC0rAmh0cDr5vZmwCSpgCHmNlFwMFxrqvwE78YeNDMni9jlZ1zrsMSnvnh58B3gXtbeL3Zz1ygcyamFmwG/Ktovw7Yo6WTJQ0ELgR2kfS9KIH9N7A/0E/S1mZ2XTPvOw04Ldr9UNLfyxVAKwYBCxMqKyl5jAk8rixJMqZPdPQCzz8/+6GeXZu/rdaMHpJmFe1PNrPJcd4o6fPAPDN7oUQLrU2fuR2V1cTU3HfPWjrZzBYBpzc5diVwZalCoh9srB9uOUmaZWajki63kvIYE3hcWZK1mMxsQrmuJekRYJNmXjoX+D7QWgewNn3mdlRWE1MdsHnR/lBgfpXq4pxzqWZm+zd3XNKngOFAobU0FHhe0mgz+3fRqYl+5mY1MT0HjJA0HJgHHAt8obpVcs65bDGzl4DBhX1Jc4FRZtb0lmein7lZ6C7+G+AvwLaS6iSdYmb1wBnAQ8CrwF1m9ko161lmid8+TEAeYwKPK0vyGFPFSBoi6QGApD9zZVax24TOOedcm6W+xeScc65z8cTknHMuVTwxpZCSGu6doDzGBB5XluQxprzyxJQCkvaSdLmkIwEsBw/+8hgTeFxZkseYOgtPTFUmaT/gBsIcVadLuqylSRSzIo8xgceVJXmMqTPxxFR9OwOPmNkvCDOdbwYcJKl3NSvVQXmMCTyuLMljTJ2GJ6aESTpQ0lHR/H0AbwCNkgaaWR0wnTAH1YiqVbKN8hgTeFxkKK48xtSZeWJKgILukm4BfgxMAK6SNIowMWIPYNvo9LuB3sAO0XtT+TPKY0zgcUWnZyKuPMbkAv/hJCB66CrCFFATokULHwduiJbcWA78l6QtzKwBeBI4PnpvY5WqXVIeYwKPK0tx5TEmF3hiSs5woD+wRlKNmd0Qff0VwkKIWwDfjM4dBDxWlVq2TR5jAo8LshNXHmNyZuZbhTZC4q8p2v8T8PWi/V2BfwLdgE2B2wm/OM8CW1W7/p0lJo8rW3HlMSbfmvyMq12BPG3AVsAvCDPv9ig6vnH0717AAqBr0Wt3Ap+Jvu4ODKt2HHmPyePKVlx5jMm30pvfyisTSTsRHrAuASYCt0Sz83YHLpC0g5n9BXiU8IC2n6ReQD/gNQAzW2Vmc6sSQDPyGBN4XGQorjzG5Frnial8tgbeNrMfAScDK4BjCKs8nmZmf4vO+ypQD1wPzCasbbJESuV0KXmMCTyuLMWVx5hcK7K6UGDVSdqD0PV0uoWl2+cC70saZmZzJd0GHAfsaWZPFN5nZosl/TewE+E++V+rUP1m5TEm8LjIUFx5jMm1nbeY2igaO3EhcCMwBviFpMOAfwMNROMmzOxx4APCoD4k9ZJ0lqRtLHghLb88eYwJPK4sxZXHmFz7eWJqIzMzYEPgS2Z2AnAHcAWwEHgd2FvS9tHp04AvRe9bDrxpZv9IvNKtyGNM4HFFp08jA3HlMSbXfp6Y2kjSYMK8Wx8CmNlDwFPApcA1QB/gTEldgaHAI9HXmNn0qlS6FXmMCTyuLMWVx5hc+/nS6jFFg/cao69vB5aa2RnR/gDgBWBvYCnwE2B7wi/Ql83sqerUurQ8xgQeFxmKK48xuTKwFPRZT9tGGEl+OWH6kqFFxzcgdBgZTOi+ulXRa78Eji3aH17tOPIek8eVrbjyGJNvldn8Vl4TkjYn3MPuCnwS+I2kraKXzwf2NrMFhF+YKyQNiV7bjGjcBICZvZVYpVuRx5jA4yJDceUxJlc5fiuvCYWZiX9hZvtE+1cB7wM/B5ZZmAyycO7lhAe2uxKm2f8y8L6l7Juax5jA44pey0RceYzJVVC1m2zV3oBtgK8BGxNmKt6EMLfWztHrnwR+BXyOovm5otcEbAnsW+048h6Tx5WtuPIYk2/JbZ36Vp6krwL3E+baugg4A1gMfARsI6mLmb0C/AMYY2aNkrpIOk3S7gBm9qaZ/alKIawnjzGBx0WG4spjTC5ZnToxAUOAc8zsOMKYiXMID2D/DPwXYXlmCH/pHSmpj5nVA/OBl80sjbcW8hgTeFxZiiuPMbkEddrEpDAJ5HDCKHLM7AXgJuB6M7sDWAV8RdJmwDDgCcL8XJjZ/Wa2ohr1LiWPMYHHlaW48hiTq4Jq30tMYgMGNNkvdPo4D3iwyWuvEcZNdAHOBR4irO1yRLXjaFLPwUDPPMVUFNeOOYyre5P9mqzHVfjZ5Ckm39KxVb0CFQ8QfkhYUnmLomMq+noeML5o/wfAN4v2P1HtGJqJ6cdAHbAvUJuHmKJ6/Q/QCFwc7ddmPS7Cg/wLgbsI6wn1iY4XL3SXqbiimC4AvgWMKjpem9WYfEvXlttbeZLGSPo3YfDeJDN7p/CamZmkwszq3yOs6zIi2t+S8FC2cO7bSdU5DkmnE2ZfHm1mf7Kom23GYzpQ0kuEn9UZhISLmTVkPK5NgHsJPdPuIrQUtgCw6IF/dGpm4pK0MTCV0MtuAXBx9PPramYNhWmCyFBMLn3yvOzFYmCwmX0bQNJQYKGZrQSw8LAVM7tN0tbAdyXtQpir69Uq1blFkmoIzwT3AM4zs/mSPgmsMrPXo9MKSSoTMQFI6gn0BL5iZk9Fgy73kLSVmb0B2ftZFelNuN36ZQBJhwMDil7P3M+L8MdDHzM7FCAaCPstwpRBTxHWRMpaTC5lcjPAVmESyNOA+4B3LKzP8mvCSpavEAbrrQYuBp42s9WSaqO/8moJHxi7mNnDVQphPU1immtmSyXdRLhNsgr4PPAe4QPhNjOri/5yXZPWmGC9uF43s4+KXtuRsNjbIWa2UJKiVlNN1MrISlxvRIenEp6vbEkYu/NX4LfADDNbEnWdrk9rXM3ENIhwy/V3ZvaApM8Sbpf/ntDB4YO0/1659MtFYpI0ljCVySzCCpcDzOwYSX2AdwmzE58DfIewIublZvZa0ftlKftGNBNTfzM7VtJ44CvAu2b2NUl7ERLUfDO7quj9qYsJmo1rAzP7QnF9Jf0RuNvMftnM+7MQ10qgl5kdL2lLwhINW5vZcZKOJnQCeMTM7it6f+riaiambmZ2kqQzgaOBp4E9gceBjYAzCS34ws8xdTG5bMjLrbxNCX+Bfiu65fV3SSeY2a2StjOzedF5l0p6Pjq/eP6tNP7yNI3pH5KOBP5E6F67DYCZ/UXSREJrcO2HQUpjguZ/VpPM7DeFv7SB6UBPFc08XZCxuI4zszskzSd06sDM7lJYAK8npP7n1dz/g0eY2RXR79FI4Aoze0fSK8CmVjSXXUpjchmQl84Pg4D3JPWIPsi+DZwR3dYqJCWiv17nE1bFTLvmYvo24dnZxUCNpEOih9F7ElofWfgwaC6ubxYenkfn9CS0MBqjD8QsaC6uMyV1Izx/2UjSjpL6ETpDLIfU/7yai+mc6Pbjn8zsqigpjQKeA94peTXnYsrKL32zJCn68p/AAYSZizGze4FlwDej8zaVdD1wN2F8RWofwpaIaRoh+ZxpZs8RuiAfAMwA7jWz25KvbXxxf1aRx4BPR8lqnRZT2rQS10fAqcADhOUcriUMXZhqZvcnXtmYWvl/cBmhswOS+kn6DWHOuz8X/WHhXMdYCvqsx9mAE4EDicYj8fFgvsK/DwDf5ePnZuMJiaiGMBL960DvasdRhpjuAbpG+10KX6dp68DPqkvRNbpVO44yxDUhiqsw1mwnoEe14yjnzwo4KW2/V75lf0t9i0nSXpKeJTxsnQDcLGmAReNA7OO/qL9FmKn46Gh/e+BFM2s0s7fM7Eor6v1VTR2MaY6ZrYHQjbrwdRp0MK4XLOoWDmBmq5OseykdiGs7QlyFbuEvWjRcodrK9bMys5vT8nvl8iOVialwK0FhjMs4Qi+6iYS/3F4HDofwwSxpS0n3E26VXAL8l6QngZMJ83ClQhljStWMyx5XduLKY0wun1LXK09hNHzhL8wVku4C5kYv1xOmQ3knOncUYUzFLDN7F7hf0u8J67ikKSnlLibwuKJzMxFXHmNyOVbte4nFG2G8Rz1wbbRfPE9a4Z737wiDLwF6UHR/m6K5utKy5TEmjytbceUxJt/yvaXmVp6kTxAWFjsZOFrSCDMzhdHjWLj3vTGwvYUeTxCme/lIUtdoPEiqegXlMSbwuMhQXHmMyeVfam7lmdnbkq4ws9cU5oC7gbC6ZfEvxSDgUUkbEEakfwh81VLUAaBYHmMCj4sMxZXHmFwnUO0mW/HGurcY5gOfj74udI8+lDCCfg5wbrXr21lj8riyFVceY/It31vit/IkHaowtQ6F2wnR14XJOgvT5p9DWJYZ+/gvty2BmwnrvFyYYLVLymNM4HGRobjyGJPrvBKdxFVh6YknCTMY7G5my4rudTcUnVf4ZXqCMKNxLXAj8KSl7H53HmMCjytLceUxJte5Jd1i+hC4gzCv1sXRsUYLU+RvKOkshUlXC9myHjiYsEzFEyn95cljTOBxZSmuPMbkOrGKJiZJmytMYlmwKWFalnOBvSVtFv0Ftwthdcs+0b9IOgt4FhhiZtdUsp5tkceYwOPKUlx5jMm5dVTiwRXwGeBtwiJp9/HxQ9YhwE+jr79NWOflGsLgvi2aXKNLJermMXlcWY0rjzH55ltzW9lbTJK6EyZ2PMvMDiPc9/6hpI0I3VI3VFh+YjwwAnjfgnck1Uhh2hQrmjet2vIYE3hcZCiuPMbkXEvKkpiKbyuY2SqgP9FU+YR5uIYSfmFWAbsRHtT+HjiFaH6u6L2NZpaK9WnyGBN4XGQorjzG5FwcHR5gK+m/gVMk3Qc8Z2bTCeMh+krqZWZzFSZ/3BV4ibCO0MMWRpYLGBh1Za1Pyy9PHmMCj4sMxZXHmJyLrSP3AQn3vJ8h/HIcC8wmPISdAFxN6LoK0JvwwHW3ovem8l53HmPyuLIVVx5j8s23tmxtvpWnosF7wEbAQ2b2vJlNIaxkeYOZzQDWAGMkfcLCei2zCQP5gHTd685jTOBxkaG48hiTc+0VOzFJ6iLpp8BPJY2PDtcDny6cY2ZXA70kHQ1cRvgFu0nSz4D9Cb9EqZHHmMDjIkNx5TEm5zoqVmKS9BnC//wDCOMhLpC0j5lNAzaVdHzR6d8DTjCzeWb2XeB2wmJj+5jZm+WsfEfkMSbwuCKZiCuPMTlXFnHu9wH7AscX7V8BXBZ9/TnC2Ioe0f6uwOVAt2rfp+xsMXlc2YorjzH55ls5tlhz5UnqRVj9st7CNCeTgF2Acyys53IzsBp4BDgK+MDMvtzqhasojzGBx0WG4spjTM6VQ6xbeWa23MxW2cdzao0H/mVmjdH+WcB04Bjg71n45cljTOBxkaG48hiTc+XQptnFo55DRhjEd4aZvSFpR2CumX0oqZuZra5QXSsijzGBx1XdWrZNHmNyriPa2l28kTDyfCGwczT471tEA3Uz+suTx5jA48qSPMbkXLu1eT0mSXsCT0XbzWZ2UyUqlqQ8xgQeV5bkMSbn2qs9iWkocDxwuYX5uzIvjzGBx5UleYzJufZKdAVb55xzrjVJr2DrnHPOleSJyTnnXKp4YnLOOZcqnpicc86liicm55xzqeKJyeWWpIGS5kTbvyXNi77+UNI1FSjvFklvSTo92j9d0pfacZ1jJL0u6f5y19G5LPDu4q5TkPQj4EMz+1kFy7gFuN/M7inDtcYA3zazgzt6LeeyxltMrtORNKbQGpH0I0m3Spopaa6kwyVdKuklSTMkdY3O203SHyXNlvSQpE1jlPMjSd+Ovv66pL9JelHSlOjYhpKmRceelrRTJeN2Lis8MTkHWwEHAYcAdwCPm9mngBXAQVFyugo40sx2Iyx1fmEbyzgH2MXMdgJOj46dD/w1OvZ94LYOR+JcDnSpdgWcS4EHzWyNpJeAWmBGdPwlYBiwLbAj8LAkonPebWMZLwJ3SpoGTIuO7QMcAWBmj0XPxPqZ2dL2h+Jc9nlicg5WAUSL862xjx+8NhJ+RwS8YmZ7daCMg4BPA58H/kfSJ6PrNuUPfV2n57fynGvd34GNJO0FIKlrlFhikVQDbG5mjwPfBfoDfYAngC9G54wBFprZB2WtuXMZ5C0m51phZqslHQlcKakf4ffmF8ArMS9RC9wRvVfAz81sSdRT8GZJLwLLgRPKXnnnMsi7iztXJt5d3Lny8Ft5zpXPUuAnhQG27SXpGOAaYHFZauVcxniLyTnnXKp4i8k551yqeGJyzjmXKp6YnHPOpYonJuecc6niick551yq/H941/7fM2up4QAAAABJRU5ErkJggg==\n",
      "text/plain": [
       "<Figure size 432x288 with 2 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "lc_maker_1d = LightCurveEstimator(\n",
    "    energy_edges=[1, 10] * u.TeV,\n",
    "    time_intervals=time_intervals,\n",
    "    source=\"crab\",\n",
    "    reoptimize=False,\n",
    "    selection_optional=\"all\",\n",
    ")\n",
    "\n",
    "nightwise_lc = lc_maker_1d.run(analysis_1d.datasets)\n",
    "\n",
    "nightwise_lc.plot(color=\"tab:orange\")\n",
    "ax = nightwise_lc.plot_ts_profiles()\n",
    "ax.set_ylim(1e-12, 3e-12);"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "d40b521d",
   "metadata": {},
   "source": [
    "## What next?\n",
    "\n",
    "When sources are bright enough to look for variability at small time scales, the per-observation time binning is no longer relevant. One can easily extend the light curve estimation approach presented above to any time binning. This is demonstrated in the [following tutorial](light_curve_flare.ipynb) which shows the extraction of the lightcurve of an AGN flare."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "13aadcd3",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "celltoolbar": "Edit Metadata",
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.9.12"
  },
  "nbsphinx": {
   "orphan": true
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
