
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>lomb_scargle &#8212; gammapy v0.7</title>
    <link rel="stylesheet" href="../_static/gammapy.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.7',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../_static/sidebar.js"></script>
    <link rel="shortcut icon" href="../_static/astropy_logo.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="plot_periodogram" href="gammapy.time.plot_periodogram.html" />
    <link rel="prev" title="exptest" href="gammapy.time.exptest.html" />
<link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,600' rel='stylesheet' type='text/css'/>
<script type="text/javascript" src="../_static/copybutton.js"></script>


  </head>
  <body>
<div class="topbar">
  <a class="brand" title="Documentation Home" href="../index.html"><span id="logotext1">gamma</span><span id="logotext2">py</span><span id="logotext3">:docs</span></a>
  <ul>
    <li><a class="homelink" title="Astropy Homepage" href="http://www.astropy.org"></a></li>
    <li><a title="General Index" href="../genindex.html">Index</a></li>
    <li><a title="Module Index" href="../py-modindex.html">Modules</a></li>
    <li>
      
      
<form action="../search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
      
    </li>
  </ul>
</div>

<div class="related">
    <h3>Navigation</h3>
    <ul>
      <li class="right">
	<a href="gammapy.time.plot_periodogram.html" title="plot_periodogram">
	  next &raquo;
	</a>
      </li>
      <li class="right">
	<a href="gammapy.time.exptest.html" title="exptest">
	  &laquo; previous
	</a>
	 |
      </li>
      <li>
	<a href="../index.html">gammapy v0.7</a>
	 &#187;
      </li>
      <li><a href="../time/index.html" accesskey="U">Time handling and analysis (<code class="docutils literal"><span class="pre">gammapy.time</span></code>)</a> &#187;</li>
      
      <li>lomb_scargle</li> 
    </ul>
</div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="lomb-scargle">
<h1>lomb_scargle<a class="headerlink" href="#lomb-scargle" title="Permalink to this headline">¶</a></h1>
<dl class="function">
<dt id="gammapy.time.lomb_scargle">
<code class="descclassname">gammapy.time.</code><code class="descname">lomb_scargle</code><span class="sig-paren">(</span><em>time</em>, <em>flux</em>, <em>flux_err</em>, <em>dt</em>, <em>max_period=None</em>, <em>criteria='all'</em>, <em>n_bootstraps=100</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gammapy/time/period.html#lomb_scargle"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gammapy.time.lomb_scargle" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute period and its false alarm probability of a light curve using Lomb-Scargle PSD.</p>
<p>To compute the Lomb-Scargle power spectral density, <a class="reference external" href="http://docs.astropy.org/en/latest/api/astropy.stats.LombScargle.html#astropy.stats.LombScargle" title="(in Astropy v3.1.dev21536)"><code class="xref py py-obj docutils literal"><span class="pre">astropy.stats.LombScargle</span></code></a> is called.
For eyesight inspection, the spectral window function is also returned
to evaluate the impact of sampling on the periodogram.
The criteria for the false alarm probability are both parametric and non-parametric.</p>
<p>For an introduction to the Lomb-Scargle periodogram, see Lomb (1976) and Scargle (1982).
For an introduction to the false alarm probability of thr Lomb-Scargle periodogram, see the astropy docs.</p>
<p>The function returns a results dictionary with the following content:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">pgrid</span></code> (<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.14)"><code class="xref py py-obj docutils literal"><span class="pre">ndarray</span></code></a>) – Period grid in units of <code class="docutils literal"><span class="pre">t</span></code></li>
<li><code class="docutils literal"><span class="pre">psd</span></code> (<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.14)"><code class="xref py py-obj docutils literal"><span class="pre">ndarray</span></code></a>) – PSD of Lomb-Scargle at frequencies of <code class="docutils literal"><span class="pre">fgrid</span></code></li>
<li><code class="docutils literal"><span class="pre">period</span></code> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.6)"><code class="xref py py-obj docutils literal"><span class="pre">float</span></code></a>) – Location of the highest periodogram peak</li>
<li><code class="docutils literal"><span class="pre">fap</span></code> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.6)"><code class="xref py py-obj docutils literal"><span class="pre">float</span></code></a>) or (<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.14)"><code class="xref py py-obj docutils literal"><span class="pre">ndarray</span></code></a>) – False alarm probability of <code class="docutils literal"><span class="pre">period</span></code>
under the null hypothesis of only-noise data for the specified criteria.
If criteria is not defined, the false alarm probability of all criteria is returned.</li>
<li><code class="docutils literal"><span class="pre">swf</span></code> (<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.14)"><code class="xref py py-obj docutils literal"><span class="pre">ndarray</span></code></a>) – Spectral window function</li>
</ul>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>time</strong> : <a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.14)"><code class="xref py py-obj docutils literal"><span class="pre">ndarray</span></code></a></p>
<blockquote>
<div><p>Time array of the light curve</p>
</div></blockquote>
<p><strong>flux</strong> : <a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.14)"><code class="xref py py-obj docutils literal"><span class="pre">ndarray</span></code></a></p>
<blockquote>
<div><p>Flux array of the light curve</p>
</div></blockquote>
<p><strong>flux_err</strong> : <a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.14)"><code class="xref py py-obj docutils literal"><span class="pre">ndarray</span></code></a></p>
<blockquote>
<div><p>Flux error array of the light curve</p>
</div></blockquote>
<p><strong>dt</strong> : float</p>
<blockquote>
<div><p>Desired resolution of the periodogram and the window function</p>
</div></blockquote>
<p><strong>max_period</strong> : float</p>
<blockquote>
<div><p>Maximum period to analyse</p>
</div></blockquote>
<p><strong>criteria</strong> : list of str</p>
<blockquote>
<div><p>Select which significance methods you’d like to run (by default all are running)
Available: <code class="xref py py-obj docutils literal"><span class="pre">{'pre',</span> <span class="pre">'cvm',</span> <span class="pre">'nll',</span> <span class="pre">'boot'}</span></code></p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">pre</span></code> for pre-defined beta distribution (see Schwarzenberg-Czerny (1998))</li>
<li><code class="docutils literal"><span class="pre">cvm</span></code> for Cramer-von-Mises distance minimisation (see Thieler et at. (2016))</li>
<li><code class="docutils literal"><span class="pre">nll</span></code> for negative logarithmic likelihood minimisation</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">boot</span></code> for bootstrap-resampling (see Sueveges (2012)</dt>
<dd>and <code class="docutils literal"><span class="pre">astroML.time_series.lomb_scargle_bootstrap</span></code>.</dd>
</dl>
</li>
</ul>
</div></blockquote>
<p><strong>n_bootstraps</strong> : int</p>
<blockquote>
<div><p>Number of bootstraps resampling</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>results</strong> : <a class="reference external" href="https://docs.python.org/3/library/collections.html#collections.OrderedDict" title="(in Python v3.6)"><code class="xref py py-obj docutils literal"><span class="pre">OrderedDict</span></code></a></p>
<blockquote class="last">
<div><p>Results dictionary (see description above).</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<table class="docutils citation" frame="void" id="r3136" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[R3136]</a></td><td>Lomb (1976), “Least-squares frequency analysis of unequally spaced data”,
<a class="reference external" href="https://link.springer.com/article/10.1007%2FBF00648343?LI=true">Link</a></td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="r3236" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id2">[R3236]</a></td><td>Scargle (1982), “Studies in astronomical time series analysis. II -
Statistical aspects of spectral analysis of unevenly spaced data”,
<a class="reference external" href="http://articles.adsabs.harvard.edu/full/1982ApJ...263..835S">Link</a></td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="r3336" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id3">[R3336]</a></td><td>Schwarzenberg-Czerny (1998), “The distribution of empirical periodograms: Lomb-Scargle and PDM spectra”,
<a class="reference external" href="https://academic.oup.com/mnras/article/301/3/831/1038387/The-distribution-of-empirical-periodograms-Lomb">Link</a></td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="r3436" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id4">[R3436]</a></td><td>Thieler et at. (2016), “RobPer: An R Package to Calculate Periodograms for Light Curves Based on Robust Regression”,
<a class="reference external" href="https://www.jstatsoft.org/article/view/v069i09">Link</a></td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="r3536" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id5">[R3536]</a></td><td>Sueveges (2012), “False Alarm Probability based on bootstrap and extreme-value methods for periodogram peaks”,
<a class="reference external" href="http://ada7.cosmostat.org/ADA7_proceeding_MSuveges2.pdf">Link</a></td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="r3636" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id6">[R3636]</a></td><td>Astropy docs, Lomb-Scargle Periodograms,
<a class="reference external" href="http://docs.astropy.org/en/latest/stats/lombscargle.html">Link</a></td></tr>
</tbody>
</table>
</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><h3>Page Contents</h3>
<ul>
<li><a class="reference internal" href="#">lomb_scargle</a></li>
</ul>


        </div>
      </div>
      <div class="clearer"></div>
    </div>
<footer class="footer">
  <p class="pull-right">
    <a href="../_sources/api/gammapy.time.lomb_scargle.rst.txt"
       rel="nofollow">Page Source</a> &nbsp;
    <a href="#">Back to Top</a></p>
  <p>
    &copy; Copyright 2018, The Gammapy developers.<br/>
    Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.6.7. &nbsp;
    Last built 01 Mar 2018. <br/>
  </p>
</footer>
  </body>
</html>