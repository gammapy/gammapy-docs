
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Astropy introduction for Gammapy users &#8212; gammapy v0.7</title>
    <link rel="stylesheet" href="../_static/gammapy.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.7',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../_static/sidebar.js"></script>
    <link rel="shortcut icon" href="../_static/astropy_logo.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
<link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,600' rel='stylesheet' type='text/css'/>
<script type="text/javascript" src="../_static/copybutton.js"></script>


  </head>
  <body>
<div class="topbar">
  <a class="brand" title="Documentation Home" href="../index.html"><span id="logotext1">gamma</span><span id="logotext2">py</span><span id="logotext3">:docs</span></a>
  <ul>
    <li><a class="homelink" title="Astropy Homepage" href="http://www.astropy.org"></a></li>
    <li><a title="General Index" href="../genindex.html">Index</a></li>
    <li><a title="Module Index" href="../py-modindex.html">Modules</a></li>
    <li>
      
      
<form action="../search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
      
    </li>
  </ul>
</div>

<div class="related">
    <h3>Navigation</h3>
    <ul>
      <li>
	<a href="../index.html">gammapy v0.7</a>
	 &#187;
      </li>
      
       
    </ul>
</div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput,
div.nbinput div.prompt,
div.nbinput div.input_area,
div.nbinput div[class*=highlight],
div.nbinput div[class*=highlight] pre,
div.nboutput,
div.nbinput div.prompt,
div.nbinput div.output_area,
div.nboutput div[class*=highlight],
div.nboutput div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput,
div.nboutput {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput,
    div.nboutput {
        flex-direction: column;
    }
}

/* input container */
div.nbinput {
    padding-top: 5px;
}

/* last container */
div.nblast {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput div.prompt pre {
    color: #303F9F;
}

/* output prompt */
div.nboutput div.prompt pre {
    color: #D84315;
}

/* all prompts */
div.nbinput div.prompt,
div.nboutput div.prompt {
    min-width: 9ex;
    padding-top: 0.4em;
    padding-right: 0.4em;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput div.prompt,
    div.nboutput div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput div.prompt pre,
div.nboutput div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput div.input_area,
div.nboutput div.output_area {
    padding: 0.4em;
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput div.input_area,
    div.nboutput div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput div.input_area {
    border: 1px solid #cfcfcf;
    border-radius: 2px;
    background: #f7f7f7;
}

/* override MathJax center alignment in output cells */
div.nboutput div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.pngmath center alignment in output cells */
div.nboutput div.math p {
    text-align: left;
}

/* standard error */
div.nboutput div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }
</style>
<script type="text/javascript" src="../_static/linksdl.js"></script><div class="admonition note">
<p class="first"><strong>This is a fixed-text formatted version of a Jupyter notebook.</strong></p>
<p>You can contribute with your own notebooks in this <a class="reference external" href="https://github.com/gammapy/gammapy-extra/tree/master/notebooks">GitHub
repository</a>.</p>
<p class="last"><strong>Source files:</strong>
<a class="reference external" href="../_static/notebooks/astropy_introduction.ipynb">astropy_introduction.ipynb</a>
|
<a class="reference external" href="../_static/notebooks/astropy_introduction.py">astropy_introduction.py</a></p>
</div>
<div class="section" id="Astropy-introduction-for-Gammapy-users">
<h1>Astropy introduction for Gammapy users<a class="headerlink" href="#Astropy-introduction-for-Gammapy-users" title="Permalink to this headline">¶</a></h1>
<div class="section" id="Introduction">
<h2>Introduction<a class="headerlink" href="#Introduction" title="Permalink to this headline">¶</a></h2>
<p>To become efficient at using Gammapy, you have to learn to use some
parts of Astropy, especially FITS I/O and how to work with Table,
Quantity, SkyCoord, Angle and Time objects.</p>
<p>Gammapy is built on Astropy, meaning that data in Gammapy is often
stored in Astropy objects, and the methods on those objects are part of
the public Gammapy API.</p>
<p>This tutorial is a quick introduction to the parts of Astropy you should
know become familiar with to use Gammapy (or also when not using
Gammapy, just doing astronomy from Python scripts). The largest part is
devoted to tables, which are a the most important building block for
Gammapy (event lists, flux points, light curves, … many other thing
are store in Table objects).</p>
<p>We will:</p>
<ul class="simple">
<li>open and write fits files with
<a class="reference external" href="http://docs.astropy.org/en/stable/io/fits/index.html">io.fits</a></li>
<li>manipulate
<a class="reference external" href="http://docs.astropy.org/en/stable/coordinates/">coordinates</a>:
<a class="reference external" href="http://docs.astropy.org/en/stable/api/astropy.coordinates.SkyCoord.html">SkyCoord</a>
and
<a class="reference external" href="http://docs.astropy.org/en/stable/coordinates/angles.html">Angle</a>
classes</li>
<li>use <a class="reference external" href="http://docs.astropy.org/en/stable/units/index.html">units</a>
and
<a class="reference external" href="http://docs.astropy.org/en/stable/api/astropy.units.Quantity.html">Quantities</a>.
See also this
<a class="reference external" href="http://www.astropy.org/astropy-tutorials/Quantities.html">tutorial</a></li>
<li>manipulate <a class="reference external" href="http://docs.astropy.org/en/stable/time/index.html">Times and
Dates</a></li>
<li>use <a class="reference external" href="http://docs.astropy.org/en/stable/table/index.html">tables</a>
with the
<a class="reference external" href="http://docs.astropy.org/en/stable/api/astropy.table.Table.html">Table</a>
class with the Fermi catalog</li>
<li>define regions in the sky with the
<a class="reference external" href="http://astropy-regions.readthedocs.io/en/latest/getting_started.html">region</a>
package</li>
</ul>
</div>
<div class="section" id="Setup">
<h2>Setup<a class="headerlink" href="#Setup" title="Permalink to this headline">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="c1"># to make plots appear in the notebook</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="c1"># If something below doesn&#39;t work, here&#39;s how you</span>
<span class="c1"># can check what version of Numpy and Astropy you have</span>
<span class="c1"># All examples should work with Astropy 1.3,</span>
<span class="c1"># most even with Astropy 1.0</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">astropy</span>
<span class="k">print</span><span class="p">(</span><span class="s1">&#39;numpy:&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">__version__</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s1">&#39;astropy:&#39;</span><span class="p">,</span> <span class="n">astropy</span><span class="o">.</span><span class="n">__version__</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
numpy: 1.12.1
astropy: 2.0.dev17848
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="c1"># Units, Quantities and constants</span>
<span class="kn">import</span> <span class="nn">astropy.units</span> <span class="kn">as</span> <span class="nn">u</span>
<span class="kn">from</span> <span class="nn">astropy.units</span> <span class="kn">import</span> <span class="n">Quantity</span>
<span class="kn">import</span> <span class="nn">astropy.constants</span> <span class="kn">as</span> <span class="nn">cst</span>

<span class="kn">from</span> <span class="nn">astropy.io</span> <span class="kn">import</span> <span class="n">fits</span>
<span class="kn">from</span> <span class="nn">astropy.table</span> <span class="kn">import</span> <span class="n">Table</span>
<span class="kn">from</span> <span class="nn">astropy.coordinates</span> <span class="kn">import</span> <span class="n">SkyCoord</span><span class="p">,</span> <span class="n">Angle</span>
<span class="kn">from</span> <span class="nn">astropy.time</span> <span class="kn">import</span> <span class="n">Time</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Units-and-constants">
<h2>Units and constants<a class="headerlink" href="#Units-and-constants" title="Permalink to this headline">¶</a></h2>
<div class="section" id="Basic-usage">
<h3>Basic usage<a class="headerlink" href="#Basic-usage" title="Permalink to this headline">¶</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="c1"># One can create a Quantity like this</span>
<span class="n">L</span> <span class="o">=</span> <span class="n">Quantity</span><span class="p">(</span><span class="mf">1e35</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="s1">&#39;erg/s&#39;</span><span class="p">)</span>
<span class="c1"># or like this</span>
<span class="n">d</span> <span class="o">=</span> <span class="mi">8</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">kpc</span>

<span class="c1"># then one can produce new Quantities</span>
<span class="n">flux</span> <span class="o">=</span> <span class="n">L</span> <span class="o">/</span> <span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">d</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>

<span class="c1"># And convert its value to any (homogeneous) unit</span>
<span class="k">print</span><span class="p">(</span><span class="n">flux</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;erg cm-2 s-1&#39;</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="n">flux</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;W/m2&#39;</span><span class="p">))</span>
<span class="c1"># print(flux.to(&#39;Ci&#39;)) would raise a UnitConversionError</span>

</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
1.3058974431347377e-11 erg / (cm2 s)
1.3058974431347378e-14 W / m2
</pre></div></div>
</div>
<p>More generally a Quantity is a numpy array with a unit.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">E</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">GeV</span>
<span class="k">print</span><span class="p">(</span><span class="n">E</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;TeV&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[  0.01         0.02154435   0.04641589   0.1          0.21544347
   0.46415888   1.           2.15443469   4.64158883  10.        ] TeV
</pre></div></div>
</div>
<p>Here we compute the interaction time of protons.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">x_eff</span> <span class="o">=</span> <span class="mi">30</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">mbarn</span>
<span class="n">density</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">cm</span> <span class="o">**</span> <span class="o">-</span><span class="mi">3</span>

<span class="n">interaction_time</span> <span class="o">=</span> <span class="p">(</span><span class="n">density</span> <span class="o">*</span> <span class="n">x_eff</span> <span class="o">*</span> <span class="n">cst</span><span class="o">.</span><span class="n">c</span><span class="p">)</span> <span class="o">**</span> <span class="o">-</span><span class="mi">1</span>

<span class="n">interaction_time</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;Myr&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>Out[6]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="math">
$35.233361 \; \mathrm{Myr}$</div></div>
</div>
</div>
<div class="section" id="Use-Quantities-in-functions">
<h3>Use Quantities in functions<a class="headerlink" href="#Use-Quantities-in-functions" title="Permalink to this headline">¶</a></h3>
<p>We compute here the energy loss rate of an electron of kinetic energy E
in magnetic field B. See formula (5B10) in this
<a class="reference external" href="http://www.cv.nrao.edu/course/astr534/SynchrotronPower.html">lecture</a></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">electron_energy_loss_rate</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">E</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; energy loss rate of an electron of kinetic energy E in magnetic field B</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">U_B</span> <span class="o">=</span> <span class="n">B</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">cst</span><span class="o">.</span><span class="n">mu0</span><span class="p">)</span>
    <span class="n">gamma</span> <span class="o">=</span> <span class="n">E</span> <span class="o">/</span> <span class="p">(</span><span class="n">cst</span><span class="o">.</span><span class="n">m_e</span> <span class="o">*</span> <span class="n">cst</span><span class="o">.</span><span class="n">c</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>   <span class="c1"># note that this works only because E/(cst.m_e*cst.c**2) is dimensionless</span>
    <span class="n">beta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">gamma</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
    <span class="k">return</span> <span class="mf">4.</span> <span class="o">/</span> <span class="mf">3.</span> <span class="o">*</span> <span class="n">cst</span><span class="o">.</span><span class="n">sigma_T</span> <span class="o">*</span> <span class="n">cst</span><span class="o">.</span><span class="n">c</span> <span class="o">*</span> <span class="n">gamma</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">beta</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">U_B</span>

<span class="k">print</span><span class="p">(</span><span class="n">electron_energy_loss_rate</span><span class="p">(</span><span class="mf">1e-5</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">G</span><span class="p">,</span> <span class="mi">1</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">TeV</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;erg/s&#39;</span><span class="p">))</span>

<span class="c1"># Now plot it</span>
<span class="n">E_elec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mf">1.</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">MeV</span>
<span class="n">B</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">G</span>
<span class="n">plt</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">E_elec</span><span class="p">,(</span><span class="n">E_elec</span> <span class="o">/</span> <span class="n">electron_energy_loss_rate</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">E_elec</span><span class="p">))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;yr&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
4.0519328131469305e-13 erg / s
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>Out[7]:
</pre></div>
</div>
<div class="output_area highlight-none"><div class="highlight"><pre>
<span></span>[&lt;matplotlib.lines.Line2D at 0x10b2ee048&gt;]
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_astropy_introduction_12_2.png" src="../_images/notebooks_astropy_introduction_12_2.png" />
</div>
</div>
<p>A frequent issue is homogeneity. One can use decorators to ensure it.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="c1"># This ensures that B and E are homogeneous to magnetic field strength and energy</span>
<span class="c1"># If not will raise a UnitError exception</span>
<span class="nd">@u.quantity_input</span><span class="p">(</span><span class="n">B</span><span class="o">=</span><span class="n">u</span><span class="o">.</span><span class="n">T</span><span class="p">,</span><span class="n">E</span><span class="o">=</span><span class="n">u</span><span class="o">.</span><span class="n">J</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">electron_energy_loss_rate</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">E</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; energy loss rate of an electron of kinetic energy E in magnetic field B</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">U_B</span> <span class="o">=</span> <span class="n">B</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">cst</span><span class="o">.</span><span class="n">mu0</span><span class="p">)</span>
    <span class="n">gamma</span> <span class="o">=</span> <span class="n">E</span> <span class="o">/</span> <span class="p">(</span><span class="n">cst</span><span class="o">.</span><span class="n">m_e</span> <span class="o">*</span> <span class="n">cst</span><span class="o">.</span><span class="n">c</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>   <span class="c1"># note that this works only because E/(cst.m_e*cst.c**2) is dimensionless</span>
    <span class="n">beta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">gamma</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
    <span class="k">return</span> <span class="mf">4.</span> <span class="o">/</span> <span class="mf">3.</span> <span class="o">*</span> <span class="n">cst</span><span class="o">.</span><span class="n">sigma_T</span> <span class="o">*</span> <span class="n">cst</span><span class="o">.</span><span class="n">c</span> <span class="o">*</span> <span class="n">gamma</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">beta</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">U_B</span>

<span class="c1"># Now try it</span>
<span class="k">try</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="n">electron_energy_loss_rate</span><span class="p">(</span><span class="mf">1e-5</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">G</span><span class="p">,</span> <span class="mi">1</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">Hz</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;erg/s&#39;</span><span class="p">))</span>
<span class="k">except</span> <span class="n">u</span><span class="o">.</span><span class="n">UnitsError</span> <span class="k">as</span> <span class="n">message</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Incorrect unit: &#39;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">message</span><span class="p">))</span>

</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Incorrect unit: Argument &#39;E&#39; to function &#39;electron_energy_loss_rate&#39; must be in units convertible to &#39;J&#39;.
</pre></div></div>
</div>
</div>
</div>
<div class="section" id="Coordinates">
<h2>Coordinates<a class="headerlink" href="#Coordinates" title="Permalink to this headline">¶</a></h2>
<p>Note that SkyCoord are arrays of coordinates. We will see that in more
detail in the next section.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="c1"># Different ways to create a SkyCoord</span>
<span class="n">c1</span> <span class="o">=</span> <span class="n">SkyCoord</span><span class="p">(</span><span class="mf">10.625</span><span class="p">,</span> <span class="mf">41.2</span><span class="p">,</span> <span class="n">frame</span><span class="o">=</span><span class="s1">&#39;icrs&#39;</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="s1">&#39;deg&#39;</span><span class="p">)</span>
<span class="n">c1</span> <span class="o">=</span> <span class="n">SkyCoord</span><span class="p">(</span><span class="s1">&#39;00h42m30s&#39;</span><span class="p">,</span> <span class="s1">&#39;+41d12m00s&#39;</span><span class="p">,</span> <span class="n">frame</span><span class="o">=</span><span class="s1">&#39;icrs&#39;</span><span class="p">)</span>

<span class="n">c2</span> <span class="o">=</span> <span class="n">SkyCoord</span><span class="p">(</span><span class="mf">83.633083</span><span class="p">,</span> <span class="mf">22.0145</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="s1">&#39;deg&#39;</span><span class="p">)</span>
<span class="c1"># If you have internet access, you could also use this to define the `source_pos`:</span>
<span class="c1"># c2 = SkyCoord.from_name(&quot;Crab&quot;)     # Get the name from CDS</span>

<span class="k">print</span><span class="p">(</span><span class="n">c1</span><span class="o">.</span><span class="n">ra</span><span class="p">,</span><span class="n">c2</span><span class="o">.</span><span class="n">dec</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="s1">&#39;Distance to Crab: &#39;</span><span class="p">,</span> <span class="n">c1</span><span class="o">.</span><span class="n">separation</span><span class="p">(</span><span class="n">c2</span><span class="p">))</span>    <span class="c1"># separation returns an Angle object</span>
<span class="k">print</span><span class="p">(</span><span class="s1">&#39;Distance to Crab: &#39;</span><span class="p">,</span> <span class="n">c1</span><span class="o">.</span><span class="n">separation</span><span class="p">(</span><span class="n">c2</span><span class="p">)</span><span class="o">.</span><span class="n">degree</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
10d37m30s 22d00m52.2s
Distance to Crab:  63d12m28.2297s
Distance to Crab:  63.2078415848386
</pre></div></div>
</div>
<div class="section" id="Coordinate-transformations">
<h3>Coordinate transformations<a class="headerlink" href="#Coordinate-transformations" title="Permalink to this headline">¶</a></h3>
<p>How to change between coordinate frames. The Crab in Galactic
coordinates.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">c2b</span> <span class="o">=</span> <span class="n">c2</span><span class="o">.</span><span class="n">galactic</span>
<span class="k">print</span><span class="p">(</span><span class="n">c2b</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">c2b</span><span class="o">.</span><span class="n">l</span><span class="p">,</span> <span class="n">c2b</span><span class="o">.</span><span class="n">b</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;SkyCoord (Galactic): (l, b) in deg
    ( 184.55745771, -5.78435696)&gt;
184d33m26.8478s -5d47m03.6851s
</pre></div></div>
</div>
</div>
</div>
<div class="section" id="Time">
<h2>Time<a class="headerlink" href="#Time" title="Permalink to this headline">¶</a></h2>
<p>Is the Crab visible now?</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">now</span> <span class="o">=</span> <span class="n">Time</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="n">now</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">now</span><span class="o">.</span><span class="n">mjd</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
2017-04-11 06:58:46.032083
57854.290810556515
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="c1"># define the location for the AltAz system</span>
<span class="kn">from</span> <span class="nn">astropy.coordinates</span> <span class="kn">import</span> <span class="n">EarthLocation</span><span class="p">,</span> <span class="n">AltAz</span>
<span class="n">paris</span> <span class="o">=</span> <span class="n">EarthLocation</span><span class="p">(</span><span class="n">lat</span><span class="o">=</span><span class="mf">48.8567</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">,</span> <span class="n">lon</span><span class="o">=</span><span class="mf">2.3508</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">deg</span> <span class="p">)</span>

<span class="c1"># calculate the horizontal coordinates</span>
<span class="n">crab_altaz</span> <span class="o">=</span> <span class="n">c2</span><span class="o">.</span><span class="n">transform_to</span><span class="p">(</span><span class="n">AltAz</span><span class="p">(</span><span class="n">obstime</span><span class="o">=</span><span class="n">now</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="n">paris</span><span class="p">))</span>

<span class="k">print</span><span class="p">(</span><span class="n">crab_altaz</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;SkyCoord (AltAz: obstime=2017-04-11 06:58:46.032083, location=(4200910.643257838, 172456.78503911156, 4780088.658775934) m, pressure=0.0 hPa, temperature=0.0 deg_C, relative_humidity=0, obswl=1.0 micron): (az, alt) in deg
    ( 39.72687934, -9.48762642)&gt;
</pre></div></div>
</div>
</div>
<div class="section" id="Table:-Manipulating-the-3FGL-catalog">
<h2>Table: Manipulating the 3FGL catalog<a class="headerlink" href="#Table:-Manipulating-the-3FGL-catalog" title="Permalink to this headline">¶</a></h2>
<p>Here we are going to do some selections with the 3FGL catalog. To do so
we use the Table class from astropy.</p>
<div class="section" id="Accessing-the-table">
<h3>Accessing the table<a class="headerlink" href="#Accessing-the-table" title="Permalink to this headline">¶</a></h3>
<p>First, we need to open the catalog in a Table.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="c1"># Open Fermi 3FGL from the repo</span>
<span class="n">table</span> <span class="o">=</span> <span class="n">Table</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s2">&quot;../datasets/catalogs/fermi/gll_psc_v16.fit.gz&quot;</span><span class="p">)</span>
<span class="c1"># Alternatively, one can grab it from the server.</span>
<span class="c1">#table = Table.read(&quot;http://fermi.gsfc.nasa.gov/ssc/data/access/lat/4yr_catalog/gll_psc_v16.fit&quot;)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="stderr output_area docutils container">
<div class="highlight"><pre>
WARNING: hdu= was not specified but multiple tables are present, reading in first available table (hdu=1) [astropy.io.fits.connect]
WARNING: UnitsWarning: &#39;photon/cm**2/MeV/s&#39; contains multiple slashes, which is discouraged by the FITS standard [astropy.units.format.generic]
WARNING: UnitsWarning: &#39;photon/cm**2/s&#39; contains multiple slashes, which is discouraged by the FITS standard [astropy.units.format.generic]
WARNING: UnitsWarning: The unit &#39;erg&#39; has been deprecated in the FITS standard. Suggested: cm2 g s-2. [astropy.units.format.utils]
WARNING: UnitsWarning: &#39;erg/cm**2/s&#39; contains multiple slashes, which is discouraged by the FITS standard [astropy.units.format.generic]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="c1"># Note that a single FITS file might contain different tables in different HDUs</span>
<span class="n">filename</span> <span class="o">=</span> <span class="s2">&quot;../datasets/catalogs/fermi/gll_psc_v16.fit.gz&quot;</span>
<span class="c1"># You can load a `fits.HDUList` and check the extension names</span>
<span class="k">print</span><span class="p">([</span><span class="n">_</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">filename</span><span class="p">)])</span>
<span class="c1"># Then you can load by name or integer index via the `hdu` option</span>
<span class="n">extended_source_table</span> <span class="o">=</span> <span class="n">Table</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">hdu</span><span class="o">=</span><span class="s1">&#39;ExtendedSources&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&#39;PRIMARY&#39;, &#39;LAT_Point_Source_Catalog&#39;, &#39;ROIs&#39;, &#39;Hist_Start&#39;, &#39;GTI&#39;, &#39;ExtendedSources&#39;]
</pre></div></div>
</div>
</div>
<div class="section" id="General-informations-on-the-Table">
<h3>General informations on the Table<a class="headerlink" href="#General-informations-on-the-Table" title="Permalink to this headline">¶</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">table</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;Table length=3034&gt;
        name          dtype   shape        unit       n_bad
-------------------- ------- ------- ---------------- -----
         Source_Name   str18                              0
             RAJ2000 float32                      deg     0
             DEJ2000 float32                      deg     0
                GLON float32                      deg     0
                GLAT float32                      deg     0
   Conf_68_SemiMajor float32                      deg    28
   Conf_68_SemiMinor float32                      deg    28
      Conf_68_PosAng float32                      deg    28
   Conf_95_SemiMajor float32                      deg    28
   Conf_95_SemiMinor float32                      deg    28
      Conf_95_PosAng float32                      deg    28
             ROI_num   int16                              0
          Signif_Avg float32                              5
        Pivot_Energy float32                      MeV     0
        Flux_Density float32         ph / (cm2 MeV s)     0
    Unc_Flux_Density float32         ph / (cm2 MeV s)     5
            Flux1000 float32             ph / (cm2 s)     0
        Unc_Flux1000 float32             ph / (cm2 s)     5
      Energy_Flux100 float32            erg / (cm2 s)     0
  Unc_Energy_Flux100 float32            erg / (cm2 s)     5
        Signif_Curve float32                              0
        SpectrumType   str16                              0
      Spectral_Index float32                              0
  Unc_Spectral_Index float32                              9
                beta float32                           2639
            Unc_beta float32                           2680
              Cutoff float32                      MeV  2918
          Unc_Cutoff float32                      MeV  2918
           Exp_Index float32                           2918
       Unc_Exp_Index float32                           3028
      PowerLaw_Index float32                              0
          Flux30_100 float32             ph / (cm2 s)  3034
      Unc_Flux30_100 float32             ph / (cm2 s)  3034
         nuFnu30_100 float32            erg / (cm2 s)  3034
       Sqrt_TS30_100 float32                           3034
         Flux100_300 float32             ph / (cm2 s)     0
     Unc_Flux100_300 float32    (2,)     ph / (cm2 s)   836
        nuFnu100_300 float32            erg / (cm2 s)     0
      Sqrt_TS100_300 float32                              5
        Flux300_1000 float32             ph / (cm2 s)     0
    Unc_Flux300_1000 float32    (2,)     ph / (cm2 s)   327
       nuFnu300_1000 float32            erg / (cm2 s)     0
     Sqrt_TS300_1000 float32                              5
       Flux1000_3000 float32             ph / (cm2 s)     0
   Unc_Flux1000_3000 float32    (2,)     ph / (cm2 s)   111
      nuFnu1000_3000 float32            erg / (cm2 s)     0
    Sqrt_TS1000_3000 float32                              0
      Flux3000_10000 float32             ph / (cm2 s)     0
  Unc_Flux3000_10000 float32    (2,)     ph / (cm2 s)   137
     nuFnu3000_10000 float32            erg / (cm2 s)     0
   Sqrt_TS3000_10000 float32                              3
    Flux10000_100000 float32             ph / (cm2 s)     0
Unc_Flux10000_100000 float32    (2,)     ph / (cm2 s)   670
   nuFnu10000_100000 float32            erg / (cm2 s)     0
 Sqrt_TS10000_100000 float32                              2
   Variability_Index float32                              0
         Signif_Peak float32                           2387
           Flux_Peak float32             ph / (cm2 s)  2387
       Unc_Flux_Peak float32             ph / (cm2 s)  2387
           Time_Peak float64                        s  2387
       Peak_Interval float32                        s  2387
        Flux_History float32   (48,)     ph / (cm2 s)     0
    Unc_Flux_History float32 (48, 2)     ph / (cm2 s) 64623
Extended_Source_Name   str18                              0
           0FGL_Name   str17                              0
           1FGL_Name   str18                              0
           2FGL_Name   str18                              0
           1FHL_Name   str18                              0
          ASSOC_GAM1   str15                              0
          ASSOC_GAM2   str14                              0
          ASSOC_GAM3   str15                              0
         TEVCAT_FLAG    str1                              0
           ASSOC_TEV   str21                              0
              CLASS1    str5                              0
              ASSOC1   str26                              0
              ASSOC2   str26                              0
               Flags   int16                              0
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="c1"># Statistics on each column</span>
<span class="n">table</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;stats&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;Table length=3034&gt;
        name              mean          std          min         max     n_bad
-------------------- ------------- ------------- ----------- ----------- -----
         Source_Name            --            --          --          --     0
             RAJ2000       185.638       100.585      0.0377     359.881     0
             DEJ2000      -2.23514       41.5371    -87.6185     88.7739     0
                GLON       186.273       107.572    0.126161     359.969     0
                GLAT       1.22728       36.4998    -87.9516     86.3679     0
   Conf_68_SemiMajor          -inf           nan        -inf    0.658726    28
   Conf_68_SemiMinor          -inf           nan        -inf    0.320945    28
      Conf_68_PosAng     -0.219671       51.9263      -89.94       89.92    28
   Conf_95_SemiMajor          -inf           nan        -inf      1.0681    28
   Conf_95_SemiMinor          -inf           nan        -inf      0.5204    28
      Conf_95_PosAng     -0.219671       51.9263      -89.94       89.92    28
             ROI_num 424.777191826 238.846231996           1         840     0
          Signif_Avg          -inf           nan        -inf     1048.96     5
        Pivot_Energy       2104.46        2578.2     100.798     37202.0     0
        Flux_Density   1.29389e-11   2.17231e-10 4.21515e-16 1.14476e-08     0
    Unc_Flux_Density          -inf           nan        -inf 6.86476e-10     5
            Flux1000    2.7507e-09   2.76475e-08 4.90582e-12 1.29768e-06     0
        Unc_Flux1000          -inf           nan        -inf 2.89396e-09     5
      Energy_Flux100   2.56011e-11   1.88859e-10 1.65227e-12 8.93008e-09     0
  Unc_Energy_Flux100          -inf           nan        -inf 2.52953e-11     5
        Signif_Curve       2.43161       3.87731         0.0      84.973     0
        SpectrumType            --            --          --          --     0
      Spectral_Index       2.21451      0.360539         0.5     5.71589     0
  Unc_Spectral_Index          -inf           nan        -inf     1.06113     9
                beta          -inf           nan        -inf         1.0  2639
            Unc_beta          -inf           nan        -inf    0.337608  2680
              Cutoff          -inf           nan        -inf     13326.4  2918
          Unc_Cutoff          -inf           nan        -inf     3750.56  2918
           Exp_Index          -inf           nan        -inf         1.0  2918
       Unc_Exp_Index          -inf           nan        -inf   0.0442999  3028
      PowerLaw_Index       2.24982      0.306354     1.09753     5.71589     0
          Flux30_100           nan           nan         nan         nan  3034
      Unc_Flux30_100           nan           nan         nan         nan  3034
         nuFnu30_100           nan           nan         nan         nan  3034
       Sqrt_TS30_100           nan           nan         nan         nan  3034
         Flux100_300   2.37795e-08   1.20342e-07 1.00222e-14 5.37625e-06     0
     Unc_Flux100_300          -inf           nan        -inf 9.56701e-08   836
        nuFnu100_300   5.71922e-12   3.02685e-11 2.49123e-18 1.37177e-09     0
      Sqrt_TS100_300       3.81654       8.91583         0.0     215.416     5
        Flux300_1000   8.61936e-09   6.73293e-08 3.97788e-15 3.21672e-06     0
    Unc_Flux300_1000          -inf           nan        -inf 1.89716e-08   327
       nuFnu300_1000   5.90484e-12   4.79845e-11 2.91179e-18 2.29243e-09     0
     Sqrt_TS300_1000        7.4718       19.8981         0.0     568.663     5
       Flux1000_3000   2.19502e-09   2.27795e-08 1.50877e-15 1.07019e-06     0
   Unc_Flux1000_3000          -inf           nan        -inf 6.09948e-09   111
      nuFnu1000_3000   5.14613e-12   5.38784e-11 3.76523e-18 2.52534e-09     0
    Sqrt_TS1000_3000       8.60778       22.2479         0.0     711.632     0
      Flux3000_10000   4.83629e-10   4.64785e-09 9.33897e-16 2.16177e-07     0
  Unc_Flux3000_10000          -inf           nan        -inf 2.98606e-09   137
     nuFnu3000_10000   3.07335e-12   2.83225e-11  5.6769e-18 1.32102e-09     0
   Sqrt_TS3000_10000       6.98671       13.9194         0.0     465.899     3
    Flux10000_100000   7.39921e-11   3.22538e-10 1.03878e-17 1.13815e-08     0
Unc_Flux10000_100000          -inf           nan        -inf 7.88092e-10   670
   nuFnu10000_100000   1.16414e-12   4.63575e-12 9.38528e-20 1.16018e-10     0
 Sqrt_TS10000_100000       4.01938       5.47004         0.0     111.192     2
   Variability_Index       154.126       1230.71         0.0     60733.9     0
         Signif_Peak          -inf           nan        -inf     255.071  2387
           Flux_Peak          -inf           nan        -inf 2.12374e-05  2387
       Unc_Flux_Peak          -inf           nan        -inf 1.47859e-07  2387
           Time_Peak          -inf           nan        -inf 364203776.0  2387
       Peak_Interval          -inf           nan        -inf    2.63e+06  2387
        Flux_History   3.54401e-08   2.26052e-07         0.0 2.12374e-05     0
    Unc_Flux_History          -inf           nan        -inf 2.30386e-07 64623
Extended_Source_Name            --            --          --          --     0
           0FGL_Name            --            --          --          --     0
           1FGL_Name            --            --          --          --     0
           2FGL_Name            --            --          --          --     0
           1FHL_Name            --            --          --          --     0
          ASSOC_GAM1            --            --          --          --     0
          ASSOC_GAM2            --            --          --          --     0
          ASSOC_GAM3            --            --          --          --     0
         TEVCAT_FLAG            --            --          --          --     0
           ASSOC_TEV            --            --          --          --     0
              CLASS1            --            --          --          --     0
              ASSOC1            --            --          --          --     0
              ASSOC2            --            --          --          --     0
               Flags 45.7735662492 265.711605004           0        2565     0
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="stderr output_area docutils container">
<div class="highlight"><pre>
/opt/local/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/site-packages/numpy/lib/nanfunctions.py:1304: RuntimeWarning: invalid value encountered in subtract
  np.subtract(arr, avg, out=arr, casting=&#39;unsafe&#39;)
/opt/local/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/site-packages/numpy/lib/nanfunctions.py:1304: RuntimeWarning: invalid value encountered in subtract
  np.subtract(arr, avg, out=arr, casting=&#39;unsafe&#39;)
/opt/local/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/site-packages/numpy/lib/nanfunctions.py:1304: RuntimeWarning: invalid value encountered in subtract
  np.subtract(arr, avg, out=arr, casting=&#39;unsafe&#39;)
/opt/local/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/site-packages/numpy/lib/nanfunctions.py:1304: RuntimeWarning: invalid value encountered in subtract
  np.subtract(arr, avg, out=arr, casting=&#39;unsafe&#39;)
/opt/local/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/site-packages/numpy/lib/nanfunctions.py:1304: RuntimeWarning: invalid value encountered in subtract
  np.subtract(arr, avg, out=arr, casting=&#39;unsafe&#39;)
/opt/local/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/site-packages/numpy/lib/nanfunctions.py:1304: RuntimeWarning: invalid value encountered in subtract
  np.subtract(arr, avg, out=arr, casting=&#39;unsafe&#39;)
/opt/local/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/site-packages/numpy/lib/nanfunctions.py:1304: RuntimeWarning: invalid value encountered in subtract
  np.subtract(arr, avg, out=arr, casting=&#39;unsafe&#39;)
/opt/local/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/site-packages/numpy/lib/nanfunctions.py:1304: RuntimeWarning: invalid value encountered in subtract
  np.subtract(arr, avg, out=arr, casting=&#39;unsafe&#39;)
/opt/local/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/site-packages/numpy/lib/nanfunctions.py:1304: RuntimeWarning: invalid value encountered in subtract
  np.subtract(arr, avg, out=arr, casting=&#39;unsafe&#39;)
/opt/local/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/site-packages/numpy/lib/nanfunctions.py:1304: RuntimeWarning: invalid value encountered in subtract
  np.subtract(arr, avg, out=arr, casting=&#39;unsafe&#39;)
/opt/local/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/site-packages/numpy/lib/nanfunctions.py:1304: RuntimeWarning: invalid value encountered in subtract
  np.subtract(arr, avg, out=arr, casting=&#39;unsafe&#39;)
/opt/local/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/site-packages/numpy/lib/nanfunctions.py:1304: RuntimeWarning: invalid value encountered in subtract
  np.subtract(arr, avg, out=arr, casting=&#39;unsafe&#39;)
/opt/local/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/site-packages/numpy/lib/nanfunctions.py:1304: RuntimeWarning: invalid value encountered in subtract
  np.subtract(arr, avg, out=arr, casting=&#39;unsafe&#39;)
/opt/local/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/site-packages/numpy/lib/nanfunctions.py:1304: RuntimeWarning: invalid value encountered in subtract
  np.subtract(arr, avg, out=arr, casting=&#39;unsafe&#39;)
/opt/local/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/site-packages/numpy/lib/nanfunctions.py:1304: RuntimeWarning: invalid value encountered in subtract
  np.subtract(arr, avg, out=arr, casting=&#39;unsafe&#39;)
/opt/local/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/site-packages/numpy/lib/nanfunctions.py:1304: RuntimeWarning: invalid value encountered in subtract
  np.subtract(arr, avg, out=arr, casting=&#39;unsafe&#39;)
/opt/local/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/site-packages/numpy/lib/nanfunctions.py:1304: RuntimeWarning: invalid value encountered in subtract
  np.subtract(arr, avg, out=arr, casting=&#39;unsafe&#39;)
/opt/local/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/site-packages/numpy/lib/nanfunctions.py:1304: RuntimeWarning: invalid value encountered in subtract
  np.subtract(arr, avg, out=arr, casting=&#39;unsafe&#39;)
/opt/local/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/site-packages/numpy/lib/nanfunctions.py:1304: RuntimeWarning: invalid value encountered in subtract
  np.subtract(arr, avg, out=arr, casting=&#39;unsafe&#39;)
/opt/local/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/site-packages/numpy/lib/nanfunctions.py:1304: RuntimeWarning: invalid value encountered in subtract
  np.subtract(arr, avg, out=arr, casting=&#39;unsafe&#39;)
/opt/local/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/site-packages/numpy/lib/nanfunctions.py:1304: RuntimeWarning: invalid value encountered in subtract
  np.subtract(arr, avg, out=arr, casting=&#39;unsafe&#39;)
/opt/local/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/site-packages/numpy/lib/nanfunctions.py:1304: RuntimeWarning: invalid value encountered in subtract
  np.subtract(arr, avg, out=arr, casting=&#39;unsafe&#39;)
/opt/local/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/site-packages/numpy/lib/nanfunctions.py:1304: RuntimeWarning: invalid value encountered in subtract
  np.subtract(arr, avg, out=arr, casting=&#39;unsafe&#39;)
/opt/local/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/site-packages/numpy/lib/nanfunctions.py:1304: RuntimeWarning: invalid value encountered in subtract
  np.subtract(arr, avg, out=arr, casting=&#39;unsafe&#39;)
/opt/local/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/site-packages/numpy/lib/nanfunctions.py:1304: RuntimeWarning: invalid value encountered in subtract
  np.subtract(arr, avg, out=arr, casting=&#39;unsafe&#39;)
/opt/local/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/site-packages/numpy/lib/nanfunctions.py:1304: RuntimeWarning: invalid value encountered in subtract
  np.subtract(arr, avg, out=arr, casting=&#39;unsafe&#39;)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="c1">### list of column names</span>
<span class="n">table</span><span class="o">.</span><span class="n">colnames</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>Out[17]:
</pre></div>
</div>
<div class="output_area highlight-none"><div class="highlight"><pre>
<span></span>[&#39;Source_Name&#39;,
 &#39;RAJ2000&#39;,
 &#39;DEJ2000&#39;,
 &#39;GLON&#39;,
 &#39;GLAT&#39;,
 &#39;Conf_68_SemiMajor&#39;,
 &#39;Conf_68_SemiMinor&#39;,
 &#39;Conf_68_PosAng&#39;,
 &#39;Conf_95_SemiMajor&#39;,
 &#39;Conf_95_SemiMinor&#39;,
 &#39;Conf_95_PosAng&#39;,
 &#39;ROI_num&#39;,
 &#39;Signif_Avg&#39;,
 &#39;Pivot_Energy&#39;,
 &#39;Flux_Density&#39;,
 &#39;Unc_Flux_Density&#39;,
 &#39;Flux1000&#39;,
 &#39;Unc_Flux1000&#39;,
 &#39;Energy_Flux100&#39;,
 &#39;Unc_Energy_Flux100&#39;,
 &#39;Signif_Curve&#39;,
 &#39;SpectrumType&#39;,
 &#39;Spectral_Index&#39;,
 &#39;Unc_Spectral_Index&#39;,
 &#39;beta&#39;,
 &#39;Unc_beta&#39;,
 &#39;Cutoff&#39;,
 &#39;Unc_Cutoff&#39;,
 &#39;Exp_Index&#39;,
 &#39;Unc_Exp_Index&#39;,
 &#39;PowerLaw_Index&#39;,
 &#39;Flux30_100&#39;,
 &#39;Unc_Flux30_100&#39;,
 &#39;nuFnu30_100&#39;,
 &#39;Sqrt_TS30_100&#39;,
 &#39;Flux100_300&#39;,
 &#39;Unc_Flux100_300&#39;,
 &#39;nuFnu100_300&#39;,
 &#39;Sqrt_TS100_300&#39;,
 &#39;Flux300_1000&#39;,
 &#39;Unc_Flux300_1000&#39;,
 &#39;nuFnu300_1000&#39;,
 &#39;Sqrt_TS300_1000&#39;,
 &#39;Flux1000_3000&#39;,
 &#39;Unc_Flux1000_3000&#39;,
 &#39;nuFnu1000_3000&#39;,
 &#39;Sqrt_TS1000_3000&#39;,
 &#39;Flux3000_10000&#39;,
 &#39;Unc_Flux3000_10000&#39;,
 &#39;nuFnu3000_10000&#39;,
 &#39;Sqrt_TS3000_10000&#39;,
 &#39;Flux10000_100000&#39;,
 &#39;Unc_Flux10000_100000&#39;,
 &#39;nuFnu10000_100000&#39;,
 &#39;Sqrt_TS10000_100000&#39;,
 &#39;Variability_Index&#39;,
 &#39;Signif_Peak&#39;,
 &#39;Flux_Peak&#39;,
 &#39;Unc_Flux_Peak&#39;,
 &#39;Time_Peak&#39;,
 &#39;Peak_Interval&#39;,
 &#39;Flux_History&#39;,
 &#39;Unc_Flux_History&#39;,
 &#39;Extended_Source_Name&#39;,
 &#39;0FGL_Name&#39;,
 &#39;1FGL_Name&#39;,
 &#39;2FGL_Name&#39;,
 &#39;1FHL_Name&#39;,
 &#39;ASSOC_GAM1&#39;,
 &#39;ASSOC_GAM2&#39;,
 &#39;ASSOC_GAM3&#39;,
 &#39;TEVCAT_FLAG&#39;,
 &#39;ASSOC_TEV&#39;,
 &#39;CLASS1&#39;,
 &#39;ASSOC1&#39;,
 &#39;ASSOC2&#39;,
 &#39;Flags&#39;]
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="c1"># HTML display</span>
<span class="c1"># table.show_in_browser(jsviewer=True)</span>
<span class="c1"># table.show_in_notebook(jsviewer=True)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Accessing-the-table">
<h3>Accessing the table<a class="headerlink" href="#Accessing-the-table" title="Permalink to this headline">¶</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="c1"># The header keywords are stored as a dict</span>
<span class="c1"># table.meta</span>
<span class="n">table</span><span class="o">.</span><span class="n">meta</span><span class="p">[</span><span class="s1">&#39;TSMIN&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>Out[19]:
</pre></div>
</div>
<div class="output_area highlight-none"><div class="highlight"><pre>
<span></span>25
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="c1"># First row</span>
<span class="n">table</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>Out[20]:
</pre></div>
</div>
<div class="output_area docutils container">
&lt;Row index=0&gt;
<table id="table4485607208">
<thead><tr><th>Source_Name</th><th>RAJ2000</th><th>DEJ2000</th><th>GLON</th><th>GLAT</th><th>Conf_68_SemiMajor</th><th>Conf_68_SemiMinor</th><th>Conf_68_PosAng</th><th>Conf_95_SemiMajor</th><th>Conf_95_SemiMinor</th><th>Conf_95_PosAng</th><th>ROI_num</th><th>Signif_Avg</th><th>Pivot_Energy</th><th>Flux_Density</th><th>Unc_Flux_Density</th><th>Flux1000</th><th>Unc_Flux1000</th><th>Energy_Flux100</th><th>Unc_Energy_Flux100</th><th>Signif_Curve</th><th>SpectrumType</th><th>Spectral_Index</th><th>Unc_Spectral_Index</th><th>beta</th><th>Unc_beta</th><th>Cutoff</th><th>Unc_Cutoff</th><th>Exp_Index</th><th>Unc_Exp_Index</th><th>PowerLaw_Index</th><th>Flux30_100</th><th>Unc_Flux30_100</th><th>nuFnu30_100</th><th>Sqrt_TS30_100</th><th>Flux100_300</th><th>Unc_Flux100_300 [2]</th><th>nuFnu100_300</th><th>Sqrt_TS100_300</th><th>Flux300_1000</th><th>Unc_Flux300_1000 [2]</th><th>nuFnu300_1000</th><th>Sqrt_TS300_1000</th><th>Flux1000_3000</th><th>Unc_Flux1000_3000 [2]</th><th>nuFnu1000_3000</th><th>Sqrt_TS1000_3000</th><th>Flux3000_10000</th><th>Unc_Flux3000_10000 [2]</th><th>nuFnu3000_10000</th><th>Sqrt_TS3000_10000</th><th>Flux10000_100000</th><th>Unc_Flux10000_100000 [2]</th><th>nuFnu10000_100000</th><th>Sqrt_TS10000_100000</th><th>Variability_Index</th><th>Signif_Peak</th><th>Flux_Peak</th><th>Unc_Flux_Peak</th><th>Time_Peak</th><th>Peak_Interval</th><th>Flux_History [48]</th><th>Unc_Flux_History [48,2]</th><th>Extended_Source_Name</th><th>0FGL_Name</th><th>1FGL_Name</th><th>2FGL_Name</th><th>1FHL_Name</th><th>ASSOC_GAM1</th><th>ASSOC_GAM2</th><th>ASSOC_GAM3</th><th>TEVCAT_FLAG</th><th>ASSOC_TEV</th><th>CLASS1</th><th>ASSOC1</th><th>ASSOC2</th><th>Flags</th></tr></thead>
<thead><tr><th></th><th>deg</th><th>deg</th><th>deg</th><th>deg</th><th>deg</th><th>deg</th><th>deg</th><th>deg</th><th>deg</th><th>deg</th><th></th><th></th><th>MeV</th><th>ph / (cm2 MeV s)</th><th>ph / (cm2 MeV s)</th><th>ph / (cm2 s)</th><th>ph / (cm2 s)</th><th>erg / (cm2 s)</th><th>erg / (cm2 s)</th><th></th><th></th><th></th><th></th><th></th><th></th><th>MeV</th><th>MeV</th><th></th><th></th><th></th><th>ph / (cm2 s)</th><th>ph / (cm2 s)</th><th>erg / (cm2 s)</th><th></th><th>ph / (cm2 s)</th><th>ph / (cm2 s)</th><th>erg / (cm2 s)</th><th></th><th>ph / (cm2 s)</th><th>ph / (cm2 s)</th><th>erg / (cm2 s)</th><th></th><th>ph / (cm2 s)</th><th>ph / (cm2 s)</th><th>erg / (cm2 s)</th><th></th><th>ph / (cm2 s)</th><th>ph / (cm2 s)</th><th>erg / (cm2 s)</th><th></th><th>ph / (cm2 s)</th><th>ph / (cm2 s)</th><th>erg / (cm2 s)</th><th></th><th></th><th></th><th>ph / (cm2 s)</th><th>ph / (cm2 s)</th><th>s</th><th>s</th><th>ph / (cm2 s)</th><th>ph / (cm2 s)</th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th></tr></thead>
<thead><tr><th>str18</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>int16</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>str16</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float64</th><th>float32</th><th>float32</th><th>float32</th><th>str18</th><th>str17</th><th>str18</th><th>str18</th><th>str18</th><th>str15</th><th>str14</th><th>str15</th><th>str1</th><th>str21</th><th>str5</th><th>str26</th><th>str26</th><th>int16</th></tr></thead>
<tr><td>3FGL J0000.1+6545</td><td>0.0377</td><td>65.7517</td><td>117.694</td><td>3.40296</td><td>0.0628445</td><td>0.0481047</td><td>41.03</td><td>0.1019</td><td>0.078</td><td>41.03</td><td>185</td><td>6.81313</td><td>1159.08</td><td>1.00534e-12</td><td>1.49106e-13</td><td>1.01596e-09</td><td>1.57592e-10</td><td>1.35695e-11</td><td>2.07317e-12</td><td>3.39662</td><td>PowerLaw</td><td>2.41096</td><td>0.0823208</td><td>-inf</td><td>-inf</td><td>-inf</td><td>-inf</td><td>-inf</td><td>-inf</td><td>2.41096</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>1.80832e-08</td><td>-8.39548e-09 .. 8.23604e-09</td><td>4.17529e-12</td><td>2.16875</td><td>6.94073e-09</td><td>-1.35281e-09 .. 1.36692e-09</td><td>4.54365e-12</td><td>5.26971</td><td>1.23665e-09</td><td>-2.25128e-10 .. 2.34347e-10</td><td>2.85534e-12</td><td>6.02224</td><td>5.78052e-11</td><td>-4.04457e-11 .. 4.8534e-11</td><td>3.78413e-13</td><td>1.50919</td><td>2.83963e-11</td><td>-1.48428e-11 .. 1.91547e-11</td><td>4.3172e-13</td><td>2.42117</td><td>40.7535</td><td>-inf</td><td>-inf</td><td>-inf</td><td>-inf</td><td>-inf</td><td>6.36157e-08 .. 0.0</td><td>-2.7777e-08 .. 2.09131e-08</td><td></td><td></td><td></td><td>2FGL J2359.6+6543c</td><td></td><td></td><td></td><td></td><td>N</td><td></td><td></td><td></td><td></td><td>4</td></tr>
</table></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="c1"># Spectral index of the 5 first entries</span>
<span class="n">table</span><span class="p">[:</span><span class="mi">5</span><span class="p">][</span><span class="s1">&#39;Spectral_Index&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>Out[21]:
</pre></div>
</div>
<div class="output_area docutils container">
&lt;Column name=&apos;Spectral_Index&apos; dtype=&apos;float32&apos; length=5&gt;
<table>
<tr><td>2.41096</td></tr>
<tr><td>1.86673</td></tr>
<tr><td>2.73279</td></tr>
<tr><td>2.14935</td></tr>
<tr><td>2.30511</td></tr>
</table></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="c1"># Which source has the lowest spectral index?</span>
<span class="n">min_index_row</span> <span class="o">=</span> <span class="n">table</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">table</span><span class="p">[</span><span class="s1">&#39;Spectral_Index&#39;</span><span class="p">])]</span>
<span class="k">print</span><span class="p">(</span><span class="s1">&#39;Hardest source: &#39;</span><span class="p">,</span><span class="n">min_index_row</span><span class="p">[</span><span class="s1">&#39;Source_Name&#39;</span><span class="p">],</span>
                         <span class="n">min_index_row</span><span class="p">[</span><span class="s1">&#39;CLASS1&#39;</span><span class="p">],</span><span class="n">min_index_row</span><span class="p">[</span><span class="s1">&#39;Spectral_Index&#39;</span><span class="p">])</span>

<span class="c1"># Which source has the largest spectral index?</span>
<span class="n">max_index_row</span> <span class="o">=</span> <span class="n">table</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">table</span><span class="p">[</span><span class="s1">&#39;Spectral_Index&#39;</span><span class="p">])]</span>
<span class="k">print</span><span class="p">(</span><span class="s1">&#39;Softest source: &#39;</span><span class="p">,</span><span class="n">max_index_row</span><span class="p">[</span><span class="s1">&#39;Source_Name&#39;</span><span class="p">],</span>
                         <span class="n">max_index_row</span><span class="p">[</span><span class="s1">&#39;CLASS1&#39;</span><span class="p">],</span><span class="n">max_index_row</span><span class="p">[</span><span class="s1">&#39;Spectral_Index&#39;</span><span class="p">])</span>


</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Hardest source:  3FGL J2051.3-0828  PSR   0.5
Softest source:  3FGL J0534.5+2201s PWN   5.71589
</pre></div></div>
</div>
</div>
<div class="section" id="Quantities-and-SkyCoords-from-a-Table">
<h3>Quantities and SkyCoords from a Table<a class="headerlink" href="#Quantities-and-SkyCoords-from-a-Table" title="Permalink to this headline">¶</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">fluxes</span> <span class="o">=</span> <span class="n">table</span><span class="p">[</span><span class="s1">&#39;nuFnu1000_3000&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">quantity</span>
<span class="k">print</span><span class="p">(</span><span class="n">fluxes</span><span class="p">)</span>
<span class="n">coord</span> <span class="o">=</span> <span class="n">SkyCoord</span><span class="p">(</span><span class="n">table</span><span class="p">[</span><span class="s1">&#39;GLON&#39;</span><span class="p">],</span><span class="n">table</span><span class="p">[</span><span class="s1">&#39;GLAT&#39;</span><span class="p">],</span><span class="n">frame</span><span class="o">=</span><span class="s1">&#39;galactic&#39;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">coord</span><span class="o">.</span><span class="n">fk5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[  2.85534313e-12   3.53278225e-13   6.76803394e-13 ...,   7.31505785e-13
   1.04839715e-12   4.78210245e-13] erg / (cm2 s)
&lt;SkyCoord (FK5: equinox=J2000.000): (ra, dec) in deg
    [(  3.87171473e-02,  65.75181023), (  6.14202362e-02, -37.64829309),
     (  2.54455001e-01,  63.2441096 ), ...,
     (  3.59736655e+02,  39.44771268), (  3.59829367e+02, -30.64638846),
     (  3.59881529e+02, -20.88248885)]&gt;
</pre></div></div>
</div>
</div>
<div class="section" id="Selections-in-a-Table">
<h3>Selections in a Table<a class="headerlink" href="#Selections-in-a-Table" title="Permalink to this headline">¶</a></h3>
<p>Here we select Sources according to their class and do some whole sky
chart</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="c1"># Get coordinates of FSRQs</span>
<span class="n">fsrq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">logical_or</span><span class="p">(</span><span class="n">table</span><span class="p">[</span><span class="s1">&#39;CLASS1&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;fsrq &#39;</span><span class="p">,</span><span class="n">table</span><span class="p">[</span><span class="s1">&#39;CLASS1&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;FSQR &#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="c1"># This is here for plotting purpose...</span>
<span class="c1">#glon = glon.wrap_at(180*u.degree)</span>

<span class="c1"># Open figure</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s2">&quot;aitoff&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="n">fsrq</span><span class="p">]</span><span class="o">.</span><span class="n">l</span><span class="o">.</span><span class="n">wrap_at</span><span class="p">(</span><span class="mi">180</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">degree</span><span class="p">)</span><span class="o">.</span><span class="n">radian</span><span class="p">,</span>
           <span class="n">coord</span><span class="p">[</span><span class="n">fsrq</span><span class="p">]</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">radian</span><span class="p">,</span>
           <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;FSRQ&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="c1"># ax.invert_xaxis()  -&gt; This does not work for projections...</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>Out[25]:
</pre></div>
</div>
<div class="output_area highlight-none"><div class="highlight"><pre>
<span></span>&lt;matplotlib.legend.Legend at 0x11081d780&gt;
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_astropy_introduction_39_1.png" src="../_images/notebooks_astropy_introduction_39_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="c1"># Now do it for a series of classes</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s2">&quot;aitoff&quot;</span><span class="p">)</span>

<span class="n">source_classes</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="s1">&#39;psr&#39;</span><span class="p">,</span><span class="s1">&#39;spp&#39;</span><span class="p">,</span> <span class="s1">&#39;fsrq&#39;</span><span class="p">,</span> <span class="s1">&#39;bll&#39;</span><span class="p">,</span> <span class="s1">&#39;bin&#39;</span><span class="p">]</span>

<span class="k">for</span> <span class="n">source_class</span> <span class="ow">in</span> <span class="n">source_classes</span><span class="p">:</span>
    <span class="c1"># We select elements with correct class in upper or lower characters</span>
    <span class="n">index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">_</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="n">source_class</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">table</span><span class="p">[</span><span class="s1">&#39;CLASS1&#39;</span><span class="p">]])</span>

    <span class="n">label</span> <span class="o">=</span> <span class="n">source_class</span> <span class="k">if</span> <span class="n">source_class</span> <span class="k">else</span> <span class="s1">&#39;unid&#39;</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
        <span class="n">coord</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">l</span><span class="o">.</span><span class="n">wrap_at</span><span class="p">(</span><span class="mi">180</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">degree</span><span class="p">)</span><span class="o">.</span><span class="n">radian</span><span class="p">,</span>
        <span class="n">coord</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">radian</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span>
    <span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>Out[26]:
</pre></div>
</div>
<div class="output_area highlight-none"><div class="highlight"><pre>
<span></span>&lt;matplotlib.legend.Legend at 0x10b5cecc0&gt;
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_astropy_introduction_40_1.png" src="../_images/notebooks_astropy_introduction_40_1.png" />
</div>
</div>
</div>
<div class="section" id="Creating-tables">
<h3>Creating tables<a class="headerlink" href="#Creating-tables" title="Permalink to this headline">¶</a></h3>
<p>A <code class="docutils literal"><span class="pre">Table</span></code> is basically a dict mapping column names to column values,
where a column value is a Numpy array (or Quantity object, which is a
Numpy array sub-class). This implies that adding columns to a table
after creation is nice and easy, but adding a row is hard and slow,
basically all data has to be copied and all objects that make up a Table
have to be re-created.</p>
<p>Here’s one way to create a <code class="docutils literal"><span class="pre">Table</span></code> from scratch: put the data into a
list of dicts, and then call the <code class="docutils literal"><span class="pre">Table</span></code> constructor with the <code class="docutils literal"><span class="pre">rows</span></code>
option.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">rows</span> <span class="o">=</span> <span class="p">[</span>
    <span class="nb">dict</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="s1">&#39;spam&#39;</span><span class="p">),</span>
    <span class="nb">dict</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mi">43</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="s1">&#39;ham&#39;</span><span class="p">),</span>
<span class="p">]</span>
<span class="n">my_table</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span><span class="n">rows</span><span class="o">=</span><span class="n">rows</span><span class="p">)</span>
<span class="n">my_table</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>Out[27]:
</pre></div>
</div>
<div class="output_area docutils container">
&lt;Table length=2&gt;
<table id="table4571828968" class="table-striped table-bordered table-condensed">
<thead><tr><th>a</th><th>b</th></tr></thead>
<thead><tr><th>int64</th><th>str4</th></tr></thead>
<tr><td>42</td><td>spam</td></tr>
<tr><td>43</td><td>ham</td></tr>
</table></div>
</div>
</div>
<div class="section" id="Writing-tables">
<h3>Writing tables<a class="headerlink" href="#Writing-tables" title="Permalink to this headline">¶</a></h3>
<p>Writing tables to files is easy, you can just give the filename and
format you want. If you run a script repeatedly you might want to add
<code class="docutils literal"><span class="pre">overwrite=True</span></code>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="c1"># Examples how to write a table in different formats</span>
<span class="c1"># Uncomment if you really want to do it</span>

<span class="c1"># my_table.write(&#39;/tmp/table.fits&#39;, format=&#39;fits&#39;)</span>
<span class="c1"># my_table.write(&#39;/tmp/table.fits.gz&#39;, format=&#39;fits&#39;)</span>
<span class="c1"># my_table.write(&#39;/tmp/table.ecsv&#39;, format=&#39;ascii.ecsv&#39;)</span>
</pre></div>
</div>
</div>
<p>FITS (and some other formats, e.g. HDF5) support writing multiple tables
to a single file. The <code class="docutils literal"><span class="pre">table.write</span></code> API doesn’t support that directly
yet. Here’s how you can currently write multiple tables to a FITS file:
you have to convert the <code class="docutils literal"><span class="pre">astropy.table.Table</span></code> objects to
<code class="docutils literal"><span class="pre">astropy.io.fits.BinTable</span></code> objects, and then store them in a
<code class="docutils literal"><span class="pre">astropy.io.fits.HDUList</span></code> objects and call <code class="docutils literal"><span class="pre">HDUList.writeto</span></code>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [29]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">my_table2</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]))</span>
<span class="n">hdu_list</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">HDUList</span><span class="p">([</span>
    <span class="n">fits</span><span class="o">.</span><span class="n">PrimaryHDU</span><span class="p">(),</span> <span class="c1"># need an empty primary HDU</span>
    <span class="n">fits</span><span class="o">.</span><span class="n">table_to_hdu</span><span class="p">(</span><span class="n">my_table</span><span class="p">),</span>
    <span class="n">fits</span><span class="o">.</span><span class="n">table_to_hdu</span><span class="p">(</span><span class="n">my_table2</span><span class="p">),</span>
<span class="p">])</span>
<span class="c1"># hdu_list.writeto(&#39;tables.fits&#39;)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="Using-regions">
<h2>Using regions<a class="headerlink" href="#Using-regions" title="Permalink to this headline">¶</a></h2>
<p>Let’s try to find sources inside a circular region in the sky.</p>
<p>For this we will rely on the <a class="reference external" href="http://astropy-regions.readthedocs.io/en/latest/index.html">region
package</a></p>
<p>We first create a circular region centered on a given SkyCoord with a
given radius.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [30]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">regions</span> <span class="kn">import</span> <span class="n">CircleSkyRegion</span>

<span class="c1">#center = SkyCoord.from_name(&quot;M31&quot;)</span>
<span class="n">center</span> <span class="o">=</span> <span class="n">SkyCoord</span><span class="p">(</span><span class="n">ra</span><span class="o">=</span><span class="s1">&#39;0h42m44.31s&#39;</span><span class="p">,</span> <span class="n">dec</span><span class="o">=</span><span class="s1">&#39;41d16m09.4s&#39;</span><span class="p">)</span>

<span class="n">circle_region</span> <span class="o">=</span> <span class="n">CircleSkyRegion</span><span class="p">(</span>
    <span class="n">center</span><span class="o">=</span><span class="n">center</span><span class="p">,</span>
    <span class="n">radius</span><span class="o">=</span><span class="n">Angle</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="s1">&#39;deg&#39;</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<p>We now use the contains method to search objects in this circular region
in the sky.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [31]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">in_region</span> <span class="o">=</span> <span class="n">circle_region</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">coord</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [32]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s2">&quot;aitoff&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="n">in_region</span><span class="p">]</span><span class="o">.</span><span class="n">l</span><span class="o">.</span><span class="n">radian</span><span class="p">,</span> <span class="n">coord</span><span class="p">[</span><span class="n">in_region</span><span class="p">]</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">radian</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>Out[32]:
</pre></div>
</div>
<div class="output_area highlight-none"><div class="highlight"><pre>
<span></span>&lt;matplotlib.collections.PathCollection at 0x10b4c7a20&gt;
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_astropy_introduction_51_1.png" src="../_images/notebooks_astropy_introduction_51_1.png" />
</div>
</div>
<div class="section" id="Tables-and-pandas">
<h3>Tables and pandas<a class="headerlink" href="#Tables-and-pandas" title="Permalink to this headline">¶</a></h3>
<p><a class="reference external" href="http://pandas.pydata.org/">pandas</a> is one of the most-used packages
in the scientific Python stack. Numpy provides the <code class="docutils literal"><span class="pre">ndarray</span></code> object
and functions that operate on <code class="docutils literal"><span class="pre">ndarray</span></code> objects. Pandas provides the
<code class="docutils literal"><span class="pre">Dataframe</span></code> and <code class="docutils literal"><span class="pre">Series</span></code> objects, which roughly correspond to the
Astropy <code class="docutils literal"><span class="pre">Table</span></code> and <code class="docutils literal"><span class="pre">Column</span></code> objects. While both
<code class="docutils literal"><span class="pre">pandas.Dataframe</span></code> and <code class="docutils literal"><span class="pre">astropy.table.Table</span></code> can often be used to
work with tabular data, each has features that the other doesn’t. When
Astropy was started, it was decided to not base it on
<code class="docutils literal"><span class="pre">pandas.Dataframe</span></code>, but to introduce <code class="docutils literal"><span class="pre">Table</span></code>, mainly because
<code class="docutils literal"><span class="pre">pandas.Dataframe</span></code> doesn’t support multi-dimensional columns, but FITS
does and astronomers use sometimes.</p>
<p>But <code class="docutils literal"><span class="pre">pandas.Dataframe</span></code> has a ton of features that <code class="docutils literal"><span class="pre">Table</span></code> doesn’t,
and is highly optimised, so if you find something to be hard with
<code class="docutils literal"><span class="pre">Table</span></code>, you can convert it to a <code class="docutils literal"><span class="pre">Dataframe</span></code> and do your work there.
As explained in the <a class="reference external" href="http://docs.astropy.org/en/stable/table/pandas.html">interfacing with the pandas
package</a> page in
the Astropy docs, it is easy to go back and forth between Table and
Dataframe:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">table</span> <span class="o">=</span> <span class="n">Table</span><span class="o">.</span><span class="n">from_pandas</span><span class="p">(</span><span class="n">dataframe</span><span class="p">)</span>
<span class="n">dataframe</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span>
</pre></div>
</div>
<p>Let’s try it out with the Fermi-LAT catalog.</p>
<p>One little trick is needed when converting to a dataframe: we need to
drop the multi-dimensional columns that the 3FGL catalog uses for a few
columns (flux up/down errors, and lightcurves):</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [33]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">scalar_colnames</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">name</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">table</span><span class="o">.</span><span class="n">colnames</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">table</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">data_frame</span> <span class="o">=</span> <span class="n">table</span><span class="p">[</span><span class="n">scalar_colnames</span><span class="p">]</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [34]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="c1"># If you want to have a quick-look at the dataframe:</span>
<span class="c1"># data_frame</span>
<span class="c1"># data_frame.info()</span>
<span class="c1"># data_frame.describe()</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [35]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="c1"># Just do demonstrate one of the useful DataFrame methods,</span>
<span class="c1"># this is how you can count the number of sources in each class:</span>
<span class="n">data_frame</span><span class="p">[</span><span class="s1">&#39;CLASS1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>Out[35]:
</pre></div>
</div>
<div class="output_area highlight-none"><div class="highlight"><pre>
<span></span>1010
bll       642
bcu       568
fsrq      446
PSR       143
spp        49
FSRQ       38
psr        24
BLL        18
glc        15
rdg        12
SNR        12
snr        11
PWN        10
BCU         5
sbg         4
agn         3
nlsy1       3
ssrq        3
HMB         3
RDG         3
GAL         2
NLSY1       2
pwn         2
gal         1
sey         1
BIN         1
NOV         1
css         1
SFR         1
Name: CLASS1, dtype: int64
</pre></div>
</div>
</div>
<p>If you’d like to learn more about pandas, have a look
<a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/10min.html">here</a> or
<a class="reference external" href="http://nbviewer.jupyter.org/github/jakevdp/PythonDataScienceHandbook/blob/master/notebooks/03.00-Introduction-to-Pandas.ipynb">here</a>.</p>
</div>
</div>
<div class="section" id="Exercises">
<h2>Exercises<a class="headerlink" href="#Exercises" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>When searched for the hardest and softest sources in 3FGL we did not
look at the type of spectrum (PL, ECPL etc), find the hardest and
softest PL sources instead.</li>
<li>Replot the full sky chart of sources in ra-dec instead of galactic
coordinates</li>
<li>Find the 3FGL sources visible from Paris now</li>
</ul>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><h3>Page Contents</h3>
<ul>
<li><a class="reference internal" href="#">Astropy introduction for Gammapy users</a><ul>
<li><a class="reference internal" href="#Introduction">Introduction</a></li>
<li><a class="reference internal" href="#Setup">Setup</a></li>
<li><a class="reference internal" href="#Units-and-constants">Units and constants</a><ul>
<li><a class="reference internal" href="#Basic-usage">Basic usage</a></li>
<li><a class="reference internal" href="#Use-Quantities-in-functions">Use Quantities in functions</a></li>
</ul>
</li>
<li><a class="reference internal" href="#Coordinates">Coordinates</a><ul>
<li><a class="reference internal" href="#Coordinate-transformations">Coordinate transformations</a></li>
</ul>
</li>
<li><a class="reference internal" href="#Time">Time</a></li>
<li><a class="reference internal" href="#Table:-Manipulating-the-3FGL-catalog">Table: Manipulating the 3FGL catalog</a><ul>
<li><a class="reference internal" href="#Accessing-the-table">Accessing the table</a></li>
<li><a class="reference internal" href="#General-informations-on-the-Table">General informations on the Table</a></li>
<li><a class="reference internal" href="#Accessing-the-table">Accessing the table</a></li>
<li><a class="reference internal" href="#Quantities-and-SkyCoords-from-a-Table">Quantities and SkyCoords from a Table</a></li>
<li><a class="reference internal" href="#Selections-in-a-Table">Selections in a Table</a></li>
<li><a class="reference internal" href="#Creating-tables">Creating tables</a></li>
<li><a class="reference internal" href="#Writing-tables">Writing tables</a></li>
</ul>
</li>
<li><a class="reference internal" href="#Using-regions">Using regions</a><ul>
<li><a class="reference internal" href="#Tables-and-pandas">Tables and pandas</a></li>
</ul>
</li>
<li><a class="reference internal" href="#Exercises">Exercises</a></li>
</ul>
</li>
</ul>


        </div>
      </div>
      <div class="clearer"></div>
    </div>
<footer class="footer">
  <p class="pull-right">
    <a href="../_sources/notebooks/astropy_introduction.ipynb.txt"
       rel="nofollow">Page Source</a> &nbsp;
    <a href="#">Back to Top</a></p>
  <p>
    &copy; Copyright 2018, The Gammapy developers.<br/>
    Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.6.7. &nbsp;
    Last built 01 Mar 2018. <br/>
  </p>
</footer>
  </body>
</html>