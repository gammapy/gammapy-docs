
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Getting started with Gammapy &#8212; gammapy v0.7</title>
    <link rel="stylesheet" href="../_static/gammapy.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.7',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../_static/sidebar.js"></script>
    <link rel="shortcut icon" href="../_static/astropy_logo.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
<link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,600' rel='stylesheet' type='text/css'/>
<script type="text/javascript" src="../_static/copybutton.js"></script>


  </head>
  <body>
<div class="topbar">
  <a class="brand" title="Documentation Home" href="../index.html"><span id="logotext1">gamma</span><span id="logotext2">py</span><span id="logotext3">:docs</span></a>
  <ul>
    <li><a class="homelink" title="Astropy Homepage" href="http://www.astropy.org"></a></li>
    <li><a title="General Index" href="../genindex.html">Index</a></li>
    <li><a title="Module Index" href="../py-modindex.html">Modules</a></li>
    <li>
      
      
<form action="../search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
      
    </li>
  </ul>
</div>

<div class="related">
    <h3>Navigation</h3>
    <ul>
      <li>
	<a href="../index.html">gammapy v0.7</a>
	 &#187;
      </li>
      
       
    </ul>
</div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput,
div.nbinput div.prompt,
div.nbinput div.input_area,
div.nbinput div[class*=highlight],
div.nbinput div[class*=highlight] pre,
div.nboutput,
div.nbinput div.prompt,
div.nbinput div.output_area,
div.nboutput div[class*=highlight],
div.nboutput div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput,
div.nboutput {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput,
    div.nboutput {
        flex-direction: column;
    }
}

/* input container */
div.nbinput {
    padding-top: 5px;
}

/* last container */
div.nblast {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput div.prompt pre {
    color: #303F9F;
}

/* output prompt */
div.nboutput div.prompt pre {
    color: #D84315;
}

/* all prompts */
div.nbinput div.prompt,
div.nboutput div.prompt {
    min-width: 9ex;
    padding-top: 0.4em;
    padding-right: 0.4em;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput div.prompt,
    div.nboutput div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput div.prompt pre,
div.nboutput div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput div.input_area,
div.nboutput div.output_area {
    padding: 0.4em;
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput div.input_area,
    div.nboutput div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput div.input_area {
    border: 1px solid #cfcfcf;
    border-radius: 2px;
    background: #f7f7f7;
}

/* override MathJax center alignment in output cells */
div.nboutput div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.pngmath center alignment in output cells */
div.nboutput div.math p {
    text-align: left;
}

/* standard error */
div.nboutput div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }
</style>
<script type="text/javascript" src="../_static/linksdl.js"></script><div class="admonition note">
<p class="first"><strong>This is a fixed-text formatted version of a Jupyter notebook.</strong></p>
<p>You can contribute with your own notebooks in this <a class="reference external" href="https://github.com/gammapy/gammapy-extra/tree/master/notebooks">GitHub
repository</a>.</p>
<p class="last"><strong>Source files:</strong>
<a class="reference external" href="../_static/notebooks/first_steps.ipynb">first_steps.ipynb</a> |
<a class="reference external" href="../_static/notebooks/first_steps.py">first_steps.py</a></p>
</div>
<div class="section" id="Getting-started-with-Gammapy">
<h1>Getting started with Gammapy<a class="headerlink" href="#Getting-started-with-Gammapy" title="Permalink to this headline">¶</a></h1>
<div class="section" id="Introduction">
<h2>Introduction<a class="headerlink" href="#Introduction" title="Permalink to this headline">¶</a></h2>
<p>This is a getting started tutorial for
<a class="reference external" href="http://docs.gammapy.org/">Gammapy</a>.</p>
<p>In this tutorial we will use the <a class="reference external" href="http://fermi.gsfc.nasa.gov/ssc/data/access/lat/2FHL/">Second Fermi-LAT Catalog of
High-Energy Sources (2FHL)
catalog</a>,
corresponding event list and images to learn how to work with some of
the central Gammapy data structures.</p>
<p>We will cover the following topics:</p>
<ul class="simple">
<li><strong>Sky images</strong></li>
<li>We will learn how to handle image based data with gammapy using a
Fermi-LAT 2FHL example image. We will work with the following
classes:<ul>
<li><a class="reference external" href="http://docs.gammapy.org/0.7/api/gammapy.image.SkyImage.html">gammapy.image.SkyImage</a></li>
<li><a class="reference external" href="http://astropy.readthedocs.io/en/latest/coordinates/index.html">astropy.coordinates.SkyCoord</a></li>
<li><a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html">numpy.ndarray</a></li>
</ul>
</li>
<li><strong>Event lists</strong></li>
<li>We will learn how to handle event lists with Gammapy. Important for
this are the following classes:<ul>
<li><a class="reference external" href="http://docs.gammapy.org/0.7/api/gammapy.data.EventList.html">gammapy.data.EventList</a></li>
<li><a class="reference external" href="http://docs.astropy.org/en/stable/api/astropy.table.Table.html#astropy.table.Table">astropy.table.Table</a></li>
</ul>
</li>
<li><strong>Source catalogs</strong></li>
<li>We will show how to load source catalogs with Gammapy and explore the
data using the following classes:<ul>
<li><a class="reference external" href="http://docs.gammapy.org/0.7/api/gammapy.catalog.SourceCatalog.html">gammapy.catalog.SourceCatalog</a>,
specifically
<a class="reference external" href="http://docs.gammapy.org/0.7/api/gammapy.catalog.SourceCatalog2FHL.html">gammapy.catalog.SourceCatalog2FHL</a></li>
<li><a class="reference external" href="http://docs.astropy.org/en/stable/api/astropy.table.Table.html#astropy.table.Table">astropy.table.Table</a></li>
</ul>
</li>
<li><strong>Spectral models and flux points</strong></li>
<li>We will pick an example source and show how to plot its spectral
model and flux points. For this we will use the following classes:<ul>
<li><a class="reference external" href="http://docs.gammapy.org/0.7/api/gammapy.spectrum.models.SpectralModel.html">gammapy.spectrum.SpectralModel</a>,
specifically the
<a class="reference external" href="http://docs.gammapy.org/0.7/api/gammapy.spectrum.models.PowerLaw2.html">PowerLaw2</a>
model.</li>
<li><a class="reference external" href="http://docs.gammapy.org/0.7/api/gammapy.spectrum.FluxPoints.html#gammapy.spectrum.FluxPoints">gammapy.spectrum.FluxPoints</a></li>
<li><a class="reference external" href="http://docs.astropy.org/en/stable/api/astropy.table.Table.html#astropy.table.Table">astropy.table.Table</a></li>
</ul>
</li>
</ul>
<p>If you’re not yet familiar with the listed Astropy classes, maybe check
out the <a class="reference internal" href="astropy_introduction.html"><span class="doc">Astropy introduction for Gammapy
users</span></a> first.</p>
</div>
<div class="section" id="Setup">
<h2>Setup<a class="headerlink" href="#Setup" title="Permalink to this headline">¶</a></h2>
<p><strong>Important</strong>: to run this tutorial the environment variable
<code class="docutils literal"><span class="pre">GAMMAPY_EXTRA</span></code> must be defined and point to the directory, where the
gammapy-extra is respository located on your machine. To check whether
your setup is correct you can execute the following cell:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">os</span>

<span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expandvars</span><span class="p">(</span><span class="s1">&#39;$GAMMAPY_EXTRA/datasets&#39;</span><span class="p">)</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;gammapy-extra repository not found!&#39;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Great your setup is correct!&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Great your setup is correct!
</pre></div></div>
</div>
<p>In case you encounter an error, you can un-comment and execute the
following cell to continue. But we recommend to set up your enviroment
correctly as decribed
<a class="reference external" href="http://docs.gammapy.org/0.7/datasets/index.html#gammapy-extra">here</a>
after you are done with this notebook.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="c1">#os.environ[&#39;GAMMAPY_EXTRA&#39;] = os.path.join(os.getcwd(), &#39;..&#39;)</span>
</pre></div>
</div>
</div>
<p>Now we can continue with the usual IPython notebooks and Python imports:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">astropy.units</span> <span class="kn">as</span> <span class="nn">u</span>
<span class="kn">from</span> <span class="nn">astropy.coordinates</span> <span class="kn">import</span> <span class="n">SkyCoord</span>
<span class="kn">from</span> <span class="nn">astropy.visualization</span> <span class="kn">import</span> <span class="n">simple_norm</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Sky-images">
<h2>Sky images<a class="headerlink" href="#Sky-images" title="Permalink to this headline">¶</a></h2>
<p>The central data structure to work with image based data in Gammapy is
the
<a class="reference external" href="http://docs.gammapy.org/0.7/api/gammapy.image.SkyImage.html">SkyImage</a>
class. It combines the raw data with world coordinate (WCS) information,
FITS I/O functionality and convenience methods, that allow easy
handling, processing and plotting of image based data.</p>
<p>In this section we will learn how to:</p>
<ul class="simple">
<li>Read sky images from FITS files</li>
<li>Smooth images</li>
<li>Plot images</li>
<li>Cutout parts from images</li>
<li>Reproject images to different WCS</li>
</ul>
<p>The <code class="docutils literal"><span class="pre">SkyImage</span></code> class is part of the
<a class="reference external" href="http://docs.gammapy.org/0.7/image/index.html">gammapy.image</a>
submodule. So we will start by importing it from there:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">gammapy.image</span> <span class="kn">import</span> <span class="n">SkyImage</span>
</pre></div>
</div>
</div>
<p>As a first example, we will read a FITS file from a prepared Fermi-LAT
2FHL dataset:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">vela_2fhl</span> <span class="o">=</span> <span class="n">SkyImage</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s2">&quot;$GAMMAPY_EXTRA/datasets/fermi_2fhl/fermi_2fhl_vela.fits.gz&quot;</span><span class="p">,</span> <span class="n">hdu</span><span class="o">=</span><span class="s1">&#39;COUNTS&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>As the FITS file <code class="docutils literal"><span class="pre">fermi_2fhl_vela.fits.gz</span></code> contains mutiple image
extensions and a <code class="docutils literal"><span class="pre">SkyImage</span></code> can only represent a single image, we
explicitely specify to read the extension called ‘Counts’. Let’s print
the image to get some basic information about it:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="k">print</span><span class="p">(</span><span class="n">vela_2fhl</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Name: Counts
Data shape: (180, 320)
Data type: &gt;f8
Data unit: ct
Data mean: 2.720e-02
WCS type: [&#39;GLON-CAR&#39;, &#39;GLAT-CAR&#39;]

</pre></div></div>
</div>
<p>The shape of the image is 320x180 pixel, the data unit is counts (‘ct’)
and it is defined using a cartesian projection in galactic coordinates.</p>
<p>Let’s take a closer look a the <code class="docutils literal"><span class="pre">.data</span></code> attribute:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">vela_2fhl</span><span class="o">.</span><span class="n">data</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>Out[8]:
</pre></div>
</div>
<div class="output_area highlight-none"><div class="highlight"><pre>
<span></span>array([[ 0.,  0.,  0., ...,  0.,  0.,  0.],
       [ 0.,  0.,  0., ...,  0.,  0.,  0.],
       [ 0.,  0.,  0., ...,  0.,  0.,  0.],
       ...,
       [ 0.,  0.,  0., ...,  0.,  0.,  0.],
       [ 0.,  0.,  0., ...,  0.,  0.,  0.],
       [ 0.,  0.,  0., ...,  0.,  0.,  0.]])
</pre></div>
</div>
</div>
<p>That looks familiar! It just an <em>ordinary</em> 2 dimensional numpy array,
which means you can apply any known numpy method to it:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="k">print</span><span class="p">(</span><span class="s1">&#39;Total number of counts in the image: {:.0f}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">vela_2fhl</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">sum</span><span class="p">()))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Total number of counts in the image: 1567
</pre></div></div>
</div>
<p>To show the image on the screen we can use the
<a class="reference external" href="http://docs.gammapy.org/0.7/api/gammapy.image.SkyImage.html#gammapy.image.SkyImage.show">SkyImage.show()</a>
method. It basically calls
<a class="reference external" href="http://matplotlib.org/api/pyplot_api.html#matplotlib.pyplot.imshow">plt.imshow</a>,
passing the <code class="docutils literal"><span class="pre">vela_2fhl.data</span></code> attribute but in addition handles axis
with world coordinates using
<a class="reference external" href="https://wcsaxes.readthedocs.io/en/latest/">wcsaxes</a> and defines some
defaults for nicer plots (e.g. the colormap ‘afmhot’):</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">vela_2fhl</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_first_steps_20_0.png" src="../_images/notebooks_first_steps_20_0.png" />
</div>
</div>
<p>To make the structures in the image more visible we will smooth the data
using a Gausian kernel with a radius of 0.5 deg. Again
<code class="docutils literal"><span class="pre">SkyImage.smooth()</span></code> is a wrapper around existing functionality from
the scientific Python libraries. In this case it is Scipy’s
<a class="reference external" href="https://docs.scipy.org/doc/scipy-0.16.1/reference/generated/scipy.ndimage.filters.gaussian_filter.html">gaussian_filter</a>
method. For convenience the kernel shape can be specified with as string
and the smoothing radius with a quantity. It returns again a
<code class="docutils literal"><span class="pre">SkyImage</span></code> object, that we can plot directly the same way we did
above:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="c1"># smooth counts image with gaussian kernel of 0.5 deg</span>
<span class="n">vela_2fhl_smoothed</span> <span class="o">=</span> <span class="n">vela_2fhl</span><span class="o">.</span><span class="n">smooth</span><span class="p">(</span><span class="n">kernel</span><span class="o">=</span><span class="s1">&#39;gauss&#39;</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">)</span>
<span class="n">vela_2fhl_smoothed</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_first_steps_22_0.png" src="../_images/notebooks_first_steps_22_0.png" />
</div>
</div>
<p>The smoothed plot already looks much nicer, but still the image is
rather large. As we are mostly interested in the inner part of the
image, we will cut out a quadratic region of the size 9 deg x 9 deg
around Vela. Therefore we use
<a class="reference external" href="http://docs.gammapy.org/0.7/api/gammapy.image.SkyImage.html#gammapy.image.SkyImage.cutout">SkyImage.cutout()</a>,
which wraps Astropy’s
<a class="reference external" href="http://docs.astropy.org/en/stable/api/astropy.nddata.Cutout2D.html">Cutout2D</a>.
Again it returns a <code class="docutils literal"><span class="pre">SkyImage</span></code> object:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="c1"># define center and size of the cutout region</span>
<span class="n">center</span> <span class="o">=</span> <span class="n">SkyCoord</span><span class="p">(</span><span class="mf">265.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="s1">&#39;deg&#39;</span><span class="p">,</span> <span class="n">frame</span><span class="o">=</span><span class="s1">&#39;galactic&#39;</span><span class="p">)</span>
<span class="n">size</span> <span class="o">=</span> <span class="mf">9.0</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">deg</span>

<span class="n">vela_2fhl_cutout</span> <span class="o">=</span> <span class="n">vela_2fhl_smoothed</span><span class="o">.</span><span class="n">cutout</span><span class="p">(</span><span class="n">center</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>
<span class="n">vela_2fhl_cutout</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_first_steps_24_0.png" src="../_images/notebooks_first_steps_24_0.png" />
</div>
</div>
<p>To make this exercise a bit more scientifically useful, we will load a
second image containing WMAP data from the same region:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">vela_wmap</span> <span class="o">=</span> <span class="n">SkyImage</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s2">&quot;$GAMMAPY_EXTRA/datasets/images/Vela_region_WMAP_K.fits&quot;</span><span class="p">)</span>

<span class="c1"># define a norm to stretch the data, so it is better visible</span>
<span class="n">norm</span> <span class="o">=</span> <span class="n">simple_norm</span><span class="p">(</span><span class="n">vela_wmap</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">stretch</span><span class="o">=</span><span class="s1">&#39;sqrt&#39;</span><span class="p">,</span> <span class="n">max_percent</span><span class="o">=</span><span class="mf">99.9</span><span class="p">)</span>
<span class="n">vela_wmap</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_first_steps_26_0.png" src="../_images/notebooks_first_steps_26_0.png" />
</div>
</div>
<p>In order to make the structures in the data better visible we used the
<a class="reference external" href="http://docs.astropy.org/en/stable/api/astropy.visualization.mpl_normalize.simple_norm.html#astropy.visualization.mpl_normalize.simple_norm">simple_norm()</a>
method, which allows to stretch the data for plotting. This is very
similar to the methods that e.g. <code class="docutils literal"><span class="pre">ds9</span></code> provides. In addition we used a
different colormap called ‘viridis’. An overview of different colomaps
can be found
<a class="reference external" href="http://matplotlib.org/examples/color/colormaps_reference.html">here</a>.</p>
<p>Now let’s check the details of the WMAP image:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="k">print</span><span class="p">(</span><span class="n">vela_wmap</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Name: None
Data shape: (300, 300)
Data type: &gt;f4
Data unit: mK
Data mean: 1.827e+00
WCS type: [&#39;RA---TAN&#39;, &#39;DEC--TAN&#39;]

</pre></div></div>
</div>
<p>As you can see it is defined using a tangential projection and ICRS
coordinates, which is different from the projection used for the
<code class="docutils literal"><span class="pre">vela_2fhl</span></code> image. To compare both images we have to reproject one
image to the WCS of the other. This can be achieved with the
<a class="reference external" href="http://docs.gammapy.org/0.7/api/gammapy.image.SkyImage.html#gammapy.image.SkyImage.reproject">SkyImage.reproject()</a>
method:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="c1"># reproject WMAP image</span>
<span class="n">vela_wmap_reprojected</span> <span class="o">=</span> <span class="n">vela_wmap</span><span class="o">.</span><span class="n">reproject</span><span class="p">(</span><span class="n">vela_2fhl</span><span class="p">)</span>

<span class="c1"># cutout part we&#39;re interested in</span>
<span class="n">vela_wmap_reprojected_cutout</span> <span class="o">=</span> <span class="n">vela_wmap_reprojected</span><span class="o">.</span><span class="n">cutout</span><span class="p">(</span><span class="n">center</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>
<span class="n">vela_wmap_reprojected_cutout</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_first_steps_30_0.png" src="../_images/notebooks_first_steps_30_0.png" />
</div>
</div>
<p>Finally we will combine both images in single plot, by plotting WMAP
contours on top of the smoothed Fermi-LAT 2FHL image:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">vela_2fhl_cutout</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">vela_wmap_reprojected_cutout</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Blues&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>Out[16]:
</pre></div>
</div>
<div class="output_area highlight-none"><div class="highlight"><pre>
<span></span>&lt;matplotlib.contour.QuadContourSet at 0x11639b278&gt;
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_first_steps_32_1.png" src="../_images/notebooks_first_steps_32_1.png" />
</div>
</div>
<div class="section" id="Exercises">
<h3>Exercises<a class="headerlink" href="#Exercises" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Add a marker and circle at the Vela pulsar position (you can find
examples in the WCSAxes
<a class="reference external" href="https://wcsaxes.readthedocs.io/en/latest/overlays.html">documentation</a>).</li>
<li>Find the maximum brightness location in the WMAP image. The methods
<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.argmax.html">np.argmax()</a>
and
<a class="reference external" href="http://docs.gammapy.org/0.7/api/gammapy.image.SkyImage.html#gammapy.image.SkyImage.wcs_pixel_to_skycoord">SkyImage.wcs_pixel_to_skycoord()</a>
might be helpful. Try to identify the source.</li>
</ul>
</div>
</div>
<div class="section" id="Event-lists">
<h2>Event lists<a class="headerlink" href="#Event-lists" title="Permalink to this headline">¶</a></h2>
<p>Almost any high-level gamma-ray data analysis starts with the raw
measured counts data, which is stored in event lists. In Gammapy event
lists are represented by the
<a class="reference external" href="http://docs.gammapy.org/0.7/api/gammapy.data.EventList.html">gammapy.data.EventList</a>
class.</p>
<p>In this section we will learn how to:</p>
<ul class="simple">
<li>Read event lists from FITS files</li>
<li>Access and work with the <code class="docutils literal"><span class="pre">EventList</span></code> attributes such as <code class="docutils literal"><span class="pre">.table</span></code>
and <code class="docutils literal"><span class="pre">.energy</span></code></li>
<li>Filter events lists using convenience methods</li>
</ul>
<p>Let’s start with the import from the
<a class="reference external" href="http://docs.gammapy.org/0.7/data/index.html">gammapy.data</a>
submodule:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">gammapy.data</span> <span class="kn">import</span> <span class="n">EventList</span>
</pre></div>
</div>
</div>
<p>Very similar to the <code class="docutils literal"><span class="pre">SkyImage</span></code> class an event list can be created, by
passing a filename to the <code class="docutils literal"><span class="pre">.read()</span></code> method:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">events_2fhl</span> <span class="o">=</span> <span class="n">EventList</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;$GAMMAPY_EXTRA/datasets/fermi_2fhl/2fhl_events.fits.gz&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>This time the actual data is stored as an
<a class="reference external" href="http://docs.astropy.org/en/stable/api/astropy.table.Table.html#astropy.table.Table">astropy.table.Table</a>
object. It can be accessed with <code class="docutils literal"><span class="pre">.table</span></code> attribute:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">events_2fhl</span><span class="o">.</span><span class="n">table</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>Out[19]:
</pre></div>
</div>
<div class="output_area docutils container">
&lt;Table length=60978&gt;
<table id="table4667969608" class="table-striped table-bordered table-condensed">
<thead><tr><th>ENERGY</th><th>RA</th><th>DEC</th><th>L</th><th>B</th><th>THETA</th><th>PHI</th><th>ZENITH_ANGLE</th><th>EARTH_AZIMUTH_ANGLE</th><th>TIME</th><th>EVENT_ID</th><th>RUN_ID</th><th>RECON_VERSION</th><th>CALIB_VERSION [3]</th><th>EVENT_CLASS [32]</th><th>EVENT_TYPE [32]</th><th>CONVERSION_TYPE</th><th>LIVETIME</th><th>DIFRSP0</th><th>DIFRSP1</th><th>DIFRSP2</th><th>DIFRSP3</th><th>DIFRSP4</th></tr></thead>
<thead><tr><th>MeV</th><th>deg</th><th>deg</th><th>deg</th><th>deg</th><th>deg</th><th>deg</th><th>deg</th><th>deg</th><th>s</th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th>s</th><th></th><th></th><th></th><th></th><th></th></tr></thead>
<thead><tr><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float64</th><th>int32</th><th>int32</th><th>int16</th><th>int16</th><th>bool</th><th>bool</th><th>int16</th><th>float64</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th></tr></thead>
<tr><td>145927.0</td><td>291.662</td><td>42.2341</td><td>74.5437</td><td>11.8678</td><td>38.0455</td><td>83.5358</td><td>55.6387</td><td>314.034</td><td>239561457.866</td><td>4851437</td><td>239559565</td><td>0</td><td>0 .. 0</td><td>False .. True</td><td>False .. True</td><td>0</td><td>275.698088974</td><td>2.69657e-11</td><td>3238.25</td><td>0.0</td><td>0.0</td><td>0.0</td></tr>
<tr><td>221273.0</td><td>46.9858</td><td>-40.6389</td><td>247.489</td><td>-58.8739</td><td>34.1051</td><td>224.209</td><td>68.2524</td><td>198.319</td><td>239562739.085</td><td>7521432</td><td>239559565</td><td>0</td><td>0 .. 0</td><td>False .. True</td><td>False .. True</td><td>0</td><td>64.7974931598</td><td>1.53573e-12</td><td>2774.2</td><td>0.0</td><td>0.0</td><td>0.0</td></tr>
<tr><td>57709.2</td><td>121.841</td><td>49.2288</td><td>169.868</td><td>32.3017</td><td>71.5636</td><td>34.2925</td><td>36.7173</td><td>25.5439</td><td>239563180.302</td><td>8690693</td><td>239559565</td><td>0</td><td>0 .. 0</td><td>False .. True</td><td>False .. True</td><td>0</td><td>30.57218647</td><td>8.11096e-12</td><td>253.221</td><td>0.0</td><td>0.0</td><td>0.0</td></tr>
<tr><td>221224.0</td><td>83.5626</td><td>-4.21744</td><td>207.783</td><td>-19.0771</td><td>20.5089</td><td>92.1605</td><td>32.3033</td><td>239.141</td><td>239563382.213</td><td>9208424</td><td>239559565</td><td>0</td><td>0 .. 0</td><td>False .. True</td><td>False .. True</td><td>0</td><td>27.4125095904</td><td>1.66075e-11</td><td>2980.12</td><td>0.0</td><td>0.0</td><td>0.0</td></tr>
<tr><td>698997.0</td><td>320.895</td><td>-1.32789</td><td>51.2218</td><td>-33.9718</td><td>35.3621</td><td>158.741</td><td>12.0867</td><td>72.2029</td><td>239566572.951</td><td>2480483</td><td>239565645</td><td>0</td><td>0 .. 0</td><td>False .. True</td><td>False .. True</td><td>0</td><td>106.475481123</td><td>2.26543e-13</td><td>2706.14</td><td>0.0</td><td>0.0</td><td>0.0</td></tr>
<tr><td>119159.0</td><td>318.811</td><td>12.3028</td><td>62.6361</td><td>-24.416</td><td>26.5896</td><td>213.894</td><td>17.7156</td><td>23.9409</td><td>239572348.06</td><td>1725276</td><td>239571670</td><td>0</td><td>0 .. 0</td><td>False .. True</td><td>False .. True</td><td>0</td><td>185.346427292</td><td>2.75677e-11</td><td>3439.29</td><td>0.0</td><td>0.0</td><td>0.0</td></tr>
<tr><td>56175.6</td><td>279.251</td><td>47.8835</td><td>76.6915</td><td>22.0739</td><td>29.1034</td><td>61.0048</td><td>62.1731</td><td>321.104</td><td>239572763.431</td><td>76017</td><td>239572736</td><td>0</td><td>0 .. 0</td><td>False .. True</td><td>False .. True</td><td>0</td><td>24.4507339597</td><td>2.08265e-10</td><td>4071.25</td><td>0.0</td><td>0.0</td><td>0.0</td></tr>
<tr><td>1.41812e+06</td><td>100.311</td><td>-47.4481</td><td>256.468</td><td>-21.2641</td><td>61.2256</td><td>294.18</td><td>90.4753</td><td>144.149</td><td>239573788.813</td><td>1781569</td><td>239572736</td><td>0</td><td>0 .. 0</td><td>False .. True</td><td>False .. True</td><td>0</td><td>68.271614641</td><td>3.20022e-14</td><td>1086.23</td><td>0.0</td><td>0.0</td><td>0.0</td></tr>
<tr><td>62164.9</td><td>331.492</td><td>-41.2264</td><td>359.42</td><td>-53.4049</td><td>28.1408</td><td>229.927</td><td>52.0142</td><td>189.054</td><td>239578601.168</td><td>2000700</td><td>239577663</td><td>0</td><td>0 .. 0</td><td>False .. True</td><td>False .. True</td><td>0</td><td>90.332262665</td><td>1.21479e-10</td><td>3566.07</td><td>0.0</td><td>0.0</td><td>0.0</td></tr>
<tr><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td></tr>
<tr><td>51296.8</td><td>79.0311</td><td>78.9327</td><td>133.868</td><td>22.2399</td><td>51.1726</td><td>267.814</td><td>99.7602</td><td>357.79</td><td>444418973.822</td><td>1284853</td><td>444418590</td><td>0</td><td>0 .. 0</td><td>False .. True</td><td>False .. True</td><td>0</td><td>181.6889835</td><td>2.14127e-10</td><td>2586.88</td><td>0.0</td><td>0.0</td><td>0.0</td></tr>
<tr><td>60315.7</td><td>243.681</td><td>-50.5669</td><td>332.43</td><td>0.28268</td><td>24.8501</td><td>255.683</td><td>74.8804</td><td>195.14</td><td>444421777.761</td><td>6582949</td><td>444418590</td><td>0</td><td>0 .. 0</td><td>False .. True</td><td>False .. False</td><td>1</td><td>57.3358902931</td><td>2.35854e-08</td><td>3541.04</td><td>0.0</td><td>0.0</td><td>0.0</td></tr>
<tr><td>90000.1</td><td>282.698</td><td>-33.1987</td><td>2.66219</td><td>-14.3339</td><td>8.49144</td><td>343.559</td><td>47.3965</td><td>191.033</td><td>444422182.738</td><td>7507466</td><td>444418590</td><td>0</td><td>0 .. 0</td><td>False .. True</td><td>False .. True</td><td>0</td><td>187.602469146</td><td>3.62123e-10</td><td>3792.57</td><td>0.0</td><td>0.0</td><td>0.0</td></tr>
<tr><td>61988.7</td><td>247.98</td><td>-48.1091</td><td>336.146</td><td>0.0220339</td><td>33.6499</td><td>144.271</td><td>80.3966</td><td>221.396</td><td>444422758.145</td><td>8699147</td><td>444418590</td><td>0</td><td>0 .. 0</td><td>False .. True</td><td>False .. True</td><td>0</td><td>39.2098327279</td><td>2.26421e-08</td><td>3395.07</td><td>0.0</td><td>0.0</td><td>0.0</td></tr>
<tr><td>54282.9</td><td>159.924</td><td>-58.3628</td><td>286.362</td><td>0.205554</td><td>24.1196</td><td>287.138</td><td>65.0847</td><td>177.524</td><td>444425794.794</td><td>2522237</td><td>444424619</td><td>0</td><td>0 .. 0</td><td>False .. True</td><td>False .. True</td><td>0</td><td>196.209668875</td><td>4.8258e-09</td><td>3672.78</td><td>0.0</td><td>0.0</td><td>0.0</td></tr>
<tr><td>146728.0</td><td>244.848</td><td>-46.5876</td><td>335.754</td><td>2.60326</td><td>45.2539</td><td>5.33644</td><td>91.871</td><td>137.032</td><td>444425911.819</td><td>2705210</td><td>444424619</td><td>0</td><td>0 .. 0</td><td>False .. True</td><td>False .. False</td><td>1</td><td>65.6327857375</td><td>4.4595e-10</td><td>2899.33</td><td>0.0</td><td>0.0</td><td>0.0</td></tr>
<tr><td>135433.0</td><td>83.5278</td><td>27.9053</td><td>179.529</td><td>-2.69106</td><td>17.4911</td><td>52.0858</td><td>53.306</td><td>313.822</td><td>444430968.968</td><td>939188</td><td>444430599</td><td>0</td><td>0 .. 0</td><td>False .. True</td><td>False .. False</td><td>1</td><td>97.6446831226</td><td>1.57989e-10</td><td>3515.6</td><td>0.0</td><td>0.0</td><td>0.0</td></tr>
<tr><td>61592.1</td><td>231.214</td><td>-5.45521</td><td>357.435</td><td>40.6473</td><td>46.6356</td><td>141.047</td><td>62.7584</td><td>256.631</td><td>444433607.906</td><td>5443944</td><td>444430599</td><td>0</td><td>0 .. 0</td><td>False .. True</td><td>False .. False</td><td>1</td><td>28.7290657759</td><td>2.82028e-10</td><td>2793.45</td><td>0.0</td><td>0.0</td><td>0.0</td></tr>
<tr><td>80480.8</td><td>228.244</td><td>-45.044</td><td>327.561</td><td>10.9528</td><td>37.3149</td><td>193.714</td><td>83.3882</td><td>221.57</td><td>444433702.069</td><td>5612443</td><td>444430599</td><td>0</td><td>0 .. 0</td><td>False .. True</td><td>False .. False</td><td>1</td><td>122.891819298</td><td>2.26095e-10</td><td>3176.43</td><td>0.0</td><td>0.0</td><td>0.0</td></tr>
<tr><td>124449.0</td><td>238.008</td><td>-51.0371</td><td>329.429</td><td>2.3006</td><td>32.4522</td><td>199.504</td><td>80.9768</td><td>214.48</td><td>444433764.433</td><td>5723361</td><td>444430599</td><td>0</td><td>0 .. 0</td><td>False .. True</td><td>False .. True</td><td>0</td><td>185.255487204</td><td>8.54908e-10</td><td>3366.3</td><td>0.0</td><td>0.0</td><td>0.0</td></tr>
</table></div>
</div>
<p>Let’s try to find the total number of events contained int the list.
This doesn’t work:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="k">print</span><span class="p">(</span><span class="s1">&#39;Total number of events: {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">events_2fhl</span><span class="o">.</span><span class="n">table</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Total number of events: 60978
</pre></div></div>
</div>
<p>Because Gammapy objects don’t redefine properties, that are accessible
from the underlying Astropy of Numpy data object.</p>
<p>So in this case of course we can directly use the <code class="docutils literal"><span class="pre">.table</span></code> attribute
to find the total number of events:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="k">print</span><span class="p">(</span><span class="s1">&#39;Total number of events: {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">events_2fhl</span><span class="o">.</span><span class="n">table</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Total number of events: 60978
</pre></div></div>
</div>
<p>And we can access any other attribute of the <code class="docutils literal"><span class="pre">Table</span></code> object as well:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">events_2fhl</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">colnames</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>Out[22]:
</pre></div>
</div>
<div class="output_area highlight-none"><div class="highlight"><pre>
<span></span>[&#39;ENERGY&#39;,
 &#39;RA&#39;,
 &#39;DEC&#39;,
 &#39;L&#39;,
 &#39;B&#39;,
 &#39;THETA&#39;,
 &#39;PHI&#39;,
 &#39;ZENITH_ANGLE&#39;,
 &#39;EARTH_AZIMUTH_ANGLE&#39;,
 &#39;TIME&#39;,
 &#39;EVENT_ID&#39;,
 &#39;RUN_ID&#39;,
 &#39;RECON_VERSION&#39;,
 &#39;CALIB_VERSION&#39;,
 &#39;EVENT_CLASS&#39;,
 &#39;EVENT_TYPE&#39;,
 &#39;CONVERSION_TYPE&#39;,
 &#39;LIVETIME&#39;,
 &#39;DIFRSP0&#39;,
 &#39;DIFRSP1&#39;,
 &#39;DIFRSP2&#39;,
 &#39;DIFRSP3&#39;,
 &#39;DIFRSP4&#39;]
</pre></div>
</div>
</div>
<p>For convenience we can access the most important event parameters as
properties on the <code class="docutils literal"><span class="pre">EventList</span></code> objects. The attributes will return
corresponding Astropy objects to represent the data, such as
<a class="reference external" href="http://docs.astropy.org/en/stable/api/astropy.units.Quantity.html#astropy.units.Quantity">astropy.units.Quantity</a>,
<a class="reference external" href="http://docs.astropy.org/en/stable/api/astropy.coordinates.SkyCoord.html">astropy.coordinates.SkyCoord</a>
or
<a class="reference external" href="http://docs.astropy.org/en/stable/api/astropy.time.Time.html#astropy.time.Time">astropy.time.Time</a>
objects:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">events_2fhl</span><span class="o">.</span><span class="n">energy</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;GeV&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>Out[23]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="math">
$[145.92725,~221.27338,~57.709244,~\dots, 61.592117,~80.480789,~124.44917] \; \mathrm{GeV}$</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">events_2fhl</span><span class="o">.</span><span class="n">galactic</span>
<span class="c1">#events_2fhl.radec</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>Out[24]:
</pre></div>
</div>
<div class="output_area highlight-none"><div class="highlight"><pre>
<span></span>&lt;SkyCoord (Galactic): (l, b) in deg
    [(  74.54326949,  11.86794629), ( 247.48874019, -58.87409431),
     ( 169.86765712,  32.30144389), ..., ( 357.43496217,  40.64753602),
     ( 327.56037412,  10.95297324), ( 329.42901812,   2.30075607)]&gt;
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">events_2fhl</span><span class="o">.</span><span class="n">time</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>Out[25]:
</pre></div>
</div>
<div class="output_area highlight-none"><div class="highlight"><pre>
<span></span>&lt;Time object: scale=&#39;tt&#39; format=&#39;mjd&#39; value=[ 54682.7028015   54682.71763043  54682.72273711 ...,  57053.90824179
  57053.90933163  57053.91005343]&gt;
</pre></div>
</div>
</div>
<p>In addition <code class="docutils literal"><span class="pre">EventList</span></code> provides convenience methods to filter the
event lists. One possible use case is to find the highest energy event
within a radius of 0.5 deg around the vela position:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="c1"># select all events within a radius of 0.5 deg around center</span>
<span class="n">events_vela_2fhl</span> <span class="o">=</span> <span class="n">events_2fhl</span><span class="o">.</span><span class="n">select_sky_cone</span><span class="p">(</span><span class="n">center</span><span class="o">=</span><span class="n">center</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">)</span>

<span class="c1"># sort events by energy</span>
<span class="n">events_vela_2fhl</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="s1">&#39;ENERGY&#39;</span><span class="p">)</span>

<span class="c1"># and show highest energy photon</span>
<span class="n">events_vela_2fhl</span><span class="o">.</span><span class="n">energy</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;GeV&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>Out[26]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="math">
$342.76625 \; \mathrm{GeV}$</div></div>
</div>
<div class="section" id="Exercises">
<h3>Exercises<a class="headerlink" href="#Exercises" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Make a counts energy spectrum for the galactic center region, within
a radius of 10 deg.</li>
</ul>
</div>
</div>
<div class="section" id="Source-catalogs">
<h2>Source catalogs<a class="headerlink" href="#Source-catalogs" title="Permalink to this headline">¶</a></h2>
<p>Gammapy provides a convenient interface to access and work with catalog
based data.</p>
<p>In this section we will learn how to:</p>
<ul class="simple">
<li>Load builtins catalogs from
<a class="reference external" href="http://docs.gammapy.org/0.7/catalog/index.html">gammapy.catalog</a></li>
<li>Sort and index the underlying Astropy tables</li>
<li>Access data from individual sources</li>
</ul>
<p>Let’s start with importing the 2FHL catalog object from the
<a class="reference external" href="http://docs.gammapy.org/0.7/catalog/index.html">gammapy.catalog</a>
submodule:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">gammapy.catalog</span> <span class="kn">import</span> <span class="n">SourceCatalog2FHL</span>
</pre></div>
</div>
</div>
<p>First we initialize the Fermi-LAT 2FHL catalog and directly take a look
at the <code class="docutils literal"><span class="pre">.table</span></code> attribute:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">fermi_2fhl</span> <span class="o">=</span> <span class="n">SourceCatalog2FHL</span><span class="p">(</span><span class="s1">&#39;$GAMMAPY_EXTRA/datasets/catalogs/fermi/gll_psch_v08.fit.gz&#39;</span><span class="p">)</span>
<span class="n">fermi_2fhl</span><span class="o">.</span><span class="n">table</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>Out[28]:
</pre></div>
</div>
<div class="output_area docutils container">
&lt;Table length=360&gt;
<table id="table4673084720" class="table-striped table-bordered table-condensed">
<thead><tr><th>Source_Name</th><th>RAJ2000</th><th>DEJ2000</th><th>GLON</th><th>GLAT</th><th>Pos_err_68</th><th>TS</th><th>Spectral_Index</th><th>Unc_Spectral_Index</th><th>Intr_Spectral_Index_D11</th><th>Unc_Intr_Spectral_Index_D11</th><th>Intr_Spectral_Index_G12</th><th>Unc_Intr_Spectral_Index_G12</th><th>Flux50</th><th>Unc_Flux50</th><th>Energy_Flux50</th><th>Unc_Energy_Flux50</th><th>Flux50_171GeV</th><th>Unc_Flux50_171GeV [2]</th><th>Sqrt_TS50_171GeV</th><th>Flux171_585GeV</th><th>Unc_Flux171_585GeV [2]</th><th>Sqrt_TS171_585GeV</th><th>Flux585_2000GeV</th><th>Unc_Flux585_2000GeV [2]</th><th>Sqrt_TS585_2000GeV</th><th>Npred</th><th>HEP_Energy</th><th>HEP_Prob</th><th>ROI</th><th>ASSOC</th><th>ASSOC_PROB_BAY</th><th>ASSOC_PROB_LR</th><th>CLASS</th><th>Redshift</th><th>NuPeak_obs</th><th>3FGL_Name</th><th>1FHL_Name</th><th>TeVCat_Name</th></tr></thead>
<thead><tr><th>str18</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>int16</th><th>str25</th><th>float32</th><th>float32</th><th>str8</th><th>float32</th><th>float32</th><th>str18</th><th>str18</th><th>str18</th></tr></thead>
<tr><td>2FHL J0008.1+4709</td><td>2.0437</td><td>47.1642</td><td>115.339</td><td>-15.0688</td><td>0.061114</td><td>28.64</td><td>6.24</td><td>2.75</td><td>3.96</td><td>3.19</td><td>2.16</td><td>4.21</td><td>1.23e-11</td><td>6.71e-12</td><td>1.21e-12</td><td>6.71e-13</td><td>3.36344e-12</td><td>-1.53668e-12 .. 2.16095e-12</td><td>5.35354</td><td>4.34947e-18</td><td>nan .. 4.75389e-12</td><td>0.0</td><td>8.44871e-18</td><td>nan .. 7.29101e-12</td><td>0.0</td><td>4.0</td><td>68.15</td><td>0.99</td><td>1</td><td>MG4 J000800+4712</td><td>0.99722</td><td>0.834827</td><td>bll</td><td>2.1</td><td>2.51188e+15</td><td>3FGL J0008.0+4713</td><td>1FHL J0007.7+4709</td><td></td></tr>
<tr><td>2FHL J0009.3+5031</td><td>2.3435</td><td>50.5217</td><td>116.124</td><td>-11.7932</td><td>0.0454392</td><td>53.97</td><td>5.08</td><td>1.66</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>1.91e-11</td><td>7.82e-12</td><td>2.03e-12</td><td>8.79e-13</td><td>8.36282e-12</td><td>-2.98962e-12 .. 3.89512e-12</td><td>7.35132</td><td>2.91458e-17</td><td>nan .. 5.10003e-12</td><td>0.0</td><td>3.50875e-16</td><td>nan .. 4.87458e-12</td><td>0.0</td><td>6.4</td><td>72.76</td><td>1.0</td><td>1</td><td>NVSS J000922+503028</td><td>0.999724</td><td>0.734808</td><td>bll</td><td>0.0</td><td>1.41254e+15</td><td>3FGL J0009.3+5030</td><td>1FHL J0009.2+5032</td><td></td></tr>
<tr><td>2FHL J0018.5+2947</td><td>4.6355</td><td>29.7879</td><td>114.463</td><td>-32.5424</td><td>0.0370936</td><td>30.89</td><td>2.58</td><td>0.99</td><td>2.41</td><td>1.04</td><td>2.4</td><td>1.04</td><td>1.06e-11</td><td>6.15e-12</td><td>2.05e-12</td><td>1.72e-12</td><td>9.65438e-12</td><td>-5.55342e-12 .. 5.55342e-12</td><td>5.76579</td><td>1.179e-15</td><td>nan .. 5.37865e-12</td><td>0.0</td><td>1.60465e-16</td><td>nan .. 6.12008e-12</td><td>0.0</td><td>3.0</td><td>127.32</td><td>1.0</td><td>3</td><td>RBS 0042</td><td>0.999868</td><td>0.978522</td><td>bll</td><td>0.1</td><td>5.91561e+16</td><td>3FGL J0018.4+2947</td><td>1FHL J0018.6+2946</td><td></td></tr>
<tr><td>2FHL J0022.0+0006</td><td>5.5001</td><td>0.1059</td><td>107.172</td><td>-61.8618</td><td>0.0511852</td><td>29.96</td><td>1.86</td><td>0.57</td><td>0.95</td><td>0.72</td><td>0.88</td><td>0.71</td><td>1.97e-11</td><td>9.56e-12</td><td>6.86e-12</td><td>5.29e-12</td><td>1.61197e-11</td><td>-7.17255e-12 .. 9.95349e-12</td><td>5.3822</td><td>3.63922e-12</td><td>-4.38636e-12 .. 4.38636e-12</td><td>1.38539</td><td>8.42356e-16</td><td>nan .. 7.3424e-12</td><td>0.0</td><td>4.8</td><td>180.13</td><td>0.86</td><td>2</td><td>5BZGJ0022+0006</td><td>0.99928</td><td>0.900089</td><td>bll-g</td><td>0.306</td><td>4.31519e+16</td><td></td><td></td><td></td></tr>
<tr><td>2FHL J0033.6-1921</td><td>8.4115</td><td>-19.3575</td><td>94.28</td><td>-81.2224</td><td>0.0348384</td><td>148.31</td><td>3.32</td><td>0.69</td><td>2.56</td><td>0.88</td><td>2.33</td><td>0.92</td><td>5.46e-11</td><td>1.5e-11</td><td>7.62e-12</td><td>2.69e-12</td><td>4.00161e-11</td><td>-1.01615e-11 .. 1.22378e-11</td><td>12.1725</td><td>2.13901e-12</td><td>nan .. 8.25812e-12</td><td>0.907958</td><td>2.43955e-17</td><td>nan .. 6.84226e-12</td><td>0.0</td><td>13.8</td><td>170.01</td><td>0.99</td><td>2</td><td>KUV 00311-1938</td><td>0.999759</td><td>0.981424</td><td>bll</td><td>0.61</td><td>8.31764e+15</td><td>3FGL J0033.6-1921</td><td>1FHL J0033.6-1921</td><td>TeV J0033-1921</td></tr>
<tr><td>2FHL J0035.8+5949</td><td>8.9625</td><td>59.8312</td><td>120.972</td><td>-2.98122</td><td>0.0316026</td><td>402.4</td><td>2.23</td><td>0.21</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>1.25e-10</td><td>1.9e-11</td><td>3.11e-11</td><td>7.23e-12</td><td>9.42294e-11</td><td>-1.52566e-11 .. 1.71572e-11</td><td>17.3124</td><td>2.66991e-11</td><td>-7.62818e-12 .. 9.45084e-12</td><td>10.3909</td><td>3.72609e-16</td><td>nan .. 4.67444e-12</td><td>0.0</td><td>46.5</td><td>247.62</td><td>0.96</td><td>4</td><td>1ES 0033+595</td><td>0.999958</td><td>0.992868</td><td>bll</td><td>0.0</td><td>1.31826e+17</td><td>3FGL J0035.9+5949</td><td>1FHL J0035.9+5950</td><td>TeV J0035+5950</td></tr>
<tr><td>2FHL J0040.3+4049</td><td>10.0949</td><td>40.8315</td><td>120.676</td><td>-21.9918</td><td>0.0355148</td><td>26.76</td><td>2.12</td><td>0.81</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>1.05e-11</td><td>6.3e-12</td><td>2.84e-12</td><td>2.67e-12</td><td>7.41577e-12</td><td>-4.0778e-12 .. 6.45182e-12</td><td>4.95442</td><td>3.00308e-12</td><td>-2.31775e-12 .. 4.46644e-12</td><td>1.70835</td><td>4.73166e-16</td><td>nan .. 5.79809e-12</td><td>0.0</td><td>3.2</td><td>258.77</td><td>0.85</td><td>3</td><td>B3 0037+405</td><td>0.998738</td><td>0.9347</td><td>bcu I</td><td>0.0</td><td>1.0</td><td>3FGL J0040.3+4049</td><td>1FHL J0040.3+4049</td><td></td></tr>
<tr><td>2FHL J0043.9+3424</td><td>10.9755</td><td>34.4109</td><td>121.164</td><td>-28.435</td><td>0.0592417</td><td>39.5</td><td>4.57</td><td>1.61</td><td>3.46</td><td>1.85</td><td>2.95</td><td>1.91</td><td>1.83e-11</td><td>8.24e-12</td><td>2.03e-12</td><td>9.93e-13</td><td>9.65762e-12</td><td>-4.31687e-12 .. 4.31687e-12</td><td>6.31152</td><td>8.75861e-17</td><td>nan .. 5.24335e-12</td><td>0.0</td><td>9.43812e-16</td><td>nan .. 5.68787e-12</td><td>0.0</td><td>5.4</td><td>109.97</td><td>0.9</td><td>3</td><td>GB6 J0043+3426</td><td>0.998594</td><td>0.838844</td><td>fsrq</td><td>0.966</td><td>6.45655e+13</td><td>3FGL J0043.8+3425</td><td>1FHL J0043.7+3425</td><td></td></tr>
<tr><td>2FHL J0045.2+2127</td><td>11.3161</td><td>21.4555</td><td>121.017</td><td>-41.3933</td><td>0.0378046</td><td>110.43</td><td>3.07</td><td>0.64</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>4.14e-11</td><td>1.26e-11</td><td>6.29e-12</td><td>2.45e-12</td><td>3.11532e-11</td><td>-8.93008e-12 .. 1.10103e-11</td><td>10.2404</td><td>2.99712e-12</td><td>-3.03054e-12 .. 3.03054e-12</td><td>2.7089</td><td>4.68348e-17</td><td>nan .. 6.42314e-12</td><td>0.0</td><td>11.4</td><td>246.75</td><td>0.99</td><td>5</td><td>GB6 J0045+2127</td><td>0.99961</td><td>0.965127</td><td>bll</td><td>0.0</td><td>1.0023e+16</td><td>3FGL J0045.3+2126</td><td>1FHL J0045.2+2126</td><td></td></tr>
<tr><td>2FHL J0048.0+5449</td><td>12.0023</td><td>54.8281</td><td>122.433</td><td>-8.04033</td><td>0.0572055</td><td>35.15</td><td>1.3</td><td>0.51</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>1.21e-11</td><td>6.12e-12</td><td>7.64e-12</td><td>5.72e-12</td><td>6.43137e-12</td><td>-3.56228e-12 .. 5.62894e-12</td><td>4.6401</td><td>2.94345e-12</td><td>-3.03542e-12 .. 3.03542e-12</td><td>2.27561</td><td>3.59026e-12</td><td>-2.51846e-12 .. 4.90533e-12</td><td>2.86203</td><td>4.1</td><td>605.9</td><td>0.99</td><td>4</td><td>1RXS J004754.5+544758</td><td>nan</td><td>0.906161</td><td>bcu II</td><td>0.0</td><td>7.87046e+15</td><td>3FGL J0047.9+5447</td><td></td><td></td></tr>
<tr><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td></tr>
<tr><td>2FHL J2322.5+3436</td><td>350.628</td><td>34.613</td><td>102.876</td><td>-24.7718</td><td>0.0717998</td><td>28.77</td><td>2.33</td><td>0.8</td><td>2.13</td><td>0.85</td><td>2.11</td><td>0.85</td><td>1.42e-11</td><td>7.46e-12</td><td>3.24e-12</td><td>2.48e-12</td><td>1.37062e-11</td><td>-5.99053e-12 .. 8.27325e-12</td><td>5.51109</td><td>1.50445e-15</td><td>nan .. 5.25568e-12</td><td>0.0</td><td>3.34396e-16</td><td>nan .. 6.35236e-12</td><td>0.0</td><td>4.1</td><td>166.2</td><td>0.99</td><td>133</td><td>TXS 2320+343</td><td>0.996639</td><td>0.877901</td><td>bll-g</td><td>0.098</td><td>1.04713e+15</td><td>3FGL J2322.5+3436</td><td>1FHL J2322.5+3436</td><td></td></tr>
<tr><td>2FHL J2322.7-4916</td><td>350.698</td><td>-49.2706</td><td>334.608</td><td>-62.0492</td><td>0.038949</td><td>36.84</td><td>4.58</td><td>1.69</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>1.75e-11</td><td>8.3e-12</td><td>1.94e-12</td><td>9.96e-13</td><td>9.13009e-12</td><td>-3.73356e-12 .. 5.01738e-12</td><td>6.05223</td><td>6.65757e-17</td><td>nan .. 5.27137e-12</td><td>0.0</td><td>6.34713e-16</td><td>nan .. 5.77243e-12</td><td>0.0</td><td>5.1</td><td>106.33</td><td>0.9</td><td>138</td><td>SUMSS J232254-491629</td><td>0.999434</td><td>0.937726</td><td>bll</td><td>0.0</td><td>4.46683e+15</td><td>3FGL J2322.9-4917</td><td></td><td></td></tr>
<tr><td>2FHL J2323.4+5848</td><td>350.874</td><td>58.808</td><td>111.744</td><td>-2.14031</td><td>0.0348384</td><td>183.62</td><td>2.45</td><td>0.3</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>7.81e-11</td><td>1.53e-11</td><td>1.64e-11</td><td>4.68e-12</td><td>5.93689e-11</td><td>-1.21101e-11 .. 1.38986e-11</td><td>11.6238</td><td>1.03761e-11</td><td>-4.37845e-12 .. 6.14398e-12</td><td>5.81435</td><td>2.90309e-12</td><td>-2.02416e-12 .. 3.98202e-12</td><td>3.50834</td><td>28.8</td><td>662.12</td><td>1.0</td><td>135</td><td>Cas A</td><td>nan</td><td>0.999833</td><td>snr</td><td>nan</td><td>nan</td><td>3FGL J2323.4+5849</td><td>1FHL J2323.3+5849</td><td>TeV J2323+588</td></tr>
<tr><td>2FHL J2323.8+4209</td><td>350.972</td><td>42.1629</td><td>106.059</td><td>-17.8224</td><td>0.0456016</td><td>70.61</td><td>4.21</td><td>1.16</td><td>4.14</td><td>1.15</td><td>4.13</td><td>1.15</td><td>3.05e-11</td><td>1.05e-11</td><td>3.55e-12</td><td>1.35e-12</td><td>1.62017e-11</td><td>-5.24708e-12 .. 6.61912e-12</td><td>8.11938</td><td>2.00018e-12</td><td>-1.41271e-12 .. 2.77927e-12</td><td>2.56849</td><td>2.18906e-18</td><td>nan .. 5.54082e-12</td><td>0.0</td><td>9.3</td><td>230.9</td><td>0.92</td><td>133</td><td>1ES 2321+419</td><td>0.99956</td><td>0.961506</td><td>bll</td><td>0.059</td><td>4.84173e+15</td><td>3FGL J2323.9+4211</td><td>1FHL J2323.8+4210</td><td></td></tr>
<tr><td>2FHL J2324.7-4041</td><td>351.195</td><td>-40.6934</td><td>350.157</td><td>-67.5836</td><td>0.0358658</td><td>80.93</td><td>3.18</td><td>0.83</td><td>2.94</td><td>0.87</td><td>2.9</td><td>0.87</td><td>2.97e-11</td><td>1.08e-11</td><td>4.34e-12</td><td>2.03e-12</td><td>2.13391e-11</td><td>-7.09939e-12 .. 9.10435e-12</td><td>8.85383</td><td>2.71834e-12</td><td>-2.11714e-12 .. 4.11668e-12</td><td>1.65792</td><td>3.54717e-17</td><td>nan .. 6.3514e-12</td><td>0.0</td><td>8.0</td><td>118.48</td><td>1.0</td><td>138</td><td>1ES 2322-409</td><td>0.999467</td><td>0.985516</td><td>bll</td><td>0.173587</td><td>8.31764e+15</td><td>3FGL J2324.7-4040</td><td>1FHL J2324.6-4041</td><td></td></tr>
<tr><td>2FHL J2329.2+3754</td><td>352.308</td><td>37.9157</td><td>105.532</td><td>-22.1627</td><td>0.038539</td><td>39.4</td><td>3.29</td><td>1.19</td><td>2.99</td><td>1.28</td><td>2.92</td><td>1.28</td><td>1.43e-11</td><td>7.17e-12</td><td>2.02e-12</td><td>1.25e-12</td><td>1.11304e-11</td><td>-4.6962e-12 .. 6.5288e-12</td><td>6.31149</td><td>4.40415e-16</td><td>nan .. 5.47737e-12</td><td>0.0</td><td>2.64065e-17</td><td>nan .. 5.92547e-12</td><td>0.0</td><td>4.3</td><td>142.13</td><td>0.98</td><td>133</td><td>NVSS J232914+375414</td><td>0.999792</td><td>0.956363</td><td>bll</td><td>0.264</td><td>8.91251e+15</td><td>3FGL J2329.2+3754</td><td>1FHL J2329.1+3754</td><td></td></tr>
<tr><td>2FHL J2340.8+8014</td><td>355.203</td><td>80.2447</td><td>119.838</td><td>17.7999</td><td>0.0348934</td><td>69.79</td><td>4.2</td><td>1.28</td><td>4.0</td><td>1.36</td><td>3.94</td><td>1.37</td><td>1.95e-11</td><td>7.24e-12</td><td>2.26e-12</td><td>9.72e-13</td><td>1.16398e-11</td><td>-3.81183e-12 .. 4.82791e-12</td><td>8.38745</td><td>1.25703e-16</td><td>nan .. 3.71812e-12</td><td>0.0</td><td>1.13621e-15</td><td>nan .. 4.04723e-12</td><td>0.0</td><td>7.9</td><td>80.85</td><td>0.86</td><td>125</td><td>1RXS J234051.4+801513</td><td>0.999874</td><td>0.979435</td><td>bll</td><td>0.274</td><td>3.42768e+15</td><td>3FGL J2340.7+8016</td><td>1FHL J2341.3+8016</td><td></td></tr>
<tr><td>2FHL J2343.5+3438</td><td>355.898</td><td>34.6484</td><td>107.422</td><td>-26.1717</td><td>0.0715056</td><td>27.43</td><td>4.99</td><td>2.36</td><td>4.88</td><td>2.43</td><td>4.79</td><td>2.44</td><td>1.33e-11</td><td>7.32e-12</td><td>1.41e-12</td><td>8.56e-13</td><td>5.94254e-12</td><td>-2.73222e-12 .. 3.85247e-12</td><td>5.2347</td><td>5.08627e-17</td><td>nan .. 8.36317e-12</td><td>0.0</td><td>3.14709e-16</td><td>nan .. 5.6852e-12</td><td>0.0</td><td>3.9</td><td>72.66</td><td>1.0</td><td>133</td><td>1RXS J234332.5+343957</td><td>0.999148</td><td>0.955429</td><td>bll</td><td>0.366</td><td>1.0292e+15</td><td>3FGL J2343.7+3437</td><td></td><td></td></tr>
<tr><td>2FHL J2347.1+5142</td><td>356.75</td><td>51.7081</td><td>112.88</td><td>-9.90159</td><td>0.0335464</td><td>209.84</td><td>1.85</td><td>0.25</td><td>1.74</td><td>0.26</td><td>1.73</td><td>0.26</td><td>7.48e-11</td><td>1.54e-11</td><td>2.62e-11</td><td>8.56e-12</td><td>4.78884e-11</td><td>-1.15596e-11 .. 1.339e-11</td><td>11.282</td><td>2.42894e-11</td><td>-7.68104e-12 .. 9.87777e-12</td><td>8.8577</td><td>3.51388e-12</td><td>-3.55282e-12 .. 3.55282e-12</td><td>2.66572</td><td>25.2</td><td>652.31</td><td>0.99</td><td>1</td><td>1ES 2344+514</td><td>0.99986</td><td>0.988082</td><td>bll</td><td>0.044</td><td>7.07946e+15</td><td>3FGL J2347.0+5142</td><td>1FHL J2347.0+5142</td><td>TeV J2346+5142</td></tr>
<tr><td>2FHL J2352.0-7558</td><td>358.019</td><td>-75.9718</td><td>307.623</td><td>-40.6111</td><td>0.0733733</td><td>28.49</td><td>3.37</td><td>1.24</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>1.18e-11</td><td>6.14e-12</td><td>1.63e-12</td><td>1.03e-12</td><td>9.00308e-12</td><td>-3.9133e-12 .. 5.47729e-12</td><td>5.38935</td><td>3.90782e-16</td><td>nan .. 4.95279e-12</td><td>0.0</td><td>3.23398e-17</td><td>nan .. 5.16722e-12</td><td>0.0</td><td>3.9</td><td>134.72</td><td>1.0</td><td>137</td><td></td><td>nan</td><td>nan</td><td>unk</td><td>nan</td><td>nan</td><td>3FGL J2351.9-7601</td><td></td><td></td></tr>
</table></div>
</div>
<p>This looks very familiar again. The data is just stored as an
<a class="reference external" href="http://docs.astropy.org/en/stable/api/astropy.table.Table.html#astropy.table.Table">astropy.table.Table</a>
object. We have all the methods and attributes of the <code class="docutils literal"><span class="pre">Table</span></code> object
available. E.g. we can sort the underlying table by <code class="docutils literal"><span class="pre">TS</span></code> to find the
top 5 most significant sources:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [29]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="c1"># sort table by TS</span>
<span class="n">fermi_2fhl</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="s1">&#39;TS&#39;</span><span class="p">)</span>

<span class="c1"># invert the order to find the highest values and take the top 5</span>
<span class="n">top_five_TS_2fhl</span> <span class="o">=</span> <span class="n">fermi_2fhl</span><span class="o">.</span><span class="n">table</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">][:</span><span class="mi">5</span><span class="p">]</span>

<span class="c1"># print the top five significant sources with association and source class</span>
<span class="n">top_five_TS_2fhl</span><span class="p">[[</span><span class="s1">&#39;Source_Name&#39;</span><span class="p">,</span> <span class="s1">&#39;ASSOC&#39;</span><span class="p">,</span> <span class="s1">&#39;CLASS&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>Out[29]:
</pre></div>
</div>
<div class="output_area docutils container">
&lt;Table length=5&gt;
<table id="table4667789440" class="table-striped table-bordered table-condensed">
<thead><tr><th>Source_Name</th><th>ASSOC</th><th>CLASS</th></tr></thead>
<thead><tr><th>str18</th><th>str25</th><th>str8</th></tr></thead>
<tr><td>2FHL J1104.4+3812</td><td>Mkn 421</td><td>bll</td></tr>
<tr><td>2FHL J0534.5+2201</td><td>Crab</td><td>pwn</td></tr>
<tr><td>2FHL J1653.9+3945</td><td>Mkn 501</td><td>bll</td></tr>
<tr><td>2FHL J1555.7+1111</td><td>PG 1553+113</td><td>bll</td></tr>
<tr><td>2FHL J2158.8-3013</td><td>PKS 2155-304</td><td>bll</td></tr>
</table></div>
</div>
<p>If you are interested in the data of an individual source you can access
the information from catalog using the name of the source or any alias
source name that is defined in the catalog:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [30]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">mkn_421_2fhl</span> <span class="o">=</span> <span class="n">fermi_2fhl</span><span class="p">[</span><span class="s1">&#39;2FHL J1104.4+3812&#39;</span><span class="p">]</span>

<span class="c1"># or use any alias source name that is defined in the catalog</span>
<span class="n">mkn_421_2fhl</span> <span class="o">=</span> <span class="n">fermi_2fhl</span><span class="p">[</span><span class="s1">&#39;Mkn 421&#39;</span><span class="p">]</span>
<span class="k">print</span><span class="p">(</span><span class="n">mkn_421_2fhl</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;TS&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
5600.98
</pre></div></div>
</div>
<div class="section" id="Exercises">
<h3>Exercises<a class="headerlink" href="#Exercises" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Try to load the Fermi-LAT 3FHL catalog and check the total number of
sources it contains.</li>
<li>Select all the sources from the 2FHL catalog which are contained in
the Vela region. Add markers for all these sources and try to add
labels with the source names. The methods
<a class="reference external" href="http://docs.gammapy.org/0.7/api/gammapy.image.SkyImage.html#gammapy.image.SkyImage.contains">SkyImage.contains()</a>
and
<a class="reference external" href="http://matplotlib.org/api/_as_gen/matplotlib.axes.Axes.text.html#matplotlib.axes.Axes.text">ax.text()</a>
might be helpful.</li>
<li>Try to find the source class of the object at position ra=68.6803,
dec=9.3331</li>
</ul>
</div>
</div>
<div class="section" id="Spectral-models-and-flux-points">
<h2>Spectral models and flux points<a class="headerlink" href="#Spectral-models-and-flux-points" title="Permalink to this headline">¶</a></h2>
<p>In the previous section we learned how access basic data from individual
sources in the catalog. Now we will go one step further and explore the
full spectral information of sources. We will learn how to:</p>
<ul class="simple">
<li>Plot spectral models</li>
<li>Compute integral and energy fluxes</li>
<li>Read and plot flux points</li>
</ul>
<p>As a first example we will start with the Crab Nebula:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [31]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">crab_2fhl</span> <span class="o">=</span> <span class="n">fermi_2fhl</span><span class="p">[</span><span class="s1">&#39;Crab&#39;</span><span class="p">]</span>
<span class="k">print</span><span class="p">(</span><span class="n">crab_2fhl</span><span class="o">.</span><span class="n">spectral_model</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
PowerLaw2
ParameterList
Parameter(name=&#39;amplitude&#39;, value=1.3099999973675835e-09, unit=Unit(&#34;1 / (cm2 s)&#34;), min=0, max=None, frozen=False)
Parameter(name=&#39;index&#39;, value=2.130000114440918, unit=Unit(dimensionless), min=0, max=None, frozen=False)
Parameter(name=&#39;emin&#39;, value=0.05, unit=Unit(&#34;TeV&#34;), min=None, max=None, frozen=False)
Parameter(name=&#39;emax&#39;, value=2.0, unit=Unit(&#34;TeV&#34;), min=None, max=None, frozen=False)

Covariance: [[  4.66488967e-21   0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  0.00000000e+00   4.90000004e-03   0.00000000e+00   0.00000000e+00]
 [  0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00]]
</pre></div></div>
</div>
<p>The <code class="docutils literal"><span class="pre">crab_2fhl.spectral_model</span></code> is an instance of the
<a class="reference external" href="http://docs.gammapy.org/0.7/api/gammapy.spectrum.models.PowerLaw2.html#gammapy.spectrum.models.PowerLaw2">gammapy.spectrum.models.PowerLaw2</a>
model, with the parameter values and errors taken from the 2FHL catalog.</p>
<p>Let’s plot the spectral model in the energy range between 50 GeV and
2000 GeV:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [32]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">ax_crab_2fhl</span> <span class="o">=</span> <span class="n">crab_2fhl</span><span class="o">.</span><span class="n">spectral_model</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">energy_range</span><span class="o">=</span><span class="p">[</span><span class="mi">50</span><span class="p">,</span> <span class="mi">2000</span><span class="p">]</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">GeV</span><span class="p">,</span> <span class="n">energy_power</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_first_steps_65_0.png" src="../_images/notebooks_first_steps_65_0.png" />
</div>
</div>
<p>We assign the return axes object to variable called <code class="docutils literal"><span class="pre">ax_crab_2fhl</span></code>,
because we will re-use it later to plot the flux points on top.</p>
<p>To compute the differential flux at 100 GeV we can simply call the model
like normal Python function and convert to the desired units:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [33]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">crab_2fhl</span><span class="o">.</span><span class="n">spectral_model</span><span class="p">(</span><span class="mi">100</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">GeV</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;cm-2 s-1 GeV-1&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>Out[33]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="math">
$6.8700477 \times 10^{-12} \; \mathrm{\frac{1}{GeV\,s\,cm^{2}}}$</div></div>
</div>
<p>Next we can compute the integral flux of the Crab between 50 GeV and
2000 GeV:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [34]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">crab_2fhl</span><span class="o">.</span><span class="n">spectral_model</span><span class="o">.</span><span class="n">integral</span><span class="p">(</span>
    <span class="n">emin</span><span class="o">=</span><span class="mi">50</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">GeV</span><span class="p">,</span> <span class="n">emax</span><span class="o">=</span><span class="mi">2000</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">GeV</span><span class="p">,</span>
<span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;cm-2 s-1&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>Out[34]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="math">
$1.31 \times 10^{-9} \; \mathrm{\frac{1}{s\,cm^{2}}}$</div></div>
</div>
<p>We can easily convince ourself, that it corresponds to the value given
in the Fermi-LAT 2FHL catalog:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [35]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">crab_2fhl</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Flux50&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>Out[35]:
</pre></div>
</div>
<div class="output_area highlight-none"><div class="highlight"><pre>
<span></span>1.31e-09
</pre></div>
</div>
</div>
<p>In addition we can compute the energy flux between 50 GeV and 2000 GeV:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [36]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">crab_2fhl</span><span class="o">.</span><span class="n">spectral_model</span><span class="o">.</span><span class="n">energy_flux</span><span class="p">(</span>
    <span class="n">emin</span><span class="o">=</span><span class="mi">50</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">GeV</span><span class="p">,</span> <span class="n">emax</span><span class="o">=</span><span class="mi">2000</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">GeV</span><span class="p">,</span>
<span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;erg cm-2 s-1&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>Out[36]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="math">
$3.5295398 \times 10^{-10} \; \mathrm{\frac{erg}{s\,cm^{2}}}$</div></div>
</div>
<p>Next we will access the flux points data of the Crab:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [37]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="k">print</span><span class="p">(</span><span class="n">crab_2fhl</span><span class="o">.</span><span class="n">flux_points</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Flux points of type &#39;dnde&#39;
</pre></div></div>
</div>
<p>If you want to learn more about the different flux point formats you can
read the specification
<a class="reference external" href="http://gamma-astro-data-formats.readthedocs.io/en/latest/results/flux_points/index.html#flux-points">here</a>.</p>
<p>No we can check again the underlying astropy data structure by accessing
the <code class="docutils literal"><span class="pre">.table</span></code> attribute:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [38]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">crab_2fhl</span><span class="o">.</span><span class="n">flux_points</span><span class="o">.</span><span class="n">table</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>Out[38]:
</pre></div>
</div>
<div class="output_area docutils container">
&lt;Table length=3&gt;
<table id="table4667474328" class="table-striped table-bordered table-condensed">
<thead><tr><th>e_min</th><th>e_max</th><th>flux</th><th>flux_errn</th><th>flux_errp</th><th>is_ul</th><th>flux_ul</th><th>e_ref</th><th>dnde</th><th>dnde_errn</th><th>dnde_errp</th><th>dnde_ul</th></tr></thead>
<thead><tr><th>GeV</th><th>GeV</th><th>1 / (cm2 s)</th><th>1 / (cm2 s)</th><th>1 / (cm2 s)</th><th></th><th>1 / (cm2 s)</th><th>TeV</th><th>GeV(9/8) / (cm2 s TeV(17/8))</th><th>GeV(9/8) / (cm2 s TeV(17/8))</th><th>GeV(9/8) / (cm2 s TeV(17/8))</th><th>GeV(9/8) / (cm2 s TeV(17/8))</th></tr></thead>
<thead><tr><th>float64</th><th>float64</th><th>float32</th><th>float32</th><th>float32</th><th>bool</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th></tr></thead>
<tr><td>50.0</td><td>171.0</td><td>9.94072e-10</td><td>5.7595e-11</td><td>5.94726e-11</td><td>False</td><td>nan</td><td>0.0917326969964</td><td>2.01666069866e-05</td><td>1.16842211486e-06</td><td>1.20651355523e-06</td><td>nan</td></tr>
<tr><td>171.0</td><td>585.0</td><td>2.43875e-10</td><td>2.82542e-11</td><td>3.04354e-11</td><td>False</td><td>nan</td><td>0.313772883446</td><td>1.44599896753e-06</td><td>1.6752658163e-07</td><td>1.80459220037e-07</td><td>nan</td></tr>
<tr><td>585.0</td><td>2000.0</td><td>5.27536e-11</td><td>1.33401e-11</td><td>1.60478e-11</td><td>False</td><td>nan</td><td>1.07308951286</td><td>9.15157602841e-08</td><td>2.31421507433e-08</td><td>2.78392984262e-08</td><td>nan</td></tr>
</table></div>
</div>
<p>Finally let’s combine spectral model and flux points in a single plot
and scale with <code class="docutils literal"><span class="pre">energy_power=2</span></code> to obtain the spectral energy
distribution:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [39]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">crab_2fhl</span><span class="o">.</span><span class="n">spectral_model</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">energy_range</span><span class="o">=</span><span class="p">[</span><span class="mi">50</span><span class="p">,</span> <span class="mi">2000</span><span class="p">]</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">GeV</span><span class="p">,</span> <span class="n">energy_power</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">crab_2fhl</span><span class="o">.</span><span class="n">flux_points</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">energy_power</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>Out[39]:
</pre></div>
</div>
<div class="output_area highlight-none"><div class="highlight"><pre>
<span></span>&lt;matplotlib.axes._subplots.AxesSubplot at 0x116a8f7f0&gt;
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_first_steps_79_1.png" src="../_images/notebooks_first_steps_79_1.png" />
</div>
</div>
<div class="section" id="Exercises">
<h3>Exercises<a class="headerlink" href="#Exercises" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Plot the spectral model and flux points for PKS 2155-304 for the 3FGL
and 2FHL catalogs. Try to plot the error of the model (aka
“Butterfly”) as well. Note this requires the <a class="reference external" href="https://pythonhosted.org/uncertainties/">uncertainties
package</a> to be installed
on your machine.</li>
</ul>
</div>
</div>
<div class="section" id="What-next?">
<h2>What next?<a class="headerlink" href="#What-next?" title="Permalink to this headline">¶</a></h2>
<p>This was a quick introduction to some of the high-level classes in
Astropy and Gammapy.</p>
<ul class="simple">
<li>To learn more about those classes, go to the API docs (links are in
the introduction at the top).</li>
<li>To learn more about other parts of Gammapy (e.g. Fermi-LAT and TeV
data analysis), check out the other tutorial notebooks.</li>
<li>To see what’s available in Gammapy, browse the <a class="reference external" href="http://docs.gammapy.org/">Gammapy
docs</a> or use the full-text search.</li>
<li>If you have any questions, ask on the mailing list.</li>
</ul>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><h3>Page Contents</h3>
<ul>
<li><a class="reference internal" href="#">Getting started with Gammapy</a><ul>
<li><a class="reference internal" href="#Introduction">Introduction</a></li>
<li><a class="reference internal" href="#Setup">Setup</a></li>
<li><a class="reference internal" href="#Sky-images">Sky images</a><ul>
<li><a class="reference internal" href="#Exercises">Exercises</a></li>
</ul>
</li>
<li><a class="reference internal" href="#Event-lists">Event lists</a><ul>
<li><a class="reference internal" href="#Exercises">Exercises</a></li>
</ul>
</li>
<li><a class="reference internal" href="#Source-catalogs">Source catalogs</a><ul>
<li><a class="reference internal" href="#Exercises">Exercises</a></li>
</ul>
</li>
<li><a class="reference internal" href="#Spectral-models-and-flux-points">Spectral models and flux points</a><ul>
<li><a class="reference internal" href="#Exercises">Exercises</a></li>
</ul>
</li>
<li><a class="reference internal" href="#What-next?">What next?</a></li>
</ul>
</li>
</ul>


        </div>
      </div>
      <div class="clearer"></div>
    </div>
<footer class="footer">
  <p class="pull-right">
    <a href="../_sources/notebooks/first_steps.ipynb.txt"
       rel="nofollow">Page Source</a> &nbsp;
    <a href="#">Back to Top</a></p>
  <p>
    &copy; Copyright 2018, The Gammapy developers.<br/>
    Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.6.7. &nbsp;
    Last built 01 Mar 2018. <br/>
  </p>
</footer>
  </body>
</html>