

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>HGPS &mdash; gammapy v0.8</title>
  

  
  
    <link rel="shortcut icon" href="../_static/gammapy_logo.ico"/>
  
  
  
    <link rel="canonical" href="http://docs.gammapy.org/dev/notebooks/hgps.html"/>
  

  

  
  
    

  

  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/gammapy.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Astrophysical source population modeling with Gammapy" href="source_population_model.html" />
    <link rel="prev" title="Light curves" href="light_curve.html" /> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> gammapy
          

          
          </a>

          
            
            
              <div class="version">
                0.8
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../getting-started.html">Getting Started</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../getting-started.html#help">Help!?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting-started.html#install">Install</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting-started.html#download-tutorials">Download tutorials</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting-started.html#check-your-setup">Check your setup</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting-started.html#use-gammapy">Use Gammapy</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../getting-started.html#id2">Python</a></li>
<li class="toctree-l3"><a class="reference internal" href="../getting-started.html#ipython">IPython</a></li>
<li class="toctree-l3"><a class="reference internal" href="../getting-started.html#python-script">Python script</a></li>
<li class="toctree-l3"><a class="reference internal" href="../getting-started.html#command-line">Command line</a></li>
<li class="toctree-l3"><a class="reference internal" href="../getting-started.html#jupyter-notebooks">Jupyter notebooks</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../getting-started.html#install-issues">Install issues</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="../tutorials.html">Tutorial notebooks</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../tutorials.html#notebooks">Notebooks</a><ul>
<li class="toctree-l3"><a class="reference internal" href="first_steps.html">Getting started with Gammapy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="first_steps.html#Introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="first_steps.html#Setup">Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="first_steps.html#Maps">Maps</a></li>
<li class="toctree-l4"><a class="reference internal" href="first_steps.html#Event-lists">Event lists</a></li>
<li class="toctree-l4"><a class="reference internal" href="first_steps.html#Source-catalogs">Source catalogs</a></li>
<li class="toctree-l4"><a class="reference internal" href="first_steps.html#Spectral-models-and-flux-points">Spectral models and flux points</a></li>
<li class="toctree-l4"><a class="reference internal" href="first_steps.html#What-next?">What next?</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="intro_maps.html">Gammapy Maps</a><ul>
<li class="toctree-l4"><a class="reference internal" href="intro_maps.html#Introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="intro_maps.html#0.-Setup">0. Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="intro_maps.html#1.-Creating-WCS-Maps">1. Creating WCS Maps</a></li>
<li class="toctree-l4"><a class="reference internal" href="intro_maps.html#2.-Accessing-and-Modifying-Data">2. Accessing and Modifying Data</a></li>
<li class="toctree-l4"><a class="reference internal" href="intro_maps.html#3.-Reading-and-Writing">3. Reading and Writing</a></li>
<li class="toctree-l4"><a class="reference internal" href="intro_maps.html#4.-Visualizing-and-Plotting">4. Visualizing and Plotting</a></li>
<li class="toctree-l4"><a class="reference internal" href="intro_maps.html#5.-Reprojecting,-Interpolating-and-Miscellaneous">5. Reprojecting, Interpolating and Miscellaneous</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="cta_1dc_introduction.html">CTA first data challenge (1DC) with Gammapy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="cta_1dc_introduction.html#Introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="cta_1dc_introduction.html#Notebook-and-Gammapy-Setup">Notebook and Gammapy Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="cta_1dc_introduction.html#DC-1-data">DC-1 data</a></li>
<li class="toctree-l4"><a class="reference internal" href="cta_1dc_introduction.html#EVENT-data">EVENT data</a></li>
<li class="toctree-l4"><a class="reference internal" href="cta_1dc_introduction.html#EVENT-analysis-example">EVENT analysis example</a></li>
<li class="toctree-l4"><a class="reference internal" href="cta_1dc_introduction.html#IRFs">IRFs</a></li>
<li class="toctree-l4"><a class="reference internal" href="cta_1dc_introduction.html#Index-files-and-DataStore">Index files and DataStore</a></li>
<li class="toctree-l4"><a class="reference internal" href="cta_1dc_introduction.html#Select-observations">Select observations</a></li>
<li class="toctree-l4"><a class="reference internal" href="cta_1dc_introduction.html#Load-data">Load data</a></li>
<li class="toctree-l4"><a class="reference internal" href="cta_1dc_introduction.html#Model-XML-files">Model XML files</a></li>
<li class="toctree-l4"><a class="reference internal" href="cta_1dc_introduction.html#Exercises">Exercises</a></li>
<li class="toctree-l4"><a class="reference internal" href="cta_1dc_introduction.html#What-next?">What next?</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="cta_data_analysis.html">CTA data analysis with Gammapy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="cta_data_analysis.html#Introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="cta_data_analysis.html#Setup">Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="cta_data_analysis.html#Select-observations">Select observations</a></li>
<li class="toctree-l4"><a class="reference internal" href="cta_data_analysis.html#Make-sky-images">Make sky images</a></li>
<li class="toctree-l4"><a class="reference internal" href="cta_data_analysis.html#Source-Detection">Source Detection</a></li>
<li class="toctree-l4"><a class="reference internal" href="cta_data_analysis.html#Spatial-analysis">Spatial analysis</a></li>
<li class="toctree-l4"><a class="reference internal" href="cta_data_analysis.html#Spectrum">Spectrum</a></li>
<li class="toctree-l4"><a class="reference internal" href="cta_data_analysis.html#Exercises">Exercises</a></li>
<li class="toctree-l4"><a class="reference internal" href="cta_data_analysis.html#What-next?">What next?</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="analysis_3d.html">3D analysis</a><ul>
<li class="toctree-l4"><a class="reference internal" href="analysis_3d.html#Setup">Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="analysis_3d.html#Prepare-modeling-input-data">Prepare modeling input data</a></li>
<li class="toctree-l4"><a class="reference internal" href="analysis_3d.html#Likelihood-fit">Likelihood fit</a></li>
<li class="toctree-l4"><a class="reference internal" href="analysis_3d.html#Exercises">Exercises</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="simulate_3d.html">3D simulation and fitting</a><ul>
<li class="toctree-l4"><a class="reference internal" href="simulate_3d.html#Imports-and-versions">Imports and versions</a></li>
<li class="toctree-l4"><a class="reference internal" href="simulate_3d.html#Simulate">Simulate</a></li>
<li class="toctree-l4"><a class="reference internal" href="simulate_3d.html#Fit">Fit</a></li>
<li class="toctree-l4"><a class="reference internal" href="simulate_3d.html#iminuit">iminuit</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="hess.html">H.E.S.S. with Gammapy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="hess.html#Data-access">Data access</a></li>
<li class="toctree-l4"><a class="reference internal" href="hess.html#Maps">Maps</a></li>
<li class="toctree-l4"><a class="reference internal" href="hess.html#PSF">PSF</a></li>
<li class="toctree-l4"><a class="reference internal" href="hess.html#Map-fit">Map fit</a></li>
<li class="toctree-l4"><a class="reference internal" href="hess.html#Residual-image">Residual image</a></li>
<li class="toctree-l4"><a class="reference internal" href="hess.html#Spectrum">Spectrum</a></li>
<li class="toctree-l4"><a class="reference internal" href="hess.html#Exercises">Exercises</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="detect_ts.html">Source detection with Gammapy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="detect_ts.html#Introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="detect_ts.html#Setup">Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="detect_ts.html#Compute-TS-image">Compute TS image</a></li>
<li class="toctree-l4"><a class="reference internal" href="detect_ts.html#Plot-images">Plot images</a></li>
<li class="toctree-l4"><a class="reference internal" href="detect_ts.html#Source-catalog">Source catalog</a></li>
<li class="toctree-l4"><a class="reference internal" href="detect_ts.html#Measurements">Measurements</a></li>
<li class="toctree-l4"><a class="reference internal" href="detect_ts.html#Compare-to-2FHL">Compare to 2FHL</a></li>
<li class="toctree-l4"><a class="reference internal" href="detect_ts.html#Exercises">Exercises</a></li>
<li class="toctree-l4"><a class="reference internal" href="detect_ts.html#What-next?">What next?</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="image_fitting_with_sherpa.html">Fitting 2D images with Sherpa</a><ul>
<li class="toctree-l4"><a class="reference internal" href="image_fitting_with_sherpa.html#Introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="image_fitting_with_sherpa.html#Read-sky-images">Read sky images</a></li>
<li class="toctree-l4"><a class="reference internal" href="image_fitting_with_sherpa.html#Exercises">Exercises</a></li>
<li class="toctree-l4"><a class="reference internal" href="image_fitting_with_sherpa.html#What-next?">What next?</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="spectrum_models.html">Spectral models in Gammapy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="spectrum_models.html#Introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_models.html#Setup">Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_models.html#Create-a-model">Create a model</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_models.html#Get-and-set-model-parameters">Get and set model parameters</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_models.html#List-available-models">List available models</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_models.html#Plotting">Plotting</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_models.html#Parameter-errors">Parameter errors</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_models.html#Integral-fluxes">Integral fluxes</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_models.html#User-defined-model">User-defined model</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_models.html#What’s-next?">What’s next?</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="spectrum_pipe.html">Spectrum analysis with Gammapy (run pipeline)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="spectrum_pipe.html#Setup">Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_pipe.html#Select-data">Select data</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_pipe.html#Configure-the-analysis">Configure the analysis</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_pipe.html#Run-the-analysis">Run the analysis</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_pipe.html#Results">Results</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_pipe.html#Exercises">Exercises</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="spectrum_analysis.html">Spectral analysis with Gammapy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="spectrum_analysis.html#Introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_analysis.html#Setup">Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_analysis.html#Configure-logger">Configure logger</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_analysis.html#Load-Data">Load Data</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_analysis.html#Define-Target-Region">Define Target Region</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_analysis.html#Create-exclusion-mask">Create exclusion mask</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_analysis.html#Estimate-background">Estimate background</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_analysis.html#Source-statistic">Source statistic</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_analysis.html#Extract-spectrum">Extract spectrum</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_analysis.html#Look-at-observations">Look at observations</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_analysis.html#Fit-spectrum">Fit spectrum</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_analysis.html#Compute-Flux-Points">Compute Flux Points</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_analysis.html#Stack-observations">Stack observations</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_analysis.html#Exercises">Exercises</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_analysis.html#What-next?">What next?</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="spectrum_fitting_with_sherpa.html">Fitting gammapy spectra with sherpa</a><ul>
<li class="toctree-l4"><a class="reference internal" href="spectrum_fitting_with_sherpa.html#Load-data-stack">Load data stack</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_fitting_with_sherpa.html#Define-source-model">Define source model</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_fitting_with_sherpa.html#Fit-and-error-estimation">Fit and error estimation</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_fitting_with_sherpa.html#Results-plot">Results plot</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_fitting_with_sherpa.html#Errors-and-confidence-contours">Errors and confidence contours</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_fitting_with_sherpa.html#Exercises">Exercises</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="sed_fitting_gammacat_fermi.html">Flux point fitting in Gammapy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="sed_fitting_gammacat_fermi.html#Introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="sed_fitting_gammacat_fermi.html#Setup">Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="sed_fitting_gammacat_fermi.html#Load-spectral-points">Load spectral points</a></li>
<li class="toctree-l4"><a class="reference internal" href="sed_fitting_gammacat_fermi.html#Power-Law-Fit">Power Law Fit</a></li>
<li class="toctree-l4"><a class="reference internal" href="sed_fitting_gammacat_fermi.html#Exponential-Cut-Off-Powerlaw-Fit">Exponential Cut-Off Powerlaw Fit</a></li>
<li class="toctree-l4"><a class="reference internal" href="sed_fitting_gammacat_fermi.html#Log-Parabola-Fit">Log-Parabola Fit</a></li>
<li class="toctree-l4"><a class="reference internal" href="sed_fitting_gammacat_fermi.html#Exercises">Exercises</a></li>
<li class="toctree-l4"><a class="reference internal" href="sed_fitting_gammacat_fermi.html#What-next?">What next?</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="fermi_lat.html">Fermi-LAT data with Gammapy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="fermi_lat.html#Introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="fermi_lat.html#Setup">Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="fermi_lat.html#Events">Events</a></li>
<li class="toctree-l4"><a class="reference internal" href="fermi_lat.html#Counts">Counts</a></li>
<li class="toctree-l4"><a class="reference internal" href="fermi_lat.html#Exposure">Exposure</a></li>
<li class="toctree-l4"><a class="reference internal" href="fermi_lat.html#Galactic-diffuse-background">Galactic diffuse background</a></li>
<li class="toctree-l4"><a class="reference internal" href="fermi_lat.html#Isotropic-diffuse-background">Isotropic diffuse background</a></li>
<li class="toctree-l4"><a class="reference internal" href="fermi_lat.html#PSF">PSF</a></li>
<li class="toctree-l4"><a class="reference internal" href="fermi_lat.html#Background">Background</a></li>
<li class="toctree-l4"><a class="reference internal" href="fermi_lat.html#Excess-and-flux">Excess and flux</a></li>
<li class="toctree-l4"><a class="reference internal" href="fermi_lat.html#Fit">Fit</a></li>
<li class="toctree-l4"><a class="reference internal" href="fermi_lat.html#Exercises">Exercises</a></li>
<li class="toctree-l4"><a class="reference internal" href="fermi_lat.html#Summary">Summary</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="light_curve.html">Light curves</a><ul>
<li class="toctree-l4"><a class="reference internal" href="light_curve.html#Introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="light_curve.html#Setup">Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="light_curve.html#Spectrum">Spectrum</a></li>
<li class="toctree-l4"><a class="reference internal" href="light_curve.html#Light-curve-estimation">Light curve estimation</a></li>
<li class="toctree-l4"><a class="reference internal" href="light_curve.html#Results">Results</a></li>
<li class="toctree-l4"><a class="reference internal" href="light_curve.html#Exercises">Exercises</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 current"><a class="reference internal" href="../tutorials.html#extra-topics">Extra topics</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">HGPS</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Notebook-Overview">Notebook Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Packages">Packages</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Setup">Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Download-Data">Download Data</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Catalog-with-Astropy">Catalog with Astropy</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Maps-with-Astropy">Maps with Astropy</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Catalog-with-Gammapy">Catalog with Gammapy</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Maps-with-Gammapy">Maps with Gammapy</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Conclusions">Conclusions</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Exercises">Exercises</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="source_population_model.html">Astrophysical source population modeling with Gammapy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="source_population_model.html#Introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="source_population_model.html#Setup">Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="source_population_model.html#Simulate-positions">Simulate positions</a></li>
<li class="toctree-l4"><a class="reference internal" href="source_population_model.html#Simulate-luminosities">Simulate luminosities</a></li>
<li class="toctree-l4"><a class="reference internal" href="source_population_model.html#Compute-observable-parameters">Compute observable parameters</a></li>
<li class="toctree-l4"><a class="reference internal" href="source_population_model.html#Check-output">Check output</a></li>
<li class="toctree-l4"><a class="reference internal" href="source_population_model.html#Exercises">Exercises</a></li>
<li class="toctree-l4"><a class="reference internal" href="source_population_model.html#What-next?">What next?</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="cwt.html">CWT Algorithm</a><ul>
<li class="toctree-l4"><a class="reference internal" href="cwt.html#Setup">Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="cwt.html#CWT-Algorithm.-PlayGround">CWT Algorithm. PlayGround</a></li>
<li class="toctree-l4"><a class="reference internal" href="cwt.html#Results-of-analysis">Results of analysis</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="astro_dark_matter.html">Dark matter utilities</a><ul>
<li class="toctree-l4"><a class="reference internal" href="astro_dark_matter.html#Introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="astro_dark_matter.html#Setup">Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="astro_dark_matter.html#Profiles">Profiles</a></li>
<li class="toctree-l4"><a class="reference internal" href="astro_dark_matter.html#J-Factors">J Factors</a></li>
<li class="toctree-l4"><a class="reference internal" href="astro_dark_matter.html#Gamma-ray-spectra-at-production">Gamma-ray spectra at production</a></li>
<li class="toctree-l4"><a class="reference internal" href="astro_dark_matter.html#Flux-maps">Flux maps</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="background_model.html">Make template background model</a><ul>
<li class="toctree-l4"><a class="reference internal" href="background_model.html#Introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="background_model.html#Setup">Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="background_model.html#Select-off-data">Select off data</a></li>
<li class="toctree-l4"><a class="reference internal" href="background_model.html#Background-model">Background model</a></li>
<li class="toctree-l4"><a class="reference internal" href="background_model.html#Zenith-dependence">Zenith dependence</a></li>
<li class="toctree-l4"><a class="reference internal" href="background_model.html#Index-tables">Index tables</a></li>
<li class="toctree-l4"><a class="reference internal" href="background_model.html#Exercises">Exercises</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials.html#basics">Basics</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../install/index.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../install/index.html#quick-install-guide">Quick install guide</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../install/index.html#stable-version">Stable version</a></li>
<li class="toctree-l3"><a class="reference internal" href="../install/index.html#development-version">Development version</a></li>
<li class="toctree-l3"><a class="reference internal" href="../install/index.html#verify">Verify</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../install/index.html#need-help">Need help?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../install/index.html#detailed-information">Detailed information</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../install/conda.html">Installation with conda</a></li>
<li class="toctree-l3"><a class="reference internal" href="../install/pip.html">Installation with pip or setup.py</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../install/pip.html#install-pip">pip</a></li>
<li class="toctree-l4"><a class="reference internal" href="../install/pip.html#setup-py">setup.py</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../install/macports.html">Installation with Macports</a></li>
<li class="toctree-l3"><a class="reference internal" href="../install/other.html">Other package managers</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../install/other.html#id1">apt-get</a></li>
<li class="toctree-l4"><a class="reference internal" href="../install/other.html#id2">yum</a></li>
<li class="toctree-l4"><a class="reference internal" href="../install/other.html#id3">Homebrew</a></li>
<li class="toctree-l4"><a class="reference internal" href="../install/other.html#id4">Fermi ScienceTools</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../install/check.html">Check Gammapy installation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../install/check.html#how-to-run-checks">How to run checks</a></li>
<li class="toctree-l4"><a class="reference internal" href="../install/check.html#common-issues">Common issues</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../install/dependencies.html">Dependencies</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../data/index.html">data - Data and observations</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../data/index.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../data/index.html#getting-started">Getting Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="../data/index.html#using-gammapy-data">Using <code class="docutils literal notranslate"><span class="pre">gammapy.data</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../data/index.html#reference-api">Reference/API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../data/index.html#module-gammapy.data">gammapy.data Package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../data/index.html#classes">Classes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../data/index.html#variables">Variables</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../irf/index.html">irf - Instrument response functions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../irf/index.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../irf/index.html#getting-started">Getting Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="../irf/index.html#effective-area">Effective area</a></li>
<li class="toctree-l2"><a class="reference internal" href="../irf/index.html#background">Background</a></li>
<li class="toctree-l2"><a class="reference internal" href="../irf/index.html#psf">PSF</a></li>
<li class="toctree-l2"><a class="reference internal" href="../irf/index.html#energy-dispersion">Energy Dispersion</a></li>
<li class="toctree-l2"><a class="reference internal" href="../irf/index.html#using-gammapy-irf">Using <code class="docutils literal notranslate"><span class="pre">gammapy.irf</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="../irf/theory.html">IRF Theory</a></li>
<li class="toctree-l3"><a class="reference internal" href="../irf/aeff.html">Effective area</a></li>
<li class="toctree-l3"><a class="reference internal" href="../irf/edisp.html">Energy dispersion</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../irf/index.html#reference-api">Reference/API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../irf/index.html#module-gammapy.irf">gammapy.irf Package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../irf/index.html#classes">Classes</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../maps/index.html">maps - Sky maps</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../maps/index.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../maps/index.html#getting-started">Getting Started</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../maps/index.html#constructing-with-factory-methods">Constructing with Factory Methods</a></li>
<li class="toctree-l3"><a class="reference internal" href="../maps/index.html#indexing-and-slicing">Indexing and Slicing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../maps/index.html#accessor-methods">Accessor Methods</a></li>
<li class="toctree-l3"><a class="reference internal" href="../maps/index.html#interface-with-mapcoord-and-skycoord">Interface with <code class="docutils literal notranslate"><span class="pre">MapCoord</span></code> and <code class="docutils literal notranslate"><span class="pre">SkyCoord</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../maps/index.html#mapcoord">MapCoord</a></li>
<li class="toctree-l3"><a class="reference internal" href="../maps/index.html#interpolation">Interpolation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../maps/index.html#projection">Projection</a></li>
<li class="toctree-l3"><a class="reference internal" href="../maps/index.html#iterating-on-a-map">Iterating on a Map</a></li>
<li class="toctree-l3"><a class="reference internal" href="../maps/index.html#fits-i-o">FITS I/O</a></li>
<li class="toctree-l3"><a class="reference internal" href="../maps/index.html#visualization">Visualization</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../maps/index.html#examples">Examples</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../maps/index.html#creating-a-counts-cube-from-an-ft1-file">Creating a Counts Cube from an FT1 File</a></li>
<li class="toctree-l3"><a class="reference internal" href="../maps/index.html#generating-a-cutout-of-a-model-cube">Generating a Cutout of a Model Cube</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../maps/index.html#using-gammapy-maps">Using <code class="docutils literal notranslate"><span class="pre">gammapy.maps</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="../maps/hpxmap.html">HEALPix-based Maps</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../maps/hpxmap.html#healpix-geometry">HEALPix Geometry</a></li>
<li class="toctree-l4"><a class="reference internal" href="../maps/hpxmap.html#sparse-maps">Sparse Maps</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../maps/wcsmap.html">WCS-based Maps</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../maps/index.html#reference-api">Reference/API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../maps/index.html#module-gammapy.maps">gammapy.maps Package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../maps/index.html#classes">Classes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../maps/index.html#class-inheritance-diagram">Class Inheritance Diagram</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../image/index.html">image - Map image analysis</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../image/index.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../image/index.html#getting-started">Getting Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="../image/index.html#using-gammapy-image">Using <code class="docutils literal notranslate"><span class="pre">gammapy.image</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="../image/models.html">Morphology models (<code class="docutils literal notranslate"><span class="pre">gammapy.image.models</span></code>)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../image/models.html#introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../image/models.html#getting-started">Getting Started</a></li>
<li class="toctree-l4"><a class="reference internal" href="../image/models.html#reference-api">Reference/API</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../image/plotting.html">Image plotting</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../image/plotting.html#colormaps">Colormaps</a></li>
<li class="toctree-l4"><a class="reference internal" href="../image/plotting.html#multi-panel-galactic-plane-survey-image-plots">Multi-panel Galactic plane survey image plots</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../image/index.html#reference-api">Reference/API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../image/index.html#module-gammapy.image">gammapy.image Package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../image/index.html#functions">Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../image/index.html#classes">Classes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../image/index.html#module-gammapy.image.models">gammapy.image.models Package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../image/index.html#id1">Classes</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../cube/index.html">cube - Map cube analysis</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../cube/index.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cube/index.html#getting-started">Getting Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cube/index.html#using-gammapy-cube">Using <code class="docutils literal notranslate"><span class="pre">gammapy.cube</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../cube/index.html#reference-api">Reference/API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../cube/index.html#module-gammapy.cube">gammapy.cube Package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../cube/index.html#functions">Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cube/index.html#classes">Classes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../cube/index.html#module-gammapy.cube.models">gammapy.cube.models Module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../cube/index.html#id1">Classes</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../detect/index.html">detect - Source detection</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../detect/index.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../detect/index.html#computation-of-ts-images">Computation of TS images</a></li>
<li class="toctree-l2"><a class="reference internal" href="../detect/index.html#computation-of-li-ma-significance-images">Computation of Li &amp; Ma significance images</a></li>
<li class="toctree-l2"><a class="reference internal" href="../detect/index.html#using-gammapy-detect">Using <code class="docutils literal notranslate"><span class="pre">gammapy.detect</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../detect/index.html#reference-api">Reference/API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../detect/index.html#module-gammapy.detect">gammapy.detect Package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../detect/index.html#functions">Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../detect/index.html#classes">Classes</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../background/index.html">background - Background modeling</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../background/index.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../background/index.html#getting-started">Getting Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="../background/index.html#using-gammapy-background">Using <code class="docutils literal notranslate"><span class="pre">gammapy.background</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="../background/reflected.html">Reflected regions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../background/index.html#reference-api">Reference/API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../background/index.html#module-gammapy.background">gammapy.background Package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../background/index.html#functions">Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../background/index.html#classes">Classes</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../spectrum/index.html">spectrum - 1D spectrum analysis</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../spectrum/index.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../spectrum/index.html#getting-started">Getting Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="../spectrum/index.html#using-gammapy-spectrum">Using <code class="docutils literal notranslate"><span class="pre">gammapy.spectrum</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="../spectrum/fitting.html">Spectral Fitting</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../spectrum/fitting.html#getting-started">Getting Started</a></li>
<li class="toctree-l4"><a class="reference internal" href="../spectrum/fitting.html#interactive-sherpa-fit">Interactive Sherpa Fit</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../spectrum/index.html#reference-api">Reference/API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../spectrum/index.html#module-gammapy.spectrum">gammapy.spectrum Package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../spectrum/index.html#functions">Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../spectrum/index.html#classes">Classes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../spectrum/index.html#module-gammapy.spectrum.models">gammapy.spectrum.models Module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../spectrum/index.html#id4">Classes</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../time/index.html">time - Time analysis</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../time/index.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../time/index.html#getting-started">Getting Started</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../time/index.html#lightcurve">Lightcurve</a></li>
<li class="toctree-l3"><a class="reference internal" href="../time/index.html#variability-test">Variability test</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../time/index.html#other-codes">Other codes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../time/index.html#using-gammapy-time">Using <code class="docutils literal notranslate"><span class="pre">gammapy.time</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="../time/period.html">Period detection and plotting</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../time/period.html#introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../time/period.html#getting-started">Getting Started</a></li>
<li class="toctree-l4"><a class="reference internal" href="../time/period.html#example">Example</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../time/index.html#reference-api">Reference/API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../time/index.html#module-gammapy.time">gammapy.time Package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../time/index.html#functions">Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../time/index.html#classes">Classes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../time/index.html#module-gammapy.time.models">gammapy.time.models Module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../time/index.html#id1">Classes</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../stats/index.html">stats - Statistics</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../stats/index.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stats/index.html#getting-started">Getting Started</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../stats/index.html#li-ma-significance">Li &amp; Ma Significance</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stats/index.html#confidence-intervals">Confidence Intervals</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../stats/index.html#using-gammapy-stats">Using <code class="docutils literal notranslate"><span class="pre">gammapy.stats</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="../stats/feldman_cousins.html">Feldman and Cousins Confidence Intervals</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stats/feldman_cousins.html#examples">Examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="../stats/feldman_cousins.html#acceptance-interval-fixing">Acceptance Interval Fixing</a></li>
<li class="toctree-l4"><a class="reference internal" href="../stats/feldman_cousins.html#sensitivity">Sensitivity</a></li>
<li class="toctree-l4"><a class="reference internal" href="../stats/feldman_cousins.html#general-case">General Case</a></li>
<li class="toctree-l4"><a class="reference internal" href="../stats/feldman_cousins.html#verification">Verification</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stats/fit_statistics.html">Fit statistics</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stats/fit_statistics.html#introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../stats/fit_statistics.html#gaussian-data">Gaussian data</a></li>
<li class="toctree-l4"><a class="reference internal" href="../stats/fit_statistics.html#poisson-data">Poisson data</a></li>
<li class="toctree-l4"><a class="reference internal" href="../stats/fit_statistics.html#poisson-data-with-background-measurement">Poisson data with background measurement</a></li>
<li class="toctree-l4"><a class="reference internal" href="../stats/fit_statistics.html#further-references">Further references</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../stats/index.html#reference-api">Reference/API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../stats/index.html#module-gammapy.stats">gammapy.stats Package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stats/index.html#functions">Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../stats/index.html#classes">Classes</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../utils/index.html">utils - Utilities</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../utils/index.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../utils/index.html#time-handling-in-gammapy">Time handling in Gammapy</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#time-format-and-scale">Time format and scale</a></li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#mission-elapsed-times-met">Mission elapsed times (MET)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#time-differences">Time differences</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../utils/index.html#energy-handling-in-gammapy">Energy handling in Gammapy</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#basics">Basics</a></li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#energy">Energy</a></li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#energybounds">EnergyBounds</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../utils/index.html#reference-api">Reference/API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#module-gammapy.utils.energy">gammapy.utils.energy Module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#classes">Classes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#module-gammapy.utils.units">gammapy.utils.units Module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#functions">Functions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#module-gammapy.utils.coordinates">gammapy.utils.coordinates Package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#id3">Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#variables">Variables</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#module-gammapy.utils.table">gammapy.utils.table Module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#id4">Functions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#module-gammapy.utils.fits">gammapy.utils.fits Module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#gammapy-fits-utilities">Gammapy FITS utilities</a></li>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#id5">Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#id6">Classes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#module-gammapy.utils.random">gammapy.utils.random Module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#id7">Functions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#module-gammapy.utils.distributions">gammapy.utils.distributions Package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#id8">Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#id9">Classes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#module-gammapy.utils.scripts">gammapy.utils.scripts Module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#id10">Functions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#module-gammapy.utils.testing">gammapy.utils.testing Module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#id11">Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#id12">Classes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#module-gammapy.utils.wcs">gammapy.utils.wcs Module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#id13">Functions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#module-gammapy.utils.nddata">gammapy.utils.nddata Module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#id14">Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#id15">Classes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#module-gammapy.utils.time">gammapy.utils.time Module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#id16">Functions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#module-gammapy.utils.fitting">gammapy.utils.fitting Package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#id17">Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#id18">Classes</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../scripts/index.html">scripts - Command line tools</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../scripts/index.html#introduction">Introduction</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../scripts/index.html#execute">Execute</a></li>
<li class="toctree-l3"><a class="reference internal" href="../scripts/index.html#command-not-found">Command not found</a></li>
<li class="toctree-l3"><a class="reference internal" href="../scripts/index.html#example">Example</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../scripts/index.html#reference">Reference</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../scripts/index.html#gammapy">gammapy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../scripts/index.html#gammapy-check">check</a></li>
<li class="toctree-l4"><a class="reference internal" href="../scripts/index.html#gammapy-download">download</a></li>
<li class="toctree-l4"><a class="reference internal" href="../scripts/index.html#gammapy-image">image</a></li>
<li class="toctree-l4"><a class="reference internal" href="../scripts/index.html#gammapy-info">info</a></li>
<li class="toctree-l4"><a class="reference internal" href="../scripts/index.html#gammapy-jupyter">jupyter</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../scripts/index.html#implementation">Implementation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../scripts/index.html#limitations">Limitations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../scripts/index.html#plan">Plan</a></li>
<li class="toctree-l2"><a class="reference internal" href="../scripts/index.html#write-your-own-cli">Write your own CLI</a></li>
<li class="toctree-l2"><a class="reference internal" href="../scripts/index.html#reference-api">Reference/API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../scripts/index.html#module-gammapy.scripts">gammapy.scripts Package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../scripts/index.html#classes">Classes</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../datasets/index.html">datasets - Dataset access</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../datasets/index.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../datasets/index.html#gammapy-extra">gammapy-extra</a></li>
<li class="toctree-l2"><a class="reference internal" href="../datasets/index.html#gamma-cat">Gamma-cat</a></li>
<li class="toctree-l2"><a class="reference internal" href="../datasets/index.html#getting-started">Getting Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="../datasets/index.html#using-gammapy-datasets">Using <code class="docutils literal notranslate"><span class="pre">gammapy.datasets</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../datasets/index.html#reference-api">Reference/API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../datasets/index.html#module-gammapy.datasets">gammapy.datasets Package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../datasets/index.html#functions">Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../datasets/index.html#classes">Classes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../datasets/index.html#variables">Variables</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../catalog/index.html">catalog - Source catalogs</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../catalog/index.html#introduction">Introduction</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../catalog/index.html#available-catalogs">Available catalogs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../catalog/index.html#how-it-works">How it works</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../catalog/index.html#getting-started">Getting Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="../catalog/index.html#using-gammapy-catalog">Using <code class="docutils literal notranslate"><span class="pre">gammapy.catalog</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="../catalog/gammacat.html">gamma-cat</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../catalog/gammacat.html#catalog">Catalog</a></li>
<li class="toctree-l4"><a class="reference internal" href="../catalog/gammacat.html#data-collection">Data collection</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../catalog/index.html#reference-api">Reference/API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../catalog/index.html#module-gammapy.catalog">gammapy.catalog Package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../catalog/index.html#functions">Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../catalog/index.html#classes">Classes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../catalog/index.html#variables">Variables</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../astro/index.html">astro - Astrophysics</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../astro/index.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../astro/index.html#getting-started">Getting Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="../astro/index.html#sub-packages">Sub-packages</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../astro/source/index.html">Astrophysical source models (<code class="docutils literal notranslate"><span class="pre">gammapy.astro.source</span></code>)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../astro/source/index.html#introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../astro/source/index.html#getting-started">Getting Started</a></li>
<li class="toctree-l4"><a class="reference internal" href="../astro/source/index.html#using-gammapy-astro-source">Using <code class="docutils literal notranslate"><span class="pre">gammapy.astro.source</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../astro/source/index.html#reference-api">Reference/API</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../astro/population/index.html">Astrophysical source population models (<code class="docutils literal notranslate"><span class="pre">gammapy.astro.population</span></code>)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../astro/population/index.html#introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../astro/population/index.html#getting-started">Getting Started</a></li>
<li class="toctree-l4"><a class="reference internal" href="../astro/population/index.html#reference-api">Reference/API</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../astro/darkmatter/index.html">Dark matter (<code class="docutils literal notranslate"><span class="pre">gammapy.astro.darkmatter</span></code>)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../astro/darkmatter/index.html#introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../astro/darkmatter/index.html#other-packages">Other packages</a></li>
<li class="toctree-l4"><a class="reference internal" href="../astro/darkmatter/index.html#using-gammapy-spectrum">Using <code class="docutils literal notranslate"><span class="pre">gammapy.spectrum</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../astro/darkmatter/index.html#reference-api">Reference/API</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../development/index.html">Developer documentation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../development/index.html#contact-points">Contact points</a></li>
<li class="toctree-l2"><a class="reference internal" href="../development/index.html#pages">Pages</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../development/intro.html">How to contribute to Gammapy?</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../development/intro.html#what-is-this">What is this?</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development/intro.html#get-in-touch-early">Get in touch early</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development/intro.html#make-small-pull-requests">Make small pull requests</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development/intro.html#get-set-up">Get set up</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development/intro.html#make-a-working-example">Make a working example</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development/intro.html#integrate-the-code-in-gammapy">Integrate the code in Gammapy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development/intro.html#make-a-pull-request">Make a pull request</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development/intro.html#code-review">Code review</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development/intro.html#close-the-loop">Close the loop</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../development/setup.html">Gammapy project setup</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../development/setup.html#gammapy-repository">gammapy repository</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development/setup.html#gammapy-extra-repository">gammapy-extra repository</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development/setup.html#other-repositories">Other repositories</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development/setup.html#gammapy-webpages">Gammapy webpages</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development/setup.html#continuous-integration">Continuous integration</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development/setup.html#code-quality">Code quality</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development/setup.html#releases">Releases</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development/setup.html#data-formats">Data formats</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../development/howto.html">Developer HOWTO</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../development/howto.html#where-should-i-import-from">Where should I import from?</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development/howto.html#functions-returning-several-values">Functions returning several values</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development/howto.html#python-2-and-3-support">Python 2 and 3 support</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development/howto.html#skip-unit-tests-for-some-astropy-versions">Skip unit tests for some Astropy versions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development/howto.html#fix-non-unix-line-endings">Fix non-Unix line endings</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development/howto.html#check-html-links">Check HTML links</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development/howto.html#what-checks-and-conversions-should-i-do-for-inputs">What checks and conversions should I do for inputs?</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development/howto.html#float-data-type-32-bit-or-64-bit">Float data type: 32 bit or 64 bit?</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development/howto.html#clobber-or-overwrite">Clobber or overwrite?</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development/howto.html#pixel-coordinate-convention">Pixel coordinate convention</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development/howto.html#when-to-use-c-or-cython-or-numba-for-speed">When to use C or Cython or Numba for speed</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development/howto.html#assert-convention">Assert convention</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development/howto.html#random-numbers">Random numbers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development/howto.html#logging">Logging</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development/howto.html#command-line-tools-using-click">Command line tools using click</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development/howto.html#bsd-or-gpl-license">BSD or GPL license?</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development/howto.html#changelog">Changelog</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development/howto.html#file-and-directory-path-handling">File and directory path handling</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development/howto.html#bundled-gammapy-extern-code">Bundled gammapy.extern code</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development/howto.html#interpolation-and-extrapolation">Interpolation and extrapolation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development/howto.html#locate-origin-of-warnings">Locate origin of warnings</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development/howto.html#object-text-repr-str-and-info">Object text repr, str and info</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development/howto.html#using-the-nddataarray">Using the NDDataArray</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development/howto.html#sphinx-docs-build">Sphinx docs build</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development/howto.html#documentation-guidelines">Documentation guidelines</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development/howto.html#different-versions-of-notebooks-in-binder">Different versions of notebooks in Binder</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development/howto.html#link-to-a-notebook-in-gammapy-extra-from-the-docs">Link to a notebook in gammapy-extra from the docs</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development/howto.html#include-images-from-gammapy-extra-into-the-docs">Include images from gammapy-extra into the docs</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development/howto.html#coordinate-and-axis-names">Coordinate and axis names</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development/howto.html#testing-of-plotting-functions">Testing of plotting functions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../development/release.html">How to make a Gammapy release</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../development/release.html#overview">Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development/release.html#pre-release">Pre release</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development/release.html#make-release">Make release</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development/release.html#post-release">Post release</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../development/pigs/index.html">PIGs</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../development/pigs/pig-001.html">PIG 1 - PIG purpose and guidelines</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development/pigs/pig-002.html">PIG 2 - Organization of low-level analysis code</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../development/dataformats.html">Data Formats</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../development/dataformats.html#overview">Overview</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../references.html">References</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../references.html#publications">Publications</a></li>
<li class="toctree-l2"><a class="reference internal" href="../references.html#glossary">Glossary</a></li>
<li class="toctree-l2"><a class="reference internal" href="../references.html#other-gamma-ray-packages">Other gamma-ray packages</a></li>
<li class="toctree-l2"><a class="reference internal" href="../references.html#other-useful-packages">Other useful packages</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">Changelog</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#gammapy-0p8-release">0.8 (2018-09-23)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../changelog.html#summary">Summary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../changelog.html#pull-requests">Pull requests</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#gammapy-0p7-release">0.7 (2018-02-28)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../changelog.html#id4">Summary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../changelog.html#id5">Pull requests</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#april-28-2017">0.6 (April 28, 2017)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../changelog.html#id6">Summary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../changelog.html#id7">Pull requests</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#november-22-2016">0.5 (November 22, 2016)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../changelog.html#id8">Summary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../changelog.html#id9">Pull requests</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#april-20-2016">0.4 (April 20, 2016)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../changelog.html#id10">Summary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../changelog.html#id11">Pull requests</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#august-13-2015">0.3 (August 13, 2015)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../changelog.html#id12">Summary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../changelog.html#id13">Pull requests</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#april-13-2015">0.2 (April 13, 2015)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../changelog.html#id14">Summary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../changelog.html#id15">Pull requests</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#august-25-2014">0.1 (August 25, 2014)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../changelog.html#id16">Summary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../changelog.html#id17">Pull requests</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">gammapy</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../tutorials.html">Tutorial notebooks</a> &raquo;</li>
        
      <li>HGPS</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/notebooks/hgps.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput,
div.nbinput div.prompt,
div.nbinput div.input_area,
div.nbinput div[class*=highlight],
div.nbinput div[class*=highlight] pre,
div.nboutput,
div.nbinput div.prompt,
div.nbinput div.output_area,
div.nboutput div[class*=highlight],
div.nboutput div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput,
div.nboutput {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput,
    div.nboutput {
        flex-direction: column;
    }
}

/* input container */
div.nbinput {
    padding-top: 5px;
}

/* last container */
div.nblast {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput div.prompt pre {
    color: #303F9F;
}

/* output prompt */
div.nboutput div.prompt pre {
    color: #D84315;
}

/* all prompts */
div.nbinput div.prompt,
div.nboutput div.prompt {
    min-width: 8ex;
    padding-top: 0.4em;
    padding-right: 0.4em;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput div.prompt,
    div.nboutput div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput div.prompt pre,
div.nboutput div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput div.input_area,
div.nboutput div.output_area {
    padding: 0.4em;
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput div.input_area,
    div.nboutput div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput div.input_area {
    border: 1px solid #cfcfcf;
    border-radius: 2px;
    background: #f7f7f7;
}

/* override MathJax center alignment in output cells */
div.nboutput div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.pngmath center alignment in output cells */
div.nboutput div.math p {
    text-align: left;
}

/* standard error */
div.nboutput div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast,
.nboutput.nblast {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast + .nbinput {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}
</style>
<script type="text/javascript" src="../_static/linksdl.js"></script><div class="admonition note">
<p class="admonition-title fa fa-exclamation-circle"><strong>This is a fixed-text formatted version of a Jupyter notebook.</strong></p>
<ul class="simple">
<li>Try online <a class="reference external" href="https://mybinder.org/v2/gh/gammapy/gammapy-webpage/v0.8?urlpath=lab/tree/hgps.ipynb"><img alt="Binder" src="https://mybinder.org/badge.svg" /></a></li>
<li>You can contribute with your own notebooks in this <a class="reference external" href="https://github.com/gammapy/gammapy/tree/master/tutorials">GitHub
repository</a>.</li>
<li><strong>Source files:</strong> <a class="reference external" href="../_static/notebooks/hgps.ipynb">hgps.ipynb</a> |
<a class="reference external" href="../_static/notebooks/hgps.py">hgps.py</a></li>
</ul>
</div>
<div class="section" id="HGPS">
<h1>HGPS<a class="headerlink" href="#HGPS" title="Permalink to this headline">¶</a></h1>
<div class="section" id="Introduction">
<h2>Introduction<a class="headerlink" href="#Introduction" title="Permalink to this headline">¶</a></h2>
<p>The <strong>H.E.S.S. Galactic Plane Survey (HGPS)</strong> is the first deep and wide
survey of the Milky Way in TeV gamma-rays.</p>
<p>In April 2018, a paper on the HGPS was published, and survey maps and a
source catalog on the HGPS in FITS format released.</p>
<p>More information, and the HGPS data for download in FITS format is
available here: <a class="reference external" href="https://www.mpi-hd.mpg.de/hfm/HESS/hgps">https://www.mpi-hd.mpg.de/hfm/HESS/hgps</a></p>
<p><strong>Please read the Appendix A of the paper to learn about the caveats to
using the HGPS data. Especially note that the HGPS survey maps are
correlated and thus no detailed source morphology analysis is possible,
and also note the caveats concerning spectral models and spectral flux
points.</strong></p>
</div>
<div class="section" id="Notebook-Overview">
<h2>Notebook Overview<a class="headerlink" href="#Notebook-Overview" title="Permalink to this headline">¶</a></h2>
<p>This is a Jupyter notebook that illustrates how to work with the HGPS
data from Python.</p>
<p>You will learn how to access the HGPS images as well as the HGPS catalog
and other tabular data using Astropy and Gammapy.</p>
<ul class="simple">
<li>In the first part we will only use Astropy to do some basic things.</li>
<li>Then in the second part we’ll use Gammapy to do some things that are
a little more advanced.</li>
</ul>
<p>The notebook is pretty long: feel free to skip ahead to a section of
your choice after executing the cells in the “Setup” and “Download data”
sections below.</p>
<p>Note that there are other tools to work with FITS data that we don’t
explain here. Specifically <a class="reference external" href="http://ds9.si.edu/">DS9</a> and
<a class="reference external" href="http://aladin.u-strasbg.fr/">Aladin</a> are good FITS image viewers,
and <a class="reference external" href="http://www.star.bris.ac.uk/~mbt/topcat/">TOPCAT</a> is great for
FITS tables. Astropy and Gammapy are just one way to work with the HGPS
data; any tool that can access FITS data can be used.</p>
</div>
<div class="section" id="Packages">
<h2>Packages<a class="headerlink" href="#Packages" title="Permalink to this headline">¶</a></h2>
<p>We will be using the following Python packages</p>
<ul class="simple">
<li><a class="reference external" href="http://docs.astropy.org/">astropy</a></li>
<li><a class="reference external" href="http://docs.gammapy.org/">gammapy</a></li>
<li><a class="reference external" href="https://matplotlib.org/">matplotlib</a> for plotting</li>
</ul>
<p>Under the hood all of those packages use Numpy arrays to store and work
with data.</p>
<p>More specifically, we will use the following functions and classes:</p>
<ul class="simple">
<li>From <a class="reference external" href="http://docs.astropy.org/">astropy</a>, we will use
<a class="reference external" href="http://docs.astropy.org/en/stable/io/fits/index.html">astropy.io.fits</a>
to read the FITS data,
<a class="reference external" href="http://docs.astropy.org/en/stable/table/index.html">astropy.table.Table</a>
to work with the tables, but also
<a class="reference external" href="http://docs.astropy.org/en/stable/coordinates/index.html">astropy.coordinates.SkyCoord</a>
and
<a class="reference external" href="http://docs.astropy.org/en/stable/wcs/index.html">astropy.wcs.WCS</a>
to work with sky and pixel coordinates and
<a class="reference external" href="http://docs.astropy.org/en/stable/units/index.html">astropy.units.Quantity</a>
to work with quantities.</li>
<li>From <a class="reference external" href="http://docs.gammapy.org/">gammapy</a>, we will use
<a class="reference internal" href="../api/gammapy.maps.WcsNDMap.html"><span class="doc">gammapy.maps.WcsNDMap</span></a> to work
with the HGPS sky maps, and
<a class="reference internal" href="../api/gammapy.catalog.SourceCatalogHGPS.html"><span class="doc">gammapy.catalog.SourceCatalogHGPS</span></a>
and
<a class="reference internal" href="../api/gammapy.catalog.SourceCatalogObjectHGPS.html"><span class="doc">gammapy.catalog.SourceCatalogObjectHGPS</span></a>
to work with the HGPS catalog data, especially the HGPS spectral data
using
<a class="reference internal" href="../api/gammapy.spectrum.models.SpectralModel.html"><span class="doc">gammapy.spectrum.models.SpectralModel</span></a>
and
<a class="reference internal" href="../api/gammapy.spectrum.FluxPoints.html"><span class="doc">gammapy.spectrum.FluxPoints</span></a>
objects.</li>
<li><a class="reference external" href="https://matplotlib.org/">matplotlib</a> for all plotting. For sky
image plotting, we will use matplotlib via
<a class="reference external" href="http://docs.astropy.org/en/stable/visualization/index.html">astropy.visualization</a>
and
<a class="reference internal" href="../api/gammapy.maps.WcsNDMap.html#gammapy.maps.WcsNDMap.plot"><span class="std std-ref">gammapy.maps.WcsNDMap.plot</span></a>.</li>
</ul>
<p>If you’re not familiar with Python, Numpy, Astropy, Gammapy or
matplotlib yet, use the tutorial introductions as explained
<a class="reference internal" href="../tutorials.html"><span class="doc">here</span></a>, as well as the links to the documentation
that we just mentioned.</p>
</div>
<div class="section" id="Setup">
<h2>Setup<a class="headerlink" href="#Setup" title="Permalink to this headline">¶</a></h2>
<p>We start by importing everything we will use in this notebook, and
configuring the notebook to show plots inline.</p>
<p>If you get an error here, you probably have to install the missing
package and re-start the notebook.</p>
<p>If you don’t get an error, just go ahead, no nead to read the import
code and text in this section.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">astropy.units</span> <span class="kn">as</span> <span class="nn">u</span>
<span class="kn">from</span> <span class="nn">astropy.coordinates</span> <span class="kn">import</span> <span class="n">SkyCoord</span>
<span class="kn">from</span> <span class="nn">astropy.io</span> <span class="kn">import</span> <span class="n">fits</span>
<span class="kn">from</span> <span class="nn">astropy.table</span> <span class="kn">import</span> <span class="n">Table</span>
<span class="kn">from</span> <span class="nn">astropy.wcs</span> <span class="kn">import</span> <span class="n">WCS</span>

<span class="kn">import</span> <span class="nn">astropy</span>

<span class="k">print</span><span class="p">(</span><span class="n">astropy</span><span class="o">.</span><span class="n">__version__</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
3.0.4
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">gammapy.maps</span> <span class="kn">import</span> <span class="n">Map</span>
<span class="kn">from</span> <span class="nn">gammapy.catalog</span> <span class="kn">import</span> <span class="n">SourceCatalogHGPS</span>

<span class="kn">import</span> <span class="nn">gammapy</span>

<span class="k">print</span><span class="p">(</span><span class="n">gammapy</span><span class="o">.</span><span class="n">__version__</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0.8
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>

<span class="kn">import</span> <span class="nn">matplotlib</span>

<span class="k">print</span><span class="p">(</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">__version__</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
2.2.3
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># This will work on Python 3, but fail on Python 2</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="kn">from</span> <span class="nn">urllib.request</span> <span class="kn">import</span> <span class="n">urlretrieve</span>
</pre></div>
</div>
</div>
<p>If you’re still using Python 2, please update to Python 3!</p>
<p>Also, it’s time to start using
<a class="reference external" href="http://jupyterlab.readthedocs.io/">JupyterLab</a> (which is Python 3
only, Jupyter dropped Python 2 support in 2017).</p>
<p>But OK, to be honest, actually everything here will work on Python 2, we
avoided the use of Python 3 only features for now. You just have to
import <code class="docutils literal notranslate"><span class="pre">Path</span></code> and <code class="docutils literal notranslate"><span class="pre">urlretrieve</span></code> from here instead:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># This will work on Python 2 as well as Python 3</span>
<span class="c1"># from gammapy.extern.six.moves.urllib.request import urlretrieve</span>
<span class="c1"># from gammapy.extern.pathlib import Path</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Download-Data">
<h2>Download Data<a class="headerlink" href="#Download-Data" title="Permalink to this headline">¶</a></h2>
<p>First, you need to download the HGPS FITS data from
<a class="reference external" href="https://www.mpi-hd.mpg.de/hfm/HESS/hgps">https://www.mpi-hd.mpg.de/hfm/HESS/hgps</a> .</p>
<p>If you haven’t already, you can use the following commands to download
the files to your local working directory.</p>
<p>You don’t have to read the code in the next cell; that’s just how to
downlaod files from Python. You could also download the files with your
web browser, or from the command line e.g.&nbsp;with curl:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mkdir</span> <span class="n">hgps_data</span>
<span class="n">cd</span> <span class="n">hgps_data</span>
<span class="n">curl</span> <span class="o">-</span><span class="n">O</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">www</span><span class="o">.</span><span class="n">mpi</span><span class="o">-</span><span class="n">hd</span><span class="o">.</span><span class="n">mpg</span><span class="o">.</span><span class="n">de</span><span class="o">/</span><span class="n">hfm</span><span class="o">/</span><span class="n">HESS</span><span class="o">/</span><span class="n">hgps</span><span class="o">/</span><span class="n">data</span><span class="o">/</span><span class="n">hgps_catalog_v1</span><span class="o">.</span><span class="n">fits</span><span class="o">.</span><span class="n">gz</span>
<span class="n">curl</span> <span class="o">-</span><span class="n">O</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">www</span><span class="o">.</span><span class="n">mpi</span><span class="o">-</span><span class="n">hd</span><span class="o">.</span><span class="n">mpg</span><span class="o">.</span><span class="n">de</span><span class="o">/</span><span class="n">hfm</span><span class="o">/</span><span class="n">HESS</span><span class="o">/</span><span class="n">hgps</span><span class="o">/</span><span class="n">data</span><span class="o">/</span><span class="n">hgps_map_significance_0</span><span class="o">.</span><span class="mi">1</span><span class="n">deg_v1</span><span class="o">.</span><span class="n">fits</span><span class="o">.</span><span class="n">gz</span>
</pre></div>
</div>
<p><strong>The rest of this notebook assumes that you have the data files at
``hgps_data_path``.</strong></p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Download HGPS data used in this tutorial to a folder of your choice</span>
<span class="c1"># The default `hgps_data` used here is a sub-folder in your current</span>
<span class="c1"># working directory (where you started the notebook)</span>
<span class="n">hgps_data_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;hgps_data&quot;</span><span class="p">)</span>

<span class="c1"># In this notebook we will only be working with the following files</span>
<span class="c1"># so we only download what is needed.</span>
<span class="n">hgps_filenames</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;hgps_catalog_v1.fits.gz&quot;</span><span class="p">,</span>
    <span class="s2">&quot;hgps_map_significance_0.1deg_v1.fits.gz&quot;</span><span class="p">,</span>
<span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">hgps_data_download</span><span class="p">():</span>
    <span class="n">base_url</span> <span class="o">=</span> <span class="s2">&quot;https://www.mpi-hd.mpg.de/hfm/HESS/hgps/data/&quot;</span>
    <span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="n">hgps_filenames</span><span class="p">:</span>
        <span class="n">url</span> <span class="o">=</span> <span class="n">base_url</span> <span class="o">+</span> <span class="n">filename</span>
        <span class="n">path</span> <span class="o">=</span> <span class="n">hgps_data_path</span> <span class="o">/</span> <span class="n">filename</span>
        <span class="k">if</span> <span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
            <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Already downloaded: {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">path</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Downloading {} to {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">path</span><span class="p">))</span>
            <span class="n">urlretrieve</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">path</span><span class="p">))</span>


<span class="n">hgps_data_path</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">hgps_data_download</span><span class="p">()</span>

<span class="k">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">Files at {} :</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">hgps_data_path</span><span class="o">.</span><span class="n">absolute</span><span class="p">()))</span>
<span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">hgps_data_path</span><span class="o">.</span><span class="n">iterdir</span><span class="p">():</span>
    <span class="k">print</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Downloading https://www.mpi-hd.mpg.de/hfm/HESS/hgps/data/hgps_catalog_v1.fits.gz to hgps_data/hgps_catalog_v1.fits.gz
Downloading https://www.mpi-hd.mpg.de/hfm/HESS/hgps/data/hgps_map_significance_0.1deg_v1.fits.gz to hgps_data/hgps_map_significance_0.1deg_v1.fits.gz


Files at /Users/jer/git/gammapy/temp/hgps_data :

hgps_data/hgps_map_significance_0.1deg_v1.fits.gz
hgps_data/hgps_catalog_v1.fits.gz
</pre></div></div>
</div>
</div>
<div class="section" id="Catalog-with-Astropy">
<h2>Catalog with Astropy<a class="headerlink" href="#Catalog-with-Astropy" title="Permalink to this headline">¶</a></h2>
<div class="section" id="FITS-file-content">
<h3>FITS file content<a class="headerlink" href="#FITS-file-content" title="Permalink to this headline">¶</a></h3>
<p>Let’s start by just opening up <code class="docutils literal notranslate"><span class="pre">hgps_catalog_v1.fits.gz</span></code> and looking
at the content.</p>
<p>Note that <code class="docutils literal notranslate"><span class="pre">astropy.io.fits.open</span></code> doesn’t work with <code class="docutils literal notranslate"><span class="pre">Path</span></code> objects
yet, so you have to call <code class="docutils literal notranslate"><span class="pre">str(path)</span></code> and pass a string.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">path</span> <span class="o">=</span> <span class="n">hgps_data_path</span> <span class="o">/</span> <span class="s2">&quot;hgps_catalog_v1.fits.gz&quot;</span>
<span class="n">hdu_list</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">path</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">hdu_list</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Filename: hgps_data/hgps_catalog_v1.fits.gz
No.    Name      Ver    Type      Cards   Dimensions   Format
  0  PRIMARY       1 PrimaryHDU      15   ()
  1  HGPS_SOURCES    1 BinTableHDU    327   78R x 78C   [16A, 6A, 10A, 20A, 7A, E, E, E, E, E, E, E, E, K, 18A, 103A, E, E, E, E, E, E, E, E, E, E, E, E, E, E, E, E, E, E, E, E, E, E, E, E, E, E, E, 4A, E, E, E, E, E, E, E, E, E, E, E, E, E, E, E, E, E, E, E, E, E, E, E, E, E, K, 40E, 40E, 40E, 40E, 40E, 40E, 40E, 40B]
  2  HGPS_GAUSS_COMPONENTS    1 BinTableHDU     87   98R x 13C   [9A, 16A, 15A, E, E, E, E, E, E, E, E, E, E]
  3  HGPS_ASSOCIATIONS    1 BinTableHDU     39   223R x 4C   [16A, 5A, 21A, E]
  4  HGPS_IDENTIFICATIONS    1 BinTableHDU     53   31R x 9C   [16A, 17A, 9A, 11A, 21A, 21A, E, E, E]
  5  HGPS_LARGE_SCALE_COMPONENT    1 BinTableHDU     55   50R x 7C   [E, E, E, E, E, E, E]
  6  SNRCAT        1 BinTableHDU     56   282R x 7C   [11A, E, E, 29A, E, E, E]
</pre></div></div>
</div>
<p>There are six tables. Each table and column is described in detail in
the HGPS paper.</p>
</div>
<div class="section" id="Access-table-data">
<h3>Access table data<a class="headerlink" href="#Access-table-data" title="Permalink to this headline">¶</a></h3>
<p>We could work with the <code class="docutils literal notranslate"><span class="pre">astropy.io.fits.HDUList</span></code> and
<code class="docutils literal notranslate"><span class="pre">astropy.io.fits.BinTable</span></code> objects. However, in Astropy a nicer class
to work with tables has been developed: <code class="docutils literal notranslate"><span class="pre">astropy.table.Table</span></code>.</p>
<p>We will only be using <code class="docutils literal notranslate"><span class="pre">Table</span></code>, so let’s convert the FITS tabular data
into a <code class="docutils literal notranslate"><span class="pre">Table</span></code> object:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">table</span> <span class="o">=</span> <span class="n">Table</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">hdu_list</span><span class="p">[</span><span class="s2">&quot;HGPS_SOURCES&quot;</span><span class="p">])</span>

<span class="c1"># Alternatively, reading from file directly would work like this:</span>
<span class="c1"># table = Table.read(str(path), hdu=&#39;HGPS_SOURCES&#39;)</span>
<span class="c1"># Usually you have to look first what HDUs are in a FITS file</span>
<span class="c1"># like we did above; `Table` is just for one table</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># List available columns</span>
<span class="n">table</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
<span class="c1"># To get shorter output here, we just list a few</span>
<span class="c1"># table.info(out=None)[&#39;name&#39;, &#39;dtype&#39;, &#39;shape&#39;, &#39;unit&#39;][:10]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;Table length=78&gt;
             name               dtype  shape       unit      n_bad
------------------------------ ------- ----- --------------- -----
                   Source_Name   str16                           0
            Analysis_Reference    str6                           0
                  Source_Class   str10                           0
             Identified_Object   str20                           0
           Gamma_Cat_Source_ID    str7                           0
                       RAJ2000 float32                   deg     0
                       DEJ2000 float32                   deg     0
                          GLON float32                   deg     0
                      GLON_Err float32                   deg    14
                          GLAT float32                   deg     0
                      GLAT_Err float32                   deg    14
                    Pos_Err_68 float32                   deg     3
                    Pos_Err_95 float32                   deg    14
                    ROI_Number   int64                           0
                 Spatial_Model   str18                           0
                    Components  str103                           0
                       Sqrt_TS float32                          14
                          Size float32                   deg    23
                      Size_Err float32                   deg    25
                       Size_UL float32                   deg    61
                           R70 float32                   deg    14
                         RSpec float32                   deg     0
            Excess_Model_Total float32                          14
                  Excess_RSpec float32                          14
            Excess_RSpec_Model float32                          14
              Background_RSpec float32                          14
                      Livetime float32                     h     0
              Energy_Threshold float32                   TeV    14
                      Flux_Map float32           1 / (cm2 s)     0
                  Flux_Map_Err float32           1 / (cm2 s)     0
           Flux_Map_RSpec_Data float32           1 / (cm2 s)    14
         Flux_Map_RSpec_Source float32           1 / (cm2 s)    14
          Flux_Map_RSpec_Other float32           1 / (cm2 s)    14
             Flux_Map_RSpec_LS float32           1 / (cm2 s)    14
          Flux_Map_RSpec_Total float32           1 / (cm2 s)    14
             Containment_RSpec float32                          14
           Contamination_RSpec float32                          14
Flux_Correction_RSpec_To_Total float32                          14
                 Livetime_Spec float32                     h     0
         Energy_Range_Spec_Min float32                   TeV     1
         Energy_Range_Spec_Max float32                   TeV     5
               Background_Spec float32                          14
                   Excess_Spec float32                          14
                Spectral_Model    str4                           0
               TS_ECPL_over_PL float32                          70
            Flux_Spec_Int_1TeV float32           1 / (cm2 s)     0
        Flux_Spec_Int_1TeV_Err float32           1 / (cm2 s)     0
     Flux_Spec_Energy_1_10_TeV float32         erg / (cm2 s)     0
 Flux_Spec_Energy_1_10_TeV_Err float32         erg / (cm2 s)     0
          Energy_Spec_PL_Pivot float32                   TeV     4
       Flux_Spec_PL_Diff_Pivot float32       1 / (cm2 s TeV)     4
   Flux_Spec_PL_Diff_Pivot_Err float32       1 / (cm2 s TeV)     4
        Flux_Spec_PL_Diff_1TeV float32       1 / (cm2 s TeV)     4
    Flux_Spec_PL_Diff_1TeV_Err float32       1 / (cm2 s TeV)     4
                 Index_Spec_PL float32                           4
             Index_Spec_PL_Err float32                           4
        Energy_Spec_ECPL_Pivot float32                   TeV    66
     Flux_Spec_ECPL_Diff_Pivot float32       1 / (cm2 s TeV)    66
 Flux_Spec_ECPL_Diff_Pivot_Err float32       1 / (cm2 s TeV)    66
      Flux_Spec_ECPL_Diff_1TeV float32       1 / (cm2 s TeV)    66
  Flux_Spec_ECPL_Diff_1TeV_Err float32       1 / (cm2 s TeV)    66
               Index_Spec_ECPL float32                          66
           Index_Spec_ECPL_Err float32                          66
              Lambda_Spec_ECPL float32               1 / TeV    66
          Lambda_Spec_ECPL_Err float32               1 / TeV    66
         Flux_Spec_PL_Int_1TeV float32           1 / (cm2 s)     4
     Flux_Spec_PL_Int_1TeV_Err float32           1 / (cm2 s)     4
       Flux_Spec_ECPL_Int_1TeV float32           1 / (cm2 s)    66
   Flux_Spec_ECPL_Int_1TeV_Err float32           1 / (cm2 s)    66
                 N_Flux_Points   int64                           0
            Flux_Points_Energy float32 (40,)             TeV  2546
        Flux_Points_Energy_Min float32 (40,)             TeV  2647
        Flux_Points_Energy_Max float32 (40,)             TeV  2647
              Flux_Points_Flux float32 (40,) 1 / (cm2 s TeV)  2558
       Flux_Points_Flux_Err_Lo float32 (40,) 1 / (cm2 s TeV)  2558
       Flux_Points_Flux_Err_Hi float32 (40,) 1 / (cm2 s TeV)  2558
           Flux_Points_Flux_UL float32 (40,) 1 / (cm2 s TeV)  2724
        Flux_Points_Flux_Is_UL   uint8 (40,)                     0
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Rows are accessed by indexing into the table</span>
<span class="c1"># with an integer index (Python starts at index 0)</span>
<span class="c1"># table[0]</span>
<span class="c1"># To get shorter output here, we just list a few</span>
<span class="n">table</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">table</span><span class="o">.</span><span class="n">colnames</span><span class="p">[:</span><span class="mi">5</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[13]:
</pre></div>
</div>
<div class="output_area docutils container">
<i>Row index=0</i>
<table id="table4707827104">
<thead><tr><th>Source_Name</th><th>Analysis_Reference</th><th>Source_Class</th><th>Identified_Object</th><th>Gamma_Cat_Source_ID</th></tr></thead>
<thead><tr><th>str16</th><th>str6</th><th>str10</th><th>str20</th><th>str7</th></tr></thead>
<tr><td>HESS J0835-455</td><td>HGPS</td><td>PWN</td><td>Vela X</td><td>37</td></tr>
</table></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Columns are accessed by indexing into the table</span>
<span class="c1"># with a column name string</span>
<span class="c1"># Then you can slice the column to get the rows you want</span>
<span class="n">table</span><span class="p">[</span><span class="s2">&quot;Source_Name&quot;</span><span class="p">][:</span><span class="mi">5</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[14]:
</pre></div>
</div>
<div class="output_area docutils container">
&lt;Column name=&apos;Source_Name&apos; dtype=&apos;str16&apos; length=5&gt;
<table>
<tr><td>HESS J0835-455</td></tr>
<tr><td>HESS J0852-463</td></tr>
<tr><td>HESS J1018-589 A</td></tr>
<tr><td>HESS J1018-589 B</td></tr>
<tr><td>HESS J1023-575</td></tr>
</table></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Accessing a given element of the table like this</span>
<span class="n">table</span><span class="p">[</span><span class="s2">&quot;Source_Name&quot;</span><span class="p">][</span><span class="mi">5</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[15]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>&#39;HESS J1026-582&#39;
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># If you know some Python and Numpy, you can now start</span>
<span class="c1"># to ask questions about the HGPS data.</span>
<span class="c1"># Just to give one example: &quot;What spatial models are used?&quot;</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">set</span><span class="p">(</span><span class="n">table</span><span class="p">[</span><span class="s2">&quot;Spatial_Model&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[17]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>{&#39;2-Gaussian&#39;, &#39;3-Gaussian&#39;, &#39;Gaussian&#39;, &#39;Point-Like&#39;, &#39;Shell&#39;}
</pre></div>
</div>
</div>
</div>
<div class="section" id="Convert-formats">
<h3>Convert formats<a class="headerlink" href="#Convert-formats" title="Permalink to this headline">¶</a></h3>
<p>The HGPS catalog is only released in FITS format.</p>
<p>We didn’t provide multiple formats (DS9, CSV, XML, VOTABLE, …) because
everyone needs something a little different (in terms of format or
content). Instead, here we show how you can convert to any format /
content you like wiht a few lines of Python.</p>
<div class="section" id="DS9-region-format">
<h4>DS9 region format<a class="headerlink" href="#DS9-region-format" title="Permalink to this headline">¶</a></h4>
<p>At <a class="reference external" href="https://fermi.gsfc.nasa.gov/ssc/data/access/lat/4yr_catalog/">Fermi-LAT 3FGL
webpage</a>,
we see that they also provide <a class="reference external" href="http://ds9.si.edu/doc/ref/region.html">DS9 region
files</a> that look like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">global</span> <span class="n">color</span><span class="o">=</span><span class="n">red</span>
<span class="n">fk5</span><span class="p">;</span><span class="n">point</span><span class="p">(</span>   <span class="mf">0.0377</span><span class="p">,</span> <span class="mf">65.7517</span><span class="p">)</span><span class="c1"># point=cross text={3FGL J0000.1+6545}</span>
<span class="n">fk5</span><span class="p">;</span><span class="n">point</span><span class="p">(</span>   <span class="mf">0.0612</span><span class="p">,</span><span class="o">-</span><span class="mf">37.6484</span><span class="p">)</span><span class="c1"># point=cross text={3FGL J0000.2-3738}</span>
<span class="n">fk5</span><span class="p">;</span><span class="n">point</span><span class="p">(</span>   <span class="mf">0.2535</span><span class="p">,</span> <span class="mf">63.2440</span><span class="p">)</span><span class="c1"># point=cross text={3FGL J0001.0+6314}</span>
<span class="o">...</span> <span class="n">more</span> <span class="n">lines</span><span class="p">,</span> <span class="n">one</span> <span class="k">for</span> <span class="n">each</span> <span class="n">source</span> <span class="o">...</span>
</pre></div>
</div>
<p>because many people use <a class="reference external" href="http://ds9.si.edu/">DS9</a> to view
astronomical images, and to overplot catalog data.</p>
<p>Let’s convert the HGPS catalog into this format. (to avoid very long
text output, we use <code class="docutils literal notranslate"><span class="pre">table[:3]</span></code> to just use the first three rows)</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">lines</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;global color=red&quot;</span><span class="p">]</span>
<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">table</span><span class="p">[:</span><span class="mi">3</span><span class="p">]:</span>
    <span class="n">fmt</span> <span class="o">=</span> <span class="s2">&quot;fk5;point({:.5f},{:.5f})# point=cross text={{{}}}&quot;</span>
    <span class="n">vals</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;RAJ2000&quot;</span><span class="p">],</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;DEJ2000&quot;</span><span class="p">],</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;Source_Name&quot;</span><span class="p">]</span>
    <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">*</span><span class="n">vals</span><span class="p">))</span>
<span class="n">txt</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># To save it to a DS9 region text file</span>
<span class="n">path</span> <span class="o">=</span> <span class="n">hgps_data_path</span> <span class="o">/</span> <span class="s2">&quot;hgps_my_format.reg&quot;</span>
<span class="n">path</span><span class="o">.</span><span class="n">write_text</span><span class="p">(</span><span class="n">txt</span><span class="p">)</span>

<span class="c1"># Print content of the file to check</span>
<span class="k">print</span><span class="p">(</span><span class="n">path</span><span class="o">.</span><span class="n">read_text</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
global color=red
fk5;point(128.88670,-45.65894)# point=cross text={HESS J0835-455}
fk5;point(133.00000,-46.37000)# point=cross text={HESS J0852-463}
fk5;point(154.74777,-58.93176)# point=cross text={HESS J1018-589 A}
</pre></div></div>
</div>
<p>Note that there is an extra package
<a class="reference external" href="https://astropy-regions.readthedocs.io/">astropy-regions</a> that has
classes to represent region objects and supports the DS9 format. We
could have used that to generate the DS9 region strings, or we could use
it to read the DS9 region file via:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">regions</span>
<span class="n">region_list</span> <span class="o">=</span> <span class="n">regions</span><span class="o">.</span><span class="n">ds9</span><span class="o">.</span><span class="n">read_ds9</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">path</span><span class="p">))</span>
</pre></div>
</div>
<p>We will not show examples how to work with regions or how to do
region-based analyses here, but if you want to do something like
e.g.&nbsp;measure the total flux in a given region in the HGPS maps, the
region package would be useful.</p>
</div>
<div class="section" id="CSV-format">
<h4>CSV format<a class="headerlink" href="#CSV-format" title="Permalink to this headline">¶</a></h4>
<p>Let’s do one more example, converting part of the HGPS catalog table
information to CSV, i.e.&nbsp;comma-separated format. This is a format that
can be read by any tool for tabular data, e.g.&nbsp;if you are using Excel or
ROOT for your gamma-ray data analysis, this section is for you!</p>
<p>Usually you can just use the CSV writer in Astropy like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">path</span> <span class="o">=</span> <span class="n">hgps_data_path</span> <span class="o">/</span> <span class="s1">&#39;hgps_my_format.csv&#39;</span>
<span class="n">table</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">path</span><span class="p">),</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;ascii.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>However, this doesn’t work here for two reasons:</p>
<ol class="arabic simple">
<li>this table contains metadata that trips up the Astropy CSV writer (I
filed an <a class="reference external" href="https://github.com/astropy/astropy/issues/7357">issue</a>
with Astropy)</li>
<li>this table contains array-valued columns for the spectral points and
CSV can only have scalar values.</li>
</ol>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># This is the problematic header key</span>
<span class="n">table</span><span class="o">.</span><span class="n">meta</span><span class="p">[</span><span class="s2">&quot;comments&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[20]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>[&#39;This is part of the HESS Galactic plane survey (HGPS) data.&#39;,
 &#39;&#39;,
 &#39;    Paper: https://doi.org/10.1051/0004-6361/201732098&#39;,
 &#39;    Webpage: https://www.mpi-hd.mpg.de/hfm/HESS/hgps&#39;,
 &#39;    Contact: contact@hess-experiment.eu&#39;,
 &#39;&#39;,
 &#39;The HGPS observations were taken from 2004 to 2013.&#39;,
 &#39;The paper was published and this data was released in April 2018.&#39;,
 &#39;&#39;,
 &#39;A detailed description is available in the paper.&#39;]
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># These are the array-valued columns</span>
<span class="n">array_colnames</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span>
    <span class="n">name</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">table</span><span class="o">.</span><span class="n">colnames</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">table</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span>
<span class="p">)</span>
<span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">array_colnames</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">table</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Flux_Points_Energy (78, 40)
Flux_Points_Energy_Min (78, 40)
Flux_Points_Energy_Max (78, 40)
Flux_Points_Flux (78, 40)
Flux_Points_Flux_Err_Lo (78, 40)
Flux_Points_Flux_Err_Hi (78, 40)
Flux_Points_Flux_UL (78, 40)
Flux_Points_Flux_Is_UL (78, 40)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># So each source has an array of spectral flux points,</span>
<span class="c1"># and FITS allows storing such arrays in table cells</span>
<span class="c1"># Knowing this, you could work with the spectral points directly.</span>
<span class="c1"># We won&#39;t give an example here; but instead show how to work</span>
<span class="c1"># with HGPS spectra in the Gammapy section below, because it&#39;s easier.</span>
<span class="k">print</span><span class="p">(</span><span class="n">table</span><span class="p">[</span><span class="s2">&quot;Flux_Points_Energy&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
<span class="k">print</span><span class="p">(</span><span class="n">table</span><span class="p">[</span><span class="s2">&quot;Flux_Points_Flux&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[  0.42169651   0.9531619    2.26030302   5.36002302  12.71061802
  30.14162445          nan          nan          nan          nan
          nan          nan          nan          nan          nan
          nan          nan          nan          nan          nan
          nan          nan          nan          nan          nan
          nan          nan          nan          nan          nan
          nan          nan          nan          nan          nan
          nan          nan          nan          nan          nan]
[  6.55417665e-11   1.19860311e-11   3.52555008e-12   8.32411180e-13
   1.59623955e-13   1.11618885e-14              nan              nan
              nan              nan              nan              nan
              nan              nan              nan              nan
              nan              nan              nan              nan
              nan              nan              nan              nan
              nan              nan              nan              nan
              nan              nan              nan              nan
              nan              nan              nan              nan
              nan              nan              nan              nan]
</pre></div></div>
</div>
<p>Let’s get back to our actual goal of converting part of the HGPS catalog
table data to CSV format. The following code makes a copy of the table
that contains just the scalar columns, then removes the <code class="docutils literal notranslate"><span class="pre">meta</span></code>
information (most CSV variants / readers don’t support metadata anyways)
and writes a CSV file.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">scalar_colnames</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span>
    <span class="n">name</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">table</span><span class="o">.</span><span class="n">colnames</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">table</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">1</span>
<span class="p">)</span>
<span class="n">table2</span> <span class="o">=</span> <span class="n">table</span><span class="p">[</span><span class="n">scalar_colnames</span><span class="p">]</span>
<span class="n">table2</span><span class="o">.</span><span class="n">meta</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">path</span> <span class="o">=</span> <span class="n">hgps_data_path</span> <span class="o">/</span> <span class="s2">&quot;hgps_my_format.csv&quot;</span>
<span class="n">table2</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">path</span><span class="p">),</span> <span class="n">format</span><span class="o">=</span><span class="s2">&quot;ascii.csv&quot;</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>The Astropy ASCII writer and reader supports many variants. Let’s do one
more example, using the <code class="docutils literal notranslate"><span class="pre">ascii.fixed_width</span></code> format which is a bit
easier to read for humans. We will just select a few columns and rows to
print here.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">table2</span> <span class="o">=</span> <span class="n">table</span><span class="p">[</span><span class="s2">&quot;Source_Name&quot;</span><span class="p">,</span> <span class="s2">&quot;GLON&quot;</span><span class="p">,</span> <span class="s2">&quot;GLAT&quot;</span><span class="p">][:</span><span class="mi">3</span><span class="p">]</span>
<span class="n">table2</span><span class="o">.</span><span class="n">meta</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">table2</span><span class="p">[</span><span class="s2">&quot;Source_Name&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="s2">&quot;&lt;20s&quot;</span>
<span class="n">table2</span><span class="p">[</span><span class="s2">&quot;GLON&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="s2">&quot;&gt;8.3f&quot;</span>
<span class="n">table2</span><span class="p">[</span><span class="s2">&quot;GLAT&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="s2">&quot;&gt;8.3f&quot;</span>
<span class="n">path</span> <span class="o">=</span> <span class="n">hgps_data_path</span> <span class="o">/</span> <span class="s2">&quot;hgps_my_format.csv&quot;</span>
<span class="n">table2</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">path</span><span class="p">),</span> <span class="n">format</span><span class="o">=</span><span class="s2">&quot;ascii.fixed_width&quot;</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="c1"># Print the CSV file contents to check what we have</span>
<span class="k">print</span><span class="p">(</span><span class="n">path</span><span class="o">.</span><span class="n">read_text</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
|          Source_Name |     GLON |     GLAT |
| HESS J0835-455       |  263.960 |   -3.048 |
| HESS J0852-463       |  266.287 |   -1.243 |
| HESS J1018-589 A     |  284.351 |   -1.674 |

</pre></div></div>
</div>
<p>Now you know how to work with the HGPS catalog with Python and Astropy.
For the other tables (e.g. <code class="docutils literal notranslate"><span class="pre">HGPS_GAUSS_COMPONENTS</span></code>) it’s the same: you
should read the description in the HGPS paper, then access the
information you need or convert it to the format you want as shows for
<code class="docutils literal notranslate"><span class="pre">HGPS_SOURCES</span></code> here). Let’s move on and have a look at the HGPS maps.</p>
</div>
</div>
</div>
<div class="section" id="Maps-with-Astropy">
<h2>Maps with Astropy<a class="headerlink" href="#Maps-with-Astropy" title="Permalink to this headline">¶</a></h2>
<p>This section shows how to load an HGPS survey map with Astropy, and give
examples how to work with sky and pixel coordinates to read off map
values at given positions.</p>
<p>We will keep it short, for further examples see the “Maps with Gammapy”
section below.</p>
<div class="section" id="Read">
<h3>Read<a class="headerlink" href="#Read" title="Permalink to this headline">¶</a></h3>
<p>To read the map, use <code class="docutils literal notranslate"><span class="pre">fits.open</span></code> to get an <code class="docutils literal notranslate"><span class="pre">HDUList</span></code> object, then
access <code class="docutils literal notranslate"><span class="pre">[0]</span></code> to get the first and only image HDU in the FITS file, and
finally use the <code class="docutils literal notranslate"><span class="pre">hdu.data</span></code> Numpy array, <code class="docutils literal notranslate"><span class="pre">hdu.header</span></code> header object
or <code class="docutils literal notranslate"><span class="pre">wcs</span> <span class="pre">=</span> <span class="pre">WCS(hdu.header)</span></code> WCS object to work with the data.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">path</span> <span class="o">=</span> <span class="n">hgps_data_path</span> <span class="o">/</span> <span class="s2">&quot;hgps_map_significance_0.1deg_v1.fits.gz&quot;</span>
<span class="n">hdu_list</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">path</span><span class="p">))</span>
<span class="n">hdu_list</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Filename: hgps_data/hgps_map_significance_0.1deg_v1.fits.gz
No.    Name      Ver    Type      Cards   Dimensions   Format
  0  Significance    1 PrimaryHDU      30   (9400, 500)   float32
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">hdu</span> <span class="o">=</span> <span class="n">hdu_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">type</span><span class="p">(</span><span class="n">hdu</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[26]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>astropy.io.fits.hdu.image.PrimaryHDU
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">type</span><span class="p">(</span><span class="n">hdu</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[27]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>numpy.ndarray
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">hdu</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[28]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>(500, 9400)
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [29]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># The FITS header contains the information about the</span>
<span class="c1"># WCS projection, i.e. the pixel to sky coordinate transform</span>
<span class="n">hdu</span><span class="o">.</span><span class="n">header</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[29]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>SIMPLE  =                    T / conforms to FITS standard
BITPIX  =                  -32 / array data type
NAXIS   =                    2 / number of array dimensions
NAXIS1  =                 9400
NAXIS2  =                  500
EXTNAME = &#39;Significance&#39;
HDUNAME = &#39;Significance&#39;
CTYPE1  = &#39;GLON-CAR&#39;           / Type of co-ordinate on axis 1
CTYPE2  = &#39;GLAT-CAR&#39;           / Type of co-ordinate on axis 2
EQUINOX =                2000. / [yr] Epoch of reference equinox
CRPIX1  =               4700.5 / Reference pixel on axis 1
CRPIX2  =                250.5 / Reference pixel on axis 2
CRVAL1  =                  341 / Value at ref. pixel on axis 1
CRVAL2  =                    0 / Value at ref. pixel on axis 2
CDELT1  =                -0.02 / Pixel size on axis 1
CDELT2  =                 0.02 / Pixel size on axis 2
CUNIT1  = &#39;deg     &#39;           / units of  CRVAL1 and  CDELT1
CUNIT2  = &#39;deg     &#39;           / units of  CRVAL2 and  CDELT2
TELESCOP= &#39;H.E.S.S.&#39;           / name of telescope
ORIGIN  = &#39;The H.E.S.S. Collaboration&#39; / organization responsible for the data
COMMENT This is part of the HESS Galactic plane survey (HGPS) data.
COMMENT
COMMENT     Paper: https://doi.org/10.1051/0004-6361/201732098
COMMENT     Webpage: https://www.mpi-hd.mpg.de/hfm/HESS/hgps
COMMENT     Contact: contact@hess-experiment.eu
COMMENT
COMMENT The HGPS observations were taken from 2004 to 2013.
COMMENT The paper was published and this data was released in April 2018.
COMMENT
COMMENT A detailed description is available in the paper.
</pre></div>
</div>
</div>
</div>
<div class="section" id="WCS-and-coordinates">
<h3>WCS and coordinates<a class="headerlink" href="#WCS-and-coordinates" title="Permalink to this headline">¶</a></h3>
<p>To actually do pixel to sky coordinate transformations, you have to
create a “Word coordinate system transform (WCS)” object from the FITS
header.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [30]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">wcs</span> <span class="o">=</span> <span class="n">WCS</span><span class="p">(</span><span class="n">hdu</span><span class="o">.</span><span class="n">header</span><span class="p">)</span>
<span class="n">wcs</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[30]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>WCS Keywords

Number of WCS axes: 2
CTYPE : &#39;GLON-CAR&#39;  &#39;GLAT-CAR&#39;
CRVAL : 341.0  0.0
CRPIX : 4700.5  250.5
PC1_1 PC1_2  : 1.0  0.0
PC2_1 PC2_2  : 0.0  1.0
CDELT : -0.02  0.02
NAXIS : 9400  500
</pre></div>
</div>
</div>
<p>Let’s find the (arguably) most interesting pixel in the HGPS map and
look up it’s value in the significance image.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [31]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># pos = SkyCoord.from_name(&#39;Sgr A*&#39;)</span>
<span class="n">pos</span> <span class="o">=</span> <span class="n">SkyCoord</span><span class="p">(</span><span class="mf">266.416826</span><span class="p">,</span> <span class="o">-</span><span class="mf">29.007797</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="s2">&quot;deg&quot;</span><span class="p">)</span>
<span class="n">pos</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[31]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>&lt;SkyCoord (ICRS): (ra, dec) in deg
    ( 266.416826, -29.007797)&gt;
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [32]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">xp</span><span class="p">,</span> <span class="n">yp</span> <span class="o">=</span> <span class="n">pos</span><span class="o">.</span><span class="n">to_pixel</span><span class="p">(</span><span class="n">wcs</span><span class="p">)</span>
<span class="n">xp</span><span class="p">,</span> <span class="n">yp</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[32]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>(array(3752.286808396431), array(247.19237757373006))
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [33]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Note that SkyCoord makes it easy to transform</span>
<span class="c1"># to other frames, and it knows about the frame</span>
<span class="c1"># of the WCS object, so for HGPS we have `frame=&quot;galactic&quot;`</span>
<span class="c1"># and in the call above the transformation from ICRS</span>
<span class="c1"># to Galactic and then to pixel all happened in the</span>
<span class="c1"># `pos.to_pixel` call. This gives the same pixel postion:</span>
<span class="k">print</span><span class="p">(</span><span class="n">pos</span><span class="o">.</span><span class="n">galactic</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">pos</span><span class="o">.</span><span class="n">galactic</span><span class="o">.</span><span class="n">to_pixel</span><span class="p">(</span><span class="n">wcs</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;SkyCoord (Galactic): (l, b) in deg
    ( 359.94426383, -0.04615245)&gt;
(array(3752.286808396431), array(247.19237757373006))
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [34]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># FITS WCS and Numpy have opposite array axis order</span>
<span class="c1"># So to look up a pixel in the `hdu.data` Numpy array,</span>
<span class="c1"># we need to switch to (y, x), and we also need to</span>
<span class="c1"># round correctly to the nearest int, thus the `+ 0.5`</span>
<span class="n">idx</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">yp</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">xp</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">)</span>
<span class="n">idx</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[34]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>(247, 3752)
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [35]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Now, finally the value of this pixel</span>
<span class="n">hdu</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[35]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>89.49691
</pre></div>
</div>
</div>
<p>Note that this is a significance map with correlation radius 0.1 deg.
That means that within a circle of radius 0.1 deg around the pixel
center, the signal has a significance of 74.2 sigma.</p>
<p>This does not directly correspond to the significance of a gamma-ray
source, because this circle contains emission from multiple sources and
underlying diffuse emission, and for the sources in this circle their
emission isn’t fully contained because of the size of the HESS PSF.</p>
<p>We remind you of the caveat the HGPS paper (see Appendix A) that it is
not possible to do a detailed quantitative measurement on the released
HGPS maps; the measurements in the HGPS paper were done using likelihood
fits on uncorrelated counts images taking the PSF shape into account.</p>
<p>Let’s do one more exercise: find the sky position for the pixel with the
highest significance:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [36]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># The pixel with the maximum significance</span>
<span class="n">hdu</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[36]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>89.49691
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [37]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># So it is the pixel in the HGPS map that contains Sgr A*</span>
<span class="c1"># and we already roughly know it&#39;s position</span>
<span class="c1"># Still, let&#39;s find the exact pixel center sky position</span>

<span class="c1"># We use `np.nanargmax` to find the index, but it&#39;s an index</span>
<span class="c1"># into the flattened array, so we have to &quot;unravel&quot; it to get a 2D index</span>
<span class="n">yp</span><span class="p">,</span> <span class="n">xp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unravel_index</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nanargmax</span><span class="p">(</span><span class="n">hdu</span><span class="o">.</span><span class="n">data</span><span class="p">),</span> <span class="n">hdu</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">yp</span><span class="p">,</span> <span class="n">xp</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[37]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>(247, 3752)
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [38]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">pos</span> <span class="o">=</span> <span class="n">SkyCoord</span><span class="o">.</span><span class="n">from_pixel</span><span class="p">(</span><span class="n">xp</span><span class="p">,</span> <span class="n">yp</span><span class="p">,</span> <span class="n">wcs</span><span class="p">)</span>
<span class="n">pos</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[38]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>&lt;SkyCoord (Galactic): (l, b) in deg
    ( 359.95, -0.05)&gt;
</pre></div>
</div>
</div>
<p>As you can see, working with FITS images and sky / pixel coordinates
directly requires that you learn how to use the WCS object and Numpy
arrays and to know that the axis order is <code class="docutils literal notranslate"><span class="pre">(x,</span> <span class="pre">y)</span></code> in FITS and WCS,
but <code class="docutils literal notranslate"><span class="pre">(row,</span> <span class="pre">column)</span></code>, i.e. <code class="docutils literal notranslate"><span class="pre">(y,</span> <span class="pre">x)</span></code> in Numpy. It seems quite complex
at first, but most astronomers get used to it and manage after a while.
<code class="docutils literal notranslate"><span class="pre">gammapy.maps.WcsNDMap</span></code> is a wrapper class that is a bit simpler to
use (see below), but under the hood it just calls these Numpy and
Astropy methods for you, so it’s good to know what is going on in any
case.</p>
</div>
</div>
<div class="section" id="Catalog-with-Gammapy">
<h2>Catalog with Gammapy<a class="headerlink" href="#Catalog-with-Gammapy" title="Permalink to this headline">¶</a></h2>
<p>As you have seen above, working with the HGPS FITS catalog data using
Astropy is pretty nice. But still, there are some common tasks that
aren’t trivial to do and require reading the FITS table description in
detail and writing quite a bit of Python code.</p>
<p>So that you don’t have to, we have done this for HGPS in
<a class="reference internal" href="../api/gammapy.catalog.SourceCatalogHGPS.html"><span class="doc">gammapy.catalog.SourceCatalogHGPS</span></a>
and also for a few other catalogs that are commonly used in gamma-ray
astronomy in <a class="reference internal" href="../catalog/index.html"><span class="doc">gammapy.catalog</span></a>.</p>
<div class="section" id="Read">
<h3>Read<a class="headerlink" href="#Read" title="Permalink to this headline">¶</a></h3>
<p>Let’s start by reading the HGPS catalog via the <code class="docutils literal notranslate"><span class="pre">SourceCatalogHGPS</span></code>
class (which is just a wrapper class for <code class="docutils literal notranslate"><span class="pre">astropy.table.Table</span></code>) and
access some information about a given source. Feel free to choose any
source you like here: we have chosen simply the first one on the table:
the pulsar-wind nebula Vela X, a large and bright TeV source around the
<a class="reference external" href="https://en.wikipedia.org/wiki/Vela_Pulsar">Vela pulsar</a>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [39]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">path</span> <span class="o">=</span> <span class="n">hgps_data_path</span> <span class="o">/</span> <span class="s2">&quot;hgps_catalog_v1.fits.gz&quot;</span>
<span class="n">cat</span> <span class="o">=</span> <span class="n">SourceCatalogHGPS</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Tables">
<h3>Tables<a class="headerlink" href="#Tables" title="Permalink to this headline">¶</a></h3>
<p>Now all tables from the FITS file were loaded and stored on the <code class="docutils literal notranslate"><span class="pre">cat</span></code>
object. See the
<a class="reference internal" href="../api/gammapy.catalog.SourceCatalogHGPS.html"><span class="doc">SourceCatalogHGPS</span></a>
docs, or just try accessing one:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [40]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">cat</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">meta</span><span class="p">[</span><span class="s2">&quot;EXTNAME&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[40]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>&#39;HGPS_SOURCES&#39;
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [41]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">cat</span><span class="o">.</span><span class="n">table_components</span><span class="o">.</span><span class="n">meta</span><span class="p">[</span><span class="s2">&quot;EXTNAME&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[41]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>&#39;HGPS_GAUSS_COMPONENTS&#39;
</pre></div>
</div>
</div>
</div>
<div class="section" id="Source">
<h3>Source<a class="headerlink" href="#Source" title="Permalink to this headline">¶</a></h3>
<p>You can access a given source by row index (starting at zero) or by
source name. This creates
<a class="reference internal" href="../api/gammapy.catalog.SourceCatalogObjectHGPS.html"><span class="doc">SourceCatalogObjectHGPS</span></a>
objects that have a copy of all the data for a given source. See the
class docs for a full overview.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [42]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># These all give the same source object</span>
<span class="n">source</span> <span class="o">=</span> <span class="n">cat</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="c1"># When accessing by name, the value has to match exactly</span>
<span class="c1"># the content from one of these columns:</span>
<span class="c1"># `Source_Name` or `Identified_Object`</span>
<span class="c1"># which in this case are &quot;HESS J0835-455&quot; and &quot;Vela X&quot;</span>
<span class="n">source</span> <span class="o">=</span> <span class="n">cat</span><span class="p">[</span><span class="s2">&quot;HESS J0835-455&quot;</span><span class="p">]</span>
<span class="n">source</span> <span class="o">=</span> <span class="n">cat</span><span class="p">[</span><span class="s2">&quot;Vela X&quot;</span><span class="p">]</span>
<span class="n">source</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[42]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>SourceCatalogObjectHGPS(&#39;HESS J0835-455&#39;)
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [43]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># To see a pretty-printed text version of all</span>
<span class="c1"># HGPS data on a given source:</span>
<span class="k">print</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

*** Basic info ***

Catalog row index (zero-based) : 0
Source name          : HESS J0835-455
Analysis reference   : HGPS
Source class         : PWN
Identified object    : Vela X
Gamma-Cat id         : 37


*** Info from map analysis ***

RA                   :  128.887 deg = 8h35m33s
DEC                  :  -45.659 deg = -45d39m32s
GLON                 :  263.960 +/- 0.025 deg
GLAT                 :   -3.048 +/- 0.027 deg
Position Error (68%) : 0.057 deg
Position Error (95%) : 0.093 deg
ROI number           : 18
Spatial model        : 3-Gaussian
Spatial components   : HGPSC 001, HGPSC 002, HGPSC 003
TS                   : 1553.2
sqrt(TS)             : 39.4
Size                 : 0.585 +/- 0.052 (UL: nan) deg
R70                  : 0.887 deg
RSpec                : 0.500 deg
Total model excess   : 8781.6
Excess in RSpec      : 3580.1
Model Excess in RSpec : 3637.4
Background in RSpec  : 5936.9
Livetime             : 64.9 hours
Energy threshold     : 0.47 TeV
Source flux (&gt;1 TeV) : (15.362 +/- 0.534) x 10^-12 cm^-2 s^-1 = (67.97 +/- 2.36) % Crab

Fluxes in RSpec (&gt; 1 TeV):
Map measurement                : 5.571 x 10^-12 cm^-2 s^-1 = 24.65 % Crab
Source model                   : 5.659 x 10^-12 cm^-2 s^-1 = 25.04 % Crab
Other component model          : 0.000 x 10^-12 cm^-2 s^-1 =  0.00 % Crab
Large scale component model    : 0.000 x 10^-12 cm^-2 s^-1 =  0.00 % Crab
Total model                    : 5.659 x 10^-12 cm^-2 s^-1 = 25.04 % Crab
Containment in RSpec                :  36.8 %
Contamination in RSpec              :   0.0 %
Flux correction (RSpec -&gt; Total)    : 271.4 %
Flux correction (Total -&gt; RSpec)    :  36.8 %

*** Info from spectral analysis ***

Livetime             : 18.8 hours
Energy range:        : 0.29 to 61.90 TeV
Background           : 9993.6
Excess               : 2584.4
Spectral model       : ECPL
TS ECPL over PL      : 43.0
Best-fit model flux(&gt; 1 TeV) : (17.433 +/- 1.404) x 10^-12 cm^-2 s^-1  = (77.14 +/- 6.21) % Crab
Best-fit model energy flux(1 to 10 TeV) : (76.057 +/- 7.100) x 10^-12 erg cm^-2 s^-1
Pivot energy         : 3.02 TeV
Flux at pivot energy : (1.833 +/- 0.070) x 10^-12 cm^-2 s^-1 TeV^-1  = (8.11 +/- 0.20) % Crab
PL   Flux(&gt; 1 TeV)   : (16.574 +/- 0.632) x 10^-12 cm^-2 s^-1  = (73.34 +/- 2.80) % Crab
PL   Flux(@ 1 TeV)   : (14.805 +/- 0.737) x 10^-12 cm^-2 s^-1 TeV^-1  = (65.51 +/- 2.10) % Crab
PL   Index           : 1.89 +/- 0.03
ECPL   Flux(@ 1 TeV) : (12.089 +/- 0.869) x 10^-12 cm^-2 s^-1 TeV^-1  = (53.49 +/- 2.48) % Crab
ECPL   Flux(&gt; 1 TeV) : (17.433 +/- 1.404) x 10^-12 cm^-2 s^-1  = (77.14 +/- 6.21) % Crab
ECPL Index           : 1.35 +/- 0.08
ECPL Lambda          : 0.082 +/- 0.012 TeV^-1
ECPL E_cut           : 12.27 +/- 1.74 TeV

*** Flux points info ***

Number of flux points: 6
Flux points table:

e_ref  e_min  e_max        dnde         dnde_errn       dnde_errp        dnde_ul     is_ul
 TeV    TeV    TeV   1 / (cm2 s TeV) 1 / (cm2 s TeV) 1 / (cm2 s TeV) 1 / (cm2 s TeV)
------ ------ ------ --------------- --------------- --------------- --------------- -----
 0.422  0.287  0.619       6.554e-11       1.050e-11       1.038e-11       8.637e-11 False
 0.953  0.619  1.468       1.199e-11       1.292e-12       1.289e-12       1.453e-11 False
 2.260  1.468  3.481       3.526e-12       2.358e-13       2.408e-13       4.018e-12 False
 5.360  3.481  8.254       8.324e-13       5.496e-14       5.620e-14       9.496e-13 False
12.711  8.254 19.573       1.596e-13       1.323e-14       1.349e-14       1.870e-13 False
30.142 19.573 46.416       1.116e-14       2.189e-15       2.323e-15       1.599e-14 False

*** Gaussian component info ***

Number of components: 3
Spatial components   : HGPSC 001, HGPSC 002, HGPSC 003

Component HGPSC 001:
GLON                 :  263.969 +/- 0.023 deg
GLAT                 :   -3.344 +/- 0.027 deg
Size                 : 0.237 +/- 0.023 deg
Flux (&gt;1 TeV)        : (2.76 +/- 0.52) x 10^-12 cm^-2 s^-1 = (12.2 +/- 2.3) % Crab

Component HGPSC 002:
GLON                 :  263.699 +/- 0.021 deg
GLAT                 :   -2.827 +/- 0.037 deg
Size                 : 0.156 +/- 0.018 deg
Flux (&gt;1 TeV)        : (1.08 +/- 0.21) x 10^-12 cm^-2 s^-1 = (4.8 +/- 0.9) % Crab

Component HGPSC 003:
GLON                 :  263.983 +/- 0.033 deg
GLAT                 :   -2.997 +/- 0.046 deg
Size                 : 0.650 +/- 0.027 deg
Flux (&gt;1 TeV)        : (11.52 +/- 0.73) x 10^-12 cm^-2 s^-1 = (51.0 +/- 3.2) % Crab


*** Source associations info ***

 Source_Name   Association_Catalog  Association_Name Separation
                                                        deg
-------------- ------------------- ----------------- ----------
HESS J0835-455                2FHL 2FHL J0835.3-4511   0.473783
HESS J0835-455                3FGL 3FGL J0835.3-4510   0.481869
HESS J0835-455                COMP        G263.9-3.3   0.321304
HESS J0835-455                 PSR          B0833-45   0.483905

*** Source identification info ***

Source_Name: HESS J0835-455
Identified_Object: Vela X
Class: PWN
Evidence: Morphology
Reference: 2006A%26A...448L..43A
Distance_Reference: SNRCat
Distance: 0.2750000059604645 kpc
Distance_Min: 0.25 kpc
Distance_Max: 0.30000001192092896 kpc

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [44]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># You can also more selectively print subsets of info:</span>
<span class="k">print</span><span class="p">(</span><span class="n">source</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;map&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

*** Info from map analysis ***

RA                   :  128.887 deg = 8h35m33s
DEC                  :  -45.659 deg = -45d39m32s
GLON                 :  263.960 +/- 0.025 deg
GLAT                 :   -3.048 +/- 0.027 deg
Position Error (68%) : 0.057 deg
Position Error (95%) : 0.093 deg
ROI number           : 18
Spatial model        : 3-Gaussian
Spatial components   : HGPSC 001, HGPSC 002, HGPSC 003
TS                   : 1553.2
sqrt(TS)             : 39.4
Size                 : 0.585 +/- 0.052 (UL: nan) deg
R70                  : 0.887 deg
RSpec                : 0.500 deg
Total model excess   : 8781.6
Excess in RSpec      : 3580.1
Model Excess in RSpec : 3637.4
Background in RSpec  : 5936.9
Livetime             : 64.9 hours
Energy threshold     : 0.47 TeV
Source flux (&gt;1 TeV) : (15.362 +/- 0.534) x 10^-12 cm^-2 s^-1 = (67.97 +/- 2.36) % Crab

Fluxes in RSpec (&gt; 1 TeV):
Map measurement                : 5.571 x 10^-12 cm^-2 s^-1 = 24.65 % Crab
Source model                   : 5.659 x 10^-12 cm^-2 s^-1 = 25.04 % Crab
Other component model          : 0.000 x 10^-12 cm^-2 s^-1 =  0.00 % Crab
Large scale component model    : 0.000 x 10^-12 cm^-2 s^-1 =  0.00 % Crab
Total model                    : 5.659 x 10^-12 cm^-2 s^-1 = 25.04 % Crab
Containment in RSpec                :  36.8 %
Contamination in RSpec              :   0.0 %
Flux correction (RSpec -&gt; Total)    : 271.4 %
Flux correction (Total -&gt; RSpec)    :  36.8 %

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [45]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># All of the data for this source is available</span>
<span class="c1"># via the `source.data` dictionary if you want</span>
<span class="c1"># to do some computations</span>
<span class="n">source</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;Flux_Spec_Int_1TeV&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[45]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="math notranslate nohighlight">
$1.7432536 \times 10^{-11} \; \mathrm{\frac{1}{s\,cm^{2}}}$</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [46]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># The flux points are available as a Table</span>
<span class="n">source</span><span class="o">.</span><span class="n">flux_points</span><span class="o">.</span><span class="n">table</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[46]:
</pre></div>
</div>
<div class="output_area docutils container">
<i>Table length=6</i>
<table id="table4687937040" class="table-striped table-bordered table-condensed">
<thead><tr><th>e_ref</th><th>e_min</th><th>e_max</th><th>dnde</th><th>dnde_errn</th><th>dnde_errp</th><th>dnde_ul</th><th>is_ul</th></tr></thead>
<thead><tr><th>TeV</th><th>TeV</th><th>TeV</th><th>1 / (cm2 s TeV)</th><th>1 / (cm2 s TeV)</th><th>1 / (cm2 s TeV)</th><th>1 / (cm2 s TeV)</th><th></th></tr></thead>
<thead><tr><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>bool</th></tr></thead>
<tr><td>0.421697</td><td>0.287298</td><td>0.618966</td><td>6.55418e-11</td><td>1.04995e-11</td><td>1.03791e-11</td><td>8.63693e-11</td><td>False</td></tr>
<tr><td>0.953162</td><td>0.618966</td><td>1.4678</td><td>1.1986e-11</td><td>1.29198e-12</td><td>1.28869e-12</td><td>1.45264e-11</td><td>False</td></tr>
<tr><td>2.2603</td><td>1.4678</td><td>3.4807</td><td>3.52555e-12</td><td>2.35769e-13</td><td>2.40822e-13</td><td>4.0179e-12</td><td>False</td></tr>
<tr><td>5.36002</td><td>3.4807</td><td>8.25404</td><td>8.32411e-13</td><td>5.49592e-14</td><td>5.62039e-14</td><td>9.49575e-13</td><td>False</td></tr>
<tr><td>12.7106</td><td>8.25404</td><td>19.5734</td><td>1.59624e-13</td><td>1.32323e-14</td><td>1.34932e-14</td><td>1.86966e-13</td><td>False</td></tr>
<tr><td>30.1416</td><td>19.5734</td><td>46.4159</td><td>1.11619e-14</td><td>2.1889e-15</td><td>2.32286e-15</td><td>1.59949e-14</td><td>False</td></tr>
</table></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [47]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># The spectral model is available as a</span>
<span class="c1"># Gammapy spectral model object:</span>
<span class="n">spectral_model</span> <span class="o">=</span> <span class="n">source</span><span class="o">.</span><span class="n">spectral_model</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="n">spectral_model</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
ExponentialCutoffPowerLaw

Parameters:

           name     value     error         unit      min max
        --------- --------- --------- --------------- --- ---
            index 1.354e+00 7.733e-02                 nan nan
        amplitude 6.408e-12 3.260e-13 1 / (cm2 s TeV) nan nan
        reference 1.697e+00 0.000e+00             TeV nan nan
          lambda_ 8.152e-02 1.154e-02         1 / TeV nan nan

Covariance:

           name     index   amplitude reference  lambda_
        --------- --------- --------- --------- ---------
            index 5.980e-03 0.000e+00 0.000e+00 0.000e+00
        amplitude 0.000e+00 1.063e-25 0.000e+00 0.000e+00
        reference 0.000e+00 0.000e+00 0.000e+00 0.000e+00
          lambda_ 0.000e+00 0.000e+00 0.000e+00 1.331e-04
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [48]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># One common task is to compute integral fluxes</span>
<span class="c1"># The error is computed using the covariance matrix</span>
<span class="c1"># (off-diagonal info not given in HGPS, i.e. this is an approximation)</span>
<span class="n">spectral_model</span><span class="o">.</span><span class="n">integral_error</span><span class="p">(</span><span class="n">emin</span><span class="o">=</span><span class="mi">1</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">TeV</span><span class="p">,</span> <span class="n">emax</span><span class="o">=</span><span class="mi">10</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">TeV</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[48]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="math notranslate nohighlight">
$[1.5950556 \times 10^{-11},~1.0744153 \times 10^{-12}] \; \mathrm{\frac{1}{s\,cm^{2}}}$</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [49]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Let&#39;s plot the spectrum</span>
<span class="n">source</span><span class="o">.</span><span class="n">spectral_model</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">source</span><span class="o">.</span><span class="n">energy_range</span><span class="p">)</span>
<span class="n">source</span><span class="o">.</span><span class="n">spectral_model</span><span class="p">()</span><span class="o">.</span><span class="n">plot_error</span><span class="p">(</span><span class="n">source</span><span class="o">.</span><span class="n">energy_range</span><span class="p">)</span>
<span class="n">source</span><span class="o">.</span><span class="n">flux_points</span><span class="o">.</span><span class="n">plot</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_hgps_70_0.png" src="../_images/notebooks_hgps_70_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [50]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Or let&#39;s make the same plot in the common</span>
<span class="c1"># format with y = E^2 * dnde</span>
<span class="n">opts</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">energy_power</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">flux_unit</span><span class="o">=</span><span class="s2">&quot;erg-1 cm-2 s-1&quot;</span><span class="p">)</span>
<span class="n">source</span><span class="o">.</span><span class="n">spectral_model</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">source</span><span class="o">.</span><span class="n">energy_range</span><span class="p">,</span> <span class="o">**</span><span class="n">opts</span><span class="p">)</span>
<span class="n">source</span><span class="o">.</span><span class="n">spectral_model</span><span class="p">()</span><span class="o">.</span><span class="n">plot_error</span><span class="p">(</span><span class="n">source</span><span class="o">.</span><span class="n">energy_range</span><span class="p">,</span> <span class="o">**</span><span class="n">opts</span><span class="p">)</span>
<span class="n">source</span><span class="o">.</span><span class="n">flux_points</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="o">**</span><span class="n">opts</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;E^2 dN/dE (erg cm-2 s-1)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Vela X HGPS spectrum&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_hgps_71_0.png" src="../_images/notebooks_hgps_71_0.png" />
</div>
</div>
<p>In the next section we will see how to work with the HGPS survey maps
from Gammapy, as well as work with other data from the catalog (position
and morphology information).</p>
</div>
</div>
<div class="section" id="Maps-with-Gammapy">
<h2>Maps with Gammapy<a class="headerlink" href="#Maps-with-Gammapy" title="Permalink to this headline">¶</a></h2>
<p>Let’s use the
<a class="reference internal" href="../api/gammapy.maps.Map.html#gammapy.maps.Map.read"><span class="std std-ref">gammapy.maps.Map.read</span></a>
method to load up the HGPS significance survey map.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [51]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">path</span> <span class="o">=</span> <span class="n">hgps_data_path</span> <span class="o">/</span> <span class="s2">&quot;hgps_map_significance_0.1deg_v1.fits.gz&quot;</span>
<span class="n">survey_map</span> <span class="o">=</span> <span class="n">Map</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [52]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Map has a quick-look plot method, but it&#39;s not</span>
<span class="c1"># very useful for a survey map that wide with default settings</span>
<span class="n">survey_map</span><span class="o">.</span><span class="n">plot</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_hgps_75_0.png" src="../_images/notebooks_hgps_75_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [53]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># This is a little better</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">survey_map</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">stretch</span><span class="o">=</span><span class="s2">&quot;sqrt&quot;</span><span class="p">)</span>
<span class="c1"># Note that we also assign the return value (a tuple)</span>
<span class="c1"># from the plot method call to a variable called `_`</span>
<span class="c1"># This is to avoid Jupyter printing it like in the last cell,</span>
<span class="c1"># and generally `_` is a variable name used in Python</span>
<span class="c1"># for things you don&#39;t want to name or care about at all</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_hgps_76_0.png" src="../_images/notebooks_hgps_76_0.png" />
</div>
</div>
<p>Let’s look at a cutout of the Galactic center:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [54]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">image</span> <span class="o">=</span> <span class="n">survey_map</span><span class="o">.</span><span class="n">cutout</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="p">(</span><span class="mf">3.8</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">)</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">stretch</span><span class="o">=</span><span class="s2">&quot;sqrt&quot;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;inferno&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="s2">&quot;dd&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="s2">&quot;dd&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_hgps_78_0.png" src="../_images/notebooks_hgps_78_0.png" />
</div>
</div>
<p>Side comment: If you like, you can format stuff to make it a bit more
pretty. With a few lines you can get nice plots, with a few dozen
publication-quality images. This is using
<a class="reference external" href="https://matplotlib.org/">matplotlib</a> and
<a class="reference external" href="http://docs.astropy.org/en/stable/visualization/index.html">astropy.visualization</a>.
Both are pretty complex, but there’s many examples available and there’s
not really another good alternative anyways for astronomical sky images
at the moment, so you should just go ahead and learn those.</p>
<p>There’s also a convenience method to look up the map value at a given
sky position. Let’s repeat this for the same position we did above with
Numpy and Astropy:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [55]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">pos</span> <span class="o">=</span> <span class="n">SkyCoord</span><span class="p">(</span><span class="mf">266.416826</span><span class="p">,</span> <span class="o">-</span><span class="mf">29.007797</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="s2">&quot;deg&quot;</span><span class="p">)</span>
<span class="n">survey_map</span><span class="o">.</span><span class="n">get_by_coord</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[55]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>array([ 89.4969101], dtype=float32)
</pre></div>
</div>
</div>
<div class="section" id="Vela-X">
<h3>Vela X<a class="headerlink" href="#Vela-X" title="Permalink to this headline">¶</a></h3>
<p>To finish up this tutorial, let’s do something a bit more advanced, than
involves the survey map, the HGPS source catalog, the multi-Gauss
morphology component model. Let’s show the Vela X pulsar wind nebula and
the Vela Junior supernova remnant, and overplot some HGPS catalog data.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [56]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># The spatial model for Vela X in HGPS was three Gaussians</span>
<span class="k">print</span><span class="p">(</span><span class="n">source</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
<span class="k">for</span> <span class="n">component</span> <span class="ow">in</span> <span class="n">source</span><span class="o">.</span><span class="n">components</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="n">component</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
HESS J0835-455
Component HGPSC 001:
GLON                 :  263.969 +/- 0.023 deg
GLAT                 :   -3.344 +/- 0.027 deg
Size                 : 0.237 +/- 0.023 deg
Flux (&gt;1 TeV)        : (2.76 +/- 0.52) x 10^-12 cm^-2 s^-1 = (12.2 +/- 2.3) % Crab
Component HGPSC 002:
GLON                 :  263.699 +/- 0.021 deg
GLAT                 :   -2.827 +/- 0.037 deg
Size                 : 0.156 +/- 0.018 deg
Flux (&gt;1 TeV)        : (1.08 +/- 0.21) x 10^-12 cm^-2 s^-1 = (4.8 +/- 0.9) % Crab
Component HGPSC 003:
GLON                 :  263.983 +/- 0.033 deg
GLAT                 :   -2.997 +/- 0.046 deg
Size                 : 0.650 +/- 0.027 deg
Flux (&gt;1 TeV)        : (11.52 +/- 0.73) x 10^-12 cm^-2 s^-1 = (51.0 +/- 3.2) % Crab
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [57]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">astropy.visualization</span> <span class="kn">import</span> <span class="n">simple_norm</span>
<span class="kn">from</span> <span class="nn">matplotlib.patches</span> <span class="kn">import</span> <span class="n">Circle</span>

<span class="c1"># Cutout and plot a nice image</span>
<span class="n">pos</span> <span class="o">=</span> <span class="n">SkyCoord</span><span class="p">(</span><span class="mf">264.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.5</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="s2">&quot;deg&quot;</span><span class="p">,</span> <span class="n">frame</span><span class="o">=</span><span class="s2">&quot;galactic&quot;</span><span class="p">)</span>
<span class="n">image</span> <span class="o">=</span> <span class="n">survey_map</span><span class="o">.</span><span class="n">cutout</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;6 deg&quot;</span><span class="p">,</span> <span class="s2">&quot;4 deg&quot;</span><span class="p">))</span>
<span class="n">norm</span> <span class="o">=</span> <span class="n">simple_norm</span><span class="p">(</span><span class="n">image</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">stretch</span><span class="o">=</span><span class="s2">&quot;sqrt&quot;</span><span class="p">,</span> <span class="n">min_cut</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">max_cut</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fig</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;inferno&quot;</span><span class="p">)</span>
<span class="n">transform</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_transform</span><span class="p">(</span><span class="s2">&quot;galactic&quot;</span><span class="p">)</span>

<span class="c1"># Overplot the pulsar</span>
<span class="c1"># print(SkyCoord.from_name(&#39;Vela pulsar&#39;).galactic)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="mf">263.551</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.787</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">transform</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;cyan&quot;</span><span class="p">)</span>

<span class="c1"># Overplot the circle that was used for the HGPS spectral measurement of Vela X</span>
<span class="c1"># It is centered on the centroid of the emission and has a radius of 0.5 deg</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">source</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;GLON&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">source</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;GLAT&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">source</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;RSpec&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">Circle</span><span class="p">(</span>
    <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">r</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">transform</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">4</span>
<span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>

<span class="c1"># Overplot circles that represent the components</span>
<span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">source</span><span class="o">.</span><span class="n">components</span><span class="p">:</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;GLON&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;GLAT&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;Size&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">Circle</span><span class="p">(</span>
        <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">r</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">transform</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;0.7&quot;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span>
    <span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_hgps_83_0.png" src="../_images/notebooks_hgps_83_0.png" />
</div>
</div>
<p>We note that for HGPS there are already spatial models available:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">source</span><span class="o">.</span><span class="n">spatial_model</span><span class="p">())</span>
<span class="n">source</span><span class="o">.</span><span class="n">components</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">spatial_model</span>
</pre></div>
</div>
<p>With some effort, you can use those to make HGPS model flux images.</p>
<p>There are two reasons we’re not showing this here: First, the spatial
model code in Gammapy is work in progress, it will change soon.
Secondly, doing morphology measurements on the public HGPS maps is
discouraged; we note again that the maps are correlated and no detailed
PSF information is published. So please be careful / conservative when
extracting quantitative mesurements from the HGPS maps e.g.&nbsp;for a source
of interest for you.</p>
</div>
</div>
<div class="section" id="Conclusions">
<h2>Conclusions<a class="headerlink" href="#Conclusions" title="Permalink to this headline">¶</a></h2>
<p>This concludes this tutorial how to access and work with the HGPS data
from Python, using Astropy and Gammapy.</p>
<ul class="simple">
<li>If you have any questions about the HGPS data, please use the contact
given at <a class="reference external" href="https://www.mpi-hd.mpg.de/hfm/HESS/hgps/">https://www.mpi-hd.mpg.de/hfm/HESS/hgps/</a> .</li>
<li>If you have any questions or issues about Astropy or Gammapy, please
use the Gammapy mailing list (see <a class="reference external" href="http://gammapy.org/contact.html">http://gammapy.org/contact.html</a>).</li>
</ul>
<p><strong>Please read the Appendix A of the paper to learn about the caveats to
using the HGPS data. Especially note that the HGPS survey maps are
correlated and thus no detailed source morphology analysis is possible,
and also note the caveats concerning spectral models and spectral flux
points.</strong></p>
</div>
<div class="section" id="Exercises">
<h2>Exercises<a class="headerlink" href="#Exercises" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>Re-run this notebook, but change the HGPS source that was used for
examples. If you have any questions about the data, try to access and
print or plot it. Just to give a few ideas: How many identified
pulsar wind nebulae are in HGPS? Which are the 5 brightest HGPS
sources in the 1-10 TeV energy band? Which is the second-highest
significance source in the HPGS image after the Galactic center?</li>
<li>Try to reproduce some of the figures in the HGPS paper. Don’t try to
reproduce them exactly, but just try to write ~ 10 lines of code to
access the relevant HGPS data and make a quick plot that shows the
same or similar information.</li>
<li>Fit a spectral model to the spectral points of Vela X and compare
with the HGPS model fit. (they should be similar, but not identical,
in HGPS a likelihood fit to counts data was done). For this task, the
<a class="reference internal" href="spectrum_models.html"><span class="doc">spectrum_models</span></a> and
<a class="reference internal" href="sed_fitting_gammacat_fermi.html"><span class="doc">sed_fitting_gammacat_fermi</span></a>
tutorials will be useful.</li>
</ul>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="source_population_model.html" class="btn btn-neutral float-right" title="Astrophysical source population modeling with Gammapy" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="light_curve.html" class="btn btn-neutral" title="Light curves" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, The Gammapy developers.
      Last updated on 24 Sep 2018.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'0.8',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="../_static/copybutton.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  <script type="text/javascript">
      jQuery(function () {
          
          SphinxRtdTheme.Navigation.enableSticky();
          
      });
  </script> 

</body>
</html>