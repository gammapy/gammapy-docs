
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>PIG 13 - Gammapy dependencies and distribution &#8212; gammapy v1.0rc2</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-bootstrap.5fd3999ee7762ccc51105388f4a9d115.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/gammapy.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <link rel="shortcut icon" href="../../_static/gammapy_logo.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="PIG 14 - Uncertainty estimation" href="pig-014.html" />
    <link rel="prev" title="PIG 12 - High level interface" href="pig-012.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
    
    <div class="container-fluid" id="banner"></div>

    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="container-xl">

  <div id="navbar-start">
    
    

<a class="navbar-brand" href="../../index.html">
  <img src="../../_static/gammapy_logo_nav.png" class="logo" alt="logo">
</a>


    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../getting-started/index.html">
  Getting started
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../user-guide/index.html">
  User guide
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../tutorials/index.html">
  Tutorials
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../api-reference/index.html">
  API reference
 </a>
</li>

<li class="toctree-l1 current active nav-item">
 <a class="reference internal nav-link" href="../index.html">
  Developer guide
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../release-notes/index.html">
  Release notes
 </a>
</li>

    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <div class="dropdown" id="version_switcher">
    <button type="button" class="btn btn-primary btn-sm navbar-btn dropdown-toggle" id="version_switcher_button" data-toggle="dropdown">
        1.0rc2  <!-- this text may get changed later by javascript -->
        <span class="caret"></span>
    </button>
    <div id="version_switcher_menu" class="dropdown-menu list-group-flush py-0" aria-labelledby="version_switcher_button">
    <!-- dropdown will be populated by javascript on page load -->
    </div>
</div>

<!-- NOTE: this JS must live here (not in our global JS file) because it relies
     on being processed by Jinja before it is run (specifically for replacing
     variables development/pigs/pig-013 and {'json_url': 'https://docs.gammapy.org/stable/switcher.json', 'version_match': '1.0rc2'}.
-->

<script type="text/javascript">
// Check if corresponding page path exists in other version of docs
// and, if so, go there instead of the homepage of the other docs version
function checkPageExistsAndRedirect(event) {
    const currentFilePath = "development/pigs/pig-013.html",
          tryUrl = event.target.getAttribute("href");
    let otherDocsHomepage = tryUrl.replace(currentFilePath, "");
    $.ajax({
        type: 'HEAD',
        url: tryUrl,
        // if the page exists, go there
        success: function() {
            location.href = tryUrl;
        }
    }).fail(function() {
        location.href = otherDocsHomepage;
    });
    // this prevents the browser from following the href of the clicked node
    // (which is fine because this function takes care of redirecting)
    return false;
}

// Populate the version switcher from the JSON config file
(function () {
    $.getJSON("https://docs.gammapy.org/stable/switcher.json", function(data, textStatus, jqXHR) {
        const currentFilePath = "development/pigs/pig-013.html";
        // create links to the corresponding page in the other docs versions
        $.each(data, function(index, entry) {
            // if no custom name specified (e.g., "latest"), use version string
            if (!("name" in entry)) {
                entry.name = entry.version;
            }
            // create the node
            const node = document.createElement("a");
            node.setAttribute("class", "list-group-item list-group-item-action py-1");
            node.textContent = `${entry.name}`;
            node.setAttribute("href", `${entry.url}${currentFilePath}`);
            // on click, AJAX calls will check if the linked page exists before
            // trying to redirect, and if not, will redirect to the homepage
            // for that version of the docs.
            node.onclick = checkPageExistsAndRedirect;
            // Add dataset values for the version and name in case people want
            // to apply CSS styling based on this information.
            node.dataset["versionName"] = entry.name;
            node.dataset["version"] = entry.version;

            $("#version_switcher_menu").append(node);
            // replace dropdown button text with the preferred display name of
            // this version, rather than using sphinx's 1.0rc2 variable.
            // also highlight the dropdown entry for the currently-viewed
            // version's entry
            if (entry.version == "1.0rc2") {
                node.classList.add("active");
                let btn = document.getElementById("version_switcher_button");
                btn.innerText = btn.dataset["activeVersionName"] = entry.name;
                btn.dataset["activeVersion"] = entry.version;
            }
        });
    });
})();
</script>
      </div>
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/gammapy/gammapy" rel="noopener" target="_blank" title="Github"><span><i class="fab fa-github-square"></i></span>
            <label class="sr-only">Github</label></a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="https://twitter.com/gammapyST" rel="noopener" target="_blank" title="Twitter"><span><i class="fab fa-twitter-square"></i></span>
            <label class="sr-only">Twitter</label></a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="https://gammapy.slack.com/" rel="noopener" target="_blank" title="Slack"><span><i class="fab fa-slack"></i></span>
            <label class="sr-only">Slack</label></a>
        </li>
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
            
            <!-- Only show if we have sidebars configured, else just a small margin  -->
            <div class="col-12 col-md-3 bd-sidebar">
              <div class="sidebar-start-items"><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../setup.html">
   Project setup
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../dependencies.html">
   Dependencies
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../intro.html">
   How to contribute to Gammapy
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../release.html">
   How to make a Gammapy release
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../doc_howto.html">
   Documentation How To
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../dev_howto.html">
   Developer How To
  </a>
 </li>
</ul>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="index.html">
   PIGs
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="pig-001.html">
     PIG 1 - PIG purpose and guidelines
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="pig-002.html">
     PIG 2 - Organization of low level analysis code
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="pig-003.html">
     PIG 3 - Plan for dropping Python 2.7 support
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="pig-004.html">
     PIG 4 - Setup for tutorial notebooks and data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="pig-005.html">
     PIG 5 - Gammapy 1.0 roadmap
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="pig-006.html">
     PIG 6 - CTA observation handling
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="pig-007.html">
     PIG 7 - Models
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="pig-008.html">
     PIG 8 - Datasets
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="pig-009.html">
     PIG 9 - Event sampling
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="pig-010.html">
     PIG 10 - Regions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="pig-011.html">
     PIG 11 - Light curves
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="pig-012.html">
     PIG 12 - High level interface
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     PIG 13 - Gammapy dependencies and distribution
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="pig-014.html">
     PIG 14 - Uncertainty estimation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="pig-016.html">
     PIG 16 - Gammapy package structure
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="pig-018.html">
     PIG 18 - Documentation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="pig-019.html">
     PIG 19 - Gammapy package structure follow up
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="pig-020.html">
     PIG 20 - Global Model API
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="pig-021.html">
     PIG 21 - Models improvements
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="pig-022.html">
     PIG 22 - Unified flux estimators API
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="pig-023.html">
     PIG 23 - Gammapy release cycle and version numbering
    </a>
   </li>
  </ul>
 </li>
</ul>

  </div>
</nav>
              </div>
              <div class="sidebar-end-items">
              </div>
            </div>
            
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
            
              
              <div class="toc-item">
                
<div class="tocsection onthispage mt-5 pt-1 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#abstract">
   Abstract
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#introduction">
   Introduction
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dependencies">
     Dependencies
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#distributions">
     Distributions
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#required-dependencies">
   Required dependencies
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#optional-dependencies">
   Optional dependencies
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id1">
   Distributions
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#outlook">
   Outlook
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#alternatives">
   Alternatives
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#task-list">
   Task list
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#decision">
   Decision
  </a>
 </li>
</ul>

</nav>
              </div>
              
              <div class="toc-item">
                
              </div>
              
            
          </div>
          

          
          
            
          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <section id="pig-13-gammapy-dependencies-and-distribution">
<span id="pig-013"></span><h1>PIG 13 - Gammapy dependencies and distribution<a class="headerlink" href="#pig-13-gammapy-dependencies-and-distribution" title="Permalink to this headline">#</a></h1>
<ul class="simple">
<li><p>Author: Christoph Deil, Axel Donath, Régis Terrier, Brigitta Sipocz</p></li>
<li><p>Created: Jun 6, 2019</p></li>
<li><p>Accepted: Sep 9, 2019</p></li>
<li><p>Status: accepted</p></li>
<li><p>Discussion: <a class="reference external" href="https://github.com/gammapy/gammapy/pull/2218">GH 2218</a></p></li>
</ul>
<section id="abstract">
<h2>Abstract<a class="headerlink" href="#abstract" title="Permalink to this headline">#</a></h2>
<p>Now that we have a good way to distribute Gammapy and to ship a science tool
environment to users, we propose to drop support and testing for old versions of
dependencies, and alternative distribution channels. Concretely, we propose to
require Python 3.6, Numpy 1.16 and Astropy 3.2 starting with Gammapy v0.14, and
to remove the Macports installation instructions from the Gammapy documentation.</p>
<p>We think the impact for users is small (none for most), but the benefit for
Gammapy developers and maintainers is big, allowing us to progress more quickly.</p>
<p>If you use Gammapy and need to run on old machines or exotic platforms, and this
change doesn’t work for you, let us know!</p>
</section>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">#</a></h2>
<p>Since Gammapy v0.7, released in Feb 2018, the recommended way to install
Gammapy and its dependencies has been via conda. This has worked well, allowing
us to ship a reproducible science tool environment with up-to-date versions to
all Gammapy users for each Gammapy release.</p>
<p>Each stable release for Gammapy is first published as a source distribution on
<a class="reference external" href="https://pypi.org/project/gammapy/">https://pypi.org/project/gammapy/</a>. Then conda binaries for Linux, macOS and
Windows will be built via conda-forge, and uploaded to
<a class="reference external" href="https://anaconda.org/conda-forge/gammapy">https://anaconda.org/conda-forge/gammapy</a>. Finally we write a conda environment
specification file that we publish on gammapy.org, and the end-user installation
instructions look like this:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">-</span><span class="n">O</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">gammapy</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">download</span><span class="o">/</span><span class="n">install</span><span class="o">/</span><span class="n">gammapy</span><span class="o">-</span><span class="mf">0.13</span><span class="o">-</span><span class="n">environment</span><span class="o">.</span><span class="n">yml</span>
<span class="n">conda</span> <span class="n">env</span> <span class="n">create</span> <span class="o">-</span><span class="n">f</span> <span class="n">gammapy</span><span class="o">-</span><span class="mf">0.13</span><span class="o">-</span><span class="n">environment</span><span class="o">.</span><span class="n">yml</span>
<span class="n">conda</span> <span class="n">activate</span> <span class="n">gammapy</span><span class="o">-</span><span class="mf">0.13</span>
</pre></div>
</div>
<section id="dependencies">
<h3>Dependencies<a class="headerlink" href="#dependencies" title="Permalink to this headline">#</a></h3>
<p>For the rest of this document, we would like to define and describe what we mean
when talking about “required” and “optional” dependencies for Gammapy:</p>
<ul class="simple">
<li><p>the required dependencies are the Python packages that get automatically
installed when running <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">gammapy</span></code> or <code class="docutils literal notranslate"><span class="pre">conda</span> <span class="pre">install</span> <span class="pre">gammapy</span> <span class="pre">-c</span>
<span class="pre">conda-forge</span></code>.</p></li>
<li><p>the optional dependencies are the ones listed in the conda environment
specification, that are not already required dependencies.</p></li>
</ul>
<p>For example Numpy and Astropy are required dependencies of Gammapy, and
matplotlib, Jupyter or Naima are optional dependencies. Complete tables of all
required and optional dependencies that we have at the moment are given below.</p>
<p>The choice which dependencies are required or optional (or neither) is something
we make in the metadata of the Gammapy source distribution. Our reasoning is to
declare a dependency as required if it’s needed by the vast majority of Gammapy
users, and for optional dependencies, we include all packages that are used
somewhere within the Gammapy package, or in examples and tutorials in the
Gammapy documentation.</p>
<p>We note that these two sets of dependencies are just the default, recommended
sets, it is possible to install Gammapy even without installing the required
dependencies, and of course users can install and use Gammapy together with
other Python packages, e.g. scikit-learn or whatever they like.</p>
</section>
<section id="distributions">
<h3>Distributions<a class="headerlink" href="#distributions" title="Permalink to this headline">#</a></h3>
<p>There are many distribution channels for Gammapy just as is the case for most
open-source software. E.g. at this time there is a Debian and Macports package
for Gammapy. conda is not the only, but it is the only fully supported
distribution channel for Gammapy. The reason for this is that currently manpower
and expertise in the Gammapy team is limited, and conda provides, as far as we
know, a solution that works for all users. At this time, no-one from the Gammapy
is using Macports any more, for pip there are no binary wheels published yet for
Gammapy and astropy-regions, Debian only works for Debian users and has a longer
update cycle compared to the current Gammapy 2 month release cycle, and e.g. for
Homebrew no-one packaged Gammapy so far.</p>
</section>
</section>
<section id="required-dependencies">
<h2>Required dependencies<a class="headerlink" href="#required-dependencies" title="Permalink to this headline">#</a></h2>
<p>We propose to update the Gammapy required dependencies as shown in the following
table (the release dates for the packages are shown in parentheses are were
obtained from <a class="reference external" href="https://pypi.org/">https://pypi.org/</a>).</p>
<table class="table">
<colgroup>
<col style="width: 32%" />
<col style="width: 34%" />
<col style="width: 34%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Dependency</p></th>
<th class="head"><p>Gammapy 0.13</p></th>
<th class="head"><p>Gammapy 0.14</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Python</p></td>
<td><p>3.5   (Sep 2015)</p></td>
<td><p>3.6   (Dec 2016)</p></td>
</tr>
<tr class="row-odd"><td><p>Numpy</p></td>
<td><p>1.10  (May 2016)</p></td>
<td><p>1.16  (Jan 2019)</p></td>
</tr>
<tr class="row-even"><td><p>Scipy</p></td>
<td><p>0.15  (Jan 2015)</p></td>
<td><p>1.2   (Dec 2018)</p></td>
</tr>
<tr class="row-odd"><td><p>Astropy</p></td>
<td><p>2.0   (Jul 2017)</p></td>
<td><p>3.2   (Jun 2019)</p></td>
</tr>
<tr class="row-even"><td><p>regions</p></td>
<td><p>0.4   (Jun 2019)</p></td>
<td><p>0.5   (Sep 2019)</p></td>
</tr>
<tr class="row-odd"><td><p>pyyaml</p></td>
<td><p>unclear</p></td>
<td><p>5.1   (Mar 2019)</p></td>
</tr>
<tr class="row-even"><td><p>click</p></td>
<td><p>unclear</p></td>
<td><p>7.0   (Sep 2018)</p></td>
</tr>
<tr class="row-odd"><td><p>jsonschema</p></td>
<td><p>–</p></td>
<td><p>3.0   (Feb 2019)</p></td>
</tr>
</tbody>
</table>
<p>We already mentioned the possibility to drop Python 3.5 support in
<a class="reference internal" href="pig-003.html#pig-003"><span class="std std-ref">PIG 3 - Plan for dropping Python 2.7 support</span></a>. One reason is that Anaconda and conda-forge (our main
distribution channel, used in our testing continuous integration setup) only
contains Python 2.7, 3.6 and 3.7 at this point (and 3.8 added in fall 2018),
i.e. testing on Python 3.5 is already extra effort. Also, Python 3.6 contains
some nice new features that developers can use. E.g. Sunpy or ctapipe already
require Python 3.6 or later.</p>
<p>A major motivation to update to very recent versions is that the <code class="docutils literal notranslate"><span class="pre">regions</span></code>
package is still under development (see <a class="reference internal" href="pig-010.html#pig-010"><span class="std std-ref">PIG 10 - Regions</span></a>). In Gammapy 0.13 we
require regions 0.4, and we plan to make a regions 0.5 release with further
features and fixes in September, and to require that for Gammapy 0.14.</p>
<p>For <code class="docutils literal notranslate"><span class="pre">pyyaml</span></code>, we would like to use the recent version, since it allows writing
with preserved dictionary key order, giving a nice output, whereas previously it
always sorted keys alphabetically on YAML write.</p>
<p>The current Gammapy command line interface is using <code class="docutils literal notranslate"><span class="pre">click</span></code>. Whether to keep
this or whether to use something else will be discussed in <a class="reference external" href="https://github.com/gammapy/gammapy/pull/2219">PIG 12</a>. For now,
we propose to keep things as-is, and only specify a minimum version that we’ll
test, although in practice we didn’t have any version-dependent issues with
<code class="docutils literal notranslate"><span class="pre">click</span></code> in the past years.</p>
<p>We plan to use <code class="docutils literal notranslate"><span class="pre">jsonschema</span></code> to validate YAML config files. It’s a small,
pure-Python dependency.</p>
</section>
<section id="optional-dependencies">
<h2>Optional dependencies<a class="headerlink" href="#optional-dependencies" title="Permalink to this headline">#</a></h2>
<p>We propose to update the Gammapy optional dependencies as shown in the following
table (the release dates for the packages are shown in parentheses are were
obtained from <a class="reference external" href="https://pypi.org/">https://pypi.org/</a>).</p>
<table class="table">
<colgroup>
<col style="width: 32%" />
<col style="width: 34%" />
<col style="width: 34%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Dependency</p></th>
<th class="head"><p>Gammapy 0.13</p></th>
<th class="head"><p>Gammapy 0.14</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>ipython</p></td>
<td><p>7.3   (Feb 2019)</p></td>
<td><p>7.6   (Jun 2019)</p></td>
</tr>
<tr class="row-odd"><td><p>jupyter</p></td>
<td><p>1.0   (n/a)</p></td>
<td><p>1.0   (n/a)</p></td>
</tr>
<tr class="row-even"><td><p>jupyterlab</p></td>
<td><p>0.35  (Oct 2018)</p></td>
<td><p>1.0   (Jun 2019)</p></td>
</tr>
<tr class="row-odd"><td><p>matplotlib</p></td>
<td><p>2.1   (Oct 2017)</p></td>
<td><p>3.0   (Sep 2018)</p></td>
</tr>
<tr class="row-even"><td><p>pandas</p></td>
<td><p>0.24  (Jan 2019)</p></td>
<td><p>0.25  (Jul 2019)</p></td>
</tr>
<tr class="row-odd"><td><p>healpy</p></td>
<td><p>1.11  (Aug 2017)</p></td>
<td><p>1.12  (Jun 2018)</p></td>
</tr>
<tr class="row-even"><td><p>reproject</p></td>
<td><p>0.4   (Jan 2018)</p></td>
<td><p>0.5   (Jun 2019)</p></td>
</tr>
<tr class="row-odd"><td><p>uncertainties</p></td>
<td><p>3.0   (Aug 2016)</p></td>
<td><p>3.1   (May 2019)</p></td>
</tr>
<tr class="row-even"><td><p>iminuit</p></td>
<td><p>1.3   (Jul 2018)</p></td>
<td><p>1.3.7 (Jun 2019)</p></td>
</tr>
<tr class="row-odd"><td><p>sherpa</p></td>
<td><p>4.11  (Feb 2019)</p></td>
<td><p>4.11  (Feb 2019)</p></td>
</tr>
<tr class="row-even"><td><p>naima</p></td>
<td><p>0.8   (Dec 2016)</p></td>
<td><p>0.8.3 (Nov 2018)</p></td>
</tr>
<tr class="row-odd"><td><p>emcee</p></td>
<td><p>–</p></td>
<td><p>2.2   (Jul 2016)</p></td>
</tr>
<tr class="row-even"><td><p>corner</p></td>
<td><p>–</p></td>
<td><p>2.0   (May 2016)</p></td>
</tr>
<tr class="row-odd"><td><p>parfive</p></td>
<td><p>–</p></td>
<td><p>1.0   (May 2019)</p></td>
</tr>
</tbody>
</table>
<p>We plan to use <code class="docutils literal notranslate"><span class="pre">parfive</span></code> for tutorial notebook and example dataset file
download (features parallel download and a progress bar).</p>
</section>
<section id="id1">
<h2>Distributions<a class="headerlink" href="#id1" title="Permalink to this headline">#</a></h2>
<p>The situation concerning distribution was described in the introduction above,
and some alternatives and future work are mentioned in the outlook and
alternatives sections below.</p>
<p>We propose to remove the Macports installation page from the Gammmapy
documentation, and to just leave a mention that it’s outdated and unsupported on
the page on “other ways to install Gammapy”. Short sections or pages about pip
and Debian will remain at the end of the installation instructions, for advanced
users.</p>
<p>For conda, we will improve the installation instructions, explaining the
difference between using the recommended environment and a plain <code class="docutils literal notranslate"><span class="pre">conda</span> <span class="pre">install</span>
<span class="pre">-c</span> <span class="pre">conda-forge</span> <span class="pre">gammapy</span></code>, and add lists of required and optional dependencies as
above to the Gammapy installation documentation.</p>
</section>
<section id="outlook">
<h2>Outlook<a class="headerlink" href="#outlook" title="Permalink to this headline">#</a></h2>
<p>This PIG describes only the status and very short term plan for Gammapy v0.14
and v1.0! We expect that dependencies and distribution will evolve in the coming
years.</p>
<p>E.g. we might add Numba as a dependency, or we might start to fully support pip,
if binary wheels for Gammapy and all dependencies are available (there is a
recent effort to implement this).</p>
<p>Somewhat related to this PIG: we plan to modernise Gammapy packaging following
the recommendations in <a class="reference external" href="https://github.com/astropy/astropy-APEs/pull/52">APE 17</a>. Work on this has already started in <a class="reference external" href="https://github.com/gammapy/gammapy/issues/2279">GH
2279</a>.</p>
<p>We could support other ways to ship Gammapy, e.g. Homebrew (works on MacOS and
also Linux now), or Docker images (works anywhere, self-contained).</p>
</section>
<section id="alternatives">
<h2>Alternatives<a class="headerlink" href="#alternatives" title="Permalink to this headline">#</a></h2>
<p>Since we have a working setup already, we could do nothing, which seems nice at
first, but really means continued time sink and suffering by the Gammapy
maintainers of the continuous integration testing system and the release
manager.</p>
<p>For conda, we should strongly consider introducing a <code class="docutils literal notranslate"><span class="pre">gammapy-all</span></code> metapackage
instead of the current <code class="docutils literal notranslate"><span class="pre">gammapy-environment.yml</span></code> shipped via <code class="docutils literal notranslate"><span class="pre">gammapy.org</span></code>.
That’s what e.g. the Fermi tools and glueviz and others do, and they like that
solution. It does have the advantage ob using a conda-native solution to the
question how to ship an environment. This could be prototyped any time, in
parallel with the existing solution, to gain familiarity with metapackages.</p>
</section>
<section id="task-list">
<h2>Task list<a class="headerlink" href="#task-list" title="Permalink to this headline">#</a></h2>
<ul class="simple">
<li><p>Update continuous integration test matrix to test against the minimum required
versions as specified here (and also newer versions in addition) (<a class="reference external" href="https://github.com/gammapy/gammapy/issues/2270">GH 2270</a>).</p></li>
<li><p>Drop Python 3.5 support and modernise codebase (e.g. use f-strings and use
dict instead of OrderedDict).</p></li>
<li><p>Review Gammapy codebase and remove workarounds for old Python, Numpy, Astropy,
… versions.</p></li>
<li><p>Remove <code class="docutils literal notranslate"><span class="pre">extras_require</span></code> in <code class="docutils literal notranslate"><span class="pre">setup.py</span></code>
(don’t attempt to maintain the list of optional dependencies there)</p></li>
<li><p>Review, restructure and update all Gammapy installation instructions</p></li>
<li><p>Clearly describe all required and optional dependencies in the docs</p></li>
</ul>
</section>
<section id="decision">
<h2>Decision<a class="headerlink" href="#decision" title="Permalink to this headline">#</a></h2>
<p>This proposal was extensively discussed at the July 2019 Gammapy coding sprint.
In the feedback phase we didn’t get a single comment asking for continued
support of older versions. Thus the proposal was accepted on Sep 9.</p>
</section>
</section>


              </div>
              
              
          </main>
          

      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>
<footer class="footer mt-5 mt-md-0">
  <div class="container">
    
    <div class="footer-item">
      <p class="copyright">
    &copy; Copyright 2022, The Gammapy developers.<br>
</p>
    </div>
    
    <div class="footer-item">
      <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.5.0.<br>
</p>
    </div>
    
  </div>
</footer>
  </body>
</html>