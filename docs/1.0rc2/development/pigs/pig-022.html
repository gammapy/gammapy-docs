
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>PIG 22 - Unified flux estimators API &#8212; gammapy v1.0rc2</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-bootstrap.5fd3999ee7762ccc51105388f4a9d115.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/gammapy.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <link rel="shortcut icon" href="../../_static/gammapy_logo.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="PIG 23 - Gammapy release cycle and version numbering" href="pig-023.html" />
    <link rel="prev" title="PIG 21 - Models improvements" href="pig-021.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
    
    <div class="container-fluid" id="banner"></div>

    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="container-xl">

  <div id="navbar-start">
    
    

<a class="navbar-brand" href="../../index.html">
  <img src="../../_static/gammapy_logo_nav.png" class="logo" alt="logo">
</a>


    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../getting-started/index.html">
  Getting started
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../user-guide/index.html">
  User guide
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../tutorials/index.html">
  Tutorials
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../api-reference/index.html">
  API reference
 </a>
</li>

<li class="toctree-l1 current active nav-item">
 <a class="reference internal nav-link" href="../index.html">
  Developer guide
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../release-notes/index.html">
  Release notes
 </a>
</li>

    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <div class="dropdown" id="version_switcher">
    <button type="button" class="btn btn-primary btn-sm navbar-btn dropdown-toggle" id="version_switcher_button" data-toggle="dropdown">
        1.0rc2  <!-- this text may get changed later by javascript -->
        <span class="caret"></span>
    </button>
    <div id="version_switcher_menu" class="dropdown-menu list-group-flush py-0" aria-labelledby="version_switcher_button">
    <!-- dropdown will be populated by javascript on page load -->
    </div>
</div>

<!-- NOTE: this JS must live here (not in our global JS file) because it relies
     on being processed by Jinja before it is run (specifically for replacing
     variables development/pigs/pig-022 and {'json_url': 'https://docs.gammapy.org/stable/switcher.json', 'version_match': '1.0rc2'}.
-->

<script type="text/javascript">
// Check if corresponding page path exists in other version of docs
// and, if so, go there instead of the homepage of the other docs version
function checkPageExistsAndRedirect(event) {
    const currentFilePath = "development/pigs/pig-022.html",
          tryUrl = event.target.getAttribute("href");
    let otherDocsHomepage = tryUrl.replace(currentFilePath, "");
    $.ajax({
        type: 'HEAD',
        url: tryUrl,
        // if the page exists, go there
        success: function() {
            location.href = tryUrl;
        }
    }).fail(function() {
        location.href = otherDocsHomepage;
    });
    // this prevents the browser from following the href of the clicked node
    // (which is fine because this function takes care of redirecting)
    return false;
}

// Populate the version switcher from the JSON config file
(function () {
    $.getJSON("https://docs.gammapy.org/stable/switcher.json", function(data, textStatus, jqXHR) {
        const currentFilePath = "development/pigs/pig-022.html";
        // create links to the corresponding page in the other docs versions
        $.each(data, function(index, entry) {
            // if no custom name specified (e.g., "latest"), use version string
            if (!("name" in entry)) {
                entry.name = entry.version;
            }
            // create the node
            const node = document.createElement("a");
            node.setAttribute("class", "list-group-item list-group-item-action py-1");
            node.textContent = `${entry.name}`;
            node.setAttribute("href", `${entry.url}${currentFilePath}`);
            // on click, AJAX calls will check if the linked page exists before
            // trying to redirect, and if not, will redirect to the homepage
            // for that version of the docs.
            node.onclick = checkPageExistsAndRedirect;
            // Add dataset values for the version and name in case people want
            // to apply CSS styling based on this information.
            node.dataset["versionName"] = entry.name;
            node.dataset["version"] = entry.version;

            $("#version_switcher_menu").append(node);
            // replace dropdown button text with the preferred display name of
            // this version, rather than using sphinx's 1.0rc2 variable.
            // also highlight the dropdown entry for the currently-viewed
            // version's entry
            if (entry.version == "1.0rc2") {
                node.classList.add("active");
                let btn = document.getElementById("version_switcher_button");
                btn.innerText = btn.dataset["activeVersionName"] = entry.name;
                btn.dataset["activeVersion"] = entry.version;
            }
        });
    });
})();
</script>
      </div>
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/gammapy/gammapy" rel="noopener" target="_blank" title="Github"><span><i class="fab fa-github-square"></i></span>
            <label class="sr-only">Github</label></a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="https://twitter.com/gammapyST" rel="noopener" target="_blank" title="Twitter"><span><i class="fab fa-twitter-square"></i></span>
            <label class="sr-only">Twitter</label></a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="https://gammapy.slack.com/" rel="noopener" target="_blank" title="Slack"><span><i class="fab fa-slack"></i></span>
            <label class="sr-only">Slack</label></a>
        </li>
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
            
            <!-- Only show if we have sidebars configured, else just a small margin  -->
            <div class="col-12 col-md-3 bd-sidebar">
              <div class="sidebar-start-items"><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../setup.html">
   Project setup
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../dependencies.html">
   Dependencies
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../intro.html">
   How to contribute to Gammapy
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../release.html">
   How to make a Gammapy release
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../doc_howto.html">
   Documentation How To
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../dev_howto.html">
   Developer How To
  </a>
 </li>
</ul>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="index.html">
   PIGs
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="pig-001.html">
     PIG 1 - PIG purpose and guidelines
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="pig-002.html">
     PIG 2 - Organization of low level analysis code
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="pig-003.html">
     PIG 3 - Plan for dropping Python 2.7 support
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="pig-004.html">
     PIG 4 - Setup for tutorial notebooks and data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="pig-005.html">
     PIG 5 - Gammapy 1.0 roadmap
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="pig-006.html">
     PIG 6 - CTA observation handling
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="pig-007.html">
     PIG 7 - Models
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="pig-008.html">
     PIG 8 - Datasets
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="pig-009.html">
     PIG 9 - Event sampling
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="pig-010.html">
     PIG 10 - Regions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="pig-011.html">
     PIG 11 - Light curves
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="pig-012.html">
     PIG 12 - High level interface
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="pig-013.html">
     PIG 13 - Gammapy dependencies and distribution
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="pig-014.html">
     PIG 14 - Uncertainty estimation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="pig-016.html">
     PIG 16 - Gammapy package structure
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="pig-018.html">
     PIG 18 - Documentation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="pig-019.html">
     PIG 19 - Gammapy package structure follow up
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="pig-020.html">
     PIG 20 - Global Model API
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="pig-021.html">
     PIG 21 - Models improvements
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     PIG 22 - Unified flux estimators API
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="pig-023.html">
     PIG 23 - Gammapy release cycle and version numbering
    </a>
   </li>
  </ul>
 </li>
</ul>

  </div>
</nav>
              </div>
              <div class="sidebar-end-items">
              </div>
            </div>
            
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
            
              
              <div class="toc-item">
                
<div class="tocsection onthispage mt-5 pt-1 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#abstract">
   Abstract
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#introduction">
   Introduction
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#what-we-have">
   What we have
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#proposal-of-api-for-flux-estimate-results">
   Proposal of API for flux estimate results
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#introduce-a-fluxestimate-base-class">
     Introduce a FluxEstimate base class
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#introduce-a-fluxmap-api">
     Introduce a FluxMap API
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#introduce-a-fluxpointscollection-api">
     Introduce a FluxPointsCollection API
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#unification-of-flux-estimators">
   Unification of flux estimators?
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#excess-estimators">
     Excess estimators
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#generalist-estimators">
     Generalist estimators
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#outlook">
     Outlook
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#alternative">
   Alternative
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#decision">
   Decision
  </a>
 </li>
</ul>

</nav>
              </div>
              
              <div class="toc-item">
                
              </div>
              
            
          </div>
          

          
          
            
          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <section id="pig-22-unified-flux-estimators-api">
<span id="pig-022"></span><h1>PIG 22 - Unified flux estimators API<a class="headerlink" href="#pig-22-unified-flux-estimators-api" title="Permalink to this headline">#</a></h1>
<ul class="simple">
<li><p>Author: Régis Terrier and Axel Donath</p></li>
<li><p>Created: Nov 11, 2020</p></li>
<li><p>Withdrawn: Nov 14th, 2021</p></li>
<li><p>Status: withdrawn</p></li>
<li><p>Discussion: <a class="reference external" href="https://github.com/gammapy/gammapy/pull/3075">GH 3075</a></p></li>
</ul>
<section id="abstract">
<h2>Abstract<a class="headerlink" href="#abstract" title="Permalink to this headline">#</a></h2>
<p>This pig proposes a uniform API for flux <code class="docutils literal notranslate"><span class="pre">Estimator</span></code> results. We discuss the
introduction of a general <code class="docutils literal notranslate"><span class="pre">FluxEstimate</span></code> object that would allow flux type
conversions and that would serve as a base class for <code class="docutils literal notranslate"><span class="pre">FluxPoints</span></code> and
<code class="docutils literal notranslate"><span class="pre">FluxMap</span></code> class. The latter would allow easier handling of <code class="docutils literal notranslate"><span class="pre">TSMapEstimator</span></code> results,
in particular regarding serialization and flux conversion.</p>
</section>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">#</a></h2>
<p>Flux estimation is performed by <code class="docutils literal notranslate"><span class="pre">Estimators</span></code> in gammapy.  Some perform forward-
folding methods to compute flux, ts, significance and errors at various positions
or energy. This is the case of the <code class="docutils literal notranslate"><span class="pre">FluxPointsEstimator</span></code>, the <code class="docutils literal notranslate"><span class="pre">LightCurveEstimator</span></code>
and the <code class="docutils literal notranslate"><span class="pre">TSMapEstimator</span></code>. Other perform backward folding methods to compute similar
quantities (they compute excesses and associated ts and errors and divide by the exposure
in reco energy to deduce flux quantities). This is the case of <code class="docutils literal notranslate"><span class="pre">ExcessMapEstimator</span></code>
and <code class="docutils literal notranslate"><span class="pre">ExcessProfileEstimator</span></code>.</p>
<p>So far, the output of all these estimators is diverse and rely on different conventions
for the definition of flux. There are four types of SED flux estimates described in the
gamma astro data format. They are;</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">dnde</span></code> differential flux which is defined at a given <code class="docutils literal notranslate"><span class="pre">e_ref</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">e2dnde</span></code> differential energy flux which is defined at a given <code class="docutils literal notranslate"><span class="pre">e_ref</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">flux</span></code> integral flux defined between <code class="docutils literal notranslate"><span class="pre">e_min</span></code> and <code class="docutils literal notranslate"><span class="pre">e_max</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">eflux</span></code> integral energy flux defined between <code class="docutils literal notranslate"><span class="pre">e_min</span></code> and <code class="docutils literal notranslate"><span class="pre">e_max</span></code></p></li>
</ul>
<p>To convert between these flux types, an assumption must be made on the spectral model.</p>
<p>Besides these, a useful SED type is the so-called <code class="docutils literal notranslate"><span class="pre">likelihood</span></code> type introduced by fermipy
to represent SEDs and described in the gamma astro data format (ref). It uses reference
fluxes expressed in the above flux types and a <code class="docutils literal notranslate"><span class="pre">norm</span></code> value that is used to derive the
actual fluxes. Associated quantities are denoted <code class="docutils literal notranslate"><span class="pre">norm_err</span></code>, <code class="docutils literal notranslate"><span class="pre">norm_ul</span></code> etc.</p>
</section>
<section id="what-we-have">
<h2>What we have<a class="headerlink" href="#what-we-have" title="Permalink to this headline">#</a></h2>
<p>So far, the only API in gammapy handling these different flux types is the <code class="docutils literal notranslate"><span class="pre">FluxPoints</span></code>
object. It contains a <code class="docutils literal notranslate"><span class="pre">Table</span></code> representing one given format above and utility functions
allow to convert the table into another format with e.g.:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">fp_dnde</span> <span class="o">=</span> <span class="n">fp</span><span class="o">.</span><span class="n">to_sed_type</span><span class="p">(</span><span class="s2">&quot;dnde&quot;</span><span class="p">)</span>
<span class="n">fp_energy_flux</span> <span class="o">=</span> <span class="n">fp</span><span class="o">.</span><span class="n">to_sed_type</span><span class="p">(</span><span class="s2">&quot;eflux&quot;</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="n">PowerLawSpectralModel</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="mi">3</span><span class="p">))</span>
</pre></div>
</div>
<p>The conversion is not possible in all directions.</p>
<p>The various estimators implemented so far return different objects.</p>
<ul class="simple">
<li><p>Map estimators return a dictionary of <code class="docutils literal notranslate"><span class="pre">Map</span></code> objects which are defined as <code class="docutils literal notranslate"><span class="pre">flux</span></code> types. Beyond the
fixed flux type, there is no easy API to allow the user to serialize all the <code class="docutils literal notranslate"><span class="pre">Maps</span></code> at once.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">FluxPointsEstimator</span></code> returns a <code class="docutils literal notranslate"><span class="pre">FluxPoints</span></code> object using the <code class="docutils literal notranslate"><span class="pre">likelihood</span></code> normalization scheme.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">LightCurveEstimator</span></code> relies on the <code class="docutils literal notranslate"><span class="pre">FluxPointsEstimator</span></code> in each time interval but converts the output
into a <code class="docutils literal notranslate"><span class="pre">Table</span></code> with one row per time interval and flux points stored as an array in each row.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ExcessProfileEstimator</span></code> computes an integral flux (<code class="docutils literal notranslate"><span class="pre">flux</span></code> type) in a list of regions and a list of energies.
It returns a <code class="docutils literal notranslate"><span class="pre">Table</span></code> with one region per row, and energy dependent fluxes stored as an array in each row.</p></li>
</ul>
<p>This diversity of output formats and flux types could be simplified with better design for flux quantities in gammapy.
We propose below a generalized flux points API.</p>
</section>
<section id="proposal-of-api-for-flux-estimate-results">
<h2>Proposal of API for flux estimate results<a class="headerlink" href="#proposal-of-api-for-flux-estimate-results" title="Permalink to this headline">#</a></h2>
<section id="introduce-a-fluxestimate-base-class">
<h3>Introduce a FluxEstimate base class<a class="headerlink" href="#introduce-a-fluxestimate-base-class" title="Permalink to this headline">#</a></h3>
<p>First we propose that all <code class="docutils literal notranslate"><span class="pre">Estimators</span></code> compute quantities following a SED type inspired by
the <code class="docutils literal notranslate"><span class="pre">likelihood</span></code> SED type. It would basically rely on the <code class="docutils literal notranslate"><span class="pre">norm</span></code> value and reference model
to obtain fluxes in various formats. This is the basic ingredient of the current likelihood format
described in the gadf but without the likelihood scan.</p>
<p>Using such a format, beyond the uniform behavior,  has the advantage of making flux type
conversion easier.</p>
<p>To limit code duplication (e.g. for flux conversions), we propose a common base class to
describe the format and contain the required quantities.</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">FluxEstimate</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;General likelihood sed conversion class</span>

<span class="sd">    Converts norm values into dnde, flux, etc.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : dict of `Map` or `Table`</span>
<span class="sd">        Mappable containing the sed likelihood data</span>
<span class="sd">    spectral_model : `SpectralModel`</span>
<span class="sd">        Reference spectral model</span>
<span class="sd">    energy_axis : `MapAxis`</span>
<span class="sd">        Reference energy axis</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">spectral_model</span><span class="p">,</span> <span class="n">energy_axis</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_data</span> <span class="o">=</span> <span class="n">data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spectral_model</span> <span class="o">=</span> <span class="n">spectral_model</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">energy_axis</span> <span class="o">=</span> <span class="n">energy_axis</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">dnde_ref</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Reference differential flux&quot;&quot;</span>
<span class="sd">                    energy = self.energy_axis.center</span>
<span class="sd">        return = self.spectral_model(energy)</span>

<span class="sd">    @property</span>
<span class="sd">    def dnde(self):</span>
<span class="sd">        &quot;&quot;&quot;</span><span class="n">Differential</span> <span class="n">flux</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        return self._data[&quot;norm&quot;] * self.dnde_ref</span>

<span class="s2">    @property</span>
<span class="s2">    def flux(self):</span>
<span class="s2">        &quot;&quot;&quot;</span><span class="n">Integral</span> <span class="n">flux</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        energy = self.energy_axis.edges</span>
<span class="s2">        flux_ref = self.spectral_model.integral(energy[:-1], energy[1:])</span>
<span class="s2">        return self._data[&quot;norm&quot;] * flux_ref</span>
</pre></div>
</div>
<p>Practically, this allows easy manipulation of flux quantities between formats:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">fpe</span> <span class="o">=</span> <span class="n">FluxPointsEtimator</span><span class="p">()</span>
<span class="n">fp</span> <span class="o">=</span> <span class="n">fpe</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">datasets</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">fp</span><span class="o">.</span><span class="n">dnde</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">fp</span><span class="o">.</span><span class="n">eflux_err</span><span class="p">)</span>

<span class="c1"># but also get excess number estimate</span>
<span class="n">fp</span><span class="o">.</span><span class="n">excess</span>
</pre></div>
</div>
<p>TODO: what to do with counts based quantities? Introduce an <code class="xref py py-obj docutils literal notranslate"><span class="pre">ExcessEstimate</span></code>?</p>
</section>
<section id="introduce-a-fluxmap-api">
<h3>Introduce a FluxMap API<a class="headerlink" href="#introduce-a-fluxmap-api" title="Permalink to this headline">#</a></h3>
<p>Handling a simple dictionary of <code class="docutils literal notranslate"><span class="pre">Maps</span></code> is not very convenient. It is complex to
perform flux transform, it is more complex to provide standard plotting functions
for instance. More importantly, there is no way to serialize the maps with their
associated quantities and other information. It could be useful to export the
<code class="docutils literal notranslate"><span class="pre">GTI</span></code> table of the <code class="docutils literal notranslate"><span class="pre">Dataset</span></code> that was used to extract the map or its <code class="docutils literal notranslate"><span class="pre">meta</span></code>
table. Some information on the way the flux was obtained could be kept as well
(e.g. spatial model assumed or correlation radius used).</p>
<p>The <code class="docutils literal notranslate"><span class="pre">FluxMap</span></code> would inherit from the general likelihood SED class discussed above
and could include the possibility to export the resulting maps (in particular the
<code class="docutils literal notranslate"><span class="pre">norm_scan</span></code> maps) after sparsification according to the format definition from
fermipy and presented in gamma astro data format.</p>
<p>In addition, utilities to extract flux points at various positions could be provided.</p>
<p>Typical usage would be:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">SkyModel</span><span class="p">(</span><span class="n">PointSpatialModel</span><span class="p">(),</span> <span class="n">PowerLawSpectralModel</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="mf">2.5</span><span class="p">))</span>

<span class="n">estimator</span> <span class="o">=</span> <span class="n">TSMapEstimator</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">energy_edges</span><span class="o">=</span><span class="p">[</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">]</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">TeV</span><span class="p">)</span>

<span class="n">flux_maps</span> <span class="o">=</span> <span class="n">estimator</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span>

<span class="c1"># plot differential flux map in each energy band</span>
<span class="n">flux_maps</span><span class="o">.</span><span class="n">dnde</span><span class="o">.</span><span class="n">plot_grid</span><span class="p">()</span>

<span class="c1"># plot energy flux map in each energy band</span>
<span class="n">flux_maps</span><span class="o">.</span><span class="n">eflux</span><span class="o">.</span><span class="n">plot_grid</span><span class="p">()</span>

<span class="c1"># one can access other quantities</span>
<span class="n">flux_maps</span><span class="o">.</span><span class="n">sqrt_ts</span><span class="o">.</span><span class="n">plot_grid</span><span class="p">()</span>
<span class="n">flux_maps</span><span class="o">.</span><span class="n">excess</span><span class="o">.</span><span class="n">plot_grid</span><span class="p">()</span>

<span class="c1"># Extract flux points at selected positions</span>
<span class="n">positions</span> <span class="o">=</span> <span class="n">SkyCoord</span><span class="p">([</span><span class="mf">225.31</span><span class="p">,</span> <span class="mf">200.4</span><span class="p">],</span> <span class="p">[</span><span class="mf">35.65</span><span class="p">,</span> <span class="mf">25.3</span><span class="p">],</span> <span class="n">unit</span><span class="o">=</span><span class="s2">&quot;deg&quot;</span><span class="p">,</span> <span class="n">frame</span><span class="o">=</span><span class="s2">&quot;icrs&quot;</span><span class="p">)</span>
<span class="n">fp</span> <span class="o">=</span> <span class="n">flux_maps</span><span class="o">.</span><span class="n">get_flux_points</span><span class="p">(</span><span class="n">positions</span><span class="p">)</span>
<span class="n">fp</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>

<span class="c1"># Save to disk as a fits file</span>
<span class="n">flux_maps</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;my_flux_maps.fits&quot;</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Read from disk</span>
<span class="n">new_flux_maps</span> <span class="o">=</span> <span class="n">FluxMap</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s2">&quot;my_flux_maps.fits&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="introduce-a-fluxpointscollection-api">
<h3>Introduce a FluxPointsCollection API<a class="headerlink" href="#introduce-a-fluxpointscollection-api" title="Permalink to this headline">#</a></h3>
<p>Several estimators return a set of <code class="docutils literal notranslate"><span class="pre">FluxPoints</span></code> . It is the case of the <code class="docutils literal notranslate"><span class="pre">LightCurveEstimator</span></code>,
a light curve being a time ordered list of fluxes. It is also the case of the <code class="docutils literal notranslate"><span class="pre">ExcessProfileEstimator</span></code>
which return a list of flux points ordered along a direction or radially. In the current implementation,
they produce an <code class="docutils literal notranslate"><span class="pre">~astropy.Table</span></code> where each row contain an array of fluxes representing flux points at a
given time or position.</p>
<p>This solution is not ideal. It introduces a different container logic than the <code class="docutils literal notranslate"><span class="pre">FluxPoints</span></code> for which
one row represents one energy.</p>
<p>A dedicated API could be introduced to support these objects. In order to keep the logic used in
<code class="docutils literal notranslate"><span class="pre">FluxPoints</span></code>, a flat table <code class="docutils literal notranslate"><span class="pre">Table</span></code> could be used to store the various fluxes, where each row
would represent the flux at a given energy, time, position etc.</p>
<p>Astropy provides a mechanism to group table rows according to column entries. It is then possible
to extract the relevant <code class="docutils literal notranslate"><span class="pre">FluxPoints</span></code> object, representing the simple flux points or the lightcurve.</p>
<p>A possible implementation could follow the following lines:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">energy_columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;e_min&quot;</span><span class="p">,</span> <span class="s2">&quot;e_max&quot;</span><span class="p">,</span> <span class="s2">&quot;e_ref&quot;</span><span class="p">]</span>
<span class="n">time_columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;t_min&quot;</span><span class="p">,</span> <span class="s2">&quot;t_max&quot;</span><span class="p">]</span>

<span class="k">class</span> <span class="nc">FluxPointsCollection</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">table</span> <span class="o">=</span> <span class="n">table</span>

        <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="n">_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">energy_columns</span> <span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_energy_table</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">group_by</span><span class="p">(</span><span class="n">energy_columns</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Table does not describe a flux point. Missing energy columns.&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_time_groups</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="n">_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">time_columns</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_time_table</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">group_by</span><span class="p">(</span><span class="n">time_columns</span><span class="p">)</span>


   <span class="k">def</span> <span class="nf">flux_points_at_time</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_time_table</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="s2">&quot;No time information&quot;</span><span class="p">)</span>

        <span class="n">index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">time</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">t_min</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_time_table</span><span class="o">.</span><span class="n">groups</span><span class="p">[</span><span class="n">index</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">lightcurve_at_energy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">energy</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_time_table</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="s2">&quot;No time information&quot;</span><span class="p">)</span>

        <span class="n">index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">energy</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">e_min</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_energy_table</span><span class="o">.</span><span class="n">groups</span><span class="p">[</span><span class="n">index</span><span class="p">])</span>
</pre></div>
</div>
<p>Keeping dedicated classes for specific types is an open question. While it might not be needed,
it also provides a more explicit API for the user as well as specific functionalities. In particular,
plotting is specific to each type. So will be I/O once specific data formats have been introduced.</p>
<p>We also note that <code class="docutils literal notranslate"><span class="pre">FluxPointsDataset</span></code> rely on <code class="docutils literal notranslate"><span class="pre">FluxPoints</span></code> object for now. An important missing
feature is the ability of using these for temporal model evaluation.  <code class="docutils literal notranslate"><span class="pre">TemporalModel</span></code> might requires
a <code class="docutils literal notranslate"><span class="pre">GTI</span></code>.</p>
</section>
</section>
<section id="unification-of-flux-estimators">
<h2>Unification of flux estimators?<a class="headerlink" href="#unification-of-flux-estimators" title="Permalink to this headline">#</a></h2>
<p>Most estimators actually do the same thing: <code class="xref py py-obj docutils literal notranslate"><span class="pre">LightCurveEstimator`</span></code> is simply grouping datasets in time
intervals and applies <code class="docutils literal notranslate"><span class="pre">FluxPointsEstimator</span></code> in each interval. Similarly, the <code class="docutils literal notranslate"><span class="pre">ExcessProfileEstimator</span></code>
is performing a similar thing in different regions. The necessity of a specific estimator for all
these tasks is then questionable. Currently, the responsibility of an estimator is to group and reproject
datasets in the relevant intervals or group of data and then to apply a general flux or excess estimate.</p>
<p>In practice there are two different types of estimators. We can distinguish these:</p>
<ul class="simple">
<li><p>Flux estimators perform a fit of all individual counts inside the requested range
(energy-bin and/or spatial box) to obtain a flux given a certain physical model. Because
it relies on a fit of the complete model,this approach allows to take into account fluctuations
of other parameters by performing re-optimization.</p></li>
<li><p>Excess estimators sum all counts inside the requested range and estimate the corresponding excess
counts taking into account background and other signal contributions from other sources. No explicit
fit is actually performed, since we rely on <code class="docutils literal notranslate"><span class="pre">CountsStatistics</span></code> classes. The flux is then deduced
computing the ratio of measured excess to total <code class="docutils literal notranslate"><span class="pre">npred</span></code> in a given model assumption.</p></li>
</ul>
<p>Currently, the <code class="docutils literal notranslate"><span class="pre">FluxPointsEstimator</span></code> and the <code class="docutils literal notranslate"><span class="pre">LightCurveEstimator</span></code> belong to the first category.
The <code class="docutils literal notranslate"><span class="pre">TSMapEstimator</span></code> a priori belongs there as well although our current implementation does not
allow for other parameters re-optimization. A more general implementation could also rely on
<code class="docutils literal notranslate"><span class="pre">FluxPointsEstimator</span></code>.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">ExcessMapEstimator</span></code> and <code class="docutils literal notranslate"><span class="pre">ExcessProfileEstimator</span></code> are following the second approach (as
their name suggest), but they still provide flux estimates through the excess/npred ratio. We note
that flux points and light curve can also be estimated through this approach to provide rapid estimates.</p>
<p>So we propose to introduce the following simplified estimator API:</p>
<ul class="simple">
<li><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">FluxPointsEstimator</span></code>, which handles multiple sources, time intervals and energy bins, using “forward folding”</p></li>
<li><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">FluxMapEstimator</span></code>, which handles multiple energy bins, using “forward folding”</p></li>
<li><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">ExcessPointsEstimator</span></code>, which handles multiple regions, time intervals and energy bins, using “backward folding”</p></li>
<li><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">ExcessMapEstimator</span></code>, which handles multiple energy bins, using “backward folding”</p></li>
</ul>
<section id="excess-estimators">
<h3>Excess estimators<a class="headerlink" href="#excess-estimators" title="Permalink to this headline">#</a></h3>
<p>We can unify and clarify the general approach by introducing estimators following
each of the methods.</p>
<p>A general flux estimator already exists, it is the <code class="docutils literal notranslate"><span class="pre">FluxEstimator</span></code>. It is the base of the
<code class="docutils literal notranslate"><span class="pre">FluxPointsEstimator</span></code>.</p>
<p>An equivalent <code class="docutils literal notranslate"><span class="pre">ExcessEstimator</span></code> could be added. Technically, it would mostly encapsulate
functionalities provided by the <code class="docutils literal notranslate"><span class="pre">CountsStatistics</span></code>.</p>
</section>
<section id="generalist-estimators">
<h3>Generalist estimators<a class="headerlink" href="#generalist-estimators" title="Permalink to this headline">#</a></h3>
<p>It is possible to create a generalist <code class="docutils literal notranslate"><span class="pre">FluxPointsEstimator</span></code> that could return a general
<code class="docutils literal notranslate"><span class="pre">FluxPointsCollection</span></code> without knowing a priori what type of grouping is applied to the
datasets. This would allow to perform lightcurve or region-based flux estimates with the same
API. This would allow a direct generalization of the <code class="docutils literal notranslate"><span class="pre">FluxPointsEstimator</span></code> to cover other problematic
e.g. flux estimation in phase to build phase curves, flux estimation in different observation condition or
instrument states to study systematic effects.</p>
<p>The main change required for this is to move dataset grouping to the <code class="docutils literal notranslate"><span class="pre">Datasets</span></code> level.</p>
</section>
<section id="outlook">
<h3>Outlook<a class="headerlink" href="#outlook" title="Permalink to this headline">#</a></h3>
<p>Selection by time is already possible on <code class="docutils literal notranslate"><span class="pre">Datasets</span></code> thanks to the <code class="docutils literal notranslate"><span class="pre">select_time(t_min,</span> <span class="pre">t_max)</span></code>
method. This functionality could be extended to other quantities characterizing the datasets.</p>
<p>So in future we could add more general grouping functionality on the <code class="docutils literal notranslate"><span class="pre">Datasets</span></code>. It could
internally rely on the grouping of the meta table: <code class="docutils literal notranslate"><span class="pre">Datasets.meta_table.group_by</span></code>. It would
require the table to be present in memory and be recomputed each time the <code class="docutils literal notranslate"><span class="pre">Datasets</span></code> object
is updated. Then retrieving a set of datasets could be done by <code class="docutils literal notranslate"><span class="pre">Datasets.get_group_by_idx()</span></code>.</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># group datasets according to phase</span>
<span class="n">phase_axis</span> <span class="o">=</span> <span class="n">MapAxis</span><span class="o">.</span><span class="n">from_bounds</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;phase&quot;</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="n">datasets</span><span class="o">.</span><span class="n">group_by_axis</span><span class="p">(</span><span class="n">phase_axis</span><span class="p">)</span>
<span class="n">datasets_in_phase_bin_3</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">get_group_by_idx</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="alternative">
<h2>Alternative<a class="headerlink" href="#alternative" title="Permalink to this headline">#</a></h2>
</section>
<section id="decision">
<h2>Decision<a class="headerlink" href="#decision" title="Permalink to this headline">#</a></h2>
<p>The authors have decided to withdraw the PIG. Most of the proposed changes have been
implemented independently with review and discussions on individuals PRs.</p>
</section>
</section>


              </div>
              
              
          </main>
          

      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>
<footer class="footer mt-5 mt-md-0">
  <div class="container">
    
    <div class="footer-item">
      <p class="copyright">
    &copy; Copyright 2022, The Gammapy developers.<br>
</p>
    </div>
    
    <div class="footer-item">
      <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.5.0.<br>
</p>
    </div>
    
  </div>
</footer>
  </body>
</html>