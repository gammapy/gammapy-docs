
<!DOCTYPE html>


<html lang="en" data-content_root="../../" data-theme="light">

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>High level interface &#8212; gammapy v1.3rc1</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "light";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  <!-- 
    this give us a css class that will be invisible only if js is disabled 
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css?v=fd3f3429" />
    <link rel="stylesheet" type="text/css" href="../../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css?v=d2d258e8" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css?v=203afaf9" />
  
  <!-- So that users can add custom icons -->
  <script src="../../_static/scripts/fontawesome.js?digest=26a4bc78f4c0ddb94549"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549" />

    <script src="../../_static/jquery.js?v=5d32c60e"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
    <script src="../../_static/documentation_options.js?v=e3e1e26b"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=30646c52"></script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'tutorials/starting/analysis_1';</script>
    <script>
        DOCUMENTATION_OPTIONS.theme_version = '0.16.0';
        DOCUMENTATION_OPTIONS.theme_switcher_json_url = 'https://docs.gammapy.org/stable/switcher.json';
        DOCUMENTATION_OPTIONS.theme_switcher_version_match = '1.3rc1';
        DOCUMENTATION_OPTIONS.show_version_warning_banner = false;
        </script>
    <script src="../../_static/matomo.js?v=52704cab"></script>
    <link rel="icon" href="../../_static/gammapy_logo.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Low level API" href="analysis_2.html" />
    <link rel="prev" title="Data structures" href="overview.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="1.3rc1" />
    <meta name="docbuild:last-update" content="15 Nov 2024"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="light">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
    
    
    
    <img src="../../_static/gammapy_logo_nav.png" class="logo__image only-light" alt="gammapy v1.3rc1 - Home"/>
    <img src="../../_static/gammapy_logo_nav.png" class="logo__image only-dark pst-js-only" alt="gammapy v1.3rc1 - Home"/>
  
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../getting-started/index.html">
    Getting started
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../user-guide/index.html">
    User guide
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../index.html">
    Tutorials
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../api-reference/index.html">
    API reference
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../development/index.html">
    Developer guide
  </a>
</li>

            <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-nav-more-links">
                    More
                </button>
                <ul id="pst-nav-more-links" class="dropdown-menu">
                    
<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../../release-notes/index.html">
    Release notes
  </a>
</li>

                </ul>
            </li>
            
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">
<div class="version-switcher__container dropdown pst-js-only">
  <button id="pst-version-switcher-button-2"
    type="button"
    class="version-switcher__button btn btn-sm dropdown-toggle"
    data-bs-toggle="dropdown"
    aria-haspopup="listbox"
    aria-controls="pst-version-switcher-list-2"
    aria-label="Version switcher list"
  >
    Choose version  <!-- this text may get changed later by javascript -->
    <span class="caret"></span>
  </button>
  <div id="pst-version-switcher-list-2"
    class="version-switcher__menu dropdown-menu list-group-flush py-0"
    role="listbox" aria-labelledby="pst-version-switcher-button-2">
    <!-- dropdown will be populated by javascript on page load -->
  </div>
</div></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/gammapy/gammapy" title="Github" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fab fa-github-square fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Github</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://twitter.com/gammapyST" title="Twitter" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fab fa-square-x-twitter fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Twitter</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://gammapy.slack.com/" title="Slack" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fab fa-slack fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Slack</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../getting-started/index.html">
    Getting started
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../user-guide/index.html">
    User guide
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../index.html">
    Tutorials
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../api-reference/index.html">
    API reference
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../development/index.html">
    Developer guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../release-notes/index.html">
    Release notes
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">
<div class="version-switcher__container dropdown pst-js-only">
  <button id="pst-version-switcher-button-3"
    type="button"
    class="version-switcher__button btn btn-sm dropdown-toggle"
    data-bs-toggle="dropdown"
    aria-haspopup="listbox"
    aria-controls="pst-version-switcher-list-3"
    aria-label="Version switcher list"
  >
    Choose version  <!-- this text may get changed later by javascript -->
    <span class="caret"></span>
  </button>
  <div id="pst-version-switcher-list-3"
    class="version-switcher__menu dropdown-menu list-group-flush py-0"
    role="listbox" aria-labelledby="pst-version-switcher-button-3">
    <!-- dropdown will be populated by javascript on page load -->
  </div>
</div></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/gammapy/gammapy" title="Github" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fab fa-github-square fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Github</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://twitter.com/gammapyST" title="Twitter" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fab fa-square-x-twitter fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Twitter</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://gammapy.slack.com/" title="Slack" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fab fa-slack fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Slack</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="overview.html">Data structures</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">High level interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="analysis_2.html">Low level API</a></li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../data/hess.html">H.E.S.S. with Gammapy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../data/cta.html">CTAO with Gammapy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../data/fermi_lat.html">Fermi-LAT with Gammapy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../data/hawc.html">HAWC with Gammapy</a></li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../analysis-1d/cta_sensitivity.html">Point source sensitivity</a></li>
<li class="toctree-l1"><a class="reference internal" href="../analysis-1d/spectral_analysis.html">Spectral analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../analysis-1d/spectral_analysis_hli.html">Spectral analysis with the HLI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../analysis-1d/spectral_analysis_rad_max.html">Spectral analysis with energy-dependent directional cuts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../analysis-1d/extended_source_spectral_analysis.html">Spectral analysis of extended sources</a></li>
<li class="toctree-l1"><a class="reference internal" href="../analysis-1d/spectrum_simulation.html">1D spectrum simulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../analysis-1d/sed_fitting.html">Flux point fitting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../analysis-1d/ebl.html">Account for spectral absorption due to the EBL</a></li>

</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../analysis-2d/detect.html">Source detection and significance maps</a></li>
<li class="toctree-l1"><a class="reference internal" href="../analysis-2d/ring_background.html">Ring background map</a></li>
<li class="toctree-l1"><a class="reference internal" href="../analysis-2d/modeling_2D.html">2D map fitting</a></li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../analysis-3d/analysis_3d.html">3D detailed analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../analysis-3d/cta_data_analysis.html">Basic image exploration and fitting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../analysis-3d/energy_dependent_estimation.html">Morphological energy dependence estimation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../analysis-3d/analysis_mwl.html">Multi instrument joint 3D and 1D analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../analysis-3d/simulate_3d.html">3D map simulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../analysis-3d/event_sampling.html">Event sampling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../analysis-3d/event_sampling_nrg_depend_models.html">Sample a source with energy-dependent temporal evolution</a></li>
<li class="toctree-l1"><a class="reference internal" href="../analysis-3d/flux_profiles.html">Flux Profile Estimation</a></li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../analysis-time/light_curve.html">Light curves</a></li>
<li class="toctree-l1"><a class="reference internal" href="../analysis-time/light_curve_flare.html">Light curves for flares</a></li>
<li class="toctree-l1"><a class="reference internal" href="../analysis-time/variability_estimation.html">Estimation of time variability in a lightcurve</a></li>
<li class="toctree-l1"><a class="reference internal" href="../analysis-time/time_resolved_spectroscopy.html">Time resolved spectroscopy estimator</a></li>
<li class="toctree-l1"><a class="reference internal" href="../analysis-time/light_curve_simulation.html">Simulating and fitting a time varying source</a></li>
<li class="toctree-l1"><a class="reference internal" href="../analysis-time/pulsar_analysis.html">Pulsar analysis</a></li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../api/irfs.html">Using Gammapy IRFs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/models.html">Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/priors.html">Priors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/astro_dark_matter.html">Dark matter spatial and spectral models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/maps.html">Maps</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/mask_maps.html">Mask maps</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/datasets.html">Datasets - Reduced data, IRFs, models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/makers.html">Makers - Data reduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/catalog.html">Source catalogs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/observation_clustering.html">Observational clustering</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/model_management.html">Modelling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/fitting.html">Fitting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/estimators.html">Estimators</a></li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../scripts/survey_map.html">Survey Map Script</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../index.html" class="nav-link">Tutorials</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">High level interface</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-tutorials-starting-analysis-1-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code. or to run this example in your browser via Binder</p>
</div>
<section class="sphx-glr-example-title" id="high-level-interface">
<span id="sphx-glr-tutorials-starting-analysis-1-py"></span><h1>High level interface<a class="headerlink" href="#high-level-interface" title="Link to this heading">#</a></h1>
<p>Introduction to 3D analysis using the Gammapy high level interface.</p>
<section id="prerequisites">
<h2>Prerequisites<a class="headerlink" href="#prerequisites" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Understanding the gammapy data workflow, in particular what are DL3
events and instrument response functions (IRF).</p></li>
</ul>
</section>
<section id="context">
<h2>Context<a class="headerlink" href="#context" title="Link to this heading">#</a></h2>
<p>This notebook is an introduction to gammapy analysis using the high
level interface.</p>
<p>Gammapy analysis consists in two main steps.</p>
<p>The first one is data reduction: user selected observations are reduced
to a geometry defined by the user. It can be 1D (spectrum from a given
extraction region) or 3D (with a sky projection and an energy axis). The
resulting reduced data and instrument response functions (IRF) are
called datasets in Gammapy.</p>
<p>The second step consists in setting a physical model on the datasets and
fitting it to obtain relevant physical information.</p>
<p><strong>Objective: Create a 3D dataset of the Crab using the H.E.S.S. DL3 data
release 1 and perform a simple model fitting of the Crab nebula.</strong></p>
</section>
<section id="proposed-approach">
<h2>Proposed approach<a class="headerlink" href="#proposed-approach" title="Link to this heading">#</a></h2>
<p>This notebook uses the high level <a class="reference internal" href="../../api/gammapy.analysis.Analysis.html#gammapy.analysis.Analysis" title="gammapy.analysis.Analysis"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Analysis</span></code></a> class to orchestrate data
reduction. In its current state, <a class="reference internal" href="../../api/gammapy.analysis.Analysis.html#gammapy.analysis.Analysis" title="gammapy.analysis.Analysis"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Analysis</span></code></a> supports the standard
analysis cases of joint or stacked 3D and 1D analyses. It is
instantiated with an <a class="reference internal" href="../../api/gammapy.analysis.AnalysisConfig.html#gammapy.analysis.AnalysisConfig" title="gammapy.analysis.AnalysisConfig"><code class="xref py py-obj docutils literal notranslate"><span class="pre">AnalysisConfig</span></code></a> object that gives access to
analysis parameters either directly or via a YAML config file.</p>
<p>To see what is happening under-the-hood and to get an idea of the
internal API, a second notebook performs the same analysis without using
the <a class="reference internal" href="../../api/gammapy.analysis.Analysis.html#gammapy.analysis.Analysis" title="gammapy.analysis.Analysis"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Analysis</span></code></a> class.</p>
<p>In summary, we have to:</p>
<ul class="simple">
<li><p>Create an <a class="reference internal" href="../../api/gammapy.analysis.AnalysisConfig.html#gammapy.analysis.AnalysisConfig" title="gammapy.analysis.AnalysisConfig"><code class="xref py py-obj docutils literal notranslate"><span class="pre">AnalysisConfig</span></code></a> object and edit it to
define the analysis configuration:</p>
<ul>
<li><p>Define what observations to use</p></li>
<li><p>Define the geometry of the dataset (data and IRFs)</p></li>
<li><p>Define the model we want to fit on the dataset.</p></li>
</ul>
</li>
<li><p>Instantiate a <a class="reference internal" href="../../api/gammapy.analysis.Analysis.html#gammapy.analysis.Analysis" title="gammapy.analysis.Analysis"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Analysis</span></code></a> from this configuration
and run the different analysis steps</p>
<ul>
<li><p>Observation selection</p></li>
<li><p>Data reduction</p></li>
<li><p>Model fitting</p></li>
<li><p>Estimating flux points</p></li>
</ul>
</li>
</ul>
<p>Finally, we will compare the results against a reference model.</p>
</section>
<section id="setup">
<h2>Setup<a class="headerlink" href="#setup" title="Link to this heading">#</a></h2>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <a href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="pathlib.Path" class="sphx-glr-backref-module-pathlib sphx-glr-backref-type-py-class"><span class="n">Path</span></a>
<span class="kn">from</span> <span class="nn">astropy</span> <span class="kn">import</span> <span class="n">units</span> <span class="k">as</span> <span class="n">u</span>

<span class="c1"># %matplotlib inline</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">gammapy.analysis</span> <span class="kn">import</span> <a href="../../api/gammapy.analysis.Analysis.html#gammapy.analysis.Analysis" title="gammapy.analysis.Analysis" class="sphx-glr-backref-module-gammapy-analysis sphx-glr-backref-type-py-class"><span class="n">Analysis</span></a><span class="p">,</span> <a href="../../api/gammapy.analysis.AnalysisConfig.html#gammapy.analysis.AnalysisConfig" title="gammapy.analysis.AnalysisConfig" class="sphx-glr-backref-module-gammapy-analysis sphx-glr-backref-type-py-class"><span class="n">AnalysisConfig</span></a>
</pre></div>
</div>
</section>
<section id="check-setup">
<h2>Check setup<a class="headerlink" href="#check-setup" title="Link to this heading">#</a></h2>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">gammapy.utils.check</span> <span class="kn">import</span> <span class="n">check_tutorials_setup</span>

<span class="n">check_tutorials_setup</span><span class="p">()</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>System:

        python_executable      : /home/runner/work/gammapy-docs/gammapy-docs/gammapy/.tox/build_docs/bin/python
        python_version         : 3.9.20
        machine                : x86_64
        system                 : Linux


Gammapy package:

        version                : 1.3rc1
        path                   : /home/runner/work/gammapy-docs/gammapy-docs/gammapy/.tox/build_docs/lib/python3.9/site-packages/gammapy


Other packages:

        numpy                  : 1.26.4
        scipy                  : 1.13.1
        astropy                : 5.2.2
        regions                : 0.8
        click                  : 8.1.7
        yaml                   : 6.0.2
        IPython                : 8.18.1
        jupyterlab             : not installed
        matplotlib             : 3.9.2
        pandas                 : not installed
        healpy                 : 1.17.3
        iminuit                : 2.30.1
        sherpa                 : 4.16.1
        naima                  : 0.10.0
        emcee                  : 3.1.6
        corner                 : 2.2.2
        ray                    : 2.39.0


Gammapy environment variables:

        GAMMAPY_DATA           : /home/runner/work/gammapy-docs/gammapy-docs/gammapy-datasets/1.3rc1
</pre></div>
</div>
</section>
<section id="analysis-configuration">
<h2>Analysis configuration<a class="headerlink" href="#analysis-configuration" title="Link to this heading">#</a></h2>
<p>For configuration of the analysis we use the
<a class="reference external" href="https://en.wikipedia.org/wiki/YAML">YAML</a> data format. YAML is a
machine readable serialisation format, that is also friendly for humans
to read. In this tutorial we will write the configuration file just
using Python strings, but of course the file can be created and modified
with any text editor of your choice.</p>
<p>Here is what the configuration for our analysis looks like:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="../../api/gammapy.analysis.AnalysisConfig.html#gammapy.analysis.AnalysisConfig" title="gammapy.analysis.AnalysisConfig" class="sphx-glr-backref-module-gammapy-analysis sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">config</span></a> <span class="o">=</span> <a href="../../api/gammapy.analysis.AnalysisConfig.html#gammapy.analysis.AnalysisConfig" title="gammapy.analysis.AnalysisConfig" class="sphx-glr-backref-module-gammapy-analysis sphx-glr-backref-type-py-class"><span class="n">AnalysisConfig</span></a><span class="p">()</span>
<span class="c1"># the AnalysisConfig gives access to the various parameters used from logging to reduced dataset geometries</span>
<span class="nb">print</span><span class="p">(</span><a href="../../api/gammapy.analysis.AnalysisConfig.html#gammapy.analysis.AnalysisConfig" title="gammapy.analysis.AnalysisConfig" class="sphx-glr-backref-module-gammapy-analysis sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">config</span></a><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>AnalysisConfig

    general:
        log:
            level: info
            filename: null
            filemode: null
            format: null
            datefmt: null
        outdir: .
        n_jobs: 1
        datasets_file: null
        models_file: null
    observations:
        datastore: /home/runner/work/gammapy-docs/gammapy-docs/gammapy-datasets/1.3rc1/hess-dl3-dr1
        obs_ids: []
        obs_file: null
        obs_cone:
            frame: null
            lon: null
            lat: null
            radius: null
        obs_time:
            start: null
            stop: null
        required_irf:
        - aeff
        - edisp
        - psf
        - bkg
    datasets:
        type: 1d
        stack: true
        geom:
            wcs:
                skydir:
                    frame: null
                    lon: null
                    lat: null
                binsize: 0.02 deg
                width:
                    width: 5.0 deg
                    height: 5.0 deg
                binsize_irf: 0.2 deg
            selection:
                offset_max: 2.5 deg
            axes:
                energy:
                    min: 1.0 TeV
                    max: 10.0 TeV
                    nbins: 5
                energy_true:
                    min: 0.5 TeV
                    max: 20.0 TeV
                    nbins: 16
        map_selection:
        - counts
        - exposure
        - background
        - psf
        - edisp
        background:
            method: null
            exclusion: null
            parameters: {}
        safe_mask:
            methods:
            - aeff-default
            parameters: {}
        on_region:
            frame: null
            lon: null
            lat: null
            radius: null
        containment_correction: true
    fit:
        fit_range:
            min: null
            max: null
    flux_points:
        energy:
            min: null
            max: null
            nbins: null
        source: source
        parameters:
            selection_optional: all
    excess_map:
        correlation_radius: 0.1 deg
        parameters: {}
        energy_edges:
            min: null
            max: null
            nbins: null
    light_curve:
        time_intervals:
            start: null
            stop: null
        energy_edges:
            min: null
            max: null
            nbins: null
        source: source
        parameters:
            selection_optional: all
    metadata:
        creator: Gammapy 1.3rc1
        date: &#39;2024-11-15T15:53:41.412643&#39;
        origin: null
</pre></div>
</div>
<section id="setting-the-data-to-use">
<h3>Setting the data to use<a class="headerlink" href="#setting-the-data-to-use" title="Link to this heading">#</a></h3>
<p>We want to use Crab runs from the H.E.S.S. DL3-DR1. We define here the
datastore and a cone search of observations pointing with 5 degrees of
the Crab nebula. Parameters can be set directly or as a python dict.</p>
<p>PS: do not forget to setup your environment variable <code class="xref py py-obj docutils literal notranslate"><span class="pre">$GAMMAPY_DATA</span></code> to
your local directory containing the H.E.S.S. DL3-DR1 as described in
<a class="reference internal" href="../../getting-started/quickstart.html#quickstart-setup"><span class="std std-ref">Recommended Setup</span></a>.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># We define the datastore containing the data</span>
<a href="https://docs.python.org/3/library/pathlib.html#pathlib.PosixPath" title="pathlib.PosixPath" class="sphx-glr-backref-module-pathlib sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">config</span><span class="o">.</span><span class="n">observations</span><span class="o">.</span><span class="n">datastore</span></a> <span class="o">=</span> <span class="s2">&quot;$GAMMAPY_DATA/hess-dl3-dr1&quot;</span>

<span class="c1"># We define the cone search parameters</span>
<a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">config</span><span class="o">.</span><span class="n">observations</span><span class="o">.</span><span class="n">obs_cone</span><span class="o">.</span><span class="n">frame</span></a> <span class="o">=</span> <span class="s2">&quot;icrs&quot;</span>
<a href="https://docs.astropy.org/en/latest/api/astropy.coordinates.Angle.html#astropy.coordinates.Angle" title="astropy.coordinates.Angle" class="sphx-glr-backref-module-astropy-coordinates sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">config</span><span class="o">.</span><span class="n">observations</span><span class="o">.</span><span class="n">obs_cone</span><span class="o">.</span><span class="n">lon</span></a> <span class="o">=</span> <span class="s2">&quot;83.633 deg&quot;</span>
<a href="https://docs.astropy.org/en/latest/api/astropy.coordinates.Angle.html#astropy.coordinates.Angle" title="astropy.coordinates.Angle" class="sphx-glr-backref-module-astropy-coordinates sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">config</span><span class="o">.</span><span class="n">observations</span><span class="o">.</span><span class="n">obs_cone</span><span class="o">.</span><span class="n">lat</span></a> <span class="o">=</span> <span class="s2">&quot;22.014 deg&quot;</span>
<a href="https://docs.astropy.org/en/latest/api/astropy.coordinates.Angle.html#astropy.coordinates.Angle" title="astropy.coordinates.Angle" class="sphx-glr-backref-module-astropy-coordinates sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">config</span><span class="o">.</span><span class="n">observations</span><span class="o">.</span><span class="n">obs_cone</span><span class="o">.</span><span class="n">radius</span></a> <span class="o">=</span> <span class="s2">&quot;5 deg&quot;</span>

<span class="c1"># Equivalently we could have set parameters with a python dict</span>
<span class="c1"># config.observations.obs_cone = {&quot;frame&quot;: &quot;icrs&quot;, &quot;lon&quot;: &quot;83.633 deg&quot;, &quot;lat&quot;: &quot;22.014 deg&quot;, &quot;radius&quot;: &quot;5 deg&quot;}</span>
</pre></div>
</div>
</section>
<section id="setting-the-reduced-datasets-geometry">
<h3>Setting the reduced datasets geometry<a class="headerlink" href="#setting-the-reduced-datasets-geometry" title="Link to this heading">#</a></h3>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># We want to perform a 3D analysis</span>
<a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">config</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">type</span></a> <span class="o">=</span> <span class="s2">&quot;3d&quot;</span>
<span class="c1"># We want to stack the data into a single reduced dataset</span>
<a href="https://docs.python.org/3/library/functions.html#bool" title="builtins.bool" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">config</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">stack</span></a> <span class="o">=</span> <span class="kc">True</span>

<span class="c1"># We fix the WCS geometry of the datasets</span>
<a href="../../api/gammapy.analysis.AnalysisConfig.html#gammapy.analysis.AnalysisConfig" title="gammapy.analysis.AnalysisConfig" class="sphx-glr-backref-module-gammapy-analysis sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">config</span></a><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">wcs</span><span class="o">.</span><span class="n">skydir</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;lon&quot;</span><span class="p">:</span> <span class="s2">&quot;83.633 deg&quot;</span><span class="p">,</span>
    <span class="s2">&quot;lat&quot;</span><span class="p">:</span> <span class="s2">&quot;22.014 deg&quot;</span><span class="p">,</span>
    <span class="s2">&quot;frame&quot;</span><span class="p">:</span> <span class="s2">&quot;icrs&quot;</span><span class="p">,</span>
<span class="p">}</span>
<a href="../../api/gammapy.analysis.AnalysisConfig.html#gammapy.analysis.AnalysisConfig" title="gammapy.analysis.AnalysisConfig" class="sphx-glr-backref-module-gammapy-analysis sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">config</span></a><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">wcs</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;width&quot;</span><span class="p">:</span> <span class="s2">&quot;2 deg&quot;</span><span class="p">,</span> <span class="s2">&quot;height&quot;</span><span class="p">:</span> <span class="s2">&quot;2 deg&quot;</span><span class="p">}</span>
<a href="https://docs.astropy.org/en/latest/api/astropy.coordinates.Angle.html#astropy.coordinates.Angle" title="astropy.coordinates.Angle" class="sphx-glr-backref-module-astropy-coordinates sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">config</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">wcs</span><span class="o">.</span><span class="n">binsize</span></a> <span class="o">=</span> <span class="s2">&quot;0.02 deg&quot;</span>

<span class="c1"># We now fix the energy axis for the counts map</span>
<a href="https://docs.astropy.org/en/latest/api/astropy.units.Quantity.html#astropy.units.Quantity" title="astropy.units.Quantity" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">config</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">energy</span><span class="o">.</span><span class="n">min</span></a> <span class="o">=</span> <span class="s2">&quot;1 TeV&quot;</span>
<a href="https://docs.astropy.org/en/latest/api/astropy.units.Quantity.html#astropy.units.Quantity" title="astropy.units.Quantity" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">config</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">energy</span><span class="o">.</span><span class="n">max</span></a> <span class="o">=</span> <span class="s2">&quot;10 TeV&quot;</span>
<a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">config</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">energy</span><span class="o">.</span><span class="n">nbins</span></a> <span class="o">=</span> <span class="mi">10</span>

<span class="c1"># We now fix the energy axis for the IRF maps (exposure, etc)</span>
<a href="https://docs.astropy.org/en/latest/api/astropy.units.Quantity.html#astropy.units.Quantity" title="astropy.units.Quantity" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">config</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">energy_true</span><span class="o">.</span><span class="n">min</span></a> <span class="o">=</span> <span class="s2">&quot;0.5 TeV&quot;</span>
<a href="https://docs.astropy.org/en/latest/api/astropy.units.Quantity.html#astropy.units.Quantity" title="astropy.units.Quantity" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">config</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">energy_true</span><span class="o">.</span><span class="n">max</span></a> <span class="o">=</span> <span class="s2">&quot;20 TeV&quot;</span>
<a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">config</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">energy_true</span><span class="o">.</span><span class="n">nbins</span></a> <span class="o">=</span> <span class="mi">20</span>
</pre></div>
</div>
</section>
<section id="setting-the-background-normalization-maker">
<h3>Setting the background normalization maker<a class="headerlink" href="#setting-the-background-normalization-maker" title="Link to this heading">#</a></h3>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">config</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">background</span><span class="o">.</span><span class="n">method</span></a> <span class="o">=</span> <span class="s2">&quot;fov_background&quot;</span>
<a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">config</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">background</span><span class="o">.</span><span class="n">parameters</span></a> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;method&quot;</span><span class="p">:</span> <span class="s2">&quot;scale&quot;</span><span class="p">}</span>
</pre></div>
</div>
</section>
<section id="setting-the-exclusion-mask">
<h3>Setting the exclusion mask<a class="headerlink" href="#setting-the-exclusion-mask" title="Link to this heading">#</a></h3>
<p>In order to properly adjust the background normalisation on regions
without gamma-ray signal, one needs to define an exclusion mask for the
background normalisation. For this tutorial, we use the following one
<code class="docutils literal notranslate"><span class="pre">$GAMMAPY_DATA/joint-crab/exclusion/exclusion_mask_crab.fits.gz</span></code></p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/pathlib.html#pathlib.PosixPath" title="pathlib.PosixPath" class="sphx-glr-backref-module-pathlib sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">config</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">background</span><span class="o">.</span><span class="n">exclusion</span></a> <span class="o">=</span> <span class="p">(</span>
    <span class="s2">&quot;$GAMMAPY_DATA/joint-crab/exclusion/exclusion_mask_crab.fits.gz&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
<section id="setting-modeling-and-fitting-parameters">
<h3>Setting modeling and fitting parameters<a class="headerlink" href="#setting-modeling-and-fitting-parameters" title="Link to this heading">#</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">Analysis</span></code> can perform a few modeling and fitting tasks besides data
reduction. Parameters have then to be passed to the configuration
object.</p>
<p>Here we define the energy range on which to perform the fit. We also set
the energy edges used for flux point computation as well as the
correlation radius to compute excess and significance maps.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://docs.astropy.org/en/latest/api/astropy.units.Quantity.html#astropy.units.Quantity" title="astropy.units.Quantity" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">config</span><span class="o">.</span><span class="n">fit</span><span class="o">.</span><span class="n">fit_range</span><span class="o">.</span><span class="n">min</span></a> <span class="o">=</span> <span class="mi">1</span> <span class="o">*</span> <a href="https://docs.astropy.org/en/latest/api/astropy.units.PrefixUnit.html#astropy.units.PrefixUnit" title="astropy.units.PrefixUnit" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">u</span><span class="o">.</span><span class="n">TeV</span></a>
<a href="https://docs.astropy.org/en/latest/api/astropy.units.Quantity.html#astropy.units.Quantity" title="astropy.units.Quantity" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">config</span><span class="o">.</span><span class="n">fit</span><span class="o">.</span><span class="n">fit_range</span><span class="o">.</span><span class="n">max</span></a> <span class="o">=</span> <span class="mi">10</span> <span class="o">*</span> <a href="https://docs.astropy.org/en/latest/api/astropy.units.PrefixUnit.html#astropy.units.PrefixUnit" title="astropy.units.PrefixUnit" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">u</span><span class="o">.</span><span class="n">TeV</span></a>
<a href="../../api/gammapy.analysis.AnalysisConfig.html#gammapy.analysis.AnalysisConfig" title="gammapy.analysis.AnalysisConfig" class="sphx-glr-backref-module-gammapy-analysis sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">config</span></a><span class="o">.</span><span class="n">flux_points</span><span class="o">.</span><span class="n">energy</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;min&quot;</span><span class="p">:</span> <span class="s2">&quot;1 TeV&quot;</span><span class="p">,</span> <span class="s2">&quot;max&quot;</span><span class="p">:</span> <span class="s2">&quot;10 TeV&quot;</span><span class="p">,</span> <span class="s2">&quot;nbins&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">}</span>
<a href="https://docs.astropy.org/en/latest/api/astropy.coordinates.Angle.html#astropy.coordinates.Angle" title="astropy.coordinates.Angle" class="sphx-glr-backref-module-astropy-coordinates sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">config</span><span class="o">.</span><span class="n">excess_map</span><span class="o">.</span><span class="n">correlation_radius</span></a> <span class="o">=</span> <span class="mf">0.1</span> <span class="o">*</span> <a href="https://docs.astropy.org/en/latest/api/astropy.units.Unit.html#astropy.units.Unit" title="astropy.units.Unit" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">u</span><span class="o">.</span><span class="n">deg</span></a>
</pre></div>
</div>
<p>We’re all set. But before we go on let’s see how to save or import
<code class="docutils literal notranslate"><span class="pre">AnalysisConfig</span></code> objects though YAML files.</p>
</section>
<section id="using-yaml-configuration-files">
<h3>Using YAML configuration files<a class="headerlink" href="#using-yaml-configuration-files" title="Link to this heading">#</a></h3>
<p>One can export/import the <code class="xref py py-obj docutils literal notranslate"><span class="pre">AnalysisConfig</span></code> to/from a YAML file.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="../../api/gammapy.analysis.AnalysisConfig.html#gammapy.analysis.AnalysisConfig.write" title="gammapy.analysis.AnalysisConfig.write" class="sphx-glr-backref-module-gammapy-analysis sphx-glr-backref-type-py-method"><span class="n">config</span><span class="o">.</span><span class="n">write</span></a><span class="p">(</span><span class="s2">&quot;config.yaml&quot;</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<a href="../../api/gammapy.analysis.AnalysisConfig.html#gammapy.analysis.AnalysisConfig" title="gammapy.analysis.AnalysisConfig" class="sphx-glr-backref-module-gammapy-analysis sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">config</span></a> <span class="o">=</span> <a href="../../api/gammapy.analysis.AnalysisConfig.html#gammapy.analysis.AnalysisConfig.read" title="gammapy.analysis.AnalysisConfig.read" class="sphx-glr-backref-module-gammapy-analysis sphx-glr-backref-type-py-method"><span class="n">AnalysisConfig</span><span class="o">.</span><span class="n">read</span></a><span class="p">(</span><span class="s2">&quot;config.yaml&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><a href="../../api/gammapy.analysis.AnalysisConfig.html#gammapy.analysis.AnalysisConfig" title="gammapy.analysis.AnalysisConfig" class="sphx-glr-backref-module-gammapy-analysis sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">config</span></a><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>AnalysisConfig

    general:
        log:
            level: info
            filename: null
            filemode: null
            format: null
            datefmt: null
        outdir: .
        n_jobs: 1
        datasets_file: null
        models_file: null
    observations:
        datastore: /home/runner/work/gammapy-docs/gammapy-docs/gammapy-datasets/1.3rc1/hess-dl3-dr1
        obs_ids: []
        obs_file: null
        obs_cone:
            frame: icrs
            lon: 83.633 deg
            lat: 22.014 deg
            radius: 5.0 deg
        obs_time:
            start: null
            stop: null
        required_irf:
        - aeff
        - edisp
        - psf
        - bkg
    datasets:
        type: 3d
        stack: true
        geom:
            wcs:
                skydir:
                    frame: icrs
                    lon: 83.633 deg
                    lat: 22.014 deg
                binsize: 0.02 deg
                width:
                    width: 2.0 deg
                    height: 2.0 deg
                binsize_irf: 0.2 deg
            selection:
                offset_max: 2.5 deg
            axes:
                energy:
                    min: 1.0 TeV
                    max: 10.0 TeV
                    nbins: 10
                energy_true:
                    min: 0.5 TeV
                    max: 20.0 TeV
                    nbins: 20
        map_selection:
        - counts
        - exposure
        - background
        - psf
        - edisp
        background:
            method: fov_background
            exclusion: /home/runner/work/gammapy-docs/gammapy-docs/gammapy-datasets/1.3rc1/joint-crab/exclusion/exclusion_mask_crab.fits.gz
            parameters:
                method: scale
        safe_mask:
            methods:
            - aeff-default
            parameters: {}
        on_region:
            frame: null
            lon: null
            lat: null
            radius: null
        containment_correction: true
    fit:
        fit_range:
            min: 1.0 TeV
            max: 10.0 TeV
    flux_points:
        energy:
            min: 1.0 TeV
            max: 10.0 TeV
            nbins: 4
        source: source
        parameters:
            selection_optional: all
    excess_map:
        correlation_radius: 0.1 deg
        parameters: {}
        energy_edges:
            min: null
            max: null
            nbins: null
    light_curve:
        time_intervals:
            start: null
            stop: null
        energy_edges:
            min: null
            max: null
            nbins: null
        source: source
        parameters:
            selection_optional: all
    metadata:
        creator: Gammapy 1.3rc1
        date: &#39;2024-11-15T15:53:41.438798&#39;
        origin: null
</pre></div>
</div>
</section>
</section>
<section id="running-the-analysis">
<h2>Running the analysis<a class="headerlink" href="#running-the-analysis" title="Link to this heading">#</a></h2>
<p>We first create an <a class="reference internal" href="../../api/gammapy.analysis.Analysis.html#gammapy.analysis.Analysis" title="gammapy.analysis.Analysis"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Analysis</span></code></a> object from our
configuration.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="../../api/gammapy.analysis.Analysis.html#gammapy.analysis.Analysis" title="gammapy.analysis.Analysis" class="sphx-glr-backref-module-gammapy-analysis sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">analysis</span></a> <span class="o">=</span> <a href="../../api/gammapy.analysis.Analysis.html#gammapy.analysis.Analysis" title="gammapy.analysis.Analysis" class="sphx-glr-backref-module-gammapy-analysis sphx-glr-backref-type-py-class"><span class="n">Analysis</span></a><span class="p">(</span><a href="../../api/gammapy.analysis.AnalysisConfig.html#gammapy.analysis.AnalysisConfig" title="gammapy.analysis.AnalysisConfig" class="sphx-glr-backref-module-gammapy-analysis sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">config</span></a><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Setting logging config: {&#39;level&#39;: &#39;INFO&#39;, &#39;filename&#39;: None, &#39;filemode&#39;: None, &#39;format&#39;: None, &#39;datefmt&#39;: None}
</pre></div>
</div>
<section id="observation-selection">
<h3>Observation selection<a class="headerlink" href="#observation-selection" title="Link to this heading">#</a></h3>
<p>We can directly select and load the observations from disk using
<a class="reference internal" href="../../api/gammapy.analysis.Analysis.html#gammapy.analysis.Analysis.get_observations" title="gammapy.analysis.Analysis.get_observations"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_observations()</span></code></a>:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="../../api/gammapy.analysis.Analysis.html#gammapy.analysis.Analysis.get_observations" title="gammapy.analysis.Analysis.get_observations" class="sphx-glr-backref-module-gammapy-analysis sphx-glr-backref-type-py-method"><span class="n">analysis</span><span class="o">.</span><span class="n">get_observations</span></a><span class="p">()</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Fetching observations.
Observations selected: 4 out of 4.
Number of selected observations: 4
</pre></div>
</div>
<p>The observations are now available on the <code class="xref py py-obj docutils literal notranslate"><span class="pre">Analysis</span></code> object. The
selection corresponds to the following ids:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><a href="../../api/gammapy.data.Observations.html#gammapy.data.Observations.ids" title="gammapy.data.Observations.ids" class="sphx-glr-backref-module-gammapy-data sphx-glr-backref-type-py-attribute"><span class="n">analysis</span><span class="o">.</span><span class="n">observations</span><span class="o">.</span><span class="n">ids</span></a><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[&#39;23523&#39;, &#39;23526&#39;, &#39;23559&#39;, &#39;23592&#39;]
</pre></div>
</div>
<p>To see how to explore observations, please refer to the following
notebook: <a class="reference internal" href="../data/cta.html"><span class="doc">CTA with Gammapy</span></a> or <a class="reference internal" href="../data/hess.html"><span class="doc">H.E.S.S. with
Gammapy</span></a></p>
</section>
</section>
<section id="data-reduction">
<h2>Data reduction<a class="headerlink" href="#data-reduction" title="Link to this heading">#</a></h2>
<p>Now we proceed to the data reduction. In the config file we have chosen
a WCS map geometry, energy axis and decided to stack the maps. We can
run the reduction using <code class="xref py py-obj docutils literal notranslate"><span class="pre">get_datasets()</span></code>:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="../../api/gammapy.analysis.Analysis.html#gammapy.analysis.Analysis.get_datasets" title="gammapy.analysis.Analysis.get_datasets" class="sphx-glr-backref-module-gammapy-analysis sphx-glr-backref-type-py-method"><span class="n">analysis</span><span class="o">.</span><span class="n">get_datasets</span></a><span class="p">()</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Creating reference dataset and makers.
Creating the background Maker.
Start the data reduction loop.
Computing dataset for observation 23523
Running MapDatasetMaker
Running SafeMaskMaker
Running FoVBackgroundMaker
Computing dataset for observation 23526
Running MapDatasetMaker
Running SafeMaskMaker
Running FoVBackgroundMaker
Computing dataset for observation 23559
Running MapDatasetMaker
Running SafeMaskMaker
Running FoVBackgroundMaker
Computing dataset for observation 23592
Running MapDatasetMaker
Running SafeMaskMaker
Running FoVBackgroundMaker
</pre></div>
</div>
<p>As we have chosen to stack the data, there is finally one dataset
contained which we can print:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><a href="../../api/gammapy.datasets.Datasets.html#gammapy.datasets.Datasets" title="gammapy.datasets.Datasets" class="sphx-glr-backref-module-gammapy-datasets sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">analysis</span><span class="o">.</span><span class="n">datasets</span></a><span class="p">[</span><span class="s2">&quot;stacked&quot;</span><span class="p">])</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>MapDataset
----------

  Name                            : stacked

  Total counts                    : 2485
  Total background counts         : 1997.49
  Total excess counts             : 487.51

  Predicted counts                : 1997.49
  Predicted background counts     : 1997.49
  Predicted excess counts         : nan

  Exposure min                    : 2.73e+08 m2 s
  Exposure max                    : 3.52e+09 m2 s

  Number of total bins            : 100000
  Number of fit bins              : 100000

  Fit statistic type              : cash
  Fit statistic value (-2 log(L)) : nan

  Number of models                : 0
  Number of parameters            : 0
  Number of free parameters       : 0
</pre></div>
</div>
<p>As you can see the dataset comes with a predefined background model out
of the data reduction, but no source model has been set yet.</p>
<p>The counts, exposure and background model maps are directly available on
the dataset and can be printed and plotted:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="../../api/gammapy.maps.WcsNDMap.html#gammapy.maps.WcsNDMap" title="gammapy.maps.WcsNDMap" class="sphx-glr-backref-module-gammapy-maps sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">counts</span></a> <span class="o">=</span> <a href="../../api/gammapy.datasets.Datasets.html#gammapy.datasets.Datasets" title="gammapy.datasets.Datasets" class="sphx-glr-backref-module-gammapy-datasets sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">analysis</span><span class="o">.</span><span class="n">datasets</span></a><span class="p">[</span><span class="s2">&quot;stacked&quot;</span><span class="p">]</span><span class="o">.</span><a href="../../api/gammapy.maps.WcsNDMap.html#gammapy.maps.WcsNDMap" title="gammapy.maps.WcsNDMap" class="sphx-glr-backref-module-gammapy-maps sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">counts</span></a>
<a href="../../api/gammapy.maps.WcsNDMap.html#gammapy.maps.WcsNDMap.smooth" title="gammapy.maps.WcsNDMap.smooth" class="sphx-glr-backref-module-gammapy-maps sphx-glr-backref-type-py-method"><span class="n">counts</span><span class="o">.</span><span class="n">smooth</span></a><span class="p">(</span><span class="s2">&quot;0.05 deg&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">plot_interactive</span><span class="p">()</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_analysis_1_001.png" srcset="../../_images/sphx_glr_analysis_1_001.png" alt="analysis 1" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>interactive(children=(SelectionSlider(continuous_update=False, description=&#39;Select energy:&#39;, layout=Layout(width=&#39;50%&#39;), options=(&#39;1.00 TeV - 1.26 TeV&#39;, &#39;1.26 TeV - 1.58 TeV&#39;, &#39;1.58 TeV - 2.00 TeV&#39;, &#39;2.00 TeV - 2.51 TeV&#39;, &#39;2.51 TeV - 3.16 TeV&#39;, &#39;3.16 TeV - 3.98 TeV&#39;, &#39;3.98 TeV - 5.01 TeV&#39;, &#39;5.01 TeV - 6.31 TeV&#39;, &#39;6.31 TeV - 7.94 TeV&#39;, &#39;7.94 TeV - 10.0 TeV&#39;), style=SliderStyle(description_width=&#39;initial&#39;), value=&#39;1.00 TeV - 1.26 TeV&#39;), RadioButtons(description=&#39;Select stretch:&#39;, index=1, options=(&#39;linear&#39;, &#39;sqrt&#39;, &#39;log&#39;), style=DescriptionStyle(description_width=&#39;initial&#39;), value=&#39;sqrt&#39;), Output()), _dom_classes=(&#39;widget-interact&#39;,))
</pre></div>
</div>
<p>We can also compute the map of the sqrt_ts (significance) of the excess
counts above the background. The correlation radius to sum counts is
defined in the config file.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="../../api/gammapy.analysis.Analysis.html#gammapy.analysis.Analysis.get_excess_map" title="gammapy.analysis.Analysis.get_excess_map" class="sphx-glr-backref-module-gammapy-analysis sphx-glr-backref-type-py-method"><span class="n">analysis</span><span class="o">.</span><span class="n">get_excess_map</span></a><span class="p">()</span>
<a href="../../api/gammapy.estimators.FluxMaps.html#gammapy.estimators.FluxMaps" title="gammapy.estimators.FluxMaps" class="sphx-glr-backref-module-gammapy-estimators sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">analysis</span><span class="o">.</span><span class="n">excess_map</span></a><span class="p">[</span><span class="s2">&quot;sqrt_ts&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">add_cbar</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.show.html#matplotlib.pyplot.show" title="matplotlib.pyplot.show" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">show</span></a><span class="p">()</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_analysis_1_002.png" srcset="../../_images/sphx_glr_analysis_1_002.png" alt="analysis 1" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Computing excess maps.
</pre></div>
</div>
</section>
<section id="save-dataset-to-disk">
<h2>Save dataset to disk<a class="headerlink" href="#save-dataset-to-disk" title="Link to this heading">#</a></h2>
<p>It is common to run the preparation step independent of the likelihood
fit, because often the preparation of maps, PSF and energy dispersion is
slow if you have a lot of data. We first create a folder:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/pathlib.html#pathlib.PosixPath" title="pathlib.PosixPath" class="sphx-glr-backref-module-pathlib sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">path</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="pathlib.Path" class="sphx-glr-backref-module-pathlib sphx-glr-backref-type-py-class"><span class="n">Path</span></a><span class="p">(</span><span class="s2">&quot;analysis_1&quot;</span><span class="p">)</span>
<a href="https://docs.python.org/3/library/pathlib.html#pathlib.Path.mkdir" title="pathlib.Path.mkdir" class="sphx-glr-backref-module-pathlib sphx-glr-backref-type-py-method"><span class="n">path</span><span class="o">.</span><span class="n">mkdir</span></a><span class="p">(</span><span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>And then write the maps and IRFs to disk by calling the dedicated
<a class="reference internal" href="../../api/gammapy.datasets.Datasets.html#gammapy.datasets.Datasets.write" title="gammapy.datasets.Datasets.write"><code class="xref py py-obj docutils literal notranslate"><span class="pre">write</span></code></a> method:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/pathlib.html#pathlib.PosixPath" title="pathlib.PosixPath" class="sphx-glr-backref-module-pathlib sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">filename</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/pathlib.html#pathlib.PosixPath" title="pathlib.PosixPath" class="sphx-glr-backref-module-pathlib sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">path</span></a> <span class="o">/</span> <span class="s2">&quot;crab-stacked-dataset.fits.gz&quot;</span>
<a href="../../api/gammapy.datasets.Datasets.html#gammapy.datasets.Datasets" title="gammapy.datasets.Datasets" class="sphx-glr-backref-module-gammapy-datasets sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">analysis</span><span class="o">.</span><span class="n">datasets</span></a><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><a href="https://docs.python.org/3/library/pathlib.html#pathlib.PosixPath" title="pathlib.PosixPath" class="sphx-glr-backref-module-pathlib sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">filename</span></a><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="model-fitting">
<h2>Model fitting<a class="headerlink" href="#model-fitting" title="Link to this heading">#</a></h2>
<p>Now we define a model to be fitted to the dataset. Here we use its YAML
definition to load it:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">model_config</span></a> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">components:</span>
<span class="s2">- name: crab</span>
<span class="s2">  type: SkyModel</span>
<span class="s2">  spatial:</span>
<span class="s2">    type: PointSpatialModel</span>
<span class="s2">    frame: icrs</span>
<span class="s2">    parameters:</span>
<span class="s2">    - name: lon_0</span>
<span class="s2">      value: 83.63</span>
<span class="s2">      unit: deg</span>
<span class="s2">    - name: lat_0</span>
<span class="s2">      value: 22.014</span>
<span class="s2">      unit: deg</span>
<span class="s2">  spectral:</span>
<span class="s2">    type: PowerLawSpectralModel</span>
<span class="s2">    parameters:</span>
<span class="s2">    - name: amplitude</span>
<span class="s2">      value: 1.0e-12</span>
<span class="s2">      unit: cm-2 s-1 TeV-1</span>
<span class="s2">    - name: index</span>
<span class="s2">      value: 2.0</span>
<span class="s2">      unit: &#39;&#39;</span>
<span class="s2">    - name: reference</span>
<span class="s2">      value: 1.0</span>
<span class="s2">      unit: TeV</span>
<span class="s2">      frozen: true</span>
<span class="s2">&quot;&quot;&quot;</span>
</pre></div>
</div>
<p>Now we set the model on the analysis object:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="../../api/gammapy.analysis.Analysis.html#gammapy.analysis.Analysis.set_models" title="gammapy.analysis.Analysis.set_models" class="sphx-glr-backref-module-gammapy-analysis sphx-glr-backref-type-py-method"><span class="n">analysis</span><span class="o">.</span><span class="n">set_models</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">model_config</span></a><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Reading model.
Models

Component 0: SkyModel

  Name                      : crab
  Datasets names            : None
  Spectral model type       : PowerLawSpectralModel
  Spatial  model type       : PointSpatialModel
  Temporal model type       :
  Parameters:
    index                         :      2.000   +/-    0.00
    amplitude                     :   1.00e-12   +/- 0.0e+00 1 / (cm2 s TeV)
    reference             (frozen):      1.000       TeV
    lon_0                         :     83.630   +/-    0.00 deg
    lat_0                         :     22.014   +/-    0.00 deg

Component 1: FoVBackgroundModel

  Name                      : stacked-bkg
  Datasets names            : [&#39;stacked&#39;]
  Spectral model type       : PowerLawNormSpectralModel
  Parameters:
    norm                          :      1.000   +/-    0.00
    tilt                  (frozen):      0.000
    reference             (frozen):      1.000       TeV
</pre></div>
</div>
<p>Finally we run the fit:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="../../api/gammapy.analysis.Analysis.html#gammapy.analysis.Analysis.run_fit" title="gammapy.analysis.Analysis.run_fit" class="sphx-glr-backref-module-gammapy-analysis sphx-glr-backref-type-py-method"><span class="n">analysis</span><span class="o">.</span><span class="n">run_fit</span></a><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><a href="../../api/gammapy.modeling.FitResult.html#gammapy.modeling.FitResult" title="gammapy.modeling.FitResult" class="sphx-glr-backref-module-gammapy-modeling sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">analysis</span><span class="o">.</span><span class="n">fit_result</span></a><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Fitting datasets.
OptimizeResult

        backend    : minuit
        method     : migrad
        success    : True
        message    : Optimization terminated successfully.
        nfev       : 268
        total stat : 19991.66

CovarianceResult

        backend    : minuit
        method     : hesse
        success    : True
        message    : Hesse terminated successfully.

OptimizeResult

        backend    : minuit
        method     : migrad
        success    : True
        message    : Optimization terminated successfully.
        nfev       : 268
        total stat : 19991.66

CovarianceResult

        backend    : minuit
        method     : hesse
        success    : True
        message    : Hesse terminated successfully.
</pre></div>
</div>
<p>This is how we can write the model back to file again:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/pathlib.html#pathlib.PosixPath" title="pathlib.PosixPath" class="sphx-glr-backref-module-pathlib sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">filename</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/pathlib.html#pathlib.PosixPath" title="pathlib.PosixPath" class="sphx-glr-backref-module-pathlib sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">path</span></a> <span class="o">/</span> <span class="s2">&quot;model-best-fit.yaml&quot;</span>
<a href="../../api/gammapy.analysis.Analysis.html#gammapy.analysis.Analysis.models" title="gammapy.analysis.Analysis.models" class="sphx-glr-backref-module-gammapy-analysis sphx-glr-backref-type-py-attribute"><span class="n">analysis</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">write</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/pathlib.html#pathlib.PosixPath" title="pathlib.PosixPath" class="sphx-glr-backref-module-pathlib sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">filename</span></a><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="k">with</span> <a href="https://docs.python.org/3/library/pathlib.html#pathlib.Path.open" title="pathlib.Path.open" class="sphx-glr-backref-module-pathlib sphx-glr-backref-type-py-method"><span class="n">filename</span><span class="o">.</span><span class="n">open</span></a><span class="p">(</span><span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <a href="https://docs.python.org/3/library/io.html#io.TextIOWrapper" title="io.TextIOWrapper" class="sphx-glr-backref-module-io sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">f</span></a><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><a href="https://docs.python.org/3/library/io.html#io.TextIOWrapper" title="io.TextIOWrapper" class="sphx-glr-backref-module-io sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">f</span></a><span class="o">.</span><span class="n">read</span><span class="p">())</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>components:
-   name: crab
    type: SkyModel
    spectral:
        type: PowerLawSpectralModel
        parameters:
        -   name: index
            value: 2.558338072878877
            error: 0.1032531953505502
        -   name: amplitude
            value: 4.549007644529844e-11
            unit: cm-2 s-1 TeV-1
            error: 3.731589446928548e-12
        -   name: reference
            value: 1.0
            unit: TeV
    spatial:
        type: PointSpatialModel
        frame: icrs
        parameters:
        -   name: lon_0
            value: 83.61975454954816
            unit: deg
            error: 0.0031052863692021915
        -   name: lat_0
            value: 22.024715584699834
            unit: deg
            error: 0.0029202684427718766
-   type: FoVBackgroundModel
    datasets_names:
    - stacked
    spectral:
        type: PowerLawNormSpectralModel
        parameters:
        -   name: norm
            value: 0.9868440049211211
            error: 0.023472814714293713
        -   name: tilt
            value: 0.0
        -   name: reference
            value: 1.0
            unit: TeV
covariance: model-best-fit_covariance.dat
metadata:
    creator: Gammapy 1.3rc1
    date: &#39;2024-11-15T15:53:50.190563&#39;
    origin: null
</pre></div>
</div>
<section id="flux-points">
<h3>Flux points<a class="headerlink" href="#flux-points" title="Link to this heading">#</a></h3>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="../../api/gammapy.analysis.Analysis.html#gammapy.analysis.Analysis.config" title="gammapy.analysis.Analysis.config" class="sphx-glr-backref-module-gammapy-analysis sphx-glr-backref-type-py-attribute"><span class="n">analysis</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">flux_points</span><span class="o">.</span><span class="n">source</span></a> <span class="o">=</span> <span class="s2">&quot;crab&quot;</span>
<span class="c1"># Example showing how to change the FluxPointsEstimator parameters:</span>
<a href="../../api/gammapy.analysis.Analysis.html#gammapy.analysis.Analysis.config" title="gammapy.analysis.Analysis.config" class="sphx-glr-backref-module-gammapy-analysis sphx-glr-backref-type-py-attribute"><span class="n">analysis</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">flux_points</span><span class="o">.</span><span class="n">energy</span><span class="o">.</span><span class="n">nbins</span></a> <span class="o">=</span> <span class="mi">5</span>
<a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">config_dict</span></a> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;selection_optional&quot;</span><span class="p">:</span> <span class="s2">&quot;all&quot;</span><span class="p">,</span>
    <span class="s2">&quot;n_sigma&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>  <span class="c1"># Number of sigma to use for asymmetric error computation</span>
    <span class="s2">&quot;n_sigma_ul&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>  <span class="c1"># Number of sigma to use for upper limit computation</span>
<span class="p">}</span>
<a href="../../api/gammapy.analysis.Analysis.html#gammapy.analysis.Analysis.config" title="gammapy.analysis.Analysis.config" class="sphx-glr-backref-module-gammapy-analysis sphx-glr-backref-type-py-attribute"><span class="n">analysis</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">flux_points</span><span class="o">.</span><span class="n">parameters</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">config_dict</span></a>

<a href="../../api/gammapy.analysis.Analysis.html#gammapy.analysis.Analysis.get_flux_points" title="gammapy.analysis.Analysis.get_flux_points" class="sphx-glr-backref-module-gammapy-analysis sphx-glr-backref-type-py-method"><span class="n">analysis</span><span class="o">.</span><span class="n">get_flux_points</span></a><span class="p">()</span>

<span class="c1"># Example showing how to change just before plotting the threshold on the signal significance</span>
<span class="c1"># (points vs upper limits), even if this has no effect with this data set.</span>
<a href="../../api/gammapy.estimators.FluxPoints.html#gammapy.estimators.FluxPoints" title="gammapy.estimators.FluxPoints" class="sphx-glr-backref-module-gammapy-estimators sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fp</span></a> <span class="o">=</span> <a href="../../api/gammapy.estimators.FluxPoints.html#gammapy.estimators.FluxPoints" title="gammapy.estimators.FluxPoints" class="sphx-glr-backref-module-gammapy-estimators sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">analysis</span><span class="o">.</span><span class="n">flux_points</span><span class="o">.</span><span class="n">data</span></a>
<a href="../../api/gammapy.estimators.FluxPoints.html#gammapy.estimators.FluxPoints.sqrt_ts_threshold_ul" title="gammapy.estimators.FluxPoints.sqrt_ts_threshold_ul" class="sphx-glr-backref-module-gammapy-estimators sphx-glr-backref-type-py-attribute"><span class="n">fp</span><span class="o">.</span><span class="n">sqrt_ts_threshold_ul</span></a> <span class="o">=</span> <span class="mi">5</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.html#matplotlib.axes.Axes" title="matplotlib.axes.Axes" class="sphx-glr-backref-module-matplotlib-axes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ax_sed</span></a><span class="p">,</span> <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.html#matplotlib.axes.Axes" title="matplotlib.axes.Axes" class="sphx-glr-backref-module-matplotlib-axes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ax_residuals</span></a> <span class="o">=</span> <a href="../../api/gammapy.datasets.FluxPointsDataset.html#gammapy.datasets.FluxPointsDataset.plot_fit" title="gammapy.datasets.FluxPointsDataset.plot_fit" class="sphx-glr-backref-module-gammapy-datasets sphx-glr-backref-type-py-method"><span class="n">analysis</span><span class="o">.</span><span class="n">flux_points</span><span class="o">.</span><span class="n">plot_fit</span></a><span class="p">()</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.show.html#matplotlib.pyplot.show" title="matplotlib.pyplot.show" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">show</span></a><span class="p">()</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_analysis_1_003.png" srcset="../../_images/sphx_glr_analysis_1_003.png" alt="analysis 1" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Calculating flux points.
Reoptimize = False ignored for iminuit backend
Reoptimize = False ignored for iminuit backend
Reoptimize = False ignored for iminuit backend
Reoptimize = False ignored for iminuit backend
Reoptimize = False ignored for iminuit backend
Reoptimize = False ignored for iminuit backend
Reoptimize = False ignored for iminuit backend
Reoptimize = False ignored for iminuit backend
Reoptimize = False ignored for iminuit backend
Reoptimize = False ignored for iminuit backend
Inferred format: gadf-sed

      e_ref                 dnde         ...      sqrt_ts
       TeV            1 / (cm2 s TeV)    ...
------------------ --------------------- ... ------------------
1.2589254117941673 2.353592500058824e-11 ... 24.262554796103245
1.9952623149688797 8.843863242310971e-12 ... 22.394765638937866
3.1622776601683795  2.48180882997916e-12 ... 16.751643891117176
 5.011872336272724 6.137521287529426e-13 ...  11.92960065298276
 7.943282347242818 2.431023787974766e-13 ...  8.315767542862533
</pre></div>
</div>
<p>The flux points can be exported to a fits table following the format
defined
<a class="reference external" href="https://gamma-astro-data-formats.readthedocs.io/en/latest/spectra/flux_points/index.html">here</a></p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/pathlib.html#pathlib.PosixPath" title="pathlib.PosixPath" class="sphx-glr-backref-module-pathlib sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">filename</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/pathlib.html#pathlib.PosixPath" title="pathlib.PosixPath" class="sphx-glr-backref-module-pathlib sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">path</span></a> <span class="o">/</span> <span class="s2">&quot;flux-points.fits&quot;</span>
<a href="../../api/gammapy.datasets.FluxPointsDataset.html#gammapy.datasets.FluxPointsDataset.write" title="gammapy.datasets.FluxPointsDataset.write" class="sphx-glr-backref-module-gammapy-datasets sphx-glr-backref-type-py-method"><span class="n">analysis</span><span class="o">.</span><span class="n">flux_points</span><span class="o">.</span><span class="n">write</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/pathlib.html#pathlib.PosixPath" title="pathlib.PosixPath" class="sphx-glr-backref-module-pathlib sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">filename</span></a><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Inferred format: gadf-sed
</pre></div>
</div>
<p>To check the fit is correct, we compute the map of the sqrt_ts of the
excess counts above the current model.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="../../api/gammapy.analysis.Analysis.html#gammapy.analysis.Analysis.get_excess_map" title="gammapy.analysis.Analysis.get_excess_map" class="sphx-glr-backref-module-gammapy-analysis sphx-glr-backref-type-py-method"><span class="n">analysis</span><span class="o">.</span><span class="n">get_excess_map</span></a><span class="p">()</span>
<a href="../../api/gammapy.estimators.FluxMaps.html#gammapy.estimators.FluxMaps" title="gammapy.estimators.FluxMaps" class="sphx-glr-backref-module-gammapy-estimators sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">analysis</span><span class="o">.</span><span class="n">excess_map</span></a><span class="p">[</span><span class="s2">&quot;sqrt_ts&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">add_cbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;RdBu&quot;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=-</span><span class="mi">5</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.show.html#matplotlib.pyplot.show" title="matplotlib.pyplot.show" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">show</span></a><span class="p">()</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_analysis_1_004.png" srcset="../../_images/sphx_glr_analysis_1_004.png" alt="analysis 1" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Computing excess maps.
</pre></div>
</div>
</section>
</section>
<section id="whats-next">
<h2>What’s next<a class="headerlink" href="#whats-next" title="Link to this heading">#</a></h2>
<p>You can look at the same analysis without the high level interface in
<a class="reference internal" href="analysis_2.html"><span class="doc">Low level API</span></a></p>
<p>You can see how to perform a 1D spectral analysis of the same data in
<a class="reference internal" href="../analysis-1d/spectral_analysis.html"><span class="doc">Spectral analysis</span></a></p>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> (0 minutes 14.529 seconds)</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-tutorials-starting-analysis-1-py">
<div class="binder-badge docutils container">
<a class="reference external image-reference" href="https://mybinder.org/v2/gh/gammapy/gammapy-webpage/v1.3rc1?urlpath=lab/tree/notebooks/1.3rc1/tutorials/starting/analysis_1.ipynb"><img alt="Launch binder" src="../../_images/binder_badge_logo7.svg" style="width: 150px;" />
</a>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/db1b8939ed2daf51041ae443439e89d3/analysis_1.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">analysis_1.ipynb</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/6a374d8db39e1c104db3919be69ad847/analysis_1.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">analysis_1.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-zip docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/39983d17a2a11f56c5f5cc42710364f2/analysis_1.zip"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">zipped:</span> <span class="pre">analysis_1.zip</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>
</section>


                </article>
              
              
              
              
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#prerequisites">Prerequisites</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#context">Context</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#proposed-approach">Proposed approach</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#setup">Setup</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#check-setup">Check setup</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis-configuration">Analysis configuration</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#setting-the-data-to-use">Setting the data to use</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#setting-the-reduced-datasets-geometry">Setting the reduced datasets geometry</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#setting-the-background-normalization-maker">Setting the background normalization maker</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#setting-the-exclusion-mask">Setting the exclusion mask</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#setting-modeling-and-fitting-parameters">Setting modeling and fitting parameters</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#using-yaml-configuration-files">Using YAML configuration files</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#running-the-analysis">Running the analysis</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#observation-selection">Observation selection</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-reduction">Data reduction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#save-dataset-to-disk">Save dataset to disk</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#model-fitting">Model fitting</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#flux-points">Flux points</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#whats-next">What’s next</a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">

  <div class="tocsection sourcelink">
    <a href="../../_sources/tutorials/starting/analysis_1.rst.txt">
      <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../../_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549"></script>
<script defer src="../../_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2024, The Gammapy developers.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">
    
     <a href="https://gammapy.org/DataPrivacy.html">Data Privacy.</a>
</div>
      
    </div>
  
  
    <div class="footer-items__center">
      
        <div class="footer-item"><p class="last-updated">
  Last updated on 15 Nov 2024.
  <br/>
</p></div>
      
    </div>
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.4.7.
    <br/>
  </p>
</div>
      
        <div class="footer-item">
<p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.0.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>