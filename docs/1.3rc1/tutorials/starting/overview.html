
<!DOCTYPE html>


<html lang="en" data-content_root="../../" data-theme="light">

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Data structures &#8212; gammapy v1.3rc1</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "light";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  <!-- 
    this give us a css class that will be invisible only if js is disabled 
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css?v=fd3f3429" />
    <link rel="stylesheet" type="text/css" href="../../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css?v=d2d258e8" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css?v=203afaf9" />
  
  <!-- So that users can add custom icons -->
  <script src="../../_static/scripts/fontawesome.js?digest=26a4bc78f4c0ddb94549"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549" />

    <script src="../../_static/jquery.js?v=5d32c60e"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
    <script src="../../_static/documentation_options.js?v=e3e1e26b"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=30646c52"></script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'tutorials/starting/overview';</script>
    <script>
        DOCUMENTATION_OPTIONS.theme_version = '0.16.0';
        DOCUMENTATION_OPTIONS.theme_switcher_json_url = 'https://docs.gammapy.org/stable/switcher.json';
        DOCUMENTATION_OPTIONS.theme_switcher_version_match = '1.3rc1';
        DOCUMENTATION_OPTIONS.show_version_warning_banner = false;
        </script>
    <script src="../../_static/matomo.js?v=52704cab"></script>
    <link rel="icon" href="../../_static/gammapy_logo.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="High level interface" href="analysis_1.html" />
    <link rel="prev" title="Tutorials" href="../index.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="1.3rc1" />
    <meta name="docbuild:last-update" content="15 Nov 2024"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="light">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
    
    
    
    <img src="../../_static/gammapy_logo_nav.png" class="logo__image only-light" alt="gammapy v1.3rc1 - Home"/>
    <img src="../../_static/gammapy_logo_nav.png" class="logo__image only-dark pst-js-only" alt="gammapy v1.3rc1 - Home"/>
  
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../getting-started/index.html">
    Getting started
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../user-guide/index.html">
    User guide
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../index.html">
    Tutorials
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../api-reference/index.html">
    API reference
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../development/index.html">
    Developer guide
  </a>
</li>

            <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-nav-more-links">
                    More
                </button>
                <ul id="pst-nav-more-links" class="dropdown-menu">
                    
<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../../release-notes/index.html">
    Release notes
  </a>
</li>

                </ul>
            </li>
            
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">
<div class="version-switcher__container dropdown pst-js-only">
  <button id="pst-version-switcher-button-2"
    type="button"
    class="version-switcher__button btn btn-sm dropdown-toggle"
    data-bs-toggle="dropdown"
    aria-haspopup="listbox"
    aria-controls="pst-version-switcher-list-2"
    aria-label="Version switcher list"
  >
    Choose version  <!-- this text may get changed later by javascript -->
    <span class="caret"></span>
  </button>
  <div id="pst-version-switcher-list-2"
    class="version-switcher__menu dropdown-menu list-group-flush py-0"
    role="listbox" aria-labelledby="pst-version-switcher-button-2">
    <!-- dropdown will be populated by javascript on page load -->
  </div>
</div></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/gammapy/gammapy" title="Github" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fab fa-github-square fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Github</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://twitter.com/gammapyST" title="Twitter" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fab fa-square-x-twitter fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Twitter</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://gammapy.slack.com/" title="Slack" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fab fa-slack fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Slack</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../getting-started/index.html">
    Getting started
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../user-guide/index.html">
    User guide
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../index.html">
    Tutorials
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../api-reference/index.html">
    API reference
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../development/index.html">
    Developer guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../release-notes/index.html">
    Release notes
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">
<div class="version-switcher__container dropdown pst-js-only">
  <button id="pst-version-switcher-button-3"
    type="button"
    class="version-switcher__button btn btn-sm dropdown-toggle"
    data-bs-toggle="dropdown"
    aria-haspopup="listbox"
    aria-controls="pst-version-switcher-list-3"
    aria-label="Version switcher list"
  >
    Choose version  <!-- this text may get changed later by javascript -->
    <span class="caret"></span>
  </button>
  <div id="pst-version-switcher-list-3"
    class="version-switcher__menu dropdown-menu list-group-flush py-0"
    role="listbox" aria-labelledby="pst-version-switcher-button-3">
    <!-- dropdown will be populated by javascript on page load -->
  </div>
</div></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/gammapy/gammapy" title="Github" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fab fa-github-square fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Github</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://twitter.com/gammapyST" title="Twitter" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fab fa-square-x-twitter fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Twitter</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://gammapy.slack.com/" title="Slack" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fab fa-slack fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Slack</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Data structures</a></li>
<li class="toctree-l1"><a class="reference internal" href="analysis_1.html">High level interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="analysis_2.html">Low level API</a></li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../data/hess.html">H.E.S.S. with Gammapy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../data/cta.html">CTAO with Gammapy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../data/fermi_lat.html">Fermi-LAT with Gammapy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../data/hawc.html">HAWC with Gammapy</a></li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../analysis-1d/cta_sensitivity.html">Point source sensitivity</a></li>
<li class="toctree-l1"><a class="reference internal" href="../analysis-1d/spectral_analysis.html">Spectral analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../analysis-1d/spectral_analysis_hli.html">Spectral analysis with the HLI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../analysis-1d/spectral_analysis_rad_max.html">Spectral analysis with energy-dependent directional cuts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../analysis-1d/extended_source_spectral_analysis.html">Spectral analysis of extended sources</a></li>
<li class="toctree-l1"><a class="reference internal" href="../analysis-1d/spectrum_simulation.html">1D spectrum simulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../analysis-1d/sed_fitting.html">Flux point fitting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../analysis-1d/ebl.html">Account for spectral absorption due to the EBL</a></li>

</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../analysis-2d/detect.html">Source detection and significance maps</a></li>
<li class="toctree-l1"><a class="reference internal" href="../analysis-2d/ring_background.html">Ring background map</a></li>
<li class="toctree-l1"><a class="reference internal" href="../analysis-2d/modeling_2D.html">2D map fitting</a></li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../analysis-3d/analysis_3d.html">3D detailed analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../analysis-3d/cta_data_analysis.html">Basic image exploration and fitting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../analysis-3d/energy_dependent_estimation.html">Morphological energy dependence estimation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../analysis-3d/analysis_mwl.html">Multi instrument joint 3D and 1D analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../analysis-3d/simulate_3d.html">3D map simulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../analysis-3d/event_sampling.html">Event sampling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../analysis-3d/event_sampling_nrg_depend_models.html">Sample a source with energy-dependent temporal evolution</a></li>
<li class="toctree-l1"><a class="reference internal" href="../analysis-3d/flux_profiles.html">Flux Profile Estimation</a></li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../analysis-time/light_curve.html">Light curves</a></li>
<li class="toctree-l1"><a class="reference internal" href="../analysis-time/light_curve_flare.html">Light curves for flares</a></li>
<li class="toctree-l1"><a class="reference internal" href="../analysis-time/variability_estimation.html">Estimation of time variability in a lightcurve</a></li>
<li class="toctree-l1"><a class="reference internal" href="../analysis-time/time_resolved_spectroscopy.html">Time resolved spectroscopy estimator</a></li>
<li class="toctree-l1"><a class="reference internal" href="../analysis-time/light_curve_simulation.html">Simulating and fitting a time varying source</a></li>
<li class="toctree-l1"><a class="reference internal" href="../analysis-time/pulsar_analysis.html">Pulsar analysis</a></li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../api/irfs.html">Using Gammapy IRFs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/models.html">Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/priors.html">Priors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/astro_dark_matter.html">Dark matter spatial and spectral models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/maps.html">Maps</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/mask_maps.html">Mask maps</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/datasets.html">Datasets - Reduced data, IRFs, models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/makers.html">Makers - Data reduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/catalog.html">Source catalogs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/observation_clustering.html">Observational clustering</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/model_management.html">Modelling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/fitting.html">Fitting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/estimators.html">Estimators</a></li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../scripts/survey_map.html">Survey Map Script</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../index.html" class="nav-link">Tutorials</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">Data structures</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-tutorials-starting-overview-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code. or to run this example in your browser via Binder</p>
</div>
<section class="sphx-glr-example-title" id="data-structures">
<span id="sphx-glr-tutorials-starting-overview-py"></span><h1>Data structures<a class="headerlink" href="#data-structures" title="Link to this heading">#</a></h1>
<p>Introduction to basic data structures handling.</p>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Link to this heading">#</a></h2>
<p>This is a getting started tutorial for Gammapy.</p>
<p>In this tutorial we will use the <a class="reference external" href="http://fermi.gsfc.nasa.gov/ssc/data/access/lat/3FHL/">Third Fermi-LAT Catalog of
High-Energy Sources (3FHL)
catalog</a>,
corresponding event list and images to learn how to work with some of
the central Gammapy data structures.</p>
<p>We will cover the following topics:</p>
<ul class="simple">
<li><p><strong>Sky maps</strong></p>
<ul>
<li><p>We will learn how to handle image based data with gammapy using a
Fermi-LAT 3FHL example image. We will work with the following
classes:</p>
<ul>
<li><p><a class="reference internal" href="../../api/gammapy.maps.WcsNDMap.html#gammapy.maps.WcsNDMap" title="gammapy.maps.WcsNDMap"><code class="xref py py-obj docutils literal notranslate"><span class="pre">WcsNDMap</span></code></a></p></li>
<li><p><a class="reference external" href="https://docs.astropy.org/en/latest/api/astropy.coordinates.SkyCoord.html#astropy.coordinates.SkyCoord" title="(in Astropy v7.1)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">SkyCoord</span></code></a></p></li>
<li><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.1)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ndarray</span></code></a></p></li>
</ul>
</li>
</ul>
</li>
<li><p><strong>Event lists</strong></p>
<ul>
<li><p>We will learn how to handle event lists with Gammapy. Important
for this are the following classes:</p>
<ul>
<li><p><a class="reference internal" href="../../api/gammapy.data.EventList.html#gammapy.data.EventList" title="gammapy.data.EventList"><code class="xref py py-obj docutils literal notranslate"><span class="pre">EventList</span></code></a></p></li>
<li><p><a class="reference external" href="https://docs.astropy.org/en/latest/api/astropy.table.Table.html#astropy.table.Table" title="(in Astropy v7.1)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Table</span></code></a></p></li>
</ul>
</li>
</ul>
</li>
<li><p><strong>Source catalogs</strong></p>
<ul>
<li><p>We will show how to load source catalogs with Gammapy and explore
the data using the following classes:</p>
<ul>
<li><p><a class="reference internal" href="../../api/gammapy.catalog.SourceCatalog.html#gammapy.catalog.SourceCatalog" title="gammapy.catalog.SourceCatalog"><code class="xref py py-obj docutils literal notranslate"><span class="pre">SourceCatalog</span></code></a>, specifically
<a class="reference internal" href="../../api/gammapy.catalog.SourceCatalog3FHL.html#gammapy.catalog.SourceCatalog3FHL" title="gammapy.catalog.SourceCatalog3FHL"><code class="xref py py-obj docutils literal notranslate"><span class="pre">SourceCatalog3FHL</span></code></a></p></li>
<li><p><a class="reference external" href="https://docs.astropy.org/en/latest/api/astropy.table.Table.html#astropy.table.Table" title="(in Astropy v7.1)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Table</span></code></a></p></li>
</ul>
</li>
</ul>
</li>
<li><p><strong>Spectral models and flux points</strong></p>
<ul>
<li><p>We will pick an example source and show how to plot its spectral
model and flux points. For this we will use the following classes:</p>
<ul>
<li><p><a class="reference internal" href="../../api/gammapy.modeling.models.SpectralModel.html#gammapy.modeling.models.SpectralModel" title="gammapy.modeling.models.SpectralModel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">SpectralModel</span></code></a>, specifically the
<a class="reference internal" href="../../api/gammapy.modeling.models.PowerLaw2SpectralModel.html#gammapy.modeling.models.PowerLaw2SpectralModel" title="gammapy.modeling.models.PowerLaw2SpectralModel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">PowerLaw2SpectralModel</span></code></a></p></li>
<li><p><a class="reference internal" href="../../api/gammapy.estimators.FluxPoints.html#gammapy.estimators.FluxPoints" title="gammapy.estimators.FluxPoints"><code class="xref py py-obj docutils literal notranslate"><span class="pre">FluxPoints</span></code></a></p></li>
<li><p><a class="reference external" href="https://docs.astropy.org/en/latest/api/astropy.table.Table.html#astropy.table.Table" title="(in Astropy v7.1)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Table</span></code></a></p></li>
</ul>
</li>
</ul>
</li>
</ul>
</section>
<section id="setup">
<h2>Setup<a class="headerlink" href="#setup" title="Link to this heading">#</a></h2>
<p><strong>Important</strong>: to run this tutorial the environment variable
<code class="docutils literal notranslate"><span class="pre">GAMMAPY_DATA</span></code> must be defined and point to the directory on your
machine where the datasets needed are placed. To check whether your
setup is correct you can execute the following cell:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">astropy.units</span> <span class="k">as</span> <span class="nn">u</span>
<span class="kn">from</span> <span class="nn">astropy.coordinates</span> <span class="kn">import</span> <a href="https://docs.astropy.org/en/latest/api/astropy.coordinates.SkyCoord.html#astropy.coordinates.SkyCoord" title="astropy.coordinates.SkyCoord" class="sphx-glr-backref-module-astropy-coordinates sphx-glr-backref-type-py-class"><span class="n">SkyCoord</span></a>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</section>
<section id="check-setup">
<h2>Check setup<a class="headerlink" href="#check-setup" title="Link to this heading">#</a></h2>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">gammapy.utils.check</span> <span class="kn">import</span> <span class="n">check_tutorials_setup</span>

<span class="c1"># %matplotlib inline</span>


<span class="n">check_tutorials_setup</span><span class="p">()</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>System:

        python_executable      : /home/runner/work/gammapy-docs/gammapy-docs/gammapy/.tox/build_docs/bin/python
        python_version         : 3.9.20
        machine                : x86_64
        system                 : Linux


Gammapy package:

        version                : 1.3rc1
        path                   : /home/runner/work/gammapy-docs/gammapy-docs/gammapy/.tox/build_docs/lib/python3.9/site-packages/gammapy


Other packages:

        numpy                  : 1.26.4
        scipy                  : 1.13.1
        astropy                : 5.2.2
        regions                : 0.8
        click                  : 8.1.7
        yaml                   : 6.0.2
        IPython                : 8.18.1
        jupyterlab             : not installed
        matplotlib             : 3.9.2
        pandas                 : not installed
        healpy                 : 1.17.3
        iminuit                : 2.30.1
        sherpa                 : 4.16.1
        naima                  : 0.10.0
        emcee                  : 3.1.6
        corner                 : 2.2.2
        ray                    : 2.39.0


Gammapy environment variables:

        GAMMAPY_DATA           : /home/runner/work/gammapy-docs/gammapy-docs/gammapy-datasets/1.3rc1
</pre></div>
</div>
</section>
<section id="maps">
<h2>Maps<a class="headerlink" href="#maps" title="Link to this heading">#</a></h2>
<p>The <a class="reference internal" href="../../api-reference/maps.html#module-gammapy.maps" title="gammapy.maps"><code class="xref py py-obj docutils literal notranslate"><span class="pre">maps</span></code></a> package contains classes to work with sky images
and cubes.</p>
<p>In this section, we will use a simple 2D sky image and will learn how
to:</p>
<ul class="simple">
<li><p>Read sky images from FITS files</p></li>
<li><p>Smooth images</p></li>
<li><p>Plot images</p></li>
<li><p>Cutout parts from images</p></li>
</ul>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">gammapy.maps</span> <span class="kn">import</span> <span class="n">Map</span>

<a href="../../api/gammapy.maps.WcsNDMap.html#gammapy.maps.WcsNDMap" title="gammapy.maps.WcsNDMap" class="sphx-glr-backref-module-gammapy-maps sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">gc_3fhl</span></a> <span class="o">=</span> <a href="../../api/gammapy.maps.Map.html#gammapy.maps.Map.read" title="gammapy.maps.Map.read" class="sphx-glr-backref-module-gammapy-maps-Map sphx-glr-backref-type-py-method"><span class="n">Map</span><span class="o">.</span><span class="n">read</span></a><span class="p">(</span><span class="s2">&quot;$GAMMAPY_DATA/fermi-3fhl-gc/fermi-3fhl-gc-counts.fits.gz&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>The image is a <a class="reference internal" href="../../api/gammapy.maps.WcsNDMap.html#gammapy.maps.WcsNDMap" title="gammapy.maps.WcsNDMap"><code class="xref py py-obj docutils literal notranslate"><span class="pre">WcsNDMap</span></code></a> object:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><a href="../../api/gammapy.maps.WcsNDMap.html#gammapy.maps.WcsNDMap" title="gammapy.maps.WcsNDMap" class="sphx-glr-backref-module-gammapy-maps sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">gc_3fhl</span></a><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>WcsNDMap

        geom  : WcsGeom
        axes  : [&#39;lon&#39;, &#39;lat&#39;]
        shape : (400, 200)
        ndim  : 2
        unit  :
        dtype : &gt;i8
</pre></div>
</div>
<p>The shape of the image is 400 x 200 pixel and it is defined using a
cartesian projection in galactic coordinates.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">geom</span></code> attribute is a <a class="reference internal" href="../../api/gammapy.maps.WcsGeom.html#gammapy.maps.WcsGeom" title="gammapy.maps.WcsGeom"><code class="xref py py-obj docutils literal notranslate"><span class="pre">WcsGeom</span></code></a> object:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><a href="../../api/gammapy.maps.WcsNDMap.html#gammapy.maps.WcsNDMap.geom" title="gammapy.maps.WcsNDMap.geom" class="sphx-glr-backref-module-gammapy-maps sphx-glr-backref-type-py-attribute"><span class="n">gc_3fhl</span><span class="o">.</span><span class="n">geom</span></a><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>WcsGeom

        axes       : [&#39;lon&#39;, &#39;lat&#39;]
        shape      : (400, 200)
        ndim       : 2
        frame      : galactic
        projection : CAR
        center     : 0.0 deg, 0.0 deg
        width      : 20.0 deg x 10.0 deg
        wcs ref    : 0.0 deg, 0.0 deg
</pre></div>
</div>
<p>Let’s take a closer look a the <code class="docutils literal notranslate"><span class="pre">.data</span></code> attribute:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><a href="../../api/gammapy.maps.WcsNDMap.html#gammapy.maps.WcsNDMap.data" title="gammapy.maps.WcsNDMap.data" class="sphx-glr-backref-module-gammapy-maps sphx-glr-backref-type-py-attribute"><span class="n">gc_3fhl</span><span class="o">.</span><span class="n">data</span></a><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[[0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 ...
 [0 0 0 ... 0 0 1]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 1]]
</pre></div>
</div>
<p>That looks familiar! It just an <em>ordinary</em> 2 dimensional numpy array,
which means you can apply any known numpy method to it:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Total number of counts in the image: </span><span class="si">{</span><a href="../../api/gammapy.maps.WcsNDMap.html#gammapy.maps.WcsNDMap.data" title="gammapy.maps.WcsNDMap.data" class="sphx-glr-backref-module-gammapy-maps sphx-glr-backref-type-py-attribute"><span class="n">gc_3fhl</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">sum</span></a><span class="p">()</span><span class="si">:</span><span class="s2">.0f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Total number of counts in the image: 32684
</pre></div>
</div>
<p>To show the image on the screen we can use the <code class="docutils literal notranslate"><span class="pre">plot</span></code> method. It
basically calls
<a class="reference external" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.imshow.html">plt.imshow</a>,
passing the <code class="docutils literal notranslate"><span class="pre">gc_3fhl.data</span></code> attribute but in addition handles axis with
world coordinates using
<a class="reference external" href="https://docs.astropy.org/en/stable/visualization/wcsaxes/">astropy.visualization.wcsaxes</a>
and defines some defaults for nicer plots (e.g. the colormap ‘afmhot’):</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="../../api/gammapy.maps.WcsNDMap.html#gammapy.maps.WcsNDMap.plot" title="gammapy.maps.WcsNDMap.plot" class="sphx-glr-backref-module-gammapy-maps sphx-glr-backref-type-py-method"><span class="n">gc_3fhl</span><span class="o">.</span><span class="n">plot</span></a><span class="p">(</span><span class="n">stretch</span><span class="o">=</span><span class="s2">&quot;sqrt&quot;</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.show.html#matplotlib.pyplot.show" title="matplotlib.pyplot.show" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">show</span></a><span class="p">()</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_overview_001.png" srcset="../../_images/sphx_glr_overview_001.png" alt="overview" class = "sphx-glr-single-img"/><p>To make the structures in the image more visible we will smooth the data
using a Gaussian kernel.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="../../api/gammapy.maps.WcsNDMap.html#gammapy.maps.WcsNDMap" title="gammapy.maps.WcsNDMap" class="sphx-glr-backref-module-gammapy-maps sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">gc_3fhl_smoothed</span></a> <span class="o">=</span> <a href="../../api/gammapy.maps.WcsNDMap.html#gammapy.maps.WcsNDMap.smooth" title="gammapy.maps.WcsNDMap.smooth" class="sphx-glr-backref-module-gammapy-maps sphx-glr-backref-type-py-method"><span class="n">gc_3fhl</span><span class="o">.</span><span class="n">smooth</span></a><span class="p">(</span><span class="n">kernel</span><span class="o">=</span><span class="s2">&quot;gauss&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">0.2</span> <span class="o">*</span> <a href="https://docs.astropy.org/en/latest/api/astropy.units.Unit.html#astropy.units.Unit" title="astropy.units.Unit" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">u</span><span class="o">.</span><span class="n">deg</span></a><span class="p">)</span>
<a href="../../api/gammapy.maps.WcsNDMap.html#gammapy.maps.WcsNDMap.plot" title="gammapy.maps.WcsNDMap.plot" class="sphx-glr-backref-module-gammapy-maps sphx-glr-backref-type-py-method"><span class="n">gc_3fhl_smoothed</span><span class="o">.</span><span class="n">plot</span></a><span class="p">(</span><span class="n">stretch</span><span class="o">=</span><span class="s2">&quot;sqrt&quot;</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.show.html#matplotlib.pyplot.show" title="matplotlib.pyplot.show" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">show</span></a><span class="p">()</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_overview_002.png" srcset="../../_images/sphx_glr_overview_002.png" alt="overview" class = "sphx-glr-single-img"/><p>The smoothed plot already looks much nicer, but still the image is
rather large. As we are mostly interested in the inner part of the
image, we will cut out a quadratic region of the size 9 deg x 9 deg
around Vela. Therefore we use <code class="xref py py-obj docutils literal notranslate"><span class="pre">cutout</span></code> to make a
cutout map:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># define center and size of the cutout region</span>
<a href="https://docs.astropy.org/en/latest/api/astropy.coordinates.SkyCoord.html#astropy.coordinates.SkyCoord" title="astropy.coordinates.SkyCoord" class="sphx-glr-backref-module-astropy-coordinates sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">center</span></a> <span class="o">=</span> <a href="https://docs.astropy.org/en/latest/api/astropy.coordinates.SkyCoord.html#astropy.coordinates.SkyCoord" title="astropy.coordinates.SkyCoord" class="sphx-glr-backref-module-astropy-coordinates sphx-glr-backref-type-py-class"><span class="n">SkyCoord</span></a><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="s2">&quot;deg&quot;</span><span class="p">,</span> <span class="n">frame</span><span class="o">=</span><span class="s2">&quot;galactic&quot;</span><span class="p">)</span>
<a href="../../api/gammapy.maps.WcsNDMap.html#gammapy.maps.WcsNDMap" title="gammapy.maps.WcsNDMap" class="sphx-glr-backref-module-gammapy-maps sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">gc_3fhl_cutout</span></a> <span class="o">=</span> <a href="../../api/gammapy.maps.WcsNDMap.html#gammapy.maps.WcsNDMap.cutout" title="gammapy.maps.WcsNDMap.cutout" class="sphx-glr-backref-module-gammapy-maps sphx-glr-backref-type-py-method"><span class="n">gc_3fhl_smoothed</span><span class="o">.</span><span class="n">cutout</span></a><span class="p">(</span><a href="https://docs.astropy.org/en/latest/api/astropy.coordinates.SkyCoord.html#astropy.coordinates.SkyCoord" title="astropy.coordinates.SkyCoord" class="sphx-glr-backref-module-astropy-coordinates sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">center</span></a><span class="p">,</span> <span class="mi">9</span> <span class="o">*</span> <a href="https://docs.astropy.org/en/latest/api/astropy.units.Unit.html#astropy.units.Unit" title="astropy.units.Unit" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">u</span><span class="o">.</span><span class="n">deg</span></a><span class="p">)</span>
<a href="../../api/gammapy.maps.WcsNDMap.html#gammapy.maps.WcsNDMap.plot" title="gammapy.maps.WcsNDMap.plot" class="sphx-glr-backref-module-gammapy-maps sphx-glr-backref-type-py-method"><span class="n">gc_3fhl_cutout</span><span class="o">.</span><span class="n">plot</span></a><span class="p">(</span><span class="n">stretch</span><span class="o">=</span><span class="s2">&quot;sqrt&quot;</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.show.html#matplotlib.pyplot.show" title="matplotlib.pyplot.show" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">show</span></a><span class="p">()</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_overview_003.png" srcset="../../_images/sphx_glr_overview_003.png" alt="overview" class = "sphx-glr-single-img"/><p>For a more detailed introduction to <a class="reference internal" href="../../api-reference/maps.html#module-gammapy.maps" title="gammapy.maps"><code class="xref py py-obj docutils literal notranslate"><span class="pre">maps</span></code></a>, take a look a the
<a class="reference internal" href="../api/maps.html"><span class="doc">Maps</span></a> notebook.</p>
<section id="exercises">
<h3>Exercises<a class="headerlink" href="#exercises" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Add a marker and circle at the position of <code class="docutils literal notranslate"><span class="pre">Sgr</span> <span class="pre">A*</span></code> (you can find
examples in
<a class="reference external" href="https://docs.astropy.org/en/stable/visualization/wcsaxes/">astropy.visualization.wcsaxes</a>).</p></li>
</ul>
</section>
</section>
<section id="event-lists">
<h2>Event lists<a class="headerlink" href="#event-lists" title="Link to this heading">#</a></h2>
<p>Almost any high level gamma-ray data analysis starts with the raw
measured counts data, which is stored in event lists. In Gammapy event
lists are represented by the <a class="reference internal" href="../../api/gammapy.data.EventList.html#gammapy.data.EventList" title="gammapy.data.EventList"><code class="xref py py-obj docutils literal notranslate"><span class="pre">EventList</span></code></a> class.</p>
<p>In this section we will learn how to:</p>
<ul class="simple">
<li><p>Read event lists from FITS files</p></li>
<li><p>Access and work with the <code class="docutils literal notranslate"><span class="pre">EventList</span></code> attributes such as <code class="docutils literal notranslate"><span class="pre">.table</span></code>
and <code class="docutils literal notranslate"><span class="pre">.energy</span></code></p></li>
<li><p>Filter events lists using convenience methods</p></li>
</ul>
<p>Let’s start with the import from the <a class="reference internal" href="../../api-reference/data.html#module-gammapy.data" title="gammapy.data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">data</span></code></a> submodule:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">gammapy.data</span> <span class="kn">import</span> <span class="n">EventList</span>
</pre></div>
</div>
<p>Very similar to the sky map class an event list can be created, by
passing a filename to the <a class="reference internal" href="../../api/gammapy.data.EventList.html#gammapy.data.EventList.read" title="gammapy.data.EventList.read"><code class="xref py py-obj docutils literal notranslate"><span class="pre">read()</span></code></a> method:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="../../api/gammapy.data.EventList.html#gammapy.data.EventList" title="gammapy.data.EventList" class="sphx-glr-backref-module-gammapy-data sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">events_3fhl</span></a> <span class="o">=</span> <a href="../../api/gammapy.data.EventList.html#gammapy.data.EventList.read" title="gammapy.data.EventList.read" class="sphx-glr-backref-module-gammapy-data sphx-glr-backref-type-py-method"><span class="n">EventList</span><span class="o">.</span><span class="n">read</span></a><span class="p">(</span><span class="s2">&quot;$GAMMAPY_DATA/fermi-3fhl-gc/fermi-3fhl-gc-events.fits.gz&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>This time the actual data is stored as an
<code class="xref py py-obj docutils literal notranslate"> <span class="pre">It</span> <span class="pre">can</span> <span class="pre">be</span> <span class="pre">accessed</span> <span class="pre">with</span> <span class="pre">`</span></code>.table`` attribute:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><a href="https://docs.astropy.org/en/latest/api/astropy.table.Table.html#astropy.table.Table" title="astropy.table.Table" class="sphx-glr-backref-module-astropy-table sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">events_3fhl</span><span class="o">.</span><span class="n">table</span></a><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>  ENERGY      RA       DEC         L      ... DIFRSP1 DIFRSP2 DIFRSP3 DIFRSP4
   MeV       deg       deg        deg     ...
--------- --------- ---------- ---------- ... ------- ------- ------- -------
12186.642 260.45935 -33.553337  353.36273 ...     0.0     0.0     0.0     0.0
25496.598 261.37506 -34.395004  353.09607 ...     0.0     0.0     0.0     0.0
15621.498 259.56973 -33.409416  353.05673 ...     0.0     0.0     0.0     0.0
 12816.32 273.95883 -25.340391    6.45856 ...     0.0     0.0     0.0     0.0
18988.387  260.8568 -36.355804  351.23734 ...     0.0     0.0     0.0     0.0
 11610.23 266.15518 -26.224436  2.1986027 ...     0.0     0.0     0.0     0.0
13960.802 271.44742 -29.615316  1.6267247 ...     0.0     0.0     0.0     0.0
10477.372  266.3981  -28.96814  359.97003 ...     0.0     0.0     0.0     0.0
 13030.88 271.70428 -20.632627    9.59348 ...     0.0     0.0     0.0     0.0
11517.904 265.00894 -30.065119  358.40112 ...     0.0     0.0     0.0     0.0
      ...       ...        ...        ... ...     ...     ...     ...     ...
387834.72  270.3779  -21.56711   8.171749 ...     0.0     0.0     0.0     0.0
 20559.74  268.5538 -26.345692   3.200638 ...     0.0     0.0     0.0     0.0
27209.146 266.59344  -30.52607  358.72775 ...     0.0     0.0     0.0     0.0
13911.061 269.30997 -27.239439  2.7684028 ...     0.0     0.0     0.0     0.0
13226.425 265.16287 -27.344238  0.7796942 ...     0.0     0.0     0.0     0.0
17445.463 266.63342 -28.807201 0.21464892 ...     0.0     0.0     0.0     0.0
13133.864 270.42474 -22.651058   7.251185 ...     0.0     0.0     0.0     0.0
32095.705  266.0002  -29.77206   359.1034 ...     0.0     0.0     0.0     0.0
18465.783 266.39728 -29.105953  359.85202 ...     0.0     0.0     0.0     0.0
 14457.25 262.72217 -34.388405   353.7184 ...     0.0     0.0     0.0     0.0
Length = 32843 rows
</pre></div>
</div>
<p>You can do <em>len</em> over event_3fhl.table to find the total number of
events.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><a href="https://docs.astropy.org/en/latest/api/astropy.table.Table.html#astropy.table.Table" title="astropy.table.Table" class="sphx-glr-backref-module-astropy-table sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">events_3fhl</span><span class="o">.</span><span class="n">table</span></a><span class="p">))</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>32843
</pre></div>
</div>
<p>And we can access any other attribute of the <code class="docutils literal notranslate"><span class="pre">Table</span></code> object as well:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><a href="https://docs.astropy.org/en/latest/api/astropy.table.Table.html#astropy.table.Table.colnames" title="astropy.table.Table.colnames" class="sphx-glr-backref-module-astropy-table sphx-glr-backref-type-py-attribute"><span class="n">events_3fhl</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">colnames</span></a><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[&#39;ENERGY&#39;, &#39;RA&#39;, &#39;DEC&#39;, &#39;L&#39;, &#39;B&#39;, &#39;THETA&#39;, &#39;PHI&#39;, &#39;ZENITH_ANGLE&#39;, &#39;EARTH_AZIMUTH_ANGLE&#39;, &#39;TIME&#39;, &#39;EVENT_ID&#39;, &#39;RUN_ID&#39;, &#39;RECON_VERSION&#39;, &#39;CALIB_VERSION&#39;, &#39;EVENT_CLASS&#39;, &#39;EVENT_TYPE&#39;, &#39;CONVERSION_TYPE&#39;, &#39;LIVETIME&#39;, &#39;DIFRSP0&#39;, &#39;DIFRSP1&#39;, &#39;DIFRSP2&#39;, &#39;DIFRSP3&#39;, &#39;DIFRSP4&#39;]
</pre></div>
</div>
<p>For convenience we can access the most important event parameters as
properties on the <code class="docutils literal notranslate"><span class="pre">EventList</span></code> objects. The attributes will return
corresponding Astropy objects to represent the data, such as
<a class="reference external" href="https://docs.astropy.org/en/latest/api/astropy.units.Quantity.html#astropy.units.Quantity" title="(in Astropy v7.1)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Quantity</span></code></a>,
<a class="reference external" href="https://docs.astropy.org/en/latest/api/astropy.coordinates.SkyCoord.html#astropy.coordinates.SkyCoord" title="(in Astropy v7.1)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">SkyCoord</span></code></a>
or
<a class="reference external" href="https://docs.astropy.org/en/latest/api/astropy.time.Time.html#astropy.time.Time" title="(in Astropy v7.1)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Time</span></code></a>
objects:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><a href="../../api/gammapy.data.EventList.html#gammapy.data.EventList.energy" title="gammapy.data.EventList.energy" class="sphx-glr-backref-module-gammapy-data sphx-glr-backref-type-py-attribute"><span class="n">events_3fhl</span><span class="o">.</span><span class="n">energy</span><span class="o">.</span><span class="n">to</span></a><span class="p">(</span><span class="s2">&quot;GeV&quot;</span><span class="p">))</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[12.186643 25.4966   15.621499 ... 32.095707 18.465784 14.457251] GeV
</pre></div>
</div>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><a href="../../api/gammapy.data.EventList.html#gammapy.data.EventList.galactic" title="gammapy.data.EventList.galactic" class="sphx-glr-backref-module-gammapy-data sphx-glr-backref-type-py-attribute"><span class="n">events_3fhl</span><span class="o">.</span><span class="n">galactic</span></a><span class="p">)</span>
<span class="c1"># events_3fhl.radec</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;SkyCoord (Galactic): (l, b) in deg
    [(353.36228879,  1.75408483), (353.09562941,  0.6522806 ),
     (353.05628243,  2.44528685), ..., (359.10295505, -0.1359316 ),
     (359.85157506, -0.08269984), (353.71795506, -0.26883694)]&gt;
</pre></div>
</div>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><a href="../../api/gammapy.data.EventList.html#gammapy.data.EventList.time" title="gammapy.data.EventList.time" class="sphx-glr-backref-module-gammapy-data sphx-glr-backref-type-py-attribute"><span class="n">events_3fhl</span><span class="o">.</span><span class="n">time</span></a><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[54682.82946153 54682.89243456 54682.89709472 ... 57236.75267735
 57233.37455141 57233.44802852]
</pre></div>
</div>
<p>In addition <code class="docutils literal notranslate"><span class="pre">EventList</span></code> provides convenience methods to filter the
event lists. One possible use case is to find the highest energy event
within a radius of 0.5 deg around the vela position:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># select all events within a radius of 0.5 deg around center</span>
<span class="kn">from</span> <span class="nn">gammapy.utils.regions</span> <span class="kn">import</span> <a href="https://astropy-regions.readthedocs.io/en/latest/api/regions.CircleSkyRegion.html#regions.CircleSkyRegion" title="regions.CircleSkyRegion" class="sphx-glr-backref-module-regions sphx-glr-backref-type-py-class"><span class="n">SphericalCircleSkyRegion</span></a>

<span class="n">region</span> <span class="o">=</span> <a href="https://astropy-regions.readthedocs.io/en/latest/api/regions.CircleSkyRegion.html#regions.CircleSkyRegion" title="regions.CircleSkyRegion" class="sphx-glr-backref-module-regions sphx-glr-backref-type-py-class"><span class="n">SphericalCircleSkyRegion</span></a><span class="p">(</span><a href="https://docs.astropy.org/en/latest/api/astropy.coordinates.SkyCoord.html#astropy.coordinates.SkyCoord" title="astropy.coordinates.SkyCoord" class="sphx-glr-backref-module-astropy-coordinates sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">center</span></a><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="mf">0.5</span> <span class="o">*</span> <a href="https://docs.astropy.org/en/latest/api/astropy.units.Unit.html#astropy.units.Unit" title="astropy.units.Unit" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">u</span><span class="o">.</span><span class="n">deg</span></a><span class="p">)</span>
<a href="../../api/gammapy.data.EventList.html#gammapy.data.EventList" title="gammapy.data.EventList" class="sphx-glr-backref-module-gammapy-data sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">events_gc_3fhl</span></a> <span class="o">=</span> <a href="../../api/gammapy.data.EventList.html#gammapy.data.EventList.select_region" title="gammapy.data.EventList.select_region" class="sphx-glr-backref-module-gammapy-data sphx-glr-backref-type-py-method"><span class="n">events_3fhl</span><span class="o">.</span><span class="n">select_region</span></a><span class="p">(</span><span class="n">region</span><span class="p">)</span>

<span class="c1"># sort events by energy</span>
<a href="https://docs.astropy.org/en/latest/api/astropy.table.Table.html#astropy.table.Table.sort" title="astropy.table.Table.sort" class="sphx-glr-backref-module-astropy-table sphx-glr-backref-type-py-method"><span class="n">events_gc_3fhl</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">sort</span></a><span class="p">(</span><span class="s2">&quot;ENERGY&quot;</span><span class="p">)</span>

<span class="c1"># and show highest energy photon</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;highest energy photon: &quot;</span><span class="p">,</span> <a href="../../api/gammapy.data.EventList.html#gammapy.data.EventList.energy" title="gammapy.data.EventList.energy" class="sphx-glr-backref-module-gammapy-data sphx-glr-backref-type-py-attribute"><span class="n">events_gc_3fhl</span><span class="o">.</span><span class="n">energy</span></a><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s2">&quot;GeV&quot;</span><span class="p">))</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>highest energy photon:  1917.85925 GeV
</pre></div>
</div>
<section id="id1">
<h3>Exercises<a class="headerlink" href="#id1" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Make a counts energy spectrum for the galactic center region, within
a radius of 10 deg.</p></li>
</ul>
</section>
</section>
<section id="source-catalogs">
<h2>Source catalogs<a class="headerlink" href="#source-catalogs" title="Link to this heading">#</a></h2>
<p>Gammapy provides a convenient interface to access and work with catalog
based data.</p>
<p>In this section we will learn how to:</p>
<ul class="simple">
<li><p>Load builtins catalogs from <a class="reference internal" href="../../api-reference/catalog.html#module-gammapy.catalog" title="gammapy.catalog"><code class="xref py py-obj docutils literal notranslate"><span class="pre">catalog</span></code></a></p></li>
<li><p>Sort and index the underlying Astropy tables</p></li>
<li><p>Access data from individual sources</p></li>
</ul>
<p>Let’s start with importing the 3FHL catalog object from the
<a class="reference internal" href="../../api-reference/catalog.html#module-gammapy.catalog" title="gammapy.catalog"><code class="xref py py-obj docutils literal notranslate"><span class="pre">catalog</span></code></a> submodule:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">gammapy.catalog</span> <span class="kn">import</span> <a href="../../api/gammapy.catalog.SourceCatalog3FHL.html#gammapy.catalog.SourceCatalog3FHL" title="gammapy.catalog.SourceCatalog3FHL" class="sphx-glr-backref-module-gammapy-catalog sphx-glr-backref-type-py-class"><span class="n">SourceCatalog3FHL</span></a>
</pre></div>
</div>
<p>First we initialize the Fermi-LAT 3FHL catalog and directly take a look
at the <code class="docutils literal notranslate"><span class="pre">.table</span></code> attribute:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="../../api/gammapy.catalog.SourceCatalog3FHL.html#gammapy.catalog.SourceCatalog3FHL" title="gammapy.catalog.SourceCatalog3FHL" class="sphx-glr-backref-module-gammapy-catalog sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fermi_3fhl</span></a> <span class="o">=</span> <a href="../../api/gammapy.catalog.SourceCatalog3FHL.html#gammapy.catalog.SourceCatalog3FHL" title="gammapy.catalog.SourceCatalog3FHL" class="sphx-glr-backref-module-gammapy-catalog sphx-glr-backref-type-py-class"><span class="n">SourceCatalog3FHL</span></a><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><a href="https://docs.astropy.org/en/latest/api/astropy.table.Table.html#astropy.table.Table" title="astropy.table.Table" class="sphx-glr-backref-module-astropy-table sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fermi_3fhl</span><span class="o">.</span><span class="n">table</span></a><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>   Source_Name     RAJ2000  DEJ2000  ... Redshift     NuPeak_obs
                     deg      deg    ...                  Hz
------------------ -------- -------- ... -------- ------------------
3FHL J0001.2-0748    0.3107  -7.8075 ...       --  306196370000000.0
3FHL J0001.9-4155    0.4849 -41.9303 ...       -- 6309576500000000.0
3FHL J0002.1-6728    0.5283 -67.4825 ...       -- 4466832000000000.0
3FHL J0003.3-5248    0.8300 -52.8150 ...       --       7.079464e+16
3FHL J0007.0+7303    1.7647  73.0560 ...       --                 --
3FHL J0007.9+4711    1.9931  47.1920 ...   0.2800 2511884200000000.0
3FHL J0008.4-2339    2.1243 -23.6514 ...   0.1470  524807800000000.0
3FHL J0009.1+0628    2.2874   6.4814 ...       --  663742400000000.0
3FHL J0009.4+5030    2.3504  50.5049 ...       -- 1412536400000000.0
3FHL J0009.7-4319    2.4450 -43.3195 ...       --                 --
               ...      ...      ... ...      ...                ...
3FHL J2347.9-1630  356.9978 -16.5106 ...   0.5760    9332549000000.0
3FHL J2350.5-3006  357.6354 -30.1070 ...   0.2237 3981075200000000.0
3FHL J2351.5-7559  357.8926 -75.9890 ...       --                 --
3FHL J2352.1+1753  358.0415  17.8865 ...       -- 1737799900000000.0
3FHL J2356.2+4035  359.0746  40.5985 ...   0.1310 6309576500000000.0
3FHL J2357.4-1717  359.3690 -17.2996 ...       --       8.912525e+16
3FHL J2358.4-1808  359.6205 -18.1408 ...       --                 --
3FHL J2358.5+3829  359.6266  38.4963 ...       --                 --
3FHL J2359.1-3038  359.7760 -30.6397 ...   0.1650       2.818388e+17
3FHL J2359.3-2049  359.8293 -20.8256 ...   0.0960 4073799600000000.0
Length = 1556 rows
</pre></div>
</div>
<p>This looks very familiar again. The data is just stored as an
<a class="reference external" href="https://docs.astropy.org/en/latest/api/astropy.table.Table.html#astropy.table.Table" title="(in Astropy v7.1)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Table</span></code></a>
object. We have all the methods and attributes of the <code class="docutils literal notranslate"><span class="pre">Table</span></code> object
available. E.g. we can sort the underlying table by <code class="docutils literal notranslate"><span class="pre">Signif_Avg</span></code> to
find the top 5 most significant sources:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># sort table by significance</span>
<a href="https://docs.astropy.org/en/latest/api/astropy.table.Table.html#astropy.table.Table.sort" title="astropy.table.Table.sort" class="sphx-glr-backref-module-astropy-table sphx-glr-backref-type-py-method"><span class="n">fermi_3fhl</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">sort</span></a><span class="p">(</span><span class="s2">&quot;Signif_Avg&quot;</span><span class="p">)</span>

<span class="c1"># invert the order to find the highest values and take the top 5</span>
<a href="https://docs.astropy.org/en/latest/api/astropy.table.Table.html#astropy.table.Table" title="astropy.table.Table" class="sphx-glr-backref-module-astropy-table sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">top_five_TS_3fhl</span></a> <span class="o">=</span> <a href="https://docs.astropy.org/en/latest/api/astropy.table.Table.html#astropy.table.Table" title="astropy.table.Table" class="sphx-glr-backref-module-astropy-table sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fermi_3fhl</span><span class="o">.</span><span class="n">table</span></a><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">][:</span><span class="mi">5</span><span class="p">]</span>

<span class="c1"># print the top five significant sources with association and source class</span>
<span class="nb">print</span><span class="p">(</span><a href="https://docs.astropy.org/en/latest/api/astropy.table.Table.html#astropy.table.Table" title="astropy.table.Table" class="sphx-glr-backref-module-astropy-table sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">top_five_TS_3fhl</span></a><span class="p">[[</span><span class="s2">&quot;Source_Name&quot;</span><span class="p">,</span> <span class="s2">&quot;ASSOC1&quot;</span><span class="p">,</span> <span class="s2">&quot;ASSOC2&quot;</span><span class="p">,</span> <span class="s2">&quot;CLASS&quot;</span><span class="p">,</span> <span class="s2">&quot;Signif_Avg&quot;</span><span class="p">]])</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>   Source_Name               ASSOC1           ...  CLASS  Signif_Avg
------------------ -------------------------- ... ------- ----------
3FHL J0534.5+2201  Crab Nebula                ... PWN        168.641
3FHL J1104.4+3812  Mkn 421                    ... BLL        144.406
3FHL J0835.3-4510  PSR J0835-4510             ... PSR        138.801
3FHL J0633.9+1746  PSR J0633+1746             ... PSR         99.734
3FHL J1555.7+1111  PG 1553+113                ... BLL         94.411
</pre></div>
</div>
<p>If you are interested in the data of an individual source you can access
the information from catalog using the name of the source or any alias
source name that is defined in the catalog:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="../../api/gammapy.catalog.SourceCatalogObject3FHL.html#gammapy.catalog.SourceCatalogObject3FHL" title="gammapy.catalog.SourceCatalogObject3FHL" class="sphx-glr-backref-module-gammapy-catalog sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mkn_421_3fhl</span></a> <span class="o">=</span> <a href="../../api/gammapy.catalog.SourceCatalog3FHL.html#gammapy.catalog.SourceCatalog3FHL" title="gammapy.catalog.SourceCatalog3FHL" class="sphx-glr-backref-module-gammapy-catalog sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fermi_3fhl</span></a><span class="p">[</span><span class="s2">&quot;3FHL J1104.4+3812&quot;</span><span class="p">]</span>

<span class="c1"># or use any alias source name that is defined in the catalog</span>
<a href="../../api/gammapy.catalog.SourceCatalogObject3FHL.html#gammapy.catalog.SourceCatalogObject3FHL" title="gammapy.catalog.SourceCatalogObject3FHL" class="sphx-glr-backref-module-gammapy-catalog sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mkn_421_3fhl</span></a> <span class="o">=</span> <a href="../../api/gammapy.catalog.SourceCatalog3FHL.html#gammapy.catalog.SourceCatalog3FHL" title="gammapy.catalog.SourceCatalog3FHL" class="sphx-glr-backref-module-gammapy-catalog sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fermi_3fhl</span></a><span class="p">[</span><span class="s2">&quot;Mkn 421&quot;</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><a href="../../api/gammapy.catalog.SourceCatalogObject3FHL.html#gammapy.catalog.SourceCatalogObject3FHL" title="gammapy.catalog.SourceCatalogObject3FHL" class="sphx-glr-backref-module-gammapy-catalog sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mkn_421_3fhl</span></a><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;Signif_Avg&quot;</span><span class="p">])</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>144.40611
</pre></div>
</div>
<section id="id2">
<h3>Exercises<a class="headerlink" href="#id2" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Try to load the Fermi-LAT 2FHL catalog and check the total number of
sources it contains.</p></li>
<li><p>Select all the sources from the 2FHL catalog which are contained in
the Galactic Center region. The methods
<a class="reference internal" href="../../api/gammapy.maps.WcsGeom.html#gammapy.maps.WcsGeom.contains" title="gammapy.maps.WcsGeom.contains"><code class="xref py py-obj docutils literal notranslate"><span class="pre">contains()</span></code></a> and
<a class="reference internal" href="../../api/gammapy.catalog.SourceCatalog.html#gammapy.catalog.SourceCatalog.positions" title="gammapy.catalog.SourceCatalog.positions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">positions</span></code></a> might be helpful for
this. Add markers for all these sources and try to add labels with
the source names.</p></li>
<li><p>Try to find the source class of the object at position ra=68.6803,
dec=9.3331</p></li>
</ul>
</section>
</section>
<section id="spectral-models-and-flux-points">
<h2>Spectral models and flux points<a class="headerlink" href="#spectral-models-and-flux-points" title="Link to this heading">#</a></h2>
<p>In the previous section we learned how access basic data from individual
sources in the catalog. Now we will go one step further and explore the
full spectral information of sources. We will learn how to:</p>
<ul class="simple">
<li><p>Plot spectral models</p></li>
<li><p>Compute integral and energy fluxes</p></li>
<li><p>Read and plot flux points</p></li>
</ul>
<p>As a first example we will start with the Crab Nebula:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="../../api/gammapy.catalog.SourceCatalogObject3FHL.html#gammapy.catalog.SourceCatalogObject3FHL" title="gammapy.catalog.SourceCatalogObject3FHL" class="sphx-glr-backref-module-gammapy-catalog sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">crab_3fhl</span></a> <span class="o">=</span> <a href="../../api/gammapy.catalog.SourceCatalog3FHL.html#gammapy.catalog.SourceCatalog3FHL" title="gammapy.catalog.SourceCatalog3FHL" class="sphx-glr-backref-module-gammapy-catalog sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fermi_3fhl</span></a><span class="p">[</span><span class="s2">&quot;Crab Nebula&quot;</span><span class="p">]</span>
<a href="../../api/gammapy.modeling.models.PowerLawSpectralModel.html#gammapy.modeling.models.PowerLawSpectralModel" title="gammapy.modeling.models.PowerLawSpectralModel" class="sphx-glr-backref-module-gammapy-modeling-models sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">crab_3fhl_spec</span></a> <span class="o">=</span> <a href="../../api/gammapy.catalog.SourceCatalogObject3FHL.html#gammapy.catalog.SourceCatalogObject3FHL.spectral_model" title="gammapy.catalog.SourceCatalogObject3FHL.spectral_model" class="sphx-glr-backref-module-gammapy-catalog sphx-glr-backref-type-py-method"><span class="n">crab_3fhl</span><span class="o">.</span><span class="n">spectral_model</span></a><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><a href="../../api/gammapy.modeling.models.PowerLawSpectralModel.html#gammapy.modeling.models.PowerLawSpectralModel" title="gammapy.modeling.models.PowerLawSpectralModel" class="sphx-glr-backref-module-gammapy-modeling-models sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">crab_3fhl_spec</span></a><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>PowerLawSpectralModel

type    name     value         unit        error   min max frozen link prior
---- --------- ---------- -------------- --------- --- --- ------ ---- -----
         index 2.2202e+00                2.498e-02 nan nan  False
     amplitude 1.7132e-10 cm-2 GeV-1 s-1 3.389e-12 nan nan  False
     reference 2.2726e+01            GeV 0.000e+00 nan nan   True
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">crab_3fhl_spec</span></code> is an instance of the
<a class="reference internal" href="../../api/gammapy.modeling.models.PowerLaw2SpectralModel.html#gammapy.modeling.models.PowerLaw2SpectralModel" title="gammapy.modeling.models.PowerLaw2SpectralModel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">PowerLaw2SpectralModel</span></code></a> model, with the
parameter values and errors taken from the 3FHL catalog.</p>
<p>Let’s plot the spectral model in the energy range between 10 GeV and
2000 GeV:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.html#matplotlib.axes.Axes" title="matplotlib.axes.Axes" class="sphx-glr-backref-module-matplotlib-axes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ax_crab_3fhl</span></a> <span class="o">=</span> <a href="../../api/gammapy.modeling.models.PowerLawSpectralModel.html#gammapy.modeling.models.PowerLawSpectralModel.plot" title="gammapy.modeling.models.PowerLawSpectralModel.plot" class="sphx-glr-backref-module-gammapy-modeling-models sphx-glr-backref-type-py-method"><span class="n">crab_3fhl_spec</span><span class="o">.</span><span class="n">plot</span></a><span class="p">(</span><span class="n">energy_bounds</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">2000</span><span class="p">]</span> <span class="o">*</span> <a href="https://docs.astropy.org/en/latest/api/astropy.units.PrefixUnit.html#astropy.units.PrefixUnit" title="astropy.units.PrefixUnit" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">u</span><span class="o">.</span><span class="n">GeV</span></a><span class="p">,</span> <span class="n">energy_power</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.show.html#matplotlib.pyplot.show" title="matplotlib.pyplot.show" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">show</span></a><span class="p">()</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_overview_004.png" srcset="../../_images/sphx_glr_overview_004.png" alt="overview" class = "sphx-glr-single-img"/><p>We assign the return axes object to variable called <code class="docutils literal notranslate"><span class="pre">ax_crab_3fhl</span></code>,
because we will re-use it later to plot the flux points on top.</p>
<p>To compute the differential flux at 100 GeV we can simply call the model
like normal Python function and convert to the desired units:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><a href="../../api/gammapy.modeling.models.PowerLawSpectralModel.html#gammapy.modeling.models.PowerLawSpectralModel" title="gammapy.modeling.models.PowerLawSpectralModel" class="sphx-glr-backref-module-gammapy-modeling-models sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">crab_3fhl_spec</span></a><span class="p">(</span><span class="mi">100</span> <span class="o">*</span> <a href="https://docs.astropy.org/en/latest/api/astropy.units.PrefixUnit.html#astropy.units.PrefixUnit" title="astropy.units.PrefixUnit" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">u</span><span class="o">.</span><span class="n">GeV</span></a><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s2">&quot;cm-2 s-1 GeV-1&quot;</span><span class="p">))</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>6.3848912826152664e-12 1 / (cm2 GeV s)
</pre></div>
</div>
<p>Next we can compute the integral flux of the Crab between 10 GeV and
2000 GeV:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span>
    <a href="../../api/gammapy.modeling.models.PowerLawSpectralModel.html#gammapy.modeling.models.PowerLawSpectralModel.integral" title="gammapy.modeling.models.PowerLawSpectralModel.integral" class="sphx-glr-backref-module-gammapy-modeling-models sphx-glr-backref-type-py-method"><span class="n">crab_3fhl_spec</span><span class="o">.</span><span class="n">integral</span></a><span class="p">(</span><span class="n">energy_min</span><span class="o">=</span><span class="mi">10</span> <span class="o">*</span> <a href="https://docs.astropy.org/en/latest/api/astropy.units.PrefixUnit.html#astropy.units.PrefixUnit" title="astropy.units.PrefixUnit" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">u</span><span class="o">.</span><span class="n">GeV</span></a><span class="p">,</span> <span class="n">energy_max</span><span class="o">=</span><span class="mi">2000</span> <span class="o">*</span> <a href="https://docs.astropy.org/en/latest/api/astropy.units.PrefixUnit.html#astropy.units.PrefixUnit" title="astropy.units.PrefixUnit" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">u</span><span class="o">.</span><span class="n">GeV</span></a><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span>
        <span class="s2">&quot;cm-2 s-1&quot;</span>
    <span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>8.67457342435522e-09 1 / (cm2 s)
</pre></div>
</div>
<p>We can easily convince ourself, that it corresponds to the value given
in the Fermi-LAT 3FHL catalog:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><a href="../../api/gammapy.catalog.SourceCatalogObject3FHL.html#gammapy.catalog.SourceCatalogObject3FHL" title="gammapy.catalog.SourceCatalogObject3FHL" class="sphx-glr-backref-module-gammapy-catalog sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">crab_3fhl</span></a><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;Flux&quot;</span><span class="p">])</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>8.658909145253801e-09 1 / (cm2 s)
</pre></div>
</div>
<p>In addition we can compute the energy flux between 10 GeV and 2000 GeV:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span>
    <a href="../../api/gammapy.modeling.models.PowerLawSpectralModel.html#gammapy.modeling.models.PowerLawSpectralModel.energy_flux" title="gammapy.modeling.models.PowerLawSpectralModel.energy_flux" class="sphx-glr-backref-module-gammapy-modeling-models sphx-glr-backref-type-py-method"><span class="n">crab_3fhl_spec</span><span class="o">.</span><span class="n">energy_flux</span></a><span class="p">(</span><span class="n">energy_min</span><span class="o">=</span><span class="mi">10</span> <span class="o">*</span> <a href="https://docs.astropy.org/en/latest/api/astropy.units.PrefixUnit.html#astropy.units.PrefixUnit" title="astropy.units.PrefixUnit" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">u</span><span class="o">.</span><span class="n">GeV</span></a><span class="p">,</span> <span class="n">energy_max</span><span class="o">=</span><span class="mi">2000</span> <span class="o">*</span> <a href="https://docs.astropy.org/en/latest/api/astropy.units.PrefixUnit.html#astropy.units.PrefixUnit" title="astropy.units.PrefixUnit" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">u</span><span class="o">.</span><span class="n">GeV</span></a><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span>
        <span class="s2">&quot;erg cm-2 s-1&quot;</span>
    <span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>5.311489174710791e-10 erg / (cm2 s)
</pre></div>
</div>
<p>Next we will access the flux points data of the Crab:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><a href="../../api/gammapy.catalog.SourceCatalogObject3FHL.html#gammapy.catalog.SourceCatalogObject3FHL.flux_points" title="gammapy.catalog.SourceCatalogObject3FHL.flux_points" class="sphx-glr-backref-module-gammapy-catalog sphx-glr-backref-type-py-attribute"><span class="n">crab_3fhl</span><span class="o">.</span><span class="n">flux_points</span></a><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>FluxPoints
----------

  geom                   : RegionGeom
  axes                   : [&#39;lon&#39;, &#39;lat&#39;, &#39;energy&#39;]
  shape                  : (1, 1, 5)
  quantities             : [&#39;norm&#39;, &#39;norm_errp&#39;, &#39;norm_errn&#39;, &#39;norm_ul&#39;, &#39;sqrt_ts&#39;, &#39;is_ul&#39;]
  ref. model             : pl
  n_sigma                : 1
  n_sigma_ul             : 2
  sqrt_ts_threshold_ul   : 1
  sed type init          : flux
</pre></div>
</div>
<p>If you want to learn more about the different flux point formats you can
read the specification
<a class="reference external" href="https://gamma-astro-data-formats.readthedocs.io/en/latest/spectra/flux_points/index.html">here</a>.</p>
<p>No we can check again the underlying astropy data structure by accessing
the <code class="docutils literal notranslate"><span class="pre">.table</span></code> attribute:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><a href="../../api/gammapy.catalog.SourceCatalogObject3FHL.html#gammapy.catalog.SourceCatalogObject3FHL.flux_points" title="gammapy.catalog.SourceCatalogObject3FHL.flux_points" class="sphx-glr-backref-module-gammapy-catalog sphx-glr-backref-type-py-attribute"><span class="n">crab_3fhl</span><span class="o">.</span><span class="n">flux_points</span><span class="o">.</span><span class="n">to_table</span></a><span class="p">(</span><span class="n">sed_type</span><span class="o">=</span><span class="s2">&quot;dnde&quot;</span><span class="p">,</span> <span class="n">formatted</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span> e_ref    e_min   e_max         dnde      ...     dnde_ul     sqrt_ts is_ul
  GeV      GeV     GeV    1 / (cm2 GeV s) ... 1 / (cm2 GeV s)
-------- ------- -------- --------------- ... --------------- ------- -----
  14.142  10.000   20.000       5.120e-10 ...             nan 125.157 False
  31.623  20.000   50.000       7.359e-11 ...             nan  88.715 False
  86.603  50.000  150.000       9.024e-12 ...             nan  59.087 False
 273.861 150.000  500.000       7.660e-13 ...             nan  33.076 False
1000.000 500.000 2000.000       4.291e-14 ...             nan  15.573 False
</pre></div>
</div>
<p>Finally let’s combine spectral model and flux points in a single plot
and scale with <code class="docutils literal notranslate"><span class="pre">energy_power=2</span></code> to obtain the spectral energy
distribution:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.html#matplotlib.axes.Axes" title="matplotlib.axes.Axes" class="sphx-glr-backref-module-matplotlib-axes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ax</span></a> <span class="o">=</span> <a href="../../api/gammapy.modeling.models.PowerLawSpectralModel.html#gammapy.modeling.models.PowerLawSpectralModel.plot" title="gammapy.modeling.models.PowerLawSpectralModel.plot" class="sphx-glr-backref-module-gammapy-modeling-models sphx-glr-backref-type-py-method"><span class="n">crab_3fhl_spec</span><span class="o">.</span><span class="n">plot</span></a><span class="p">(</span><span class="n">energy_bounds</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">2000</span><span class="p">]</span> <span class="o">*</span> <a href="https://docs.astropy.org/en/latest/api/astropy.units.PrefixUnit.html#astropy.units.PrefixUnit" title="astropy.units.PrefixUnit" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">u</span><span class="o">.</span><span class="n">GeV</span></a><span class="p">,</span> <span class="n">sed_type</span><span class="o">=</span><span class="s2">&quot;e2dnde&quot;</span><span class="p">)</span>
<a href="../../api/gammapy.catalog.SourceCatalogObject3FHL.html#gammapy.catalog.SourceCatalogObject3FHL.flux_points" title="gammapy.catalog.SourceCatalogObject3FHL.flux_points" class="sphx-glr-backref-module-gammapy-catalog sphx-glr-backref-type-py-attribute"><span class="n">crab_3fhl</span><span class="o">.</span><span class="n">flux_points</span><span class="o">.</span><span class="n">plot</span></a><span class="p">(</span><a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.html#matplotlib.axes.Axes" title="matplotlib.axes.Axes" class="sphx-glr-backref-module-matplotlib-axes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ax</span></a><span class="o">=</span><a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.html#matplotlib.axes.Axes" title="matplotlib.axes.Axes" class="sphx-glr-backref-module-matplotlib-axes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ax</span></a><span class="p">,</span> <span class="n">sed_type</span><span class="o">=</span><span class="s2">&quot;e2dnde&quot;</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.show.html#matplotlib.pyplot.show" title="matplotlib.pyplot.show" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">show</span></a><span class="p">()</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_overview_005.png" srcset="../../_images/sphx_glr_overview_005.png" alt="overview" class = "sphx-glr-single-img"/><section id="id3">
<h3>Exercises<a class="headerlink" href="#id3" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Plot the spectral model and flux points for PKS 2155-304 for the 3FGL
and 2FHL catalogs. Try to plot the error of the model (aka
“Butterfly”) as well.</p></li>
</ul>
</section>
</section>
<section id="what-next">
<h2>What next?<a class="headerlink" href="#what-next" title="Link to this heading">#</a></h2>
<p>This was a quick introduction to some of the high level classes in
Astropy and Gammapy.</p>
<ul class="simple">
<li><p>To learn more about those classes, go to the API docs (links are in
the introduction at the top).</p></li>
<li><p>To learn more about other parts of Gammapy (e.g. Fermi-LAT and TeV
data analysis), check out the other tutorial notebooks.</p></li>
<li><p>To see what’s available in Gammapy, browse the Gammapy docs or use
the full-text search.</p></li>
<li><p>If you have any questions, ask on the mailing list.</p></li>
</ul>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-tutorials-starting-overview-py">
<div class="binder-badge docutils container">
<a class="reference external image-reference" href="https://mybinder.org/v2/gh/gammapy/gammapy-webpage/v1.3rc1?urlpath=lab/tree/notebooks/1.3rc1/tutorials/starting/overview.ipynb"><img alt="Launch binder" src="../../_images/binder_badge_logo7.svg" style="width: 150px;" />
</a>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/b498d620c9c8072e088d03e5b1f86f65/overview.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">overview.ipynb</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/a58c9e9b0f550fcdfa900c62e84a523a/overview.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">overview.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-zip docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/7f0f5ef8ba9bdfd9da1248f73ad010fe/overview.zip"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">zipped:</span> <span class="pre">overview.zip</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>
</section>


                </article>
              
              
              
              
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#setup">Setup</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#check-setup">Check setup</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#maps">Maps</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercises">Exercises</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#event-lists">Event lists</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Exercises</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#source-catalogs">Source catalogs</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Exercises</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spectral-models-and-flux-points">Spectral models and flux points</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">Exercises</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#what-next">What next?</a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">

  <div class="tocsection sourcelink">
    <a href="../../_sources/tutorials/starting/overview.rst.txt">
      <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../../_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549"></script>
<script defer src="../../_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2024, The Gammapy developers.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">
    
     <a href="https://gammapy.org/DataPrivacy.html">Data Privacy.</a>
</div>
      
    </div>
  
  
    <div class="footer-items__center">
      
        <div class="footer-item"><p class="last-updated">
  Last updated on 15 Nov 2024.
  <br/>
</p></div>
      
    </div>
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.4.7.
    <br/>
  </p>
</div>
      
        <div class="footer-item">
<p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.0.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>