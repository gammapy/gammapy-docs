
<!DOCTYPE html>


<html lang="en" data-content_root="../" data-theme="light">

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Documentation How To &#8212; gammapy vX.Y.Z</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "light";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  <!-- 
    this give us a css class that will be invisible only if js is disabled 
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=fd3f3429" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css?v=d2d258e8" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=203afaf9" />
  
  <!-- So that users can add custom icons -->
  <script src="../_static/scripts/fontawesome.js?digest=26a4bc78f4c0ddb94549"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549" />

    <script src="../_static/jquery.js?v=5d32c60e"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
    <script src="../_static/documentation_options.js?v=1f75dfce"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=30646c52"></script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'development/doc_howto';</script>
    <script>
        DOCUMENTATION_OPTIONS.theme_version = '0.16.0';
        DOCUMENTATION_OPTIONS.theme_switcher_json_url = 'https://docs.gammapy.org/stable/switcher.json';
        DOCUMENTATION_OPTIONS.theme_switcher_version_match = 'dev';
        DOCUMENTATION_OPTIONS.show_version_warning_banner = false;
        </script>
    <script src="../_static/matomo.js?v=52704cab"></script>
    <link rel="icon" href="../_static/gammapy_logo.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Developer How To" href="dev_howto.html" />
    <link rel="prev" title="How to make a Gammapy release" href="release.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="1.3.dev1443+g419934a21" />
    <meta name="docbuild:last-update" content="12 Nov 2024"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="light">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
    
    <img src="../_static/gammapy_logo_nav.png" class="logo__image only-light" alt="gammapy vX.Y.Z - Home"/>
    <img src="../_static/gammapy_logo_nav.png" class="logo__image only-dark pst-js-only" alt="gammapy vX.Y.Z - Home"/>
  
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../getting-started/index.html">
    Getting started
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../user-guide/index.html">
    User guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../tutorials/index.html">
    Tutorials
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../api-reference/index.html">
    API reference
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="index.html">
    Developer guide
  </a>
</li>

            <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-nav-more-links">
                    More
                </button>
                <ul id="pst-nav-more-links" class="dropdown-menu">
                    
<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../release-notes/index.html">
    Release notes
  </a>
</li>

                </ul>
            </li>
            
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">
<div class="version-switcher__container dropdown pst-js-only">
  <button id="pst-version-switcher-button-2"
    type="button"
    class="version-switcher__button btn btn-sm dropdown-toggle"
    data-bs-toggle="dropdown"
    aria-haspopup="listbox"
    aria-controls="pst-version-switcher-list-2"
    aria-label="Version switcher list"
  >
    Choose version  <!-- this text may get changed later by javascript -->
    <span class="caret"></span>
  </button>
  <div id="pst-version-switcher-list-2"
    class="version-switcher__menu dropdown-menu list-group-flush py-0"
    role="listbox" aria-labelledby="pst-version-switcher-button-2">
    <!-- dropdown will be populated by javascript on page load -->
  </div>
</div></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/gammapy/gammapy" title="Github" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fab fa-github-square fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Github</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://twitter.com/gammapyST" title="Twitter" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fab fa-square-x-twitter fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Twitter</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://gammapy.slack.com/" title="Slack" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fab fa-slack fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Slack</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../getting-started/index.html">
    Getting started
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../user-guide/index.html">
    User guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../tutorials/index.html">
    Tutorials
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../api-reference/index.html">
    API reference
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="index.html">
    Developer guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../release-notes/index.html">
    Release notes
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">
<div class="version-switcher__container dropdown pst-js-only">
  <button id="pst-version-switcher-button-3"
    type="button"
    class="version-switcher__button btn btn-sm dropdown-toggle"
    data-bs-toggle="dropdown"
    aria-haspopup="listbox"
    aria-controls="pst-version-switcher-list-3"
    aria-label="Version switcher list"
  >
    Choose version  <!-- this text may get changed later by javascript -->
    <span class="caret"></span>
  </button>
  <div id="pst-version-switcher-list-3"
    class="version-switcher__menu dropdown-menu list-group-flush py-0"
    role="listbox" aria-labelledby="pst-version-switcher-button-3">
    <!-- dropdown will be populated by javascript on page load -->
  </div>
</div></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/gammapy/gammapy" title="Github" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fab fa-github-square fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Github</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://twitter.com/gammapyST" title="Twitter" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fab fa-square-x-twitter fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Twitter</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://gammapy.slack.com/" title="Slack" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fab fa-slack fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Slack</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="setup.html">Project setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="dependencies.html">Dependencies</a></li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="intro.html">How to contribute to Gammapy</a></li>
<li class="toctree-l1"><a class="reference internal" href="release.html">How to make a Gammapy release</a></li>
</ul>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Documentation How To</a></li>
<li class="toctree-l1"><a class="reference internal" href="dev_howto.html">Developer How To</a></li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="pigs/index.html">PIGs</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="pigs/pig-001.html">PIG 1 - PIG purpose and guidelines</a></li>
<li class="toctree-l2"><a class="reference internal" href="pigs/pig-002.html">PIG 2 - Organization of low level analysis code</a></li>
<li class="toctree-l2"><a class="reference internal" href="pigs/pig-003.html">PIG 3 - Plan for dropping Python 2.7 support</a></li>
<li class="toctree-l2"><a class="reference internal" href="pigs/pig-004.html">PIG 4 - Setup for tutorial notebooks and data</a></li>
<li class="toctree-l2"><a class="reference internal" href="pigs/pig-005.html">PIG 5 - Gammapy 1.0 roadmap</a></li>
<li class="toctree-l2"><a class="reference internal" href="pigs/pig-006.html">PIG 6 - CTA observation handling</a></li>
<li class="toctree-l2"><a class="reference internal" href="pigs/pig-007.html">PIG 7 - Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="pigs/pig-008.html">PIG 8 - Datasets</a></li>
<li class="toctree-l2"><a class="reference internal" href="pigs/pig-009.html">PIG 9 - Event sampling</a></li>
<li class="toctree-l2"><a class="reference internal" href="pigs/pig-010.html">PIG 10 - Regions</a></li>
<li class="toctree-l2"><a class="reference internal" href="pigs/pig-011.html">PIG 11 - Light curves</a></li>
<li class="toctree-l2"><a class="reference internal" href="pigs/pig-012.html">PIG 12 - High level interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="pigs/pig-013.html">PIG 13 - Gammapy dependencies and distribution</a></li>
<li class="toctree-l2"><a class="reference internal" href="pigs/pig-014.html">PIG 14 - Uncertainty estimation</a></li>
<li class="toctree-l2"><a class="reference internal" href="pigs/pig-016.html">PIG 16 - Gammapy package structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="pigs/pig-018.html">PIG 18 - Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="pigs/pig-019.html">PIG 19 - Gammapy package structure follow up</a></li>
<li class="toctree-l2"><a class="reference internal" href="pigs/pig-020.html">PIG 20 - Global Model API</a></li>
<li class="toctree-l2"><a class="reference internal" href="pigs/pig-021.html">PIG 21 - Models improvements</a></li>
<li class="toctree-l2"><a class="reference internal" href="pigs/pig-022.html">PIG 22 - Unified flux estimators API</a></li>
<li class="toctree-l2"><a class="reference internal" href="pigs/pig-023.html">PIG 23 - Gammapy release cycle and version numbering</a></li>
<li class="toctree-l2"><a class="reference internal" href="pigs/pig-024.html">PIG 24 - Authorship policy</a></li>
<li class="toctree-l2"><a class="reference internal" href="pigs/pig-025.html">PIG 25 - Metadata container for Gammapy</a></li>
<li class="toctree-l2"><a class="reference internal" href="pigs/pig-026.html">PIG 26 - Model Priors API</a></li>
</ul>
</details></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="index.html" class="nav-link">Developer guide</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">Documentation How To</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="documentation-how-to">
<span id="doc-howto"></span><h1>Documentation How To<a class="headerlink" href="#documentation-how-to" title="Link to this heading">#</a></h1>
<section id="documentation-building">
<h2>Documentation building<a class="headerlink" href="#documentation-building" title="Link to this heading">#</a></h2>
<p>Generating the HTML docs for Gammapy is straight-forward:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">make</span> <span class="n">docs</span><span class="o">-</span><span class="n">sphinx</span>
<span class="n">make</span> <span class="n">docs</span><span class="o">-</span><span class="n">show</span>
</pre></div>
</div>
<p>Or one can equivalently use tox:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">tox</span> <span class="o">-</span><span class="n">e</span> <span class="n">build_docs</span>
</pre></div>
</div>
<p>Generating the PDF docs is more complex.
This should work:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># build the latex file</span>
<span class="n">cd</span> <span class="n">docs</span>
<span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">sphinx</span> <span class="o">.</span> <span class="n">_build</span><span class="o">/</span><span class="n">latex</span> <span class="o">-</span><span class="n">b</span> <span class="n">latex</span> <span class="o">-</span><span class="n">j</span> <span class="n">auto</span>
<span class="c1"># first generation of pdf file</span>
<span class="n">cd</span> <span class="n">_build</span><span class="o">/</span><span class="n">latex</span>
<span class="n">pdflatex</span> <span class="o">-</span><span class="n">interaction</span><span class="o">=</span><span class="n">nonstopmode</span> <span class="n">gammapy</span><span class="o">.</span><span class="n">tex</span>
<span class="c1"># final generation of pdf file</span>
<span class="n">pdflatex</span> <span class="o">-</span><span class="n">interaction</span><span class="o">=</span><span class="n">nonstopmode</span> <span class="n">gammapy</span><span class="o">.</span><span class="n">tex</span>
<span class="c1"># clean the git repo</span>
<span class="n">git</span> <span class="n">reset</span> <span class="o">--</span><span class="n">hard</span>
<span class="c1"># open the pdf file</span>
<span class="nb">open</span> <span class="n">gammapy</span><span class="o">.</span><span class="n">pdf</span>
</pre></div>
</div>
<p>You need a bunch or LaTeX stuff, specifically <code class="docutils literal notranslate"><span class="pre">texlive-fonts-extra</span></code> is needed.</p>
</section>
<section id="check-python-code">
<h2>Check Python code<a class="headerlink" href="#check-python-code" title="Link to this heading">#</a></h2>
<section id="code-in-rst-files">
<h3>Code in RST files<a class="headerlink" href="#code-in-rst-files" title="Link to this heading">#</a></h3>
<p>Most of the documentation of Gammapy is present in RST files that are converted into HTML pages using
Sphinx during the build documentation process. You may include snippets of Python code in these RST files
within blocks labelled with <code class="docutils literal notranslate"><span class="pre">..</span> <span class="pre">code-block::</span> <span class="pre">python</span></code> Sphinx directive. However, this code could not be
tested, and it will not be possible to know if it fails in following versions of Gammapy. That’s why we
recommend using the <code class="docutils literal notranslate"><span class="pre">..</span> <span class="pre">testcode::</span></code> directive to enclose code that will be tested against the results
present in a block labelled with <code class="docutils literal notranslate"><span class="pre">..</span> <span class="pre">testoutput::</span></code> directive. If not <code class="docutils literal notranslate"><span class="pre">..</span> <span class="pre">testoutput::</span></code> directive is provided,
only execution tests will be performed.</p>
<p>For example, we could check that the code below does not fail, since it does not provide any output.</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>.. testcode::

    from gammapy.astro import source
    from gammapy.astro import population
    from gammapy.astro import darkmatter
</pre></div>
</div>
<p>On the contrary, we could check the execution of the following code as well as the output values produced.</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>.. testcode::

    from astropy.time import Time
    time = Time([&#39;1999-01-01T00:00:00.123456789&#39;, &#39;2010-01-01T00:00:00&#39;])
    print(time.mjd)

.. testoutput::

    [51179.00000143 55197.        ]
</pre></div>
</div>
<p>In order to perform tests of these snippets of code present in RST files, you may run the following command.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pytest<span class="w"> </span>--doctest-glob<span class="o">=</span><span class="s2">&quot;*.rst&quot;</span><span class="w"> </span>docs/
</pre></div>
</div>
</section>
<section id="code-in-docstrings-in-python-files">
<h3>Code in docstrings in Python files<a class="headerlink" href="#code-in-docstrings-in-python-files" title="Link to this heading">#</a></h3>
<p>It is also advisable to add code snippets within the docstrings of the classes and functions present in Python files.
These snippets show how to use the function or class that is documented, and are written in the docstrings using the
following syntax.</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Examples
--------
&gt;&gt;&gt; from astropy.units import Quantity
&gt;&gt;&gt; from gammapy.data import EventList
&gt;&gt;&gt; event_list = EventList.read(&#39;events.fits&#39;) # doctest: +SKIP
</pre></div>
</div>
<p>In the case above, we could check the execution of the first two lines importing the <code class="docutils literal notranslate"><span class="pre">Quantity</span></code> and <code class="docutils literal notranslate"><span class="pre">EventList</span></code>
modules, whilst the third line will be skipped. On the contrary, in the example below we could check the execution of
the code as well as the output value produced.</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Examples
--------
&gt;&gt;&gt; from regions import Regions
&gt;&gt;&gt; regions = Regions.parse(&quot;galactic;circle(10,20,3)&quot;, format=&quot;ds9&quot;)
&gt;&gt;&gt; print(regions[0])
Region: CircleSkyRegion
center: &lt;SkyCoord (Galactic): (l, b) in deg
    (10., 20.)&gt;
radius: 3.0 deg
</pre></div>
</div>
<p>To allow the code block to be placed correctly over multiple lines utilise the “…”:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Examples
--------
&gt;&gt;&gt; from gammapy.maps import WcsGeom, MapAxis
&gt;&gt;&gt; energy_axis_true = MapAxis.from_energy_bounds(
...            0.5, 20, 10, unit=&quot;TeV&quot;, name=&quot;energy_true&quot;
...        )
</pre></div>
</div>
<p>For a larger code block it is also possible to utilise the following syntax.</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Examples
--------
.. testcode::

    from gammapy.maps import MapAxis
    from gammapy.irf import EnergyDispersion2D
    filename = &#39;$GAMMAPY_DATA/hess-dl3-dr1/data/hess_dl3_dr1_obs_id_020136.fits.gz&#39;
    edisp2d = EnergyDispersion2D.read(filename, hdu=&quot;EDISP&quot;)
</pre></div>
</div>
<p>In order to perform tests of these snippets of code present in the docstrings of the Python files, you may run the
following command.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pytest<span class="w"> </span>--doctest-modules<span class="w"> </span>--ignore-glob<span class="o">=</span>*/tests<span class="w"> </span>gammapy
</pre></div>
</div>
<p>If you get a zsh error try using putting to ignore block inside quotes</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pytest<span class="w"> </span>--doctest-modules<span class="w"> </span><span class="s2">&quot;--ignore-glob=*/tests&quot;</span><span class="w"> </span>gammapy
</pre></div>
</div>
<p>It is also important to check that you have correctly formatted your docstring. An easy way to check this
is with the following for your specific file, i.e.:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pydocstyle<span class="w"> </span>gammapy/data/event_list.py
</pre></div>
</div>
</section>
</section>
<section id="sphinx-gallery-extension">
<h2>Sphinx gallery extension<a class="headerlink" href="#sphinx-gallery-extension" title="Link to this heading">#</a></h2>
<p>The documentation built-in process uses the <a class="reference external" href="https://sphinx-gallery.github.io/stable/">sphinx-gallery</a>
extension to build galleries of illustrated examples on how to use Gammapy (i.e.
<a class="reference internal" href="../user-guide/model-gallery/index.html#model-gallery"><span class="std std-ref">Model gallery</span></a>). The Python scripts used to produce the model gallery are placed in
<code class="docutils literal notranslate"><span class="pre">examples/models</span></code> and <code class="docutils literal notranslate"><span class="pre">examples/tutorials</span></code>. The configuration of the <code class="docutils literal notranslate"><span class="pre">sphinx-gallery</span></code> module is done in <code class="docutils literal notranslate"><span class="pre">docs/conf.py</span></code>.
The tutorials are order using a python dictionary stored in <code class="docutils literal notranslate"><span class="pre">docs/sphinxext.py</span></code>.</p>
<section id="choose-a-thumbnail-and-tooltip-for-the-tutorial-gallery">
<h3>Choose a thumbnail and tooltip for the tutorial gallery<a class="headerlink" href="#choose-a-thumbnail-and-tooltip-for-the-tutorial-gallery" title="Link to this heading">#</a></h3>
<p>The Gammapy <a class="reference internal" href="../tutorials/index.html#tutorials"><span class="std std-ref">Tutorials</span></a> are Python scripts in the Sphinx Gallery format.
They are displayed as a gallery with picture thumbnails and tooltips. You can
choose the thumbnail for the tutorial by adding a comment before the plot:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># The next line sets the thumbnail for the second figure in the gallery</span>
<span class="c1"># (plot with negative exponential in orange)</span>
<span class="c1"># sphinx_gallery_thumbnail_number = 2</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$x$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$-\exp(-x)$&#39;</span><span class="p">)</span>
<span class="c1"># To avoid matplotlib text output</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>The example is taken from the <a class="reference external" href="https://sphinx-gallery.github.io/stable/auto_examples/plot_4_choose_thumbnail.html">sphinx-gallery documentation</a>,
please refer to it for more details.</p>
<p>The tooltip is the text that appears when you hover over the thumbnail. It is taken from the first line
of the docstring of the tutorial. You can change it by editing the docstring. See e.g.
<a class="reference external" href="https://github.com/gammapy/gammapy/blob/main/examples/tutorials/starting/analysis_1.py#L5">Analysis 1 Tutorial</a>.</p>
</section>
</section>
<section id="dealing-with-links">
<h2>Dealing with links<a class="headerlink" href="#dealing-with-links" title="Link to this heading">#</a></h2>
<p>Links in tutorials are just handled via normal RST syntax.</p>
<section id="links-to-other-tutorials">
<h3>Links to other tutorials<a class="headerlink" href="#links-to-other-tutorials" title="Link to this heading">#</a></h3>
<p>From docstrings and RST documentation files in Gammapy you can link to other tutorials
and gallery examples by using RST syntax like this:</p>
<div class="highlight-rst notranslate"><div class="highlight"><pre><span></span><span class="na">:doc:</span><span class="nv">`/tutorials/starting/analysis_2`</span>
</pre></div>
</div>
<p>This will link to the tutorial <a class="reference internal" href="../tutorials/starting/analysis_2.html"><span class="doc">Low level API</span></a> from the tutorial base folder. The file
suffix will be automatically inferred by Sphinx.</p>
</section>
<section id="links-to-documentation">
<h3>Links to documentation<a class="headerlink" href="#links-to-documentation" title="Link to this heading">#</a></h3>
<p>To make a reference to a heading within an RST file, first you need to define an explicit target for the heading:</p>
<div class="highlight-rst notranslate"><div class="highlight"><pre><span></span><span class="p">..</span> <span class="nt">_datasets:</span>

<span class="gh">Datasets (DL4)</span>
<span class="gh">==============</span>
</pre></div>
</div>
<p>The reference is the rendered as <code class="docutils literal notranslate"><span class="pre">datasets</span></code>.
To link to this in the documentation you can use:</p>
<div class="highlight-rst notranslate"><div class="highlight"><pre><span></span><span class="na">:ref:</span><span class="nv">`datasets`</span>
</pre></div>
</div>
</section>
<section id="api-links">
<h3>API Links<a class="headerlink" href="#api-links" title="Link to this heading">#</a></h3>
<p>Links to Gammapy API are handled via normal Sphinx syntax in comments:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create an `~gammapy.analysis.AnalysisConfig` object and edit it to</span>
<span class="c1"># define the analysis configuration:</span>

<span class="n">config</span> <span class="o">=</span> <span class="n">AnalysisConfig</span><span class="p">()</span>
</pre></div>
</div>
<p>This will resolve to a link to the <code class="docutils literal notranslate"><span class="pre">AnalysisConfig</span></code> class in the API documentation.</p>
</section>
<section id="check-broken-links">
<span id="dev-check-html-links"></span><h3>Check broken links<a class="headerlink" href="#check-broken-links" title="Link to this heading">#</a></h3>
<p>To check for broken external links you can use <code class="docutils literal notranslate"><span class="pre">tox</span></code>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>tox<span class="w"> </span>-e<span class="w"> </span>linkcheck
</pre></div>
</div>
</section>
</section>
<section id="include-png-files-as-images">
<h2>Include png files as images<a class="headerlink" href="#include-png-files-as-images" title="Link to this heading">#</a></h2>
<section id="in-the-rst-files">
<h3>In the RST files<a class="headerlink" href="#in-the-rst-files" title="Link to this heading">#</a></h3>
<p>Gammapy has a <code class="docutils literal notranslate"><span class="pre">gp-image</span></code> directive to include an image from <code class="docutils literal notranslate"><span class="pre">$GAMMAPY_DATA/figures/</span></code>,
use the <code class="docutils literal notranslate"><span class="pre">gp-image</span></code> directive instead of the usual Sphinx <code class="docutils literal notranslate"><span class="pre">image</span></code> directive like this:</p>
<div class="highlight-rst notranslate"><div class="highlight"><pre><span></span><span class="p">..</span> <span class="ow">gp-image</span><span class="p">::</span> detect/fermi_ts_image.png
    <span class="nc">:scale:</span> 100%
</pre></div>
</div>
<p>More info on the <a class="reference external" href="http://www.sphinx-doc.org/en/stable/rest.html#images">image directive</a>.</p>
</section>
</section>
<section id="documentation-guidelines">
<h2>Documentation guidelines<a class="headerlink" href="#documentation-guidelines" title="Link to this heading">#</a></h2>
<p>Like almost all Python projects, the Gammapy documentation is written in a format called
<a class="reference external" href="http://sphinx-doc.org/rest.html">restructured text (RST)</a> and built using <a class="reference external" href="http://sphinx-doc.org/">Sphinx</a>.
We mostly follow the <a class="reference external" href="https://docs.astropy.org/en/latest/development/docguide.html#documentation-guidelines" title="(in Astropy v7.1)"><span class="xref std std-ref">Astropy documentation guidelines</span></a>,
which are based on the <a class="reference external" href="https://numpydoc.readthedocs.io/en/latest/format.html#docstring-standard">Numpy docstring standard</a>,
which is what most scientific Python packages use.</p>
<p>There’s a few details that are not easy to figure out by browsing the Numpy or Astropy
documentation guidelines, or that we actually do differently in Gammapy.
These are listed here so that Gammapy developers have a reference.</p>
<p>Usually the quickest way to figure out how something should be done is to browse the Astropy
or Gammapy code a bit (either locally with your editor or online on GitHub or via the HTML docs),
or search the Numpy or Astropy documentation guidelines mentioned above.
If that doesn’t quickly turn up something useful, please ask by putting a comment on the issue or
pull request you’re working on GitHub, or email the Gammapy mailing list.</p>
<section id="correct-format-for-bullet-point-list">
<h3>Correct format for bullet point list<a class="headerlink" href="#correct-format-for-bullet-point-list" title="Link to this heading">#</a></h3>
<p>To correctly add a bullet point list to the docstring, the following can be implemented:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Docstring explanation.</span>

<span class="sd">Parameters</span>
<span class="sd">----------</span>
<span class="sd">parameter_name : parameter_type</span>
<span class="sd">    Description of the parameter with entries:</span>
<span class="sd">            * option1 : description1</span>
<span class="sd">            * option2 : description2</span>
<span class="sd">            * option3 : description3 over more than</span>
<span class="sd">            one line.</span>
<span class="sd">&quot;&quot;&quot;</span>
</pre></div>
</div>
</section>
<section id="functions-or-class-methods-that-return-a-single-object">
<h3>Functions or class methods that return a single object<a class="headerlink" href="#functions-or-class-methods-that-return-a-single-object" title="Link to this heading">#</a></h3>
<p>For functions or class methods that return a single object, following the
Numpy docstring standard and adding a <em>Returns</em> section usually means
that you duplicate the one-line description and repeat the function name as
return variable name.
See <a class="reference external" href="https://docs.astropy.org/en/latest/api/astropy.cosmology.LambdaCDM.html#astropy.cosmology.LambdaCDM.w" title="(in Astropy v7.1)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">w</span></code></a> or <a class="reference external" href="https://docs.astropy.org/en/latest/api/astropy.time.Time.html#astropy.time.Time.sidereal_time" title="(in Astropy v7.1)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sidereal_time</span></code></a>
as examples in the Astropy codebase. Here’s a simple example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">circle_area</span><span class="p">(</span><span class="n">radius</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Circle area.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    radius : `~astropy.units.Quantity`</span>
<span class="sd">        Circle radius</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    area : `~astropy.units.Quantity`</span>
<span class="sd">        Circle area</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="mf">3.14</span> <span class="o">*</span> <span class="p">(</span><span class="n">radius</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<p>In these cases, the following shorter format omitting the <em>Returns</em> section is recommended:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">circle_area</span><span class="p">(</span><span class="n">radius</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Circle area (`~astropy.units.Quantity`).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    radius : `~astropy.units.Quantity`</span>
<span class="sd">        Circle radius</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="mf">3.14</span> <span class="o">*</span> <span class="p">(</span><span class="n">radius</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<p>Usually the parameter description doesn’t fit on the one line, so it’s
recommended to always keep this in the <em>Parameters</em> section.</p>
<p>A common case where the short format is appropriate are class properties,
because they always return a single object.
As an example see <a class="reference internal" href="../api/gammapy.data.EventList.html#gammapy.data.EventList.radec" title="gammapy.data.EventList.radec"><code class="xref py py-obj docutils literal notranslate"><span class="pre">radec</span></code></a>, which is reproduced here:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@property</span>
<span class="k">def</span> <span class="nf">radec</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Event RA / DEC sky coordinates (`~astropy.coordinates.SkyCoord`).&quot;&quot;&quot;</span>
    <span class="n">lon</span><span class="p">,</span> <span class="n">lat</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="s1">&#39;RA&#39;</span><span class="p">],</span> <span class="bp">self</span><span class="p">[</span><span class="s1">&#39;DEC&#39;</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">SkyCoord</span><span class="p">(</span><span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="s1">&#39;deg&#39;</span><span class="p">,</span> <span class="n">frame</span><span class="o">=</span><span class="s1">&#39;icrs&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="class-attributes">
<h3>Class attributes<a class="headerlink" href="#class-attributes" title="Link to this heading">#</a></h3>
<p>Class attributes (data members) and properties are currently a bit of a mess.
Attributes are listed in an <em>Attributes</em> section because I’ve listed them in a class-level
docstring attributes section as recommended
<a class="reference external" href="https://numpydoc.readthedocs.io/en/latest/format.html#docstring-standard">here</a>.
Properties are listed in separate <em>Attributes summary</em> and <em>Attributes Documentation</em>
sections, which is confusing to users (“what’s the difference between attributes and properties?”).</p>
<p>One solution is to always use properties, but that can get very verbose if we have to write
so many getters and setters. We could start using descriptors.</p>
<p>TODO: make a decision on this and describe the issue / solution here.</p>
</section>
</section>
</section>


                </article>
              
              
              
              
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#documentation-building">Documentation building</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#check-python-code">Check Python code</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#code-in-rst-files">Code in RST files</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#code-in-docstrings-in-python-files">Code in docstrings in Python files</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sphinx-gallery-extension">Sphinx gallery extension</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#choose-a-thumbnail-and-tooltip-for-the-tutorial-gallery">Choose a thumbnail and tooltip for the tutorial gallery</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#dealing-with-links">Dealing with links</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#links-to-other-tutorials">Links to other tutorials</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#links-to-documentation">Links to documentation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#api-links">API Links</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#check-broken-links">Check broken links</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#include-png-files-as-images">Include png files as images</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#in-the-rst-files">In the RST files</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#documentation-guidelines">Documentation guidelines</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#correct-format-for-bullet-point-list">Correct format for bullet point list</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#functions-or-class-methods-that-return-a-single-object">Functions or class methods that return a single object</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#class-attributes">Class attributes</a></li>
</ul>
</li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">

  <div class="tocsection sourcelink">
    <a href="../_sources/development/doc_howto.rst.txt">
      <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549"></script>
<script defer src="../_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2024, The Gammapy developers.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">
    
     <a href="https://gammapy.org/DataPrivacy.html">Data Privacy.</a>
</div>
      
    </div>
  
  
    <div class="footer-items__center">
      
        <div class="footer-item"><p class="last-updated">
  Last updated on 12 Nov 2024.
  <br/>
</p></div>
      
    </div>
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.4.7.
    <br/>
  </p>
</div>
      
        <div class="footer-item">
<p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.0.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>